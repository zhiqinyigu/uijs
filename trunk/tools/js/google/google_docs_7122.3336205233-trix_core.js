var ca=navigator,da=Boolean,ea=clearInterval,fa=encodeURIComponent,ga=parseInt,ha=String,l=window,ja=Number,ka=TX_startLoadTime,la=confirm,ma=Function,na=Object,oa=document,pa=decodeURIComponent,qa=isNaN,ra=alert,ta=screen,o=Math;
function ua(a,b) {
	return a.onload=b
}function va(a,b) {
	return a.onchange=b
}function wa(a,b) {
	return a.scrollTop=b
}function xa(a,b) {
	return a.filter=b
}function ya(a,b) {
	return a.toString =b
}function za(a,b) {
	return a.resize=b
}function Aa(a,b) {
	return a.vAlign=b
}function Ba(a,b) {
	return a.onreadystatechange=
	b
}function Ca(a,b) {
	return a.startRow=b
}function Da(a,b) {
	return a.length=b
}function Ea(a,b) {
	return a.title=b
}function Fa(a,b) {
	return a.position=b
}function Ga(a,b) {
	return a.cursor=b
}function Ha(a,b) {
	return a.selectedIndex=b
}function r(a,b) {
	return a.className=b
}function x(a,b) {
	return a.width=b
}function Ia(a,b) {
	return a.index=b
}function Ja(a,b) {
	return a.text=b
}function Ka(a,b) {
	return a.borderRight=b
}function La(a,b) {
	return a.checked=b
}function Na(a,b) {
	return a.fontFamily=b
}function Oa(a,b) {
	return a.data=
	b
}function Pa(a,b) {
	return a.borderTop=b
}function y(a,b) {
	return a.innerHTML=b
}function Ra(a,b) {
	return a.cleanup=b
}function Sa(a,b) {
	return a.selected=b
}function Ta(a,b) {
	return a.value=b
}function Ua(a,b) {
	return a.borderLeft=b
}function Va(a,b) {
	return a.fontSize=b
}function Wa(a,b) {
	return a.paddingTop=b
}function Xa(a,b) {
	return a.disabled=b
}function Za(a,b) {
	return a.color=b
}function $a(a,b) {
	return a.textAlign=b
}function ab(a,b) {
	return a.onmouseout=b
}function bb(a,b) {
	return a.currentTarget=b
}function cb(a,
b) {
	return a.backgroundColor=b
}function hb(a,b) {
	return a.fontStyle=b
}function ib(a,b) {
	return a.left=b
}function jb(a,b) {
	return a.target=b
}function kb(a,b) {
	return a.screenX=b
}function lb(a,b) {
	return a.screenY=b
}function mb(a,b) {
	return a.gridId=b
}function nb(a,b) {
	return a.remove=b
}function ob(a,b) {
	return a.start=b
}function pb(a,b) {
	return a.cssText=b
}function qb(a,b) {
	return a.onmouseover=b
}function rb(a,b) {
	return a.keyCode=b
}function sb(a,b) {
	return a.enabled=b
}function tb(a,b) {
	return a.colSpan=b
}function ub(a,
b) {
	return a.padding=b
}function vb(a,b) {
	return a.scrollLeft=b
}function wb(a,b) {
	return a.paddingRight=b
}function yb(a,b) {
	return a.bottom=b
}function zb(a,b) {
	return a.href=b
}function Ab(a,b) {
	return a.backgroundImage=b
}function Bb(a,b) {
	return a.type=b
}function Cb(a,b) {
	return a.contains=b
}function Db(a,b) {
	return a.clear=b
}function Eb(a,b) {
	return a.paddingLeft=b
}function Fb(a,b) {
	return a.borderBottom=b
}function Gb(a,b) {
	return a.border=b
}function Hb(a,b) {
	return a.reset=b
}function Ib(a,b) {
	return a.cellPadding=
	b
}function z(a,b) {
	return a.onclick=b
}function Kb(a,b) {
	return a.name=b
}function Lb(a,b) {
	return a.zIndex=b
}function Mb(a,b) {
	return a.overflow=b
}function C(a,b) {
	return a.display=b
}function Nb(a,b) {
	return a.align=b
}function D(a,b) {
	return a.height=b
}function Ob(a,b) {
	return a.nodeValue=b
}function Pb(a,b) {
	return a.cancelBubble=b
}function Qb(a,b) {
	return a.fontWeight=b
}function Rb(a,b) {
	return a.endRow=b
}function Sb(a,b) {
	return a.visibility=b
}var Tb="rules",Ub="scrollTop",Xb="previousSibling",Yb="push",Zb=
"altKey",$b="startRow",E="length",ac="title",bc="plugins",_P="prototype",cc="selectedIndex",dc="className",ec="relatedTarget",F="width",fc="index",gc="text",hc="clientWidth",ic="checked",jc="slice",kc="selection",lc="nodeType",mc="document",nc="data",oc="ctrlKey",pc="responseText",rc="innerHTML",sc="mimeTypes",tc="offsetWidth",uc="offsetParent",vc="userAgent",wc="stack",I="value",xc="location",yc="closed",zc="caller",Ac="button",Bc="metaKey",Cc="offsetLeft",Dc="message",Ec="hasOwnProperty",Fc="dispatchEvent",
J="style",Hc="hostname",Ic="capture",Jc="nodeName",Kc="currentTarget",Lc="body",Mc="left",Nc="ownerDocument",Oc="selectionStart",Pc="parent",Sc="target",Tc="screenX",Uc="screenY",Vc="lastChild",Wc="styleSheets",Xc="gridId",Yc="readyState",Zc="options",$c="charCode",L="cells",ad="start",bd="cssText",cd="protocol",dd="scrollHeight",ed="keyCode",M="firstChild",fd="enabled",gd="colSpan",hd="clientHeight",jd="scrollLeft",kd="compatMode",ld="bottom",md="currentStyle",nd="copy",od="href",pd="rows",N="type",
qd="parentWindow",rd="childNodes",sd="shiftKey",td="tagName",ud="contentDocument",vd="defaultView",wd="which",xd="enabledPlugin",yd="name",O="parentNode",zd="fileName",Ad="code",Cd="display",Dd="nextSibling",Ed="offsetTop",Fd="contentWindow",Gd="description",P="height",Hd="splice",Id="offsetHeight",Jd="nodeValue",Kd="frames",Ld="endRow",Md="host",Nd="clientX",Od="clientY",Pd="documentElement",Qd="right",Rd="event",Sd=Sd||{
},Td=this,Ud=null;
var Wd=function (a,b) {
	var c=a.split("."),d=Td,e;
	if(!(c[0] in
	d)&&d.execScript)d.execScript("var "+c[0]);
	while(e=c.shift())if(!c[E]&&Vd(b))d[e]=b;
	else d=d[e]?d[e]:(d[e]={
	})
},Xd=function (a) {
	var b=a.split("."),c=Td;
	for(var d;d=b.shift();)if(c[d])c=c[d];else return null;return c
},$d=function () {
};
var be=function (a) {
	var b=typeofa;
	if(b=="object")if(a) {
		if(typeofa[E]=="number"&&typeofa[Hd]!="undefined"&&!ae(a,"length"))return "array";
		if(typeofa.call!="undefined")return "function"
	}else return "null";
	else if(b=="function"&&typeofa.call=="undefined")return "object";
	return b
};
if(na[_P].propertyIsEnumerable )var ae=function (a,b) {
	return na[_P].propertyIsEnumerable .call(a,b)
};
else ae=function (a,b) {
	if(b in a)for(var c in a)if(c==b)return true;return false
};var Vd=function (a) {
	return typeofa!="undefined"
};
var ce=function (a) {
	return be(a)=="array"
},de=function (a) {
	var b=be(a);
	return b=="array"||b=="object"&&typeofa[E]=="number"
},ee=function (a) {
	return typeofa=="string"
},fe=function (a) {
	return typeofa=="number"
},ge=function (a) {
	return be(a)=="function"
},he=function (a) {
	var b=be(a);
	return b=="object"||b=="array"||b=="function"
},le=function (a) {
	if(a[Ec]&&a.hasOwnProperty (je))return a[je];
	if(!a[je])a[je]=++ke;
	return a[je]
},je="closure_hashCode_",ke=0,R=function (a,b) {
	var c=a.Bea;
	if(arguments[E]>2) {
		var d=Array[_P][jc].call(arguments,2);
		if(c)d.unshift.apply(d,c);
		c=d
	}b=a.Dea||b;
	a=a.Cea||a;
	var e,f=b||Td;
	e=c?function () {
		var g=Array[_P][jc].call(arguments);
		g.unshift.apply(g,c);
		return a.apply(f,g)
	}:function () {
		return a.apply(f,arguments)
	};
	e.Bea=c;
	e.Dea=b;
	e.Cea=a;
	return e
},me=function (a) {
	var b=
	Array[_P][jc].call(arguments,1);
	b.unshift(a,null);
	return R.apply(null,b)
},ne=Date.now||function () {
	return (new Date).getTime()
},oe=function (a) {
	if(Td.execScript)Td.execScript(a,"JavaScript");
	else if(Td.eval) {
		if(Ud==null) {
			Td.eval("var _et_ = 1;");
			if(typeofTd._et_!="undefined") {
				delete Td._et_;
				Ud=true
			}else Ud=false
		}if(Ud)Td.eval(a);
		else {
			var b=Td[mc],c=b.createElement("script");
			Bb(c,"text/javascript");
			c.defer=false;
			c.appendChild(b.createTextNode(a));
			b[Lc].appendChild(c);
			b[Lc].removeChild(c)
		}
	}else throwError("goog.globalEval not available");
},pe=function (a,b) {
	var c=b||{
	};
	for(var d in c)a=a.replace(new RegExp("\\{\\$"+d+"\\}","gi"),c[d]);return a
},qe=function (a,b) {
	Wd(a,b)
},re=function (a,b,c) {
	a[b]=c
};
if(!ma[_P].apply)ma[_P].apply=function (a,b) {
	var c=[],d,e;
	if(!a)a=Td;
	if(!b)b=[];
	for(var f=0;f<b[E];f++)c[f]="args["+f+"]";e="oScope.__applyTemp__.peek().("+c.join(",")+");";if(!a.__applyTemp__)a.__applyTemp__=[];a.__applyTemp__.push(this);d=eval(e);a.__applyTemp__.pop();return d
};ma[_P].inherits=function (a) {
	te(this,a)
};
var te=function (a,b) {
	function c() {
	}
	c.prototype=b[_P];
	a.B=b[_P];
	a.prototype=new c;
	a[_P].constructor =a
};
var ue=function (a,b) {
	return a.indexOf(b)==0
},ve=function (a,b) {
	var c=a[E]-b[E];
	return c>=0&&a.lastIndexOf(b,c)==c
},xe=function (a,b) {
	return we(b,a.substr(0,b[E]))==0
},ye=function (a) {
	for(var b=1;b<arguments[E];b++) {
		var c=ha(arguments[b]).replace(/\$/g,"$$$$");
		a=a.replace(/\%s/,c)
	}return a
},ze=function (a) {
	return /^[\s\xa0]*$/.test(a)
};
var Ae=function (a) {
	return a.replace(/(\r\n|\r|\n)/g,"\n")
},Be=function (a) {
	return a.replace(/^[\s\xa0]+|[\s\xa0]+$/g,"")
},Ce=function (a) {
	return a.replace(/^[\s\xa0]+/,"")
},
De=function (a) {
	return a.replace(/[\s\xa0]+$/,"")
},we=function (a,b) {
	var c=ha(a).toLowerCase(),d=ha(b).toLowerCase();
	return c<d?-1:(c==d?0:1)
},Ee=/^[a-zA-Z0-9\-_.!~*'()]*$/,Fe=function(a) {a=ha(a);if(!Ee.test(a))return fa(a);return a},Ge=function(a) {return pa(a.replace(/\+/g," "))},He=function(a,b) {return a.replace(/(\r\n|\r|\n)/g,b?"<br />":"<br>")},Pe=function(a,b) {if(b)return a.replace(Ie,"&amp;").replace(Je,"&lt;").replace(Me,"&gt;").replace(Ne,"&quot;");else{if(!Oe.test(a))return a;if(a.indexOf("&")!=
-1)a=a.replace(Ie,"&amp;");
if(a.indexOf("<")!=-1)a=a.replace(Je,"&lt;");
if(a.indexOf(">")!=-1)a=a.replace(Me,"&gt;");
if(a.indexOf('"')!=-1)a=a.replace(Ne,"&quot;");
return a
}
},Ie=/&/g,Je=/</g,Me=/>/g,Ne=/\"/g,Oe=/[&<>\"]/,Te=function (a) {
if(Qe(a,"&"))return "document" in Td&&!Qe(a,"<")?Re(a):Se(a);
return a
},Re=function (a) {
var b=Td.document.createElement("a");
b.innerHTML=a;
if(b.normalize)b.normalize();
a=b.firstChild.nodeValue;
b.innerHTML="";
return a
},Se=function (a) {
return a.replace(/&([^;
]+);
/g,function (b,
c) {
switch(c) {
	case "amp":return "&";
	case "lt":return "<";
	case "gt":return ">";
	case "quot":return '"';
	default:if(c.charAt(0)=="#") {
		var d=ja("0"+c.substr(1));
		if(!qa(d))return ha.fromCharCode(d)
	}return b
}
})
},Ue=function (a,b) {
return He(a.replace(//g," &#160;"),b)
},Ve=function (a,b) {
var c=b[E];
for(var d=0;d<c;d++) {
var e=c==1?b:b.charAt(d);
if(a.charAt(0)==e&&a.charAt(a[E]-1)==e)return a.substring(1,a[E]-1)
}return a
},Qe=function (a,b) {
return a.indexOf(b)!=-1
};
var We=function () {
return Array[_P].join.call(arguments,
"")
};
var Ye=function (a,b) {
var c=0,d=ha(a).split("."),e=ha(b).split("."),f=o.max(d[E],e[E]);
for(var g=0;c==0&&g<f;g++) {
var h=d[g]||"",i=e[g]||"",j=new RegExp("(\\d*)(\\D*)","g"),k=new RegExp("(\\d*)(\\D*)","g");
do{
	var m=j.exec(h)||["","",""],n=k.exec(i)||["","",""];
	if(m[0][E]==0&&n[0][E]==0)break;
	var q=m[1][E]==0?0:ga(m[1],10),p=n[1][E]==0?0:ga(n[1],10);
	c=Xe(q,p)||Xe(m[2][E]==0,n[2][E]==0)||Xe(m[2],n[2])
}while(c==0)
}return c
},Xe=function (a,b) {
if(a<b)return -1;
else if(a>b)return 1;
return 0
},Ze=function (a) {
var b=
0;
for(var c=0;c<a[E];++c) {
b=31*b+a.charCodeAt(c);
b%=4294967296
}return b
};
var $e=function (a) {
return "Spreadsheets"+(a?"-d":"")
};
var af=function () {
};
af[_P].Qz=false;
af[_P].qN=function () {
return this.Qz
};
af[_P].N=af[_P].qN;
af[_P].dispose=function () {
if(!this.Qz) {
this.M();
this.Qz=true
}
};
af[_P].M=function () {
};
var bf=function (a) {
if(typeofa.dispose=="function")a.dispose()
};
var cf=function (a) {
return a[a[E]-1]
},df=function (a,b,c) {
if(a.indexOf)return a.indexOf(b,c);
if(Array.indexOf)return Array.indexOf(a,b,c);
var d=c==null?0:(c<0?o.max(0,a[E]+c):c);
for(var e=d;e<a[E];e++)if(e in a&&a[e]===b)return e;return -1
},ef=function (a,b,c) {
if(a.forEach)a.forEach(b,c);
else if(Array.forEach)Array.forEach(a,b,c);
else {
var d=a[E],e=ee(a)?a.split(""):a;
for(var f=0;f<d;f++)if(f in e)b.call(c,e[f],f,a)
}
},ff=function (a,b,c) {
if(a.map)return a.map(b,c);
if(Array.map)return Array.map(a,b,c);
var d=
a[E],e=[],f=0,g=ee(a)?a.split(""):a;
for(var h=0;h<d;h++)if(h in g)e[f++]=b.call(c,g[h],h,a);return e
},hf=function (a,b,c) {
var d=gf(a,b,c);
return d<0?null:(ee(a)?a.charAt(d):a[d])
},gf=function (a,b,c) {
var d=a[E],e=ee(a)?a.split(""):a;
for(var f=0;f<d;f++)if(f in e&&b.call(c,e[f],f,a))return f;return -1
},jf=function (a,b) {
if(a.contains)return a.contains(b);
return df(a,b)>-1
},kf=function (a) {
if(!ce(a))for(var b=a[E]-1;b>=0;b--)delete a[b];Da(a,0)
},mf=function (a,b,c) {
lf(a,c,0,b)
},qf=function (a,b) {
var c=df(a,
b),d;
if(d=c!=-1)nf(a,c);
return d
},nf=function (a,b) {
return Array[_P][Hd].call(a,b,1)[E]==1
},rf=function (a) {
if(ce(a))return a.concat();
else {
var b=[];
for(var c=0,d=a[E];c<d;c++)b[c]=a[c];return b
}
},sf=function (a) {
for(var b=1;b<arguments[E];b++) {
var c=arguments[b];
if(!ce(c))a.push(c);
else a[Yb].apply(a,c)
}
},lf=function (a) {
return Array[_P][Hd].apply(a,tf(arguments,1))
},tf=function (a,b,c) {
return arguments[E]<=2?Array[_P][jc].call(a,b):Array[_P][jc].call(a,b,c)
},vf=function (a,b,c) {
var d=0,e=a[E]-1,f=c||
uf;
while(d<=e) {
var g=d+e>>1,h=f(b,a[g]);
if(h>0)d=g+1;
else if(h<0)e=g-1;
else return g
}return -(d+1)
},wf=function (a,b) {
Array[_P].sort.call(a,b||uf)
},uf=function (a,b) {
return a>b?1:(a<b?-1:0)
};
var xf=function (a,b,c) {
for(var d in a)b.call(c,a[d],d,a)
},yf=function (a) {
var b=[],c=0;
for(var d in a)b[c++]=a[d];return b
},zf=function (a) {
var b=[],c=0;
for(var d in a)b[c++]=d;return b
},Af=function (a,b) {
for(var c in a)if(a[c]==b)return true;return false
},Bf=function (a) {
for(var b in a)return false;return true
},Cf=function (a,b) {
var c;
if(c=b in a)delete a[b];
return c
},Ef=function (a,b,c) {
if(b in a)throwError('The object already contains the key "'+b+'"');
Df(a,b,c)
},Ff=function (a,b,c) {
if(b in a)return a[b];
return c
},Df=function (a,b,c) {
a[b]=c
},Gf=function (a) {
var b={
};
for(var c in a)b[c]=a[c];return b
},Hf=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],If=function (a) {
var b,c;
for(var d=1;d<arguments[E];d++) {
c=arguments[d];
for(b in c)a[b]=c[b];for(var e=0;e<Hf[E];e++) {
	b=Hf[e];
	if(na[_P][Ec].call(c,b))a[b]=c[b]
}
}
};
var Jf=function (a,b,c,d) {
this.top=Vd(a)?ja(a):undefined;
this.right=Vd(b)?ja(b):undefined;
yb(this,Vd(c)?ja(c):undefined);
ib(this,Vd(d)?ja(d):undefined)
};
Jf[_P].clone=function () {
return new Jf(this.top,this[Qd],this[ld],this[Mc])
};
ya(Jf[_P],function () {
return "("+this.top+"t, "+this[Qd]+"r, "+this[ld]+"b, "+this[Mc]+"l)"
});
Cb(Jf[_P],function (a) {
return Kf(this,a)
});
Jf[_P].expand=function (a,b,c,d) {
if(he(a)) {
this.top-=a.top;
this.right+=a[Qd];
this.bottom+=a[ld];
this.left-=a[Mc]
}else {
this.top-=a;
this.right+=
b;
this.bottom+=c;
this.left-=d
}return this
};
var Kf=function (a,b) {
if(!a||!b)return false;
return b.x>=a[Mc]&&b.x<=a[Qd]&&b.y>=a.top&&b.y<=a[ld]
};
var Of=function (a,b) {
this.x=Vd(a)?ja(a):undefined;
this.y=Vd(b)?ja(b):undefined
};
Of[_P].clone=function () {
return new Of(this.x,this.y)
};
ya(Of[_P],function () {
return "("+this.x+", "+this.y+")"
});
var Pf=function (a,b) {
a=ja(a);
b=ja(b);
ob(this,a<b?a:b);
this.end=a<b?b:a
};
Pf[_P].clone=function () {
return new Pf(this[ad],this.end)
};
ya(Pf[_P],function () {
return "["+this[ad]+", "+this.end+"]"
});
var Qf=function (a,b,c,d) {
ib(this,Vd(a)?ja(a):undefined);
this.top=Vd(b)?ja(b):undefined;
x(this,Vd(c)?ja(c):undefined);
D(this,Vd(d)?ja(d):undefined)
};
Qf[_P].clone=function () {
return new Qf(this[Mc],this.top,this[F],this[P])
};
ya(Qf[_P],function () {
return "("+this[Mc]+", "+this.top+" - "+this[F]+"w x "+this[P]+"h)"
});
var Rf=function (a,b) {
x(this,Vd(a)?ja(a):undefined);
D(this,Vd(b)?ja(b):undefined)
};
Rf[_P].clone=function () {
return new Rf(this[F],this[P])
};
ya(Rf[_P],function () {
return "("+this[F]+" x "+this[P]+")"
});
Rf[_P].area=function () {
return this[F]*this[P]
};
Rf[_P].jc=function () {
return !this.area()
};
Rf[_P].ceil=function () {
x(this,o.ceil(this[F]));
D(this,o.ceil(this[P]));
return this
};
Rf[_P].floor=function () {
x(this,o.floor(this[F]));
D(this,o.floor(this[P]));
return this
};
Rf[_P].round=function () {
x(this,o.round(this[F]));
D(this,o.round(this[P]));
return this
};
Rf[_P].scale=function (a) {
this.width*=a;
this.height*=a;
return this
};
var Sf=function (a,b,c) {
return o.min(o.max(a,b),c)
};
var Tf,S,Uf,Vf,Wf,Xf,Yf,Zf,$f,ag,bg;
(function () {
var a=false,b=false,c=false,d=false,e=false,f=false,g=false,h=false,i=false,j="";
if(Td.navigator) {
var k=ca[vc];
a=typeofopera!="undefined";
b=!a&&k.indexOf("MSIE")!=-1;
c=!a&&k.indexOf("WebKit")!=-1;
i=c&&k.indexOf("Mobile")!=-1;
d=!a&&ca.product=="Gecko"&&!c;
e=d&&ca.vendor=="Camino";
var m,n;
if(a)m=opera.version();
else {
	if(d)n=/rv\:([^\);
	]+)(\)|;
	)/;
	else if(b)n=/MSIE\s+([^\);
	]+)(\)|;
	)/;
	else if(c)n=/WebKit\/(\S+)/;
	if(n) {
		n.test(k);
		m=RegExp.$1
	}
}j=ca.platform;
f=j.indexOf("Mac")!=-1;
g=j.indexOf("Win")!=-1;
h=j.indexOf("Linux")!=-1
}Tf=a;
S=b;
Uf=d;
Vf=e;
Wf=c;
Xf=Wf;
Yf=m;
Zf=f;
$f=g;
ag=h;
bg=i
})();
var cg=function (a,b) {
return Ye(a,b)
},dg=function (a) {
return Ye(Yf,a)>=0
};
var eg,gg=function () {
if(!eg)eg=new fg;
return eg
},T=function (a) {
return a?new fg(hg(a)):gg()
},ig=function () {
return gg().W()
},jg=function (a) {
return ee(a)?oa.getElementById(a):a
},kg=jg,lg=function (a,b,c) {
return gg().oB(a,b,c)
},mg=lg,rg=function (a,b) {
xf(b,function (c,d) {
if(d=="style")pb(a[J],c);
else if(d=="class")r(a,c);
else if(d=="for")a.htmlFor=c;
else if(d in ng)a.setAttribute(ng[d],c);
else a[d]=c
})
},ng={
cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",rowspan:"rowSpan",valign:"vAlign",
height:"height",width:"width",usemap:"useMap",frameborder:"frameBorder"
},sg=function (a) {
var b=a||Td||l,c=b[mc];
if(Wf&&!dg("500")&&!bg) {
if(typeofb.innerHeight=="undefined")b=l;
var d=b.innerHeight,e=b[mc][Pd][dd];
if(b==b.top)if(e<d)d-=15;
return new Rf(b.innerWidth,d)
}var f=T(c),g=f.B0()=="CSS1Compat"&&(!Tf||Tf&&dg("9.50"))?c[Pd]:c[Lc];
return new Rf(g[hc],g[hd])
},tg=function (a) {
var b=a||Td||l,c=b[mc],d,e;
if(!Wf&&c[kd]=="CSS1Compat") {
d=c[Pd][jd];
e=c[Pd][Ub]
}else {
d=c[Lc][jd];
e=c[Lc][Ub]
}return new Of(d,
e)
},ug=function (a) {
return T(a).Bh()
},vg=function () {
var a=gg();
return a.b.apply(a,arguments)
};
var wg=function (a) {
return gg().createTextNode(a)
},xg=function (a,b) {
a.appendChild(b)
},yg=function (a) {
var b;
while(b=a[M])a.removeChild(b)
},zg=function (a,b) {
if(b[O])b[O].insertBefore(a,b)
},Ag=function (a,b) {
if(b[O])b[O].insertBefore(a,b[Dd])
},Bg=function (a) {
return a&&a[O]?a[O].removeChild(a):null
},Dg=function (a) {
return Cg(a[M],true)
},Eg=function (a) {
return Cg(a[Dd],true)
};
var Cg=function (a,b) {
while(a&&a[lc]!=1)a=
b?a[Dd]:a[Xb];
return a
};
var Fg=Wf&&cg(Yf,"521")<=0,Gg=function (a,b) {
if(typeofa.contains!="undefined"&&!Fg&&b[lc]==1)return a==b||a.contains(b);
if(typeofa.compareDocumentPosition!="undefined")return a==b||da(a.compareDocumentPosition(b)&16);
while(b&&a!=b)b=b[O];
return b==a
},hg=function (a) {
return a[lc]==9?a:a[Nc]||a[mc]
},Hg=function (a) {
return Wf?a[mc]||a[Fd][mc]:a[ud]||a[Fd][mc]
},Ig=function (a,b) {
if("textContent" in a)a.textContent=b;
else if(a[M]&&a[M][lc]==3) {
while(a[Vc]!=a[M])a.removeChild(a[Vc]);
Oa(a[M],b)
}else {
while(a.hasChildNodes())a.removeChild(a[Vc]);
var c=hg(a);
a.appendChild(c.createTextNode(b))
}
},Kg=function (a,b) {
var c=[];
Jg(a,b,c,true);
return c[E]?c[0]:undefined
},Lg=function (a,b) {
var c=[];
Jg(a,b,c,false);
return c
},Jg=function (a,b,c,d) {
if(a!=null)for(var e=0,f;f=a[rd][e];e++) {
if(b(f)) {
	c.push(f);
	if(d)return
}Jg(f,b,c,d)
}
},Mg={
SCRIPT:1,STYLE:1,HEAD:1,IFRAME:1,OBJECT:1
},Og={
IMG:" ",BR:"\n"
},Qg=function (a) {
var b;
if(S&&"innerText" in a)b=Ae(a.innerText);
else {
var c=[];
Pg(a,c,true);
b=c.join("")
}b=
b.replace(/\xAD/g,"");
b=b.replace(/+/g," ");
if(b!=" ")b=b.replace(/^\s/,"");
return b
},Pg=function (a,b,c) {
if(a[Jc] in Mg) {
}else if(a[lc]==3)if(c)b.push(ha(a[Jd]).replace(/(\r\n|\r|\n)/g,""));
else b.push(a[Jd]);
else if(a[Jc] in Og)b.push(Og[a[Jc]]);
else {
var d=a[M];
while(d) {
	Pg(d,b,c);
	d=d[Dd]
}
}
},Rg=function (a) {
if(a&&typeofa[E]=="number")if(he(a))return typeofa.item=="function"||typeofa.item=="string";
else if(ge(a))return typeofa.item=="function";
return false
},fg=function (a) {
this.Jd=a||Td[mc]||oa
};
fg[_P].nB=T;
fg[_P].W=function () {
return this.Jd
};
fg[_P].Qa=function (a) {
return ee(a)?this.Jd.getElementById(a):a
};
fg[_P].oB=function (a,b,c) {
var d=a||"*",e=c||this.Jd,f=e.getElementsByTagName(d);
if(b) {
var g=[];
for(var h=0,i;i=f[h];h++) {
	var j=i[dc];
	if(typeofj.split=="function"&&jf(j.split(" "),b))g.push(i)
}return g
}else return f
};
fg[_P].vG=fg[_P].oB;
fg[_P].Xh=rg;
fg[_P].b=function (a,b) {
if(S&&b&&b[yd])a="<"+a+' name="'+Pe(b[yd])+'">';
var c=this.createElement(a);
if(b)rg(c,b);
if(arguments[E]>2) {
function d(g) {
	if(g)this.appendChild(c,
	ee(g)?this.createTextNode(g):g)
}for(var e=2;e<arguments[E];e++) {
	var f=arguments[e];
	if(de(f)&&!(he(f)&&f[lc]>0))ef(Rg(f)?rf(f):f,d,this);
	else d.call(this,f)
}
}return c
};
fg[_P].createElement=function (a) {
return this.Jd.createElement(a)
};
fg[_P].createTextNode=function (a) {
return this.Jd.createTextNode(a)
};
fg[_P].B0=function () {
if(this.Jd[kd])return this.Jd[kd];
if(Wf) {
var a=this.b("div",{
	style:"position:absolute;width:0;height:0;width:1"
}),b=a[J][F]=="1px"?"BackCompat":"CSS1Compat";
return this.Jd.compatMode=
b
}return "BackCompat"
};
fg[_P].Bh=function () {
var a=this.Jd;
if(a[qd])return a[qd];
if(Wf&&!dg("500")&&!bg) {
var b=a.createElement("script");
y(b,"document.parentWindow=window");
var c=a[Pd];
c.appendChild(b);
c.removeChild(b);
return a[qd]
}return a[vd]
};
fg[_P].appendChild=xg;
fg[_P].zf=yg;
fg[_P].gN=zg;
fg[_P].removeNode=Bg;
fg[_P].qB=Dg;
Cb(fg[_P],Gg);
fg[_P].nL=hg;
fg[_P].Y0=Hg;
fg[_P].Co=Ig;
if("StopIteration" in Td)var Sg=Td.StopIteration;
else Sg=Error("StopIteration");
var Tg=function () {
};
Tg[_P].next=function () {
throwSg;
};
Tg[_P].__iterator__=function () {
return this
};
var Ug=function (a) {
if(ainstanceofTg)return a;
if(typeofa.__iterator__=="function")return a.__iterator__(false);
if(de(a)) {
var b=0,c=new Tg;
c.next=function () {
	while(true) {
		if(b>=a[E])throwSg;
		if(!(b in a)) {
			b++;
			continue
		}return a[b++]
	}
};
return c
}throwError("Not implemented");
},Vg=function (a,b,c) {
if(de(a))try{
ef(a,b,c)
}catch(d) {
if(d!==
Sg)throwd;
}else {
a=Ug(a);
try{
	while(true)b.call(c,a.next(),undefined,a)
}catch(d) {
	if(d!==Sg)throwd;
}
}
};
var Wg=function (a) {
if(typeofa.Fb=="function")return a.Fb();
if(ee(a))return a.split("");
if(de(a)) {
var b=[],c=a[E];
for(var d=0;d<c;d++)b.push(a[d]);return b
}return yf(a)
},Xg=function (a) {
if(typeofa.vd=="function")return a.vd();
if(typeofa.Fb=="function")return undefined;
if(de(a)||ee(a)) {
var b=[],c=a[E];
for(var d=0;d<c;d++)b.push(d);return b
}return zf(a)
},Yg=function (a,b) {
if(typeofa.contains=="function")return a.contains(b);
if(typeofa.im=="function")return a.im(b);
if(de(a)||ee(a))return jf(a,b);
return Af(a,
b)
},Zg=function (a,b,c) {
if(typeofa.forEach=="function")a.forEach(b,c);
else if(de(a)||ee(a))ef(a,b,c);
else {
var d=Xg(a),e=Wg(a),f=e[E];
for(var g=0;g<f;g++)b.call(c,e[g],d&&d[g],a)
}
};var $g=function (a) {
this.zc={
};
this.sb=[];
if(a)this.To(a)
};
$g[_P].ub=0;
$g[_P].ri=0;
$g[_P].Kc=function () {
return this.ub
};
$g[_P].Fb=function () {
this.Rs();
var a=[];
for(var b=0;b<this.sb[E];b++) {
var c=this.sb[b];
a.push(this.zc[c])
}return a
};
$g[_P].vd=function () {
this.Rs();
return this.sb.concat()
};
$g[_P].bd=function (a) {
return ah(this.zc,a)
};
$g[_P].im=function (a) {
for(var b=0;b<this.sb[E];b++) {
var c=this.sb[b];
if(ah(this.zc,c)&&this.zc[c]==a)return true
}return false
};
$g[_P].jc=function () {
return this.ub==0
};
Db($g[_P],function () {
this.zc={
};
Da(this.sb,0);
this.ub=0;
this.ri=0
});
nb($g[_P],function (a) {
if(ah(this.zc,a)) {
delete this.zc[a];
this.ub--;
this.ri++;
if(this.sb[E]>2*this.ub)this.Rs();
return true
}return false
});
$g[_P].Rs=function () {
if(this.ub!=this.sb[E]) {
var a=0,b=0;
while(a<this.sb[E]) {
	var c=this.sb[a];
	if(ah(this.zc,c))this.sb[b++]=c;
	a++
}Da(this.sb,b)
}if(this.ub!=this.sb[E]) {
var d={
},a=0,b=0;
while(a<this.sb[E]) {
	var c=this.sb[a];
	if(!ah(d,c)) {
		this.sb[b++]=c;
		d[c]=1
	}a++
}Da(this.sb,b)
}
};
$g[_P].get=function (a,
b) {
if(ah(this.zc,a))return this.zc[a];
return b
};
$g[_P].set=function (a,b) {
if(!ah(this.zc,a)) {
this.ub++;
this.sb.push(a);
this.ri++
}this.zc[a]=b
};
$g[_P].To=function (a) {
var b,c;
if(ainstanceof$g) {
b=a.vd();
c=a.Fb()
}else {
b=zf(a);
c=yf(a)
}for(var d=0;d<b[E];d++)this.set(b[d],c[d])
};$g[_P].clone=function () {
return new $g(this)
};
$g[_P].__iterator__=function (a) {
this.Rs();
var b=0,c=this.sb,d=this.zc,e=this.ri,f=this,g=new Tg;
g.next=function () {
while(true) {
	if(e!=f.ri)throwError("The map has changed since the iterator was created");
	if(b>=c[E])throwSg;
	var h=c[b++];
	return a?h:d[h]
}
};
return g
};
if(na[_P][Ec])var ah=function (a,b) {
return na[_P][Ec].call(a,b)
};
else ah=function (a,b) {
return b in a&&a[b]!==na[_P][b]
};
var bh=function (a) {
this.zc=new $g;
if(a)this.To(a)
},ch=function (a) {
var b=typeofa;
return b=="object"?"o"+le(a):b.substr(0,1)+a
};
bh[_P].Kc=function () {
return this.zc.Kc()
};
bh[_P].add=function (a) {
this.zc.set(ch(a),a)
};
bh[_P].To=function (a) {
var b=dh(a),c=b[E];
for(var d=0;d<c;d++)this.add(b[d])
};bh[_P].cc=function (a) {
var b=dh(a),c=b[E];
for(var d=0;d<c;d++)this.remove(b[d])
};nb(bh[_P],function (a) {
return this.zc.remove(ch(a))
});
Db(bh[_P],function () {
this.zc.clear()
});
bh[_P].jc=function () {
return this.zc.jc()
};
Cb(bh[_P],function (a) {
return this.zc.bd(ch(a))
});
bh[_P].Fb=function () {
return this.zc.Fb()
};
bh[_P].clone=function () {
return new bh(this)
};
bh[_P].__iterator__=function () {
return this.zc.__iterator__(false)
};
var dh=function (a) {
return Wg(a)
};
var eh=function (a,b) {
Bb(this,a);
jb(this,b);
bb(this,this[Sc])
};
te(eh,af);
eh[_P].tj=false;
eh[_P].Xn=true;
eh[_P].stopPropagation=function () {
this.tj=true
};
eh[_P].preventDefault=function () {
this.Xn=false
};
var fh=function (a,b) {
af.call(this);
this.t6=b;
this.Gm=[];
this.VY(a)
};
te(fh,af);
fh[_P].vz=null;
fh[_P].Pz=null;
fh[_P].Br=function (a) {
this.vz=a
};
fh[_P].sS=function (a) {
this.Pz=a
};
fh[_P].Ah=function () {
if(this.Gm[E])return this.Gm.pop();
return this.pp()
};
fh[_P].Qg=function (a) {
if(this.Gm[E]<this.t6)this.Gm.push(a);
else this.Oz(a)
};
fh[_P].VY=function (a) {
if(a>this.t6)throwError("[goog.structs.SimplePool] Initial cannot be greater than max");
for(var b=0;b<a;b++)this.Gm.push(this.pp())
};fh[_P].pp=function () {
return this.vz?
this.vz():{
}
};
fh[_P].Oz=function (a) {
if(this.Pz)this.Pz(a);
else if(ge(a.dispose))a.dispose();
else for(var b in a)delete a[b]
};fh[_P].M=function () {
fh.B.M.call(this);
var a=this.Gm;
while(a[E])this.Oz(a.pop());
this.Gm=null
};
var gh=function (a,b) {
if(a)this.init(a,b)
};
te(gh,eh);
var hh=[1,4,2];
Bb(gh[_P],null);
jb(gh[_P],null);
bb(gh[_P],null);
gh[_P].relatedTarget=null;
gh[_P].offsetX=0;
gh[_P].offsetY=0;
gh[_P].clientX=0;
gh[_P].clientY=0;
kb(gh[_P],0);
lb(gh[_P],0);
gh[_P].button=0;
rb(gh[_P],0);
gh[_P].charCode=0;
gh[_P].ctrlKey=false;
gh[_P].altKey=false;
gh[_P].shiftKey=false;
gh[_P].metaKey=false;
gh[_P].Vd=null;
gh[_P].init=function (a,b) {
Bb(this,a[N]);
jb(this,a[Sc]||a.srcElement);
bb(this,b);
this.relatedTarget=a[ec]?a[ec]:(this[N]==
ih?a.fromElement:(this[N]==jh?a.toElement:null));
this.offsetX=typeofa.layerX=="number"?a.layerX:a.offsetX;
this.offsetY=typeofa.layerY=="number"?a.layerY:a.offsetY;
this.clientX=typeofa[Nd]=="number"?a[Nd]:a.pageX;
this.clientY=typeofa[Od]=="number"?a[Od]:a.pageY;
kb(this,a[Tc]||0);
lb(this,a[Uc]||0);
this.button=a[Ac];
rb(this,a[ed]||0);
this.charCode=a[$c]||(this[N]==kh?a[ed]:0);
this.ctrlKey=a[oc];
this.altKey=a[Zb];
this.shiftKey=a[sd];
this.metaKey=a[Bc];
this.Vd=a;
this.Xn=null;
this.tj=null
};
gh[_P].kN=
function (a) {
return S?(this[N]==U?a==0:!(!(this.Vd[Ac]&hh[a]))):(Wf&&!dg("420")?this.Vd[Ac]==1&&a==0:this.Vd[Ac]==a)
};
gh[_P].stopPropagation=function () {
this.tj=true;
if(this.Vd.stopPropagation)this.Vd.stopPropagation();
else Pb(this.Vd,true)
};
gh[_P].preventDefault=function () {
this.Xn=false;
if(!this.Vd.preventDefault) {
this.Vd.returnValue=false;
try{
	rb(this.Vd,-1)
}catch(a) {
}
}else this.Vd.preventDefault()
};
gh[_P].M=function () {
gh.B.M.call(this);
this.Vd=null
};
var lh=function () {
},oh=0;
lh[_P].sC=null;
lh[_P].listener=null;
lh[_P].proxy=null;
lh[_P].src=null;
Bb(lh[_P],null);
lh[_P].capture=null;
lh[_P].handler=null;
lh[_P].key=0;
lh[_P].removed=false;
lh[_P].Sy=false;
lh[_P].init=function (a,b,c,d,e,f) {
if(ge(a))this.sC=true;
else if(a&&a.Nd&&ge(a.Nd))this.sC=false;
else throwError("Invalid listener argument");
this.listener=a;
this.proxy=b;
this.src=c;
Bb(this,d);
this.capture=!(!e);
this.handler=f;
this.Sy=false;
this.key=++oh;
this.removed=false
};
lh[_P].Nd=function (a) {
if(this.sC)return this.listener.call(this.handler||
this.src,a);
return this.listener.Nd.call(this.listener,a)
};
var ph={
},qh={
},rh={
},sh=new fh(0,600);
sh.Br(function () {
return {
ub:0
}
});
sh.sS(function (a) {
a.ub=0
});
var th=new fh(0,600);
th.Br(function () {
return []
});
th.sS(function (a) {
Da(a,0);
delete a.Kv;
delete a.kP
});
var uh=new fh(0,600);
uh.Br(function () {
var a=function (b) {
return vh.call(a.src,a.key,b)
};
return a
});
var wh=function () {
return new lh
},xh=new fh(0,600);
xh.Br(wh);
var yh=function () {
return new gh
},zh=function () {
var a=null;
if(S) {
a=new fh(0,600);
a.Br(yh)
}return a
},Ah=zh(),Bh="on",Ch={
},Dh=function (a,b,c,d,e) {
if(!b)throwError("Invalid event type");
else if(ce(b)) {
for(var f=0;f<b[E];f++)Dh(a,b[f],c,d,e);return null
}var g=!(!d),h=qh;if(!(b in h))h[b]=sh.Ah();h=h[b];if(!(g in h)) {
h[g]=sh.Ah();
h.ub++
}h=h[g];
var i=le(a),j,k;
if(!h[i]) {
j=h[i]=th.Ah();
h.ub++
}else {
j=h[i];
for(var f=0;f<j[E];f++) {
	k=j[f];
	if(k.listener==c&&k.handler==e) {
		if(k.removed)break;
		return j[f].key
	}
}
}var m=uh.Ah();
m.src=a;
k=xh.Ah();
k.init(c,m,a,b,g,e);
var n=k.key;
m.key=n;
j.push(k);
ph[n]=k;
if(!rh[i])rh[i]=th.Ah();
rh[i].push(k);
if(a.addEventListener) {
if(a==Td||!a.$I)a.addEventListener(b,
m,g)
}else a.attachEvent(Eh(b),m);
return n
},Fh=function (a,b,c,d,e) {
if(ce(b)) {
for(var f=0;f<b[E];f++)Fh(a,b[f],c,d,e);return null
}var g=Dh(a,b,c,d,e),h=ph[g];h.Sy=true;return g
},Gh=function (a,b,c,d,e) {
if(ce(b)) {
for(var f=0;f<b[E];f++)Gh(a,b[f],c,d,e);return null
}var g=!(!d),h=Hh(a,b,g);if(!h)return false;for(var f=0;f<h[E];f++)if(h[f].listener==c&&h[f][Ic]==g&&h[f].handler==e)return Ih(h[f].key);return false
},Ih=function (a) {
if(!ph[a])return false;
var b=ph[a];
if(b.removed)return false;
var c=b.src,d=
b[N],e=b.proxy,f=b[Ic];
if(c.removeEventListener) {
if(c==Td||!c.$I)c.removeEventListener(d,e,f)
}else if(c.detachEvent)c.detachEvent(Eh(d),e);
var g=le(c),h=qh[d][f][g];
if(rh[g]) {
var i=rh[g];
qf(i,b);
if(i[E]==0)delete rh[g]
}b.removed=true;
h.kP=true;
Jh(d,f,g,h);
delete ph[a];
return true
},Jh=function (a,b,c,d) {
if(!d.Kv)if(d.kP) {
for(var e=0,f=0;e<d[E];e++) {
	if(d[e].removed) {
		xh.Qg(d[e]);
		continue
	}if(e!=f)d[f]=d[e];
	f++
}Da(d,f);
d.kP=false;
if(f==0) {
	th.Qg(d);
	delete qh[a][b][c];
	qh[a][b].ub--;
	if(qh[a][b].ub==0) {
		sh.Qg(qh[a][b]);
		delete qh[a][b];
		qh[a].ub--
	}if(qh[a].ub==0) {
		sh.Qg(qh[a]);
		delete qh[a]
	}
}
}
},Kh=function (a,b,c) {
var d=0,e=a==null,f=b==null,g=c==null;
c=!(!c);
if(!e) {
var h=le(a);
if(rh[h]) {
	var i=rh[h];
	for(var j=i[E]-1;j>=0;j--) {
		var k=i[j];
		if((f||b==k[N])&&(g||c==k[Ic])) {
			Ih(k.key);
			d++
		}
	}
}
}else xf(rh,function (m) {
for(var n=m[E]-1;n>=0;n--) {
	var q=m[n];
	if((f||b==q[N])&&(g||c==q[Ic])) {
		Ih(q.key);
		d++
	}
}
});
return d
},Hh=function (a,b,c) {
var d=qh;
if(b in d) {
d=d[b];
if(c in d) {
	d=d[c];
	var e=le(a);
	if(d[e])return d[e]
}
}return null
},Lh=function (a,
b,c,d,e) {
var f=!(!d),g=Hh(a,b,f);
if(g)for(var h=0;h<g[E];h++)if(g[h].listener==c&&g[h][Ic]==f&&g[h].handler==e)return g[h];return null
},U="click",Mh="dblclick",Nh="mousedown",Oh="mouseup",ih="mouseover",jh="mouseout",Ph="mousemove",kh="keypress",Qh="keydown",Rh="change",Sh="contextmenu",Eh=function (a) {
if(a in Ch)return Ch[a];
return Ch[a]=Bh+a
},Uh=function (a,b,c,d) {
var e=1,f=qh;
if(b in f) {
f=f[b];
if(c in f) {
	f=f[c];
	var g=le(a);
	if(f[g]) {
		var h=f[g];
		if(!h.Kv)h.Kv=1;
		else h.Kv++;
		try{
			var i=h[E];
			for(var j=
			0;j<i;j++) {
				var k=h[j];
				if(k&&!k.removed)e&=Th(k,d)!==false
			}
		}finally{
			h.Kv--;
			Jh(b,c,g,h)
		}
	}
}
}return da(e)
},Th=function (a,b) {
var c=a.Nd(b);
if(a.Sy)Ih(a.key);
return c
},Vh=function (a,b) {
if(ee(b))b=new eh(b,a);
else if(!(binstanceofeh)) {
var c=b;
b=new eh(b[N],a);
If(b,c)
}else jb(b,b[Sc]||a);
var d=1,e,f=b[N],g=qh;
if(!(f in g))return true;
g=g[f];
var h=true in g,i=false in g;
if(h) {
e=[];
for(var j=a;j;j=j.uu())e.push(j);for(var k=e[E]-1;!b.tj&&k>=0;k--) {
	bb(b,e[k]);
	d&=Uh(e[k],b[N],true,b)&&b.Xn!=false
}
}if(i)if(h)for(var k=
0;!b.tj&&k<e[E];k++) {
bb(b,e[k]);
d&=Uh(e[k],b[N],false,b)&&b.Xn!=false
}else for(var m=a;!b.tj&&m;m=m.uu()) {
bb(b,m);
d&=Uh(m,b[N],false,b)&&b.Xn!=false
}return da(d)
},vh=function (a,b) {
if(!ph[a])return true;
var c=ph[a],d=c[N],e=qh;
if(!(d in e))return true;
e=e[d];
var f;
if(S) {
var g=b||Xd("window.event"),h=true in e;
if(h) {
	if(g[ed]<0||g.returnValue!=undefined)return true;
	Wh(g)
}le(c.src);
var i=Ah.Ah();
i.init(g,this);
f=true;
try{
	if(h) {
		var j=th.Ah();
		for(var k=i[Kc];k;k=k[O])j.push(k);for(var m=j[E]-1;!i.tj&&m>=
		0;m--) {
			bb(i,j[m]);
			f&=Uh(j[m],d,true,i)
		}for(var m=0;!i.tj&&m<j[E];m++) {
			bb(i,j[m]);
			f&=Uh(j[m],d,false,i)
		}
	}else f=Th(c,i)
}finally{
	if(j) {
		Da(j,0);
		th.Qg(j)
	}i.dispose();
	Ah.Qg(i)
}return f
}var n=new gh(b,this);
try{
f=Th(c,n)
}finally{
n.dispose()
}return f
},Wh=function (a) {
var b=false;
if(a[ed]==0)try{
rb(a,-1);
return
}catch(c) {
b=true
}if(b||a.returnValue==undefined)a.returnValue=true
};
var Xh=function () {
};
te(Xh,af);
Xh[_P].$I=true;
Xh[_P].WP=null;
Xh[_P].uu=function () {
return this.WP
};
Xh[_P].addEventListener=function (a,b,c,d) {
Dh(this,a,b,c,d)
};
Xh[_P].removeEventListener=function (a,b,c,d) {
Gh(this,a,b,c,d)
};
Xh[_P].dispatchEvent=function (a) {
return Vh(this,a)
};
Xh[_P].M=function () {
Xh.B.M.call(this);
Kh(this);
this.WP=null
};
var bi={
EDIT:1,MANAGE_ACLS:2,ADVISORY_LOCK:3
};
var ci=function () {
this.permissions=null;
this.permissionIds={
};
mb(this,null);
this.range=null;
this.rangeObj=null;
this.ownPermissions={
};
this.Wx=null;
this.er=null
},di=bi;
ci[_P].unlock=function () {
var a=60000;
this.Wx=ne()+a;
if(this.er!=null)ei(this.er);
this.er=fi(this.relock,a,this)
};
ci[_P].relock=function () {
if(this.er!=null) {
ei(this.er);
this.er=null
}this.Wx=null
};
ci[_P].zN=function () {
return !this.ownPermissions[di.EDIT]||this.ownPermissions[di.ADVISORY_LOCK]&&!this.Wx
};
ci[_P].yK=function (a) {
var b=a[1];
if(b) {
mb(this,b[4]);
this.range=b[5]
}this.permissions={
};
this.permissionIds={
};
var c=a[2];
if(c)for(var d=0;d<c[E];d++) {
var e=c[d],f=e[2],g=e[3];
this.permissions[f]=g||[];
this.permissionIds[f]=e[1]
}this.ownPermissions={
};
var h=a[3];
if(h)for(var d=0;d<h[E];d++)this.ownPermissions[h[d]]=true
};ci[_P].tda=function (a) {
var b=[];
if(this[Xc]!=null) {
var c=[];
c[4]=this[Xc];
if(this.range)c[5]=this.range;
b[1]=c
}var d=[];
for(var e in this.permissions) {
var f=[];
f[2]=ja(e);
f[3]=this.permissions[e];
f[1]=this.permissionIds[e]||
"";
d.push(f)
}b[2]=d;
if(a) {
var g=[];
for(var e in this.ownPermissions)g.push(e);b[3]=g
}return b
};var gi=function (a,b,c,d) {
this.id=a;
this.members=b?new bh:null;
Kb(this,c||a);
this.email=d||a
};
gi[_P].fW=function (a) {
if(!this.members)throwError("Tried to add a member to a non-group principal");
this.members.add(a)
};
gi[_P].m5=function (a) {
return da(this.members&&this.members.contains(a))
};
var hi=function (a) {
var b=a[1],c=a[2],d=a[3],e=a[4],f=new gi(b,da(e),d,c);
if(e)ef(e,f.fW,f);
return f
};
var ii=function (a) {
Xh.call(this);
this.QL=a;
this.Kfa=a.j.emailAddress;
this.j=a.j;
this.Gv=1;
this.Qn=new $g;
this.Fk={
};
this.Sn={
};
var b=new ci;
b.ownPermissions[di.EDIT]=true;
b.ownPermissions[di.MANAGE_ACLS]=a.Oc;
b.ownPermissions[di.ADVISORY_LOCK]=false;
this.ej=b
};
te(ii,Xh);
var ji="acl_rules_load";
ii[_P].DC=function () {
return this.Gv==2
};
ii[_P].nO=function (a,b) {
this.j.log("Got proto: "+ki(b));
var c=this.Gv;
if(c==1||a&&c!=3) {
this.Gv=3;
var d=this.QL.Xd(li);
mi(d,R(this.W8,this),"POST")
}
};
ii[_P].W8=function (a) {
try{
var b=
a[Sc].Gg();
this.j.log("Got response: "+b);
var c=ni(b),d=c[1],e=c[2];
this.Qn.clear();
if(e)for(var f=0;f<e[E];f++) {
	var g=hi(e[f]);
	this.Qn.set(g.id,g)
}this.ej=null;
this.Fk={
};
this.Sn={
};
if(d)for(var f=0;f<d[E];f++) {
	var h=new ci;
	h.yK(d[f]);
	this.hH(h)
}if(!this.ej)throwError("No global rule found");
this.j.log("Filled in "+this.HB()[E]+" rules");
this.Gv=2;
this.iG();
this.dispatchEvent(ji)
}catch(a) {
this.j.log("Exception: "+a)
}
};
ii[_P].hH=function (a) {
var b=a[Xc];
if(b==null)this.ej=a;
else if(a.range) {
a.rangeObj=
new oi(a.range);
this.Sn[b]=a
}else this.Fk[b]=a
};
ii[_P].iJ=function (a) {
var b=a[Xc];
if(a.range)delete this.Sn[b];
else delete this.Fk[b]
};
ii[_P].z$=function (a,b,c,d,e) {
if(b) {
if(!this.Gp(b[Xc],b.range))this.j.log("THIS SHOULDN'T HAPPEN");
a.permissionIds=Gf(b.permissionIds)
}if(!this.A5(a,b))return ;
var f=[];
for(var g in a.permissionIds)if(!a.permissions[g])f.push(a.permissionIds[g]);var h=[];h[1]=f;h[2]=a.tda(false);var i=this.QL.Xd(pi),j=ki(h);this.j.log("Saving rule: "+j);var k="v="+fa(j);mi(i,R(this.X8,
this,b,d,e),"POST",k);c()
};ii[_P].X8=function (a,b,c,d) {
var e=d[Sc].Gg(),f=qi(e,_M[148]);
this.j.log("Got save response: "+ki(f));
if(f)try{
var g=new ci;
g.yK(f);
if(a)this.iJ(a);
this.hH(g);
this.iG();
b();
return
}catch(h) {
this.j.log("Exception processing save response: "+h)
}c()
};
ii[_P].deleteRule=function (a,b,c,d) {
if(!this.Gp(a[Xc],a.range)) {
d();
return
}var e=[];
e[1]=yf(a.permissionIds);
var f=this.QL.Xd(ri),g=ki(e),h="v="+fa(g);
mi(f,R(this.T8,this,a,c,d),"POST",h);
b()
};
ii[_P].T8=function (a,b,c,d) {
var e=d[Sc].Gg(),
f=qi(e,_M[148]);
this.j.log("Got delete response: "+f);
if(f) {
this.iJ(a);
this.iG();
b()
}else c()
};
ii[_P].A5=function (a,b) {
var c=this.j;
if(a.range) {
var d=new si(c,a.range);
mb(d,a[Xc]);
if(!d.Tk()) {
	c.cb(d.Qi);
	return false
}
}var e=this.Gp(a[Xc],a.range);
if(e)if(!b) {
var f=a.range&&a.range!=e.range?"Only one range rule is allowed on each worksheet. Override the existing rule?":"A rule for this object already exists. Override it?";
if(!la(f))return false;
a.permissionIds=Gf(e.permissionIds)
}else if(b!=e) {
c.cb("Another rule for this object already exists.");
return false
}return true
};
ii[_P].$da=function (a) {
var b={
};
for(var c in di) {
var d=di[c];
b[d]=this.n5(this.Kfa,this.zL(a,d))
}a.ownPermissions=b;
return a
};
ii[_P].iG=function () {
if(this.Gv!=2)return ;
var a=this.HB();
for(var b=0;b<a[E];b++)this.$da(a[b])
};ii[_P].HB=function () {
var a=[this.ej],b=this.j.Aa,c=b.Cd[E];
for(var d=0;d<c;d++) {
var e=b.Xp(d).id;
a[Yb].apply(a,this.BL(e))
}return a
};
ii[_P].BL=function (a) {
var b=[],c=this.Fk[a];
if(c)b.push(c);
c=this.Sn[a];
if(c)b.push(c);
return b
};
ii[_P].Gp=function (a,b) {
return (b?
this.Sn[a]:(a!=null?this.Fk[a]:this.ej))||null
};
ii[_P].yL=function (a) {
if(a.range)return this.Fk[a[Xc]]||this.ej;
return a[Xc]!=null?this.ej:null
};
ii[_P].zL=function (a,b) {
while(a) {
var c=a.permissions[b];
if(c)return c;
a=this.yL(a)
}throwError("No default for access level "+b);
};
ii[_P].pL=function (a,b) {
var c=this.yL(a);
return c?this.zL(c,b):null
};
ii[_P].n5=function (a,b) {
for(var c=0;c<b[E];c++) {
var d=this.Qn.get(b[c]);
if(!d) {
	this.j.log("No info for a mentioned principal: "+b[c]);
	continue
}if(d.id==a||d.m5(a))return true
}return false
};
ii[_P].I1=function (a) {
var b=this.Qn.get(a);
if(!b)return a;
var c=b[yd]||b.email,d=c.indexOf("@");
if(d>=0)c=c.substr(0,d);
return c
};
ii[_P].sL=function (a) {
var b=[];
for(var c=0;c<a[E];c++)b.push(this.I1(a[c]));return b.join(", ")
};ii[_P].G1=function (a) {
var b=[],c=a.permissions[di.ADVISORY_LOCK];
if(c&&c[E]>0)b.push("Prevent accidental changes");
var d=a.permissions[di.EDIT];
if(d)b.push("<b>Edit:</b> "+this.sL(d));
d=a.permissions[di.MANAGE_ACLS];
if(d)b.push("<b>Manage protection:</b> "+this.sL(d));
return b
};
ii[_P].pn=function (a) {
var b=this.Fk[a]||this.ej;
return b.zN()
};
ii[_P].DN=function (a,b,c,d,e) {
var f=this.Sn[a];
if(f)if(f.rangeObj.overlaps(b,c,d,e))if(f.zN())return true;
else if(f.rangeObj.covers(b,c,d,e))return false;
return this.pn(a)
};
ii[_P].dispose=function () {
if(!this.N()) {
ii.B.dispose.call(this);
this.Qn.clear();
this.Qn=null;
this.ej=null;
this.Fk=null;
this.Sn=null
}
};
var ti=function (a,b) {
Xh.call(this);
this.qy=a;
this.$E=b;
this.OB={
}
};
ti.inherits(Xh);
ti[_P].Kj=null;
ti[_P].Zz=false;
ti[_P].lG=function (a,b,c,d) {
var e=this.Kj;
if(e!=a) {
this.Kj=a;
this.dispatchEvent("changegrid")
}var f=this.OB[a],g=[b,c];
if(!f||f[0]!=g[0]||f[1]!=g[1]) {
f=this.OB[a]=g;
this.dispatchEvent("changeposition")
}if(d!=this.Zz) {
this.Zz=d;
this.dispatchEvent("changeediting")
}
};
ti[_P].jB=function () {
var a=this.OB[this.Kj];
return a?a[0]:null
};
ti[_P].iB=function () {
var a=this.OB[this.Kj];
return a?a[1]:
null
};
ti[_P].dispose=function () {
if(!this.N()) {
this.dispatchEvent("dispose");
ti.B.dispose.call(this)
}
};
var ui=function (a) {
af.call(this);
this.qy=a;
this.gx=new bh
};
ui.inherits(af);
ui[_P].pW=function (a) {
this.gx.add(a)
};
ui[_P].tp=function (a) {
this.gx.remove(a)
};
ui[_P].A1=function () {
return this.gx.Kc()
};
ui[_P].dispose=function () {
if(!this.N()) {
ui.B.dispose.call(this);
var a=this.gx;
if(a)a.clear();
this.gx=null
}
};
var vi=function (a) {
Xh.call(this);
this.pG={
};
this.zr=new $g;
if(a)this.hT(a)
};
vi.inherits(Xh);
vi[_P].tD=0;
vi[_P].hT=function (a) {
var b={
};
for(var c=0;c<a[E];c++) {
var d=a[c],e=d[0],f=d[1],g=d[2],h=d[3],i=d[4],j=d[5];
b[f]=1;
this.iH(e,f);
var k=this.Au(f);
k.lG(g,h,i,j)
}var m=this.zr.vd();
for(var c=0;c<m[E];c++) {
var n=m[c];
if(!b[n])this.tp(n)
}
};
vi[_P].iH=function (a,b) {
var c=this.pG,d=c[a];
if(!d) {
d=c[a]=new ui(a);
this.tD++;
this.dispatchEvent(new wi("adduser",a,b))
}var e=this.zr,f=e.get(b);
if(!f) {
f=new ti(a,
b);
e.set(b,f);
this.dispatchEvent(new wi(xi,a,b))
}d.pW(b)
};
vi[_P].tp=function (a) {
var b=this.zr,c=b.get(a);
if(c) {
var d=c.qy,e=this.pG,f=e[d];
c.dispose();
b.remove(a);
f.tp(a);
this.dispatchEvent(new wi("deletesession",d,a));
if(f.A1()<=0) {
	e[d]=undefined;
	this.tD--;
	this.dispatchEvent(new wi(yi,d,a))
}
}
};
vi[_P].Au=function (a) {
return this.zr.get(a)
};
vi[_P].e2=function () {
return zf(this.pG)
};
vi[_P].Bu=function () {
return this.zr.Fb()
};
vi[_P].jc=function () {
return this.tD<=0
};
vi[_P].HX=function () {
var a=this.Bu();
for(var b=0;b<a[E];b++)a[b].lG(-1,-1,-1,false)
};vi[_P].dispose=function () {
if(!this.N()) {
vi.B.dispose.call(this);
this.pG=null;
this.zr=null
}
};
var xi="addsession",yi="deleteuser",wi=function (a,b,c) {
eh.call(this,a);
this.username=b;
this.sessionNum=c
};
wi.inherits(eh);
var zi,Bi=function (a,b,c) {
if(ee(b))Ai(a,c,b);
else xf(b,me(Ai,a))
},Ai=function (a,b,c) {
a[J][Ci(c)]=b
};
var Di=function (a,b) {
var c=hg(a);
if(c[vd]&&c[vd].getComputedStyle) {
var d=c[vd].getComputedStyle(a,"");
if(d)return d[b]
}return null
};
var Ei=function (a,b) {
return Di(a,b)||(a[md]?a[md][b]:null)||a[J][b]
},Fi=function (a,b,c) {
var d,e;
if(binstanceofOf) {
d=b.x;
e=b.y
}else {
d=b;
e=c
}ib(a[J],typeofd=="number"?o.round(d)+"px":d);
a[J].top=typeofe=="number"?o.round(e)+"px":e
},Gi=function (a) {
return new Of(a[Cc],
a[Ed])
},Hi=function (a) {
var b;
b=a?(a[lc]==9?a:hg(a)):ig();
if(S&&b[kd]!="CSS1Compat")return b[Lc];
return b[Pd]
},Ii=function (a) {
var b=hg(a),c=Uf&&b.getBoxObjectFor&&Ei(a,"position")=="absolute"&&(a[J].top==""||a[J][Mc]=="");
if(typeofzi=="undefined")zi=Vf&&!dg("1.8.0.11");
var d=new Of(0,0),e=Hi(b);
if(a==e)return d;
var f=null,g;
if(a.getBoundingClientRect) {
g=a.getBoundingClientRect();
var h=tg(ug(b));
d.x=g[Mc]+h.x;
d.y=g.top+h.y
}else if(b.getBoxObjectFor&&!c&&!zi) {
g=b.getBoxObjectFor(a);
var i=b.getBoxObjectFor(e);
d.x=g[Tc]-i[Tc];
d.y=g[Uc]-i[Uc]
}else {
f=a;
do{
	d.x+=f[Cc];
	d.y+=f[Ed];
	if(Wf&&Ei(f,"position")=="fixed") {
		d.x+=b[Lc][jd];
		d.y+=b[Lc][Ub];
		break
	}f=f[uc]
}while(f&&f!=a);
if(Tf||Wf&&Ei(a,"position")=="absolute")d.y-=b[Lc][Ed];
f=a[uc];
while(f&&f!=b[Lc]) {
	d.x-=f[jd];
	if(!Tf||f[td]!="TR")d.y-=f[Ub];
	f=f[uc]
}
}return d
},Ji=function (a,b,c) {
var d=Ii(a);
if(binstanceofOf) {
c=b.y;
b=b.x
}var e=b-d.x,f=c-d.y;
Fi(a,a[Cc]+e,a[Ed]+f)
},Ki=function (a,b,c) {
var d;
if(binstanceofRf) {
d=b[P];
b=b[F]
}else {
if(c==undefined)throwError("missing height argument");
d=c
}x(a[J],typeofb=="number"?o.round(b)+"px":b);
D(a[J],typeofd=="number"?o.round(d)+"px":d)
},Li=function (a) {
if(Ei(a,"display")!="none")return new Rf(a[tc],a[Id]);
var b=a[J],c=b.visibility,d=b.position;
Sb(b,"hidden");
Fa(b,"absolute");
C(b,"");
var e=a[tc],f=a[Id];
C(b,"none");
Fa(b,d);
Sb(b,c);
return new Rf(e,f)
},Ci=function (a) {
return ha(a).replace(/\-([a-z])/g,function (b,c) {
return c.toUpperCase()
})
},Mi=function (a,b) {
var c=a[J];
if("opacity" in c)c.opacity=b;
else if("MozOpacity" in c)c.MozOpacity=b;
else if("filter" in
c)xa(c,"alpha(opacity="+b*100+")")
},V=function (a,b) {
C(a[J],b?"":"none")
},Oi=function (a,b) {
var c=T(b),d=null;
if(S)d=c.W().createStyleSheet();
else {
var e=c.vG("head")[0];
if(!e) {
	var f=c.vG("body")[0];
	e=c.b("head");
	f[O].insertBefore(e,f)
}d=c.b("style");
c.appendChild(e,d)
}Ni(d,a);
return d
},Ni=function (a,b) {
if(S)pb(a,b);
else {
var c=Wf?"innerText":"innerHTML";
a[c]=b
}
},Pi=function (a) {
return "rtl"==Ei(a,"direction")
},Qi=Uf?"MozUserSelect":(Wf?"WebkitUserSelect":null),Vi=function (a,b,c) {
var d=!c?a.getElementsByTagName("*"):
null,e=Qi;
if(e) {
var f=b?"none":"";
a[J][e]=f;
if(d)for(var g=0,h;h=d[g];g++)h[J][e]=f
}else if(S||Tf) {
var f=b?"on":"";
a.setAttribute("unselectable",f);
if(d)for(var g=0,h;h=d[g];g++)h.setAttribute("unselectable",f)
}
};var Xi=function (a) {
Xh.call(this);
this.F=a||T();
this.Rw=Wi
};
te(Xi,Xh);
var Yi=0,Wi=null,Zi="action",$i="Component already rendered",aj="Unable to set parent component",bj=function (a,b) {
switch(a) {
case 1:return b?"disable":"enable";
case 2:return b?"highlight":"unhighlight";
case 4:return b?"activate":"deactivate";
case 8:return b?"select":"unselect";
case 16:return b?"check":"uncheck";
case 32:return b?"focus":"blur";
case 64:return b?"open":"close";
default:
}throwError("Invalid component state");
};
Xi[_P].qf=
null;
Xi[_P].F=null;
Xi[_P].rb=false;
Xi[_P].A=null;
Xi[_P].Rw=null;
Xi[_P].jb=null;
Xi[_P].gb=null;
Xi[_P].Hd=null;
Xi[_P].qg=null;
Xi[_P].jV=null;
Xi[_P].bb=function () {
return this.qf||(this.qf=this.w1())
};
Xi[_P].Fr=function (a) {
if(this.gb&&this.gb.qg) {
Cf(this.gb.qg,this.qf);
Ef(this.gb.qg,a,this)
}this.qf=a
};
Xi[_P].Qa=function () {
return this.A
};
Xi[_P].lx=function (a) {
this.A=a
};
Xi[_P].SS=function (a) {
if(this==a)throwError(aj);
if(a&&this.gb&&this.gb.NK(this.qf))throwError(aj);
this.gb=a
};
Xi[_P].uu=function () {
return this.gb
};
Xi[_P].b=function () {
this.A=this.F.createElement("div")
};
Xi[_P].render=function (a) {
this.wj(a)
};
Xi[_P].wj=function (a,b) {
if(this.rb)throwError($i);
if(!this.A)this.b();
if(a)a.insertBefore(this.A,b||null);
else this.F.W()[Lc].appendChild(this.A);
if(!this.gb||this.gb.rb)this.Db()
};
Xi[_P].decorate=function (a) {
if(this.rb)throwError($i);
else if(a&&this.$b(a)) {
this.jV=true;
if(!this.F||this.F.W()!=hg(a))this.F=T(a);
this.tm(a);
this.Db()
}else throwError("Invalid element to decorate");
};
Xi[_P].$b=function () {
return true
};
Xi[_P].tm=function (a) {
this.A=a
};
Xi[_P].Db=function () {
this.rb=true;
this.tA(function (a) {
if(!a.rb&&a.Qa())a.Db()
})
};
Xi[_P].rc=function () {
this.tA(function (a) {
if(a.rb)a.rc()
});
this.rb=false
};
Xi[_P].M=function () {
Xi.B.M.call(this);
if(this.rb)this.rc();
this.tA(function (a) {
a.dispose()
});
if(!this.jV&&this.A)Bg(this.A);
this.Hd=null;
this.qg=null;
this.A=null;
this.jb=null;
this.gb=null
};
Xi[_P].vx=function (a) {
this.jb=a
};
Xi[_P].w1=function () {
return ":"+Yi++
};
Xi[_P].Ca=function (a,b) {
this.RV(a,this.QK(),b)
};
Xi[_P].RV=
function (a,b,c) {
if(a.rb&&(c||!this.rb))throwError($i);
if(b<0||b>this.QK())throwError("Child component index out of bounds");
a.SS(this);
if(!this.qg||!this.Hd) {
this.qg={
};
this.Hd=[]
}Ef(this.qg,a.bb(),a);
mf(this.Hd,a,b);
if(c) {
if(!this.A)this.b();
var d=this.OK(b+1);
a.wj(this.Ja(),d?d.A:null)
}else if(this.rb&&!a.rb&&a.A)a.Db()
};
Xi[_P].Ja=function () {
return this.A
};
Xi[_P].Nk=function () {
if(this.Rw==null)this.Rw=Pi(this.rb?this.A:this.F.W()[Lc]);
return this.Rw
};
Xi[_P].N3=function () {
return !(!this.Hd)&&this.Hd[E]!=
0
};
Xi[_P].QK=function () {
return this.Hd?this.Hd[E]:0
};
Xi[_P].NK=function (a) {
return this.qg&&a?Ff(this.qg,a)||null:null
};
Xi[_P].OK=function (a) {
return this.Hd?this.Hd[a]||null:null
};
Xi[_P].tA=function (a,b) {
if(this.Hd)ef(this.Hd,a,b)
};
Xi[_P].removeChild=function (a,b) {
if(a) {
var c=ee(a)?a:a.bb();
a=this.NK(c);
if(c&&a) {
	Cf(this.qg,c);
	qf(this.Hd,a);
	if(b) {
		a.rc();
		if(a.A)Bg(a.A)
	}a.SS(null)
}
}if(!a)throwError("Child is not in parent component");
return a
};
Xi[_P].G9=function (a,b) {
return this.removeChild(this.OK(a),
b)
};
Xi[_P].zf=function (a) {
while(this.N3())this.G9(0,a)
};
var cj=Uf&&!dg("1.9a"),dj=function (a,b) {
if(Uf) {
a.setAttribute("role",b);
a.roleName=b
}
},ej=function (a,b,c) {
if(Uf)if(cj)a.setAttributeNS("http://www.w3.org/2005/07/aaa",b,c);
else a.setAttribute("aria-"+b,c)
};
var fj=function (a,b) {
r(a,b)
},gj=function (a) {
var b=a[dc];
return b&&typeofb.split=="function"?b.split(" "):[]
},hj=function (a) {
var b=gj(a),c=tf(arguments,1),d=1;
for(var e=0;e<c[E];e++)if(!jf(b,c[e])) {
b.push(c[e]);
d&=1
}else d&=0;
r(a,b.join(" "));
return da(d)
},ij=function (a) {
var b=gj(a),c=tf(arguments,1),d=0;
for(var e=0;e<b[E];e++)if(jf(c,b[e])) {
lf(b,e--,1);
d++
}r(a,b.join(" "));
return d==c[E]
},jj=function (a,b,c) {
var d=gj(a),e=false;
for(var f=0;f<d[E];f++)if(d[f]==b) {
lf(d,f--,1);
e=true
}if(e) {
d.push(c);
r(a,d.join(" "))
}return e
},kj=function (a,b) {
return jf(gj(a),b)
},lj=function (a,b,c) {
if(c)hj(a,b);
else ij(a,b)
};
var mj=function (a) {
this.G=a
};
te(mj,af);
var nj=new fh(0,100);
mj[_P].listen=function (a,b,c,d,e) {
if(ce(b)) {
for(var f=0;f<b[E];f++)this.listen(a,b[f],c,d,e);return
}var g=Dh(a,b,c||this,d||false,e||this.G||this);if(this.sb)this.sb[g]=true;else if(this.Uk) {
this.sb=nj.Ah();
this.sb[this.Uk]=true;
this.Uk=null;
this.sb[g]=true
}else this.Uk=g
};
mj[_P].unlisten=function (a,b,c,d,e) {
if(!this.Uk&&!this.sb)return ;
if(ce(b)) {
for(var f=0;f<b[E];f++)this.unlisten(a,b[f],c,d,e);return
}var g=Lh(a,b,c||this,d||false,e||this.G||
this);if(g) {
var h=g.key;
Ih(h);
if(this.sb)Cf(this.sb,h);
else if(this.Uk==h)this.Uk=null
}
};
mj[_P].cc=function () {
if(this.sb) {
for(var a in this.sb) {
	Ih(a);
	delete this.sb[a]
}nj.Qg(this.sb);
this.sb=null
}else if(this.Uk)Ih(this.Uk)
};
mj[_P].M=function () {
mj.B.M.call(this);
this.cc()
};
mj[_P].Nd=function () {
throwError("EventHandler.handleEvent not implemented");
};
var oj=function (a) {
if(!S&&!(Wf&&dg("525")))return true;
if(a>=48&&a<=57)return true;
if(a>=96&&a<=106)return true;
if(a>=65&&a<=90)return true;
if(a==27&&Wf)return false;
switch(a) {
case 13:case 27:case 32:case 63:case 107:case 109:case 110:case 111:case 186:case 189:case 187:case 188:case 190:case 191:case 192:case 222:case 219:case 220:case 221:return true;
default:return false
}
},pj=function (a) {
if(a>=48&&a<=57)return true;
if(a>=96&&a<=106)return true;
if(a>=65&&a<=90)return true;
switch(a) {
case 32:case 63:case 107:case 109:case 110:case 111:case 186:case 189:case 187:case 188:case 190:case 191:case 192:case 222:case 219:case 220:case 221:return true;
default:return false
}
};
var rj=function (a,b) {
Xh.call(this);
this.Zu=a||1;
this.Yx=b||qj;
this.YH=R(this.mda,this);
this.eO=ne()
};
te(rj,Xh);
sb(rj[_P],false);
var qj=Td.window,sj=0.8;
rj[_P].Zb=null;
rj[_P].setInterval=function (a) {
this.Zu=a;
if(this.Zb&&this[fd]) {
this.stop();
this.start()
}else if(this.Zb)this.stop()
};
rj[_P].mda=function () {
if(this[fd]) {
var a=ne()-this.eO;
if(a>0&&a<this.Zu*sj) {
	this.Zb=this.Yx.setTimeout(this.YH,this.Zu-a);
	return
}this.WZ();
if(this[fd]) {
	this.Zb=this.Yx.setTimeout(this.YH,this.Zu);
	this.eO=ne()
}
}
};
rj[_P].WZ=
function () {
this.dispatchEvent("tick")
};
ob(rj[_P],function () {
sb(this,true);
if(!this.Zb) {
this.Zb=this.Yx.setTimeout(this.YH,this.Zu);
this.eO=ne()
}
});
rj[_P].stop=function () {
sb(this,false);
this.Yx.clearTimeout(this.Zb);
this.Zb=null
};
rj[_P].M=function () {
rj.B.M.call(this);
this.stop();
this.Yx=null
};
var fi=function (a,b,c) {
if(ge(a)) {
if(c)a=R(a,c)
}else if(a&&typeofa.Nd=="function")a=R(a.Nd,a);
else throwError("Invalid listener argument");
return qj.setTimeout(a,b||0)
},ei=function (a) {
qj.clearTimeout(a)
};
;
var tj=function (a,b,c) {
jb(this,a);
this.handle=b||a;
this.qc=true;
this.xt=false;
this.limits=c||new Qf;
this.Jd=this[Sc][Nc]||this[Sc][mc];
kb(this,0);
lb(this,0);
this.deltaX=0;
this.deltaY=0;
Dh(this.handle,Nh,this.re,false,this)
};
te(tj,Xh);
tj[_P].Ad=function (a) {
this.qc=a
};
tj[_P].M=function () {
tj.B.M.call(this);
Gh(this.handle,Nh,this.re,false,this);
Gh(this.Jd,Ph,this.jD,false,this);
Gh(this.Jd,Oh,this.fA,false,this);
delete this[Sc];
delete this.handle
};
tj[_P].re=function (a) {
if(this.qc&&!this.xt) {
var b=this.dispatchEvent(new uj("start",
this,a[Nd],a[Od],a));
if(b!==false) {
	Dh(this.Jd,Ph,this.jD,false,this);
	Dh(this.Jd,Oh,this.fA,false,this);
	kb(this,a[Tc]);
	lb(this,a[Uc]);
	this.deltaX=this[Sc][Cc];
	this.deltaY=this[Sc][Ed];
	this.xt=true;
	a.preventDefault()
}
}
};
tj[_P].fA=function (a) {
if(this.xt) {
this.xt=false;
Gh(this.Jd,Ph,this.jD,false,this);
Gh(this.Jd,Oh,this.fA,false,this);
var b=this.gO(this.deltaX),c=this.hO(this.deltaY);
this.dispatchEvent(new uj("end",this,a[Nd],a[Od],a,b,c))
}
};
tj[_P].jD=function (a) {
if(this.xt&&this.qc) {
var b=a[Tc]-this[Tc],
c=a[Uc]-this[Uc];
this.deltaX+=b;
this.deltaY+=c;
var d=this.gO(this.deltaX),e=this.hO(this.deltaY);
kb(this,a[Tc]);
lb(this,a[Uc]);
var f=this.dispatchEvent(new uj("beforedrag",this,a[Nd],a[Od],a,d,e));
if(f!==false) {
	this.tZ(d,e);
	this.dispatchEvent(new uj("drag",this,a[Nd],a[Od],a,d,e));
	a.preventDefault()
}
}
};
tj[_P].gO=function (a) {
var b=this.limits,c=typeofb[Mc]!="undefined"?b[Mc]:null,d=typeofb[F]!="undefined"?b[F]:0,e=c!=null?c+d:Infinity,f=c!=null?c:-Infinity;
return o.min(e,o.max(f,a))
};
tj[_P].hO=function (a) {
var b=
this.limits,c=typeofb.top!="undefined"?b.top:null,d=typeofb[P]!="undefined"?b[P]:0,e=c!=null?c+d:Infinity,f=c!=null?c:-Infinity;
return o.min(e,o.max(f,a))
};
tj[_P].tZ=function (a,b) {
ib(this[Sc][J],a+"px");
this[Sc][J].top=b+"px"
};
var uj=function (a,b,c,d,e,f,g) {
eh.call(this,a);
Bb(this,a);
this.clientX=c;
this.clientY=d;
this.browserEvent=e;
ib(this,Vd(f)?f:b.deltaX);
this.top=Vd(g)?g:b.deltaY;
this.dragger=b
};
te(uj,eh);
var wj=function (a,b,c) {
Xi.call(this,c);
this.ud=a||"modal-dialog";
this.nG=!(!b);
this.X=vj;
this.q=new mj(this)
};
te(wj,Xi);
wj[_P].ud=null;
wj[_P].nG=false;
wj[_P].gD=true;
wj[_P].zJ=true;
wj[_P].aX=0.3;
wj[_P].Ed="";
wj[_P].R="";
wj[_P].X=null;
wj[_P].Za=null;
wj[_P].kb=false;
wj[_P].a_=false;
wj[_P].hb=null;
wj[_P].ib=null;
wj[_P].Yc=null;
wj[_P].Dd=null;
wj[_P].aG=null;
wj[_P].qd=null;
wj[_P].pc=null;
wj[_P].Jb=null;
wj[_P].q=null;
wj[_P].Va=function (a) {
this.Ed=a;
if(this.Dd)Ig(this.Dd,a)
};
wj[_P].lc=function (a) {
this.R=
a;
if(this.pc)y(this.pc,a)
};
wj[_P].$=function () {
return this.R
};
wj[_P].Ja=function () {
if(!this.pc)this.render();
return this.pc
};
wj[_P].MB=function () {
if(!this.rb)this.render();
return this.qd
};
wj[_P].Mm=function () {
if(!this.rb)this.render();
return this.Jb
};
wj[_P].zk=function () {
if(!this.rb)this.render();
return this.A
};
wj[_P].$aa=function (a) {
this.gD=a;
this.YC()
};
wj[_P].tY=function () {
var a=new tj(this.A,this.Yc);
hj(this.Yc,this.ud+"-title-draggable");
return a
};
wj[_P].b=function () {
this.YC();
this.A=this.F.b("div",
{
className:this.ud,tabIndex:0
},this.Yc=this.F.b("div",{
className:this.ud+"-title",id:this.bb()
},this.Dd=this.F.b("span",{
className:this.ud+"-title-text"
},this.Ed),this.qd=this.F.b("span",{
className:this.ud+"-title-close"
})),this.pc=this.F.b("div",{
className:this.ud+"-content"
}),this.Jb=this.F.b("div",{
className:this.ud+"-buttons"
}));
this.aG=this.Yc.id;
dj(this.A,"dialog");
ej(this.A,"labelledby",this.aG);
if(this.R)y(this.pc,this.R);
V(this.A,false);
if(this.X)this.X.Xl(this.Jb)
};
wj[_P].YC=function () {
if(this.nG&&
!this.ib) {
this.ib=this.F.b("iframe",{
	frameborder:0,style:"border: 0",className:this.ud+"-bg"
});
V(this.ib,false);
Mi(this.ib,0)
}else if(!this.nG&&this.ib) {
Bg(this.ib);
this.ib=null
}if(this.gD&&!this.hb) {
this.hb=this.F.b("div",{
	className:this.ud+"-bg"
});
Mi(this.hb,this.aX);
V(this.hb,false)
}else if(!this.gD&&this.hb) {
Bg(this.hb);
this.hb=null
}
};
wj[_P].render=function (a) {
if(this.rb)throwError($i);
if(!this.A)this.b();
var b=a||this.F.W()[Lc];
this.YQ(b);
wj.B.render.call(this,b)
};
wj[_P].YQ=function (a) {
if(this.ib)a.appendChild(this.ib);
if(this.hb)a.appendChild(this.hb)
};
wj[_P].$b=function (a) {
return a&&a[td]&&a[td]=="DIV"&&wj.B.$b.call(this,a)
};
wj[_P].tm=function (a) {
this.A=a;
hj(this.A,this.ud);
var b=this.ud+"-content";
this.pc=Kg(this.A,function (g) {
return g[lc]==1&&kj(g,b)
});
if(this.pc)this.R=this.pc[rc];
else {
this.pc=this.F.b("div",{
	className:b
});
if(this.R)y(this.pc,this.R);
this.A.appendChild(this.pc)
}var c=this.ud+"-title",d=this.ud+"-title-text",e=this.ud+"-title-close";
this.Yc=Kg(this.A,function (g) {
return g[lc]==1&&kj(g,c)
});
if(this.Yc) {
this.Dd=
Kg(this.Yc,function (g) {
	return g[lc]==1&&kj(g,d)
});
this.qd=Kg(this.Yc,function (g) {
	return g[lc]==1&&kj(g,e)
})
}else {
this.Yc=this.F.b("div",{
	className:c
});
this.A.insertBefore(this.Yc,this.pc)
}if(this.Dd)this.Ed=Qg(this.Dd);
else {
this.Dd=this.F.b("span",{
	className:d
},this.Ed);
this.Yc.appendChild(this.Dd)
}ej(this.A,"labelledby",this.aG);
if(!this.qd) {
this.qd=this.F.b("span",{
	className:e
},this.Ed);
this.Yc.appendChild(this.qd)
}var f=this.ud+"-buttons";
this.Jb=Kg(this.A,function (g) {
return g[lc]==1&&kj(g,f)
});
if(this.Jb) {
this.X=new xj(this.F);
this.X.decorate(this.Jb)
}else {
this.Jb=this.F.b("div",{
	className:f
});
this.A.appendChild(this.Jb);
if(this.X)this.X.Xl(this.Jb)
}this.YC();
this.YQ(hg(this.A)[Lc])
};
wj[_P].Db=function () {
wj.B.Db.call(this);
if(this.zJ&&!this.Za)this.Za=this.tY();
this.q.listen(this.qd,U,this.Ln);
this.q.listen(this.Jb,U,this.Lh);
dj(this.A,"dialog");
if(this.Dd.id!=="")ej(this.A,"labelledby",this.Dd.id)
};
wj[_P].rc=function () {
this.q.unlisten(this.qd,U,this.Ln);
this.q.unlisten(this.Jb,U,this.Lh);
if(this.Ka())this.D(false);
if(this.Za) {
this.Za.dispose();
this.Za=null
}wj.B.rc.call(this)
};
wj[_P].D=function (a) {
if(a==this.kb)return ;
var b=this.F.W(),c=ug(b)||l;
if(!this.rb)this.render(b[Lc]);
if(a) {
this.kR();
this.reposition();
this.q.listen(b,Qh,this.xf,true);
this.q.listen(c,"resize",this.Jn,true)
}else {
this.q.unlisten(b,Qh,this.xf,true);
this.q.unlisten(c,"resize",this.Jn,true)
}if(this.ib)V(this.ib,a);
if(this.hb)V(this.hb,a);
V(this.A,a);
if(a&&this.X) {
var d=this.X.kh;
if(d) {
	var e=this.Jb.getElementsByTagName("button");
	for(var f=0,g;g=e[f];f++)if(g[yd]==d) {
		g.focus();
		break
	}
}
}this.kb=a;
if(!a) {
this.dispatchEvent("afterhide");
if(this.a_)this.dispose()
}
};
wj[_P].Ka=function () {
return this.kb
};
wj[_P].kR=function () {
if(this.ib)V(this.ib,false);
if(this.hb)V(this.hb,false);
var a=this.F.W(),b=ug(a)||l,c=sg(b),d=a[Lc].scrollWidth,e=o.max(a[Lc][dd],c[P]);
if(this.ib) {
V(this.ib,true);
Ki(this.ib,d,e)
}if(this.hb) {
V(this.hb,true);
Ki(this.hb,d,e)
}if(this.zJ) {
var f=Li(this.A);
this.Za.limits=new Qf(0,0,d-f[F],e-f[P])
}
};
wj[_P].reposition=
function () {
var a=this.F.W(),b=ug(a)||l,c=tg(b),d=c.x,e=c.y,f=Li(this.A),g=sg(b),h=o.max(d+g[F]/2-f[F]/2,0),i=o.max(e+g[P]/2-f[P]/2,0);
Fi(this.A,h,i)
};
wj[_P].Ln=function () {
var a=this.X,b=a&&a.Sd;
if(b) {
var c=a.get(b);
if(this.dispatchEvent(new yj(b,c)))this.D(false)
}else this.D(false)
};
wj[_P].M=function () {
wj.B.M.call(this);
if(this.q) {
this.q.dispose();
this.q=null
}if(this.hb) {
Bg(this.hb);
this.hb=null
}if(this.ib) {
Bg(this.ib);
this.ib=null
}this.qd=null;
this.Jb=null
};
wj[_P].od=function (a) {
this.X=a;
if(this.Jb)this.X.Xl(this.Jb)
};
wj[_P].Lh=function (a) {
var b=this.U_(a[Sc]);
if(b) {
var c=b[yd],d=this.X.get(c);
if(this.dispatchEvent(new yj(c,d)))this.D(false)
}
};
wj[_P].U_=function (a) {
var b=a;
while(b!=null&&b!=this.Jb) {
if(b[td]=="BUTTON")return b;
b=b[O]
}return null
};
wj[_P].xf=function (a) {
if(a[ed]==27) {
var b=this.X;
if(b.Sd) {
	var c=b.get(b.Sd);
	if(this.dispatchEvent(new yj(b.Sd,c)))this.D(false)
}else this.D(false)
}else if(a[ed]==13) {
var b=this.X,d=a[Sc]&&a[Sc][td]=="BUTTON"?a[Sc][yd]:b.kh;
if(d&&this.dispatchEvent(new yj(d,b.get(d))))this.D(false)
}
};
wj[_P].Jn=function () {
this.kR()
};
var yj=function (a,b) {
Bb(this,"dialogselect");
this.key=a;
this.caption=b
};
te(yj,eh);
var zj="dialogselect",xj=function (a) {
this.F=a||T();
$g.call(this)
},vj;
te(xj,$g);
xj[_P].kh=null;
xj[_P].A=null;
xj[_P].Sd=null;
xj[_P].set=function (a,b,c,d) {
$g[_P].set.call(this,a,b);
if(c)this.kh=a;
if(d)this.Sd=a
};
xj[_P].Xl=function (a) {
this.A=a;
this.render()
};
xj[_P].render=function () {
if(this.A) {
y(this.A,"");
var a=T(this.A);
Zg(this,function (b,c) {
	this.A.appendChild(a.b("button",{
		name:c
	},b))
},
this)
}
};
xj[_P].decorate=function (a) {
if(!a||a[lc]!=1)return ;
this.A=a;
var b=this.A.getElementsByTagName("button");
for(var c=0,d,e,f;d=b[c];c++) {
e=d[yd]||d.id;
f=Qg(d)||d[I];
if(e)this.set(e,f,c==0,d[yd]==Aj)
}
};
xj[_P].WA=function (a) {
var b=this.A.getElementsByTagName("button");
for(var c=0,d;d=b[c];c++)if(d[yd]==a||d.id==a)return d;return null
};var Aj="cancel";(function () {
var a=pe("OK"),b=pe("Cancel"),c=pe("Yes"),d=pe("No"),e=pe("Save"),f=pe("Continue"),g=new xj;
g.set("ok",a,true);
var h=new xj;
h.set("ok",
a,true);
h.set(Aj,b,false,true);
vj=h;
var i=new xj;
i.set("yes",c,true);
i.set("no",d,false,true);
var j=new xj;
j.set("yes",c);
j.set("no",d,true);
j.set(Aj,b,false,true);
var k=new xj;
k.set("continue",f);
k.set("save",e);
k.set(Aj,b,true,true)
})();
var Cj=function (a,b,c,d) {
Xh.call(this);
this.hn=!d;
this.qn=!c;
var e=a||"modal-dialog";
if(this.qn&&S&&b) {
this.ib=vg("iframe",{
	frameborder:0,className:e+"-bg"
});
V(this.ib,false);
Mi(this.ib,0)
}this.hb=vg("div",{
className:e+"-bg"
});
this.A=vg("div",{
className:e
},this.Yc=vg("div",{
className:e+"-title"
},this.Dd=vg("span",{
className:e+"-title-text"
},this.Ed),this.qd=vg("span",{
className:e+"-title-close"
})),this.pc=vg("div",{
className:e+"-content",style:"overflow: auto;"
}));
if(this.hn)xg(this.A,this.Jb=vg("div",
{
className:e+"-buttons"
}));
V(this.hb,false);
V(this.A,false);
Mi(this.hb,this.o8);
Dh(this.qd,U,this.Ln,false,this);
if(this.hn)Dh(this.Jb,U,this.Lh,false,this);
this.od(Bj)
};
Cj.inherits(Xh);
Cj[_P].hn=true;
Cj[_P].qn=true;
Cj[_P].o8=0.3;
Cj[_P].Ed="";
Cj[_P].R="";
Cj[_P].X=null;
Cj[_P].kb=false;
Cj[_P].hN=false;
Cj[_P].A=null;
Cj[_P].hb=null;
Cj[_P].ib=null;
Cj[_P].Yc=null;
Cj[_P].Dd=null;
Cj[_P].qd=null;
Cj[_P].pc=null;
Cj[_P].Jb=null;
Cj[_P].Va=function (a) {
this.Ed=a;
y(this.Dd,Pe(a))
};
Cj[_P].lc=function (a) {
this.R=a;
y(this.pc,a)
};
Cj[_P].$=function () {
return this.R
};
Cj[_P].Ja=function () {
return this.pc
};
Cj[_P].MB=function () {
return this.qd
};
Cj[_P].Mm=function () {
return this.Jb
};
Cj[_P].zk=function () {
return this.A
};
Cj[_P].D=function (a) {
if(a==this.kb)return ;
if(a) {
if(!this.hN) {
	if(this.qn&&this.ib)oa[Lc].appendChild(this.ib);
	oa[Lc].appendChild(this.hb);
	oa[Lc].appendChild(this.A);
	this.hN=true;
	this.Za=new tj(this.A,this.Yc)
}this.lE();
this.reposition();
Dh(oa,Qh,this.xf,true,this);
Dh(Td,"resize",this.Jn,true,this)
}else {
Gh(oa,
Qh,this.xf,true,this);
Gh(Td,"resize",this.Jn,true,this)
}if(this.qn) {
if(this.ib)V(this.ib,a);
V(this.hb,a)
}V(this.A,a);
this.kb=a;
if(this.hn&&a&&this.X.kh) {
var b=this.Jb.getElementsByTagName("button"),c=b[E];
for(var d=0;d<c;d++)if(b[d][yd]==this.X.kh) {
	b[d].focus();
	break
}
}
};
Cj[_P].Ka=function () {
return this.kb
};
Cj[_P].lE=function () {
if(this.qn&&this.ib)V(this.ib,false);
V(this.hb,false);
var a=hg(this.hb)[Lc],b=sg(),c=a.scrollWidth,d=o.max(a[dd],b[P]);
if(this.qn) {
if(this.ib) {
	V(this.ib,true);
	Ki(this.ib,c,
	d)
}V(this.hb,true)
}Ki(this.hb,c,d);
var e=Li(this.A);
this.Za.limits=new Qf(0,0,c-e[F],d-e[P])
};
Cj[_P].reposition=function () {
var a=hg(this.hb)[Lc],b=a[jd],c=a[Ub],d=Li(this.A),e=sg(),f=b+e[F]/2-d[F]/2,g=c+e[P]/2-d[P]/2;
Fi(this.A,f,g)
};
Cj[_P].Ln=function () {
var a=this.X,b=a.Sd;
if(b) {
var c=a.get(b);
if(this.dispatchEvent(new Dj(b,c)))this.D(false)
}else this.D(false)
};
Cj[_P].dispose=function () {
if(!this.N()) {
this.D(false);
Cj.B.dispose.call(this);
Gh(this.qd,U,this.Ln,this);
if(this.hn)Gh(this.Jb,U,this.Lh,
this);
if(this.Za)this.Za.dispose();
this.Za=null;
if(this.hn)Bg(this.Jb);
Bg(this.pc);
Bg(this.qd);
Bg(this.Dd);
Bg(this.Yc);
Bg(this.A);
Bg(this.hb);
this.hb=null;
this.A=null;
this.Yc=null;
this.Dd=null;
this.qd=null;
this.pc=null;
this.Jb=null
}
};
Cj[_P].od=function (a) {
this.X=a;
this.X.Xl(this.Jb)
};
Cj[_P].Lh=function (a) {
if(a[Sc][td]=="BUTTON") {
var b=a[Sc][yd],c=this.X.get(b);
if(this.dispatchEvent(new Dj(b,c)))this.D(false)
}
};
Cj[_P].xf=function (a) {
if(a[ed]==27) {
var b=this.X;
if(b.Sd) {
	var c=b.get(b.Sd);
	if(this.dispatchEvent(new Dj(b.Sd,
	c)))this.D(false)
}else this.D(false)
}
};
Cj[_P].Jn=function () {
this.lE()
};
var Dj=function (a,b) {
Bb(this,"dialogselect");
this.key=a;
this.caption=b
};
Dj.inherits(eh);
var Ej=function () {
$g.call(this)
},Bj;
Ej.inherits($g);
Ej[_P].kh=null;
Ej[_P].A=null;
Ej[_P].Sd=null;
Ej[_P].set=function (a,b,c,d) {
$g[_P].set.call(this,a,b);
if(c)this.kh=a;
if(d)this.Sd=a
};
Ej[_P].Xl=function (a) {
this.A=a;
this.render()
};
Ej[_P].render=function () {
var a=this.A;
if(a) {
y(a,"");
Zg(this,function (b,c) {
	if(c==this.kh)a.appendChild(vg("button",
	{
		name:c,style:"font-weight:bold"
	},b));
	else a.appendChild(vg("button",{
		name:c
	},b))
},this)
}
};
(function () {
var a=new Ej;
a.set("ok","Ok",true);
a.set("cancel","Cancel",false,true);
Bj=a;
var b=new Ej;
b.set("yes","Yes",true);
b.set("no","No",false,true);
var c=new Ej;
c.set("yes","Yes");
c.set("no","No",true);
c.set("cancel","Cancel",false,true);
var d=new Ej;
d.set("continue","Continue");
d.set("save","Save");
d.set("cancel","Cancel",true,true)
})();
var Fj=function (a,b,c,d) {
c=c||3;
this.K6=c;
Cj.call(this,b?"dialog-nb":"dialog",true,c!=3,d);
if(S)wb(this.MB()[J],"28px");
this.z=a
};
Fj.inherits(Cj);
Fj[_P].Pa=function () {
return this.z
};
Fj[_P].vH=function () {
return this.K6!=3
};
Fj[_P].D=function (a) {
Fj.B.D.call(this,a);
var b=this.z;
a=this.Ka();
var c=this.K6,d=false;
if(a&&c!=1) {
b.aba(this);
d=true
}else if(b.modalDbox==this&&!a) {
b.KX();
d=true
}if(c==2&&d) {
var e=Gj(b.W(),b.pathImg)[J];
if(a) {
	D(e,b.divGrids[Ed]);
	C(e,"block");
	b.Xe.bS(false);
	b.L(false,true)
}else {
	D(e,
	"100%");
	C(e,"none");
	b.Xe.bS(true)
}
}if(!a)b.L(true)
};
Fj[_P].dispose=function () {
if(!this.N()) {
Fj.B.dispose.call(this);
this.z=null
}
};
function Hj(a,b,c) {
var d=l.setInterval(function () {
b.apply(a)
},c);
return d
}Db(Array[_P],function () {
while(this[E]>0)this.pop()
});
oa.getElementsByClassName=function (a) {
var b=oa.all;
if(!b)b=oa.getElementsByTagName("*");
var c=[];
for(var d=0;d<b[E];d++)if(b[d][dc]==a)c[c[E]]=b[d];return c
};function Ij(a) {
if(S) {
Pb(l[Rd],true);
l[Rd].returnValue=false
}else {
Pb(a,true);
a.preventDefault();
a.stopPropagation()
}
}if(!Array[_P][Yb])Array[_P].push=function (a) {
this[this[E]]=a
};
function _nullFunction() {
};
var Jj=function (a,b,c) {
if(Wf&&b=="dblclick") {
a["on"+b]=c;
return
}if(a.addEventListener)a.addEventListener(b,c,false);
else if(a.attachEvent)a.attachEvent("on"+b,c);
else a["on"+b]=c
},Kj=function (a,b,c) {
if(a.removeEventListener)a.removeEventListener(b,c,false);
else if(a.detachEvent)a.detachEvent("on"+b,c);
else a["on"+b]=null
},Lj=function (a,b) {
return function (c) {
if(!c)c=l[Rd];
if(c&&!c[Sc])jb(c,c.srcElement);
b.call(a,c)
}
};
;
var Mj="complete",Nj="readystatechange";
var Pj=function () {
return Oj()
};
var Oj=null,Qj=null,Rj=null,Sj=function (a,b) {
Oj=a;
Qj=b;
Rj=null
},Uj=function () {
var a=Tj();
return a?new ActiveXObject(a):new XMLHttpRequest
},Vj=function () {
var a=Tj(),b={
};
if(a) {
b[0]=true;
b[1]=true
}return b
};
Sj(Uj,Vj);
var Wj=null,Tj=function () {
if(!Wj&&typeofXMLHttpRequest=="undefined"&&typeofActiveXObject!="undefined") {
var a=["MSXML2.XMLHTTP.6.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"];
for(var b=0;b<a[E];b++) {
	var c=a[b];
	try{
		new ActiveXObject(c);
		Wj=
		c;
		return c
	}catch(d) {
	}
}throwError("Could not create ActiveXObject. ActiveX might be disabled, or MSXML might not be installed");
}return Wj
};
;
var Zj=function (a,b) {
try{
var c=Xj(a),d="Message: "+Pe(c[Dc])+'\nUrl: <a href="view-source:'+c[zd]+'" target="_new">'+c[zd]+"</a>\nLine: "+c.lineNumber+"\n\nBrowser stack:\n"+Pe(c[wc]+"-> ")+"[end]\n\nJS stack traversal:\n"+Pe(Yj(b)+"-> ");
return d
}catch(e) {
return "Exception trying to expose exception! You win, we lose. "+e
}
},Xj=function (a) {
var b=Xd("document.location.href");
return typeofa=="string"?{
message:a,name:"Unknown error",lineNumber:"Not available",fileName:b,stack:"Not available"
}:(!a.lineNumber||
!a[zd]||!a[wc]?{
message:a[Dc],name:a[yd],lineNumber:a.lineNumber||a.line||"Not available",fileName:a[zd]||a.sourceURL||b,stack:a[wc]||"Not available"
}:a)
},ak=function (a,b) {
var c=typeofa=="string"?Error(a):a;
if(!c[wc])c.stack=Yj(arguments.callee[zc]);
if(b) {
var d=0;
while(c["message"+d])++d;
c["message"+d]=ha(b)
}return c
},Yj=function (a) {
return bk(a||arguments.callee[zc],[])
},bk=function (a,b) {
var c=[];
if(jf(b,a))c.push("[...circular reference...]");
else if(a&&b[E]<50) {
c.push(ck(a)+"(");
var d=a.arguments;
for(var e=0;e<d[E];e++) {
	if(e>0)c.push(", ");
	var f,g=d[e];
	switch(typeofg) {
		case "object":f=g?"object":"null";
		break;
		case "string":f=g;
		break;
		case "number":f=ha(g);
		break;
		case "boolean":f=g?"true":"false";
		break;
		case "function":f=ck(g);
		f=f?f:"[fn]";
		break;
		case "undefined":default:f=typeofg;
		break
	}if(f[E]>40)f=f.substr(0,40)+"...";
	c.push(f)
}b.push(a);
c.push(")\n");
try{
	c.push(bk(a[zc],b))
}catch(h) {
	c.push("[exception trying to get caller]\n")
}
}else if(a)c.push("[...long stack...]");
else c.push("[end]");
return c.join("")
},
ck=function (a) {
var b=ha(a);
if(!dk[b]) {
var c=/function ([^\(]+)/.exec(b);
if(c) {
	var d=c[1],e=/^\$(.+)\$$/.exec(d);
	if(e)d=e[1].replace(/\${
		1,2
	}/g,".");
	dk[b]=d
}else dk[b]="[Anonymous]"
}return dk[b]
},dk={
};
var fk=function (a,b,c) {
this.Fga=ek++;
this.nda=ne();
this.Gh=a;
this.Wv=b;
this.qO=c
};
fk[_P].iA=null;
fk[_P].hA=null;
var ek=0;
fk[_P].Eaa=function (a) {
this.iA=a
};
fk[_P].Faa=function (a) {
this.hA=a
};
fk[_P].sx=function (a) {
this.Gh=a
};
var gk=function (a) {
this.Ac=a;
this.gb=null;
this.Hd={
};
this.VB=[]
};
gk[_P].Gh=null;
var hk=function (a,b) {
Kb(this,a);
Ta(this,b)
};
ya(hk[_P],function () {
return this[yd]
});
var ik=new hk("OFF",Infinity),jk=new hk("SHOUT",1200),kk=new hk("SEVERE",1000),lk=new hk("WARNING",900),mk=new hk("INFO",800),nk=new hk("CONFIG",700),ok=new hk("FINE",500);
new hk("FINER",400);
var pk=new hk("FINEST",300);
new hk("ALL",0);
var rk=function (a) {
return qk(a)
};
gk[_P].Lc=function () {
return this.Ac
};
gk[_P].bW=function (a) {
this.VB.push(a)
};
gk[_P].L9=function (a) {
return qf(this.VB,a)
};
gk[_P].sx=function (a) {
this.Gh=a
};
gk[_P].R0=function () {
if(this.Gh)return this.Gh;
if(this.gb)return this.gb.R0();
return null
};
gk[_P].uC=function (a) {
if(this.Gh)return a[I]>=this.Gh[I];
if(this.gb)return this.gb.uC(a);
return false
};
gk[_P].log=function (a,b,c) {
if(!this.uC(a))return ;
var d=new fk(a,ha(b),this.Ac);
if(c) {
d.Eaa(c);
d.Faa(Zj(c,arguments.callee[zc]))
}this.g6(d)
};
gk[_P].severe=function (a,b) {
this.log(kk,a,b)
};
gk[_P].warning=function (a,b) {
this.log(lk,a,b)
};
gk[_P].info=function (a,b) {
this.log(mk,a,b)
};
gk[_P].config=function (a,b) {
this.log(nk,a,b)
};
gk[_P].fine=function (a,b) {
this.log(ok,a,b)
};
gk[_P].finest=function (a,b) {
this.log(pk,a,b)
};
gk[_P].g6=function (a) {
if(!this.uC(a.Gh))return ;
var b=this;
while(b) {
b.mX(a);
b=b.gb
}
};
gk[_P].mX=function (a) {
for(var b=0;b<this.VB[E];b++)this.VB[b](a)
};gk[_P].pba=function (a) {
this.gb=a
};
gk[_P].UV=function (a,b) {
this.Hd[a]=b
};
var sk={
},tk=null,uk=function () {
if(!tk) {
tk=new gk("");
sk[""]=tk;
tk.sx(nk)
}
},vk=function () {
uk();
return tk
},
qk=function (a) {
uk();
return a in sk?sk[a]:wk(a)
},wk=function (a) {
var b=new gk(a),c=a.split("."),d=c[c[E]-1];
Da(c,c[E]-1);
var e=c.join("."),f=qk(e);
f.UV(d,b);
b.pba(f);
sk[a]=b;
return b
};
var xk=function () {
this.A9=ne()
},yk=new xk;
xk[_P].set=function (a) {
this.A9=a
};
Hb(xk[_P],function () {
this.set(ne())
});
xk[_P].get=function () {
return this.A9
};
var zk=function (a) {
this.Tq=a||"";
this.Wca=yk
};
zk[_P].sT=true;
zk[_P].XT=true;
zk[_P].KT=true;
zk[_P].Fx=false;
zk[_P].Ip=function () {
throwError("Must override formatRecord");
};
var Bk=function (a) {
var b=new Date(a.nda);
return Ak(b.getFullYear()-2000)+Ak(b.getMonth()+1)+Ak(b.getDate())+" "+Ak(b.getHours())+":"+Ak(b.getMinutes())+":"+Ak(b.getSeconds())+"."+Ak(o.floor(b.getMilliseconds()/10))
},Ak=function (a) {
if(a<10)return "0"+a;
return ha(a)
},Ck=function (a,b) {
var c=a.nda-b,d=c/1000,e=d.toFixed(3),f=0;
if(d<
1)f=2;
else while(d<100) {
f++;
d*=10
}while(f-->0)e=" "+e;
return e
},Dk=function (a) {
zk.call(this,a)
};
te(Dk,zk);
Dk[_P].Fx=true;
Dk[_P].Ip=function (a) {
var b;
switch(a.Gh[I]) {
case jk[I]:b="dbg-sh";
break;
case kk[I]:b="dbg-sev";
break;
case lk[I]:b="dbg-w";
break;
case mk[I]:b="dbg-i";
break;
case ok[I]:default:b="dbg-f";
break
}var c=[];
c.push(this.Tq," ");
if(this.sT)c.push("[",Bk(a),"] ");
if(this.XT)c.push("[",Ue(Ck(a,this.Wca.get())),"s] ");
if(this.KT)c.push("[",Pe(a.qO),"] ");
c.push('<span class="',b,'">',He(Ue(Pe(a.Wv))));
if(this.Fx&&a.iA)c.push("<br>",He(Ue(a.hA)));
c.push("</span><br>");
return c.join("")
};
var Ek=function (a) {
zk.call(this,a)
};
te(Ek,zk);
Ek[_P].Ip=function (a) {
var b=[];
b.push(this.Tq," ");
if(this.sT)b.push("[",Bk(a),"] ");
if(this.XT)b.push("[",Ck(a,this.Wca.get()),"s] ");
if(this.KT)b.push("[",a.qO,"] ");
b.push(a.Wv,"\n");
if(this.Fx&&a.iA)b.push(a.hA,"\n");
return b.join("")
};
var Fk=function () {
if(!Uf)return ;
this.jm={
};
this.tG={
};
this.MF=[]
};
Fk[_P].La=rk("goog.net.xhrMonitor");
Fk[_P].rQ=function (a) {
if(!Uf)return ;
var b=ee(a)?a:(he(a)?le(a):"");
this.La.finest("Pushing context: "+a+" ("+b+")");
this.MF.push(b)
};
Fk[_P].bQ=function () {
if(!Uf)return ;
var a=this.MF.pop();
this.La.finest("Popping context: "+a);
this.Wda(a)
};
Fk[_P].p6=function (a) {
if(!Uf)return ;
var b=le(a);
this.La.fine("Opening XHR : "+b);
for(var c=0;c<this.MF[E];c++) {
var d=this.MF[c];
this.Cs(this.jm,d,b);
this.Cs(this.tG,
b,d)
}
};
Fk[_P].o6=function (a) {
if(!Uf)return ;
var b=le(a);
this.La.fine("Closing XHR : "+b);
delete this.tG[b];
for(var c in this.jm) {
qf(this.jm[c],b);
if(this.jm[c][E]==0)delete this.jm[c]
}
};
Fk[_P].Wda=function (a) {
var b=this.tG[a],c=this.jm[a];
if(b&&c) {
this.La.finest("Updating dependent contexts");
ef(b,function (d) {
	ef(c,function (e) {
		this.Cs(this.jm,d,e);
		this.Cs(this.tG,e,d)
	},this)
},this)
}
};
Fk[_P].Cs=function (a,b,c) {
if(!a[b])a[b]=[];
if(!jf(a[b],c))a[b].push(c)
};
var Gk=new Fk;
var Hk=function (a) {
if(/^\s*$/.test(a))return false;
var b=/\\["\\\/bfnrtu]/g,c=/"[^"\\\n\r\u2028\u2029\x00-\x1f\x7f-\x9f]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,d=/(?:^|:|,)(?:[\s\u2028\u2029]*\[)+/g,e=/^[\],:{
}\s\u2028\u2029]*$/;
return e.test(a.replace(b,"@").replace(c,"]").replace(d,""))
},Ik=function (a) {
a=ha(a);
if(typeofa.parseJSON=="function")return a.parseJSON();
if(Hk(a))try{
return eval("("+a+")")
}catch(b) {
}throwError("Invalid JSON string: "+a);
},ni=function (a) {
return eval("("+
a+")")
},Jk=null,ki=function (a) {
if(!Jk)Jk=new Kk;
return Jk.serialize(a)
},Kk=function () {
};
Kk[_P].serialize=function (a) {
if(a!=null&&typeofa.toJSONString=="function")return a.toJSONString();
var b=[];
this.WE(a,b);
return b.join("")
};
Kk[_P].WE=function (a,b) {
switch(typeofa) {
case "string":this.WR(a,b);
break;
case "number":this.W$(a,b);
break;
case "boolean":b.push(a);
break;
case "undefined":b.push("null");
break;
case "object":if(a==null) {
	b.push("null");
	break
}if(ce(a)) {
	this.V$(a,b);
	break
}this.X$(a,b);
break;
default:throwError("Unknown type: "+
typeofa);
}
};
var Lk={
'"':'\\"',"\\":"\\\\","/":"\\/","\u0008":"\\b","\u000c":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\u000b":"\\u000b"
};
Kk[_P].WR=function (a,b) {
b.push('"',a.replace(/[\\\"\x00-\x1f\x80-\uffff]/g,function (c) {
if(c in Lk)return Lk[c];
var d=c.charCodeAt(0),e="\\u";
if(d<16)e+="000";
else if(d<256)e+="00";
else if(d<4096)e+="0";
return Lk[c]=e+d.toString (16)
}),'"')
};
Kk[_P].W$=function (a,b) {
b.push(isFinite(a)&&!qa(a)?a:"null")
};
Kk[_P].V$=function (a,b) {
var c=a[E];
b.push("[");
var d="";
for(var e=
0;e<c;e++) {
b.push(d);
this.WE(a[e],b);
d=","
}b.push("]")
};
Kk[_P].X$=function (a,b) {
b.push("{");
var c="";
for(var d in a) {
b.push(c);
this.WR(d,b);
b.push(":");
this.WE(a[d],b);
c=","
}b.push("}")
};
var Mk=function () {
Xh.call(this);
this.headers=new $g
};
te(Mk,Xh);
Mk[_P].La=rk("goog.net.XhrLite");
var Nk=[],mi=function (a,b,c,d,e,f) {
var g=new Mk;
Nk.push(g);
if(b)Dh(g,Mj,b);
Dh(g,"ready",me(Ok,g));
if(f)g.Lba(f);
g.send(a,c,d,e)
},Ok=function (a) {
a.dispose();
qf(Nk,a)
};
Mk[_P].Jc=false;
Mk[_P].Xa=null;
Mk[_P].xy=null;
Mk[_P].dO="";
Mk[_P].aO="";
Mk[_P].Bq=0;
Mk[_P].yc="";
Mk[_P].gA=false;
Mk[_P].iC=false;
Mk[_P].$r=0;
Mk[_P].Ol=null;
Mk[_P].Lba=function (a) {
this.$r=o.max(0,a)
};
Mk[_P].send=function (a,b,c,d) {
if(this.Jc)throwError("[goog.net.XhrLite] Object is active with another request");
var e=b||"GET";
this.dO=a;
this.yc="";
this.Bq=0;
this.aO=e;
this.Jc=true;
this.Xa=new Pj;
this.xy=Rj||(Rj=Qj());
Gk.p6(this.Xa);
Ba(this.Xa,R(this.EP,this));
try{
this.Hh("Opening Xhr");
this.Xa.open(e,a,true)
}catch(f) {
this.Hh("Error opening Xhr: "+f[Dc]);
this.UJ(5,f);
return
}var g=c?ha(c):"",h=this.headers.clone();
if(d)Zg(d,function (i,j) {
h.set(j,i)
});
if(e=="POST"&&!h.bd("Content-Type"))h.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");
Zg(h,function (i,j) {
this.Xa.setRequestHeader(j,i)
},this);
try{
if(this.Ol) {
	qj.clearTimeout(this.Ol);
	this.Ol=null
}if(this.$r>0) {
	this.Hh("Will abort after "+this.$r+"ms if incomplete");
	this.Ol=qj.setTimeout(R(this.Sc,this),this.$r)
}this.Hh("Sending request");
this.gA=false;
this.iC=true;
this.Xa.send(g);
this.iC=false
}catch(f) {
this.Hh("Send error: "+f[Dc]);
this.UJ(5,f)
}
};
Mk[_P].dispatchEvent=function (a) {
if(this.Xa) {
Gk.rQ(this.Xa);
try{
	Mk.B[Fc].call(this,a)
}finally{
	Gk.bQ()
}
}else Mk.B[Fc].call(this,a)
};
Mk[_P].Sc=function () {
if(typeofSd=="undefined") {
}else if(this.Xa) {
this.yc=
"Timed out after "+this.$r+"ms, aborting";
this.Bq=8;
this.Hh(this.yc);
this.dispatchEvent("timeout");
this.abort(8)
}
};
Mk[_P].UJ=function (a,b) {
this.Jc=false;
if(this.Xa)this.Xa.abort();
this.yc=b;
this.Bq=a;
this.nJ();
this.Qs()
};
Mk[_P].nJ=function () {
if(!this.gA) {
this.gA=true;
this.dispatchEvent(Mj);
this.dispatchEvent("error")
}
};
Mk[_P].abort=function (a) {
if(this.Xa) {
this.Hh("Aborting");
this.Jc=false;
this.Xa.abort();
this.Bq=a||7;
this.dispatchEvent(Mj);
this.dispatchEvent("abort");
this.Qs()
}
};
Mk[_P].M=function () {
if(this.Xa) {
this.Jc=
false;
this.Xa.abort();
this.Qs(true)
}Mk.B.M.call(this)
};
Mk[_P].EP=function () {
if(!this.Jc)return ;
if(typeofSd=="undefined") {
}else if(this.xy[1]&&this.Sm()==4&&this.Ck()==2)this.Hh("Local request error detected and ignored");
else {
if(this.iC&&this.Sm()==4) {
	fi(this.EP,0,this);
	return
}this.dispatchEvent(Nj);
if(this.mN()) {
	this.Hh("Request complete");
	this.Jc=false;
	if(this.vv()) {
		this.dispatchEvent(Mj);
		this.dispatchEvent("success")
	}else {
		this.Bq=6;
		this.yc=this.Z1()+" ["+this.Ck()+"]";
		this.nJ()
	}this.Qs()
}
}
};
Mk[_P].Qs=
function (a) {
if(this.Xa) {
Ba(this.Xa,this.xy[0]?$d:null);
var b=this.Xa;
this.Xa=null;
this.xy=null;
if(this.Ol) {
	qj.clearTimeout(this.Ol);
	this.Ol=null
}if(!a) {
	Gk.rQ(b);
	this.dispatchEvent("ready");
	Gk.bQ()
}Gk.o6(b)
}
};
Mk[_P].Na=function () {
return this.Jc
};
Mk[_P].mN=function () {
return this.Sm()==4
};
Mk[_P].vv=function () {
switch(this.Ck()) {
case 0:case 200:case 204:case 304:return true;
default:return false
}
};
Mk[_P].Sm=function () {
return this.Xa?this.Xa[Yc]:0
};
Mk[_P].Ck=function () {
try{
return this.Sm()>2?this.Xa.status:
-1
}catch(a) {
this.La.warning("Can not get status: "+a[Dc]);
return -1
}
};
Mk[_P].Z1=function () {
try{
return this.Sm()>2?this.Xa.statusText:""
}catch(a) {
this.La.fine("Can not get status: "+a[Dc]);
return ""
}
};
Mk[_P].Gg=function () {
return this.Xa?this.Xa[pc]:""
};
Mk[_P].getResponseHeader=function (a) {
return this.Xa&&this.mN()?this.Xa.getResponseHeader(a):undefined
};
Mk[_P].Hh=function (a) {
this.La.fine(a+" ["+this.aO+" "+this.dO+" "+this.Ck()+"]")
};
function Pk(a,b,c) {
this.oa=a;
var d="ifrm"+c;
this.sfa=c;
this.initFileUpload=false;
this.KD=null;
var e="<iframe src='"+(S?"#":"javascript:return false;")+"' name=";
e+=d;
e+=" id=";
e+=d;
e+=" style='display:none;'></iframe>";
y(b,e);
this.iFrame=a.getElementById(d);
var f=a.createElement("form");
f.onsubmit=function () {
return false
};
f.method="post";
jb(f,d);
f[J].margin=0;
f.encoding="multipart/form-data";
f.acceptCharset="utf-8";
b.appendChild(f);
this.sO=f;
this.kC=null;
this.jE()
}Pk[_P].jE=function () {
var a=null,
b=this.kC;
if(b!=null) {
a=b.onchange;
if(b[I][E]==0)return false
}var c=this.sfa,b=this.oa.createElement("input");
Bb(b,"file");
b.setAttribute("name",c);
b.id=c;
r(b,"browseButton");
va(b,a);
var d=this.sO;
y(d,"");
d.appendChild(b);
this.kC=b
};
Pk[_P].uS=function (a,b,c,d) {
if(S) {
this.KD=Lj(a,c);
Jj(this.iFrame,"load",this.KD)
}else ua(this.iFrame,Qk(a,c));
this.sO.action=b;
va(this.kC,Rk(this,this.fl,a,d))
};
Pk[_P].fl=function (a,b) {
var c=this.kC[I],d=c[E];
if(d<5)return false;
if(c.substring(d-4,d-3)!=".")return false;
var e=c.substring(d-4).toLowerCase(),f=false;
if(e==".xls"||e==".csv"||e==".txt"||e==".tab"||e==".tsv"||e==".ods") {
f=true;
this.initFileUpload=true;
this.sO.submit()
}b.call(a,f,c)
};
Ra(Pk[_P],function () {
if(this.KD!=null)Kj(this.iFrame,"load",this.KD)
});
function Sk(a,b,c) {
this.oa=a;
this.Sc=null;
this.DI=0;
this.wH=false;
this.tU=[];
this.mP=0;
this.U6=null;
this.onAfterHideHandler=null;
var d=Tk(a,b,"toast","");
this.dd=d;
this.NX=Lj(this,this.Kq);
Jj(d,"click",this.NX);
var e=Uk(d,18,"toastTop"),f=Uk(d,null,"toastFill");
this.Lfa=Vk(a,f,"p","toastTitle");
this.UP=Vk(a,f,"p","toastContent");
if(S) {
this.UP[J].marginTop="-14px";
Wk(a,e,"toastImgIE",c+"toastBackTop.png");
Wk(a,f,"toastImgIE",c+"toastBackFill.png")
}else {
Ab(e[J],"url("+c+"toastBackTop.png)");
Ab(f[J],
"url("+c+"toastBackFill.png)")
}if(Zf&&Uf)this.UP[J].paddingBottom="18px"
}Sk[_P].Kq=function (a) {
this.Pu();
if(this.onAfterHideHandler!=null)this.onAfterHideHandler(a)
};
Sk[_P].gi=function (a,b,c,d,e) {
if(c==null)c=5000;
if(d)this.Pu(true);
this.tU.push([a,b,c,e]);
this.OT()
};
Sk[_P].OT=function () {
if(!this.wH) {
if(this.tU[E]<1)return ;
this.wH=true;
var a=this.dd;
this.DI=yb(a[J],-100);
var b=this.tU.pop();
y(this.Lfa,b[0]);
y(this.UP,b[1]);
this.mP=b[2];
this.U6=b[3];
C(a[J],"block");
ei(this.Sc);
this.Sc=null;
this.AH()
}
};
Sk[_P].e4=function (a) {
if(a==this.U6)this.Pu()
};
Sk[_P].Pu=function (a) {
ei(this.Sc);
this.Sc=null;
C(this.dd[J],"none");
this.wH=false;
if(a!=true)this.OT()
};
Sk[_P].AH=function () {
var a=this.DI;
a+=12;
if(a>0)a=0;
yb(this.dd[J],a);
if(a<0)this.Sc=fi(this.AH,30,this);
else {
this.Sc=null;
if(this.mP>0)this.Sc=fi(this.Pu,this.mP,this)
}this.DI=a
};
Ra(Sk[_P],function () {
this.onAfterHideHandler=null;
Kj(this.dd,"click",this.NX)
});
var Xk=function (a) {
af.call(this);
this.Gt=[];
this.qa=a;
this.Xa=new Mk;
this.q=new mj(this);
this.q.listen(this.Xa,["success","ready"],this.Nu);
fi(this.QE,60000,this)
};
Xk.inherits(af);
Xk[_P].log=function (a,b,c,d,e) {
var f={
};
f.eventCode=a;
f.serverTime=b;
f.parseTime=c;
f.clientTime=d;
f.uiCode=e;
this.Gt.push(f)
};
Xk[_P].dump=function () {
return ki(this.Gt)
};
Xk[_P].QE=function () {
if(this.Gt[E]>0)this.Xa.send(this.qa,"POST","events="+this.dump());
else fi(this.QE,60000,this)
};
Xk[_P].Nu=function (a) {
if(a[N]=="success")this.clear();
else if(a[N]=="ready")fi(this.QE,60000,this)
};
Db(Xk[_P],function () {
this.Gt=[]
});
Xk[_P].dispose=function () {
if(!this.N()) {
Xk.B.dispose.call(this);
this.Gt=null
}
};
function Yk(a,b) {
this.R=null;
this.PX=null;
this.Lea=false;
this.c_=null;
this.b_=null;
this.d_=null;
this.qda=null;
if(b!=null&&b.chrome) {
this.Lea=b.chrome;
var c=Zk(b.doc,b.elem,"",0,0,b[F],b[P]),d=Tk(b.doc,c,"bar"+(b.dark?" dark":" light"),"");
x(d[J],"100%");
this.qda=d;
var e=d.insertRow(0),f=e.insertCell(0);
x(f[J],"100%");
r(f,"tabdesc");
y(f,"<b>"+b[yd]+"</b>");
f=e.insertCell(1);
r(f,"closebox");
$k(b.doc,f,b.pathImg+"close_box.gif","","","");
this.PX=f;
var g=al(b.doc,c,"","tabborder"),h=al(b.doc,g,"","tabcontent");
D(h[J],"100%");
x(a[J],"100%");
h.appendChild(a);
C(a[J],"");
this.R=c;
this.c_=g;
this.b_=h;
this.d_=a
}else this.R=a
}Yk[_P].$=function () {
return this.R
};
Yk[_P].nF=function (a) {
z(this.PX,Qk(a,a.close))
};
Yk[_P].Pd=function (a) {
var b=S;
a+=b?4:0;
var c=this.qda[Id]+(b?10:6);
D(this.R[J],a);
D(this.c_[J],a-c);
D(this.b_[J],a-c-(b?4:32));
D(this.d_[J],a-c-(b?64:32))
};
function bl(a,b,c,d) {
this.oa=a;
this.PD=c;
this.Gj=[];
this.Jc=-1;
this.qm=d;
this.RF=Tk(a,b,"tabContainer","");
this.Dda=this.RF.insertRow(0);
this.Dda.vAlgin="bottom"
}bl[_P].zi=function (a,b,c) {
var d={
};
d.dark=this.qm;
if(c!=null) {
d.handler=c.handler;
d.metaData=c.metaData;
d.closer=c.closer
}var e=new cl(this.oa,this.Dda,this,a,b,this.Gj[E],this.PD,d);
this.Gj.push(e);
return e
};
bl[_P].iaa=function (a) {
var b=this.Gj;
for(var c=0;c<b[E];c++)if(a!=c)b[c].activate(false);this.Jc=a
};bl[_P].NS=function (a) {
if(this.Jc==
a)this.Jc=-1
};
bl[_P].Xt=function () {
var a=this.Jc;
return a>=0&&a<this.Gj[E]?this.Gj[a]:null
};
bl[_P].J=function () {
return this.RF
};
C(bl[_P],function (a) {
if(a)C(this.RF[J],"");
else {
var b=this.Xt();
if(b)b.close();
C(this.RF[J],"none")
}
});
function cl(a,b,c,d,e,f,g,h) {
if(h!=null) {
this.G=h.handler;
this.qm=h.dark;
this.Cn=h.metaData
}this.Ac=d;
this.ue=c;
this.Ll=e;
this.Mc=f;
this.Pj="tab "+(this.qm?"dark":"light");
this.RX=h.closer?h.closer:new dl(this.Ll.$());
this.QF=b.insertCell(b[L][E]);
var i=this.QF;
Aa(i,"bottom");
var j=Tk(a,i,this.Pj,"");
this.Wr=j;
var k=T(j);
k.appendChild(j,k.b("tbody",null,k.b("tr",null,k.b("td",{
"class":"ul"
},k.b("div",{
"class":"img-sprite icon-tab-u-start"
})),k.b("td",{
"class":"ur",align:"right"
},k.b("div",{
"class":"img-sprite icon-tab-u-end"
}))),
k.b("tr",null,k.b("td",{
"class":"main",colSpan:2
},k.b("a",{
href:S?"#":"javascript:;"
},this.Xea=k.b("div",null,k.b("a",null,d)))))));
this.vm(false);
this.qc=false;
this.Jc=false;
this.a7=false;
this.enable(true)
}cl[_P].enable=function (a) {
if(a==this.qc)return ;
var b=this.QF;
if(a) {
z(b,el(this,this.activate,true));
var c=this.G;
if(c&&c.fM)b.onmousemove=el(c,c.fM,this);
z(this.Ll.$(),el(this,this.notify,false));
r(this.Wr,this.Pj)
}else {
z(b,null);
b.onmousemove=null;
this.vm(false);
z(this.Ll.$(),null);
r(this.Wr,
"tab disabled");
this.ue.NS(this.Mc)
}if(this.qm)this.hx("#e0edfe");
this.qc=a
};
cl[_P].activate=function (a) {
if(!this.qc) {
if(a==true)this.notify(false);
return
}if(a) {
var b=this.G;
if(b==null||b.Ks!=null&&b.Ks(this)==true) {
	if(b!=null&&b.dp!=null)b.dp(this);
	this.vm(true);
	r(this.Wr,this.Pj+" atab");
	this.ue.iaa(this.Mc);
	if(this.qm)this.hx("#79b");
	if(b!=null&&b.Ds!=null)b.Ds(this)
}else return
}else {
this.vm(false);
if(this.qm)this.hx("#e0edfe");
r(this.Wr,this.Pj);
this.ue.NS(this.Mc)
}this.Jc=a
};
cl[_P].close=function () {
if(this.Jc) {
var a=
this.G;
if(a!=null&&a.VH!=null)a.VH(this);
this.activate(false);
if(a!=null&&a.qH!=null)a.qH(this)
}
};
cl[_P].vm=function (a) {
if(a) {
this.RX.show();
this.notify(false)
}else this.RX.hide()
};
C(cl[_P],function (a) {
if(a)C(this.QF[J],"");
else {
this.close();
C(this.QF[J],"none")
}
});
cl[_P].notify=function (a) {
if(a==this.a7)return ;
if(a&&this.Jc)return ;
var b="",c="";
if(a)b="tab notify";
else if(this.Jc) {
b=this.Pj+" atab";
c="#79b"
}else if(this.qc) {
b=this.Pj;
c="#e0edfe"
}else {
b="tab disabled";
c="#e0edfe"
}r(this.Wr,b);
if(this.qm&&
!a)this.hx(c);
this.a7=a
};
cl[_P].cg=function (a) {
y(this.Xea,a)
};
cl[_P].Na=function () {
return this.Jc
};
cl[_P].wc=function () {
return this.qc
};
cl[_P].Lc=function () {
return this.Ac
};
cl[_P].hx=function (a) {
Fb(this.Wr[J],"1px solid "+a)
};
function dl(a) {
this.yg=a
}dl[_P].show=function () {
V(this.yg,true)
};
dl[_P].hide=function () {
V(this.yg,false)
};
var fl=null,gl=[null,"menu_font_","menu_size_"],hl="vertical-align:middle",il=null,jl=null,ml=["fontsize-6","fontsize-7","fontsize-8","fontsize-9","fontsize-10","fontsize-11","fontsize-12","fontsize-14","fontsize-18","fontsize-24","fontsize-36"],nl={
"fontsize-6":6,"fontsize-7":7,"fontsize-8":8,"fontsize-9":9,"fontsize-10":10,"fontsize-11":11,"fontsize-12":12,"fontsize-14":14,"fontsize-18":18,"fontsize-24":24,"fontsize-36":36
},ol={
"fontsize-6":'<font style="font-size:'+nl["fontsize-6"]+"pt;"+hl+'" unselectable=on>6</font>',
"fontsize-7":'<font style="font-size:'+nl["fontsize-7"]+"pt;"+hl+'" unselectable=on>7</font>',"fontsize-8":'<font style="font-size:'+nl["fontsize-8"]+"pt;"+hl+'" unselectable=on>8</font>',"fontsize-9":'<font style="font-size:'+nl["fontsize-9"]+"pt;"+hl+'" unselectable=on>9</font>',"fontsize-10":'<font style="font-size:'+nl["fontsize-10"]+"pt;"+hl+'" unselectable=on>10</font>',"fontsize-11":'<font style="font-size:'+nl["fontsize-11"]+"pt;"+hl+'" unselectable=on>11</font>',"fontsize-12":'<font style="font-size:'+
nl["fontsize-12"]+"pt;"+hl+'" unselectable=on>12</font>',"fontsize-14":'<font style="font-size:'+nl["fontsize-14"]+"pt;"+hl+'" unselectable=on>14</font>',"fontsize-18":'<font style="font-size:'+nl["fontsize-18"]+"pt;"+hl+'" unselectable=on>18</font>',"fontsize-24":'<font style="font-size:'+nl["fontsize-24"]+"pt;"+hl+'" unselectable=on>24</font>',"fontsize-36":'<font style="font-size:'+nl["fontsize-36"]+"pt;"+hl+'" unselectable=on>36</font>'
},pl="menu_bord_",ql=[[14,16,17,15],[18,19,20,21]],rl=[["111100",
"000011","111111","222222"],["100000","001000","010000","000100"]],sl="menu_align_",tl=[[7,8,9],[10,11,12]],ul=[["left","center","right"],["top","middle","bottom"]];
function vl(a,b,c,d) {
fl=d;
this.app=a;
this.win=a.Bh();
this.divOwner=b;
this.styleNm="";
this.menutype=c;
this.actualtype=null;
this.div_id=gl[c]
}vl[_P].Gaa=function (a) {
il=a;
var b=[];
for(var c=0;c<a[E];c++)b[c]=a[c][0];jl=b
};vl[_P].Yaa=function (a,b) {
this.actualtype=b;
this.menutype=a;
this.div_id=gl[a]
};
vl[_P].open=function (a,b,c) {
var d=false,
e=this.win[mc].getElementById(this.div_id);
if(e==null) {
d=true;
e=this.win[mc].createElement("div");
ib(e[J],a);
e[J].top=b;
e.id=this.div_id;
wl(e,this.menutype);
this.divOwner.appendChild(e)
}this.t9(e,d);
this.styleNm=c;
var f=e[J];
Lb(f,100);
ib(f,a);
f.top=b;
C(f,"block")
};
vl[_P].close=function () {
var a=this.win[mc].getElementById(this.div_id);
if(a!=null)C(a[J],"none")
};
vl[_P].isOpen=function () {
var a=this.win[mc].getElementById(this.div_id);
return a&&a[J][Cd]=="block"
};
vl[_P].t9=function (a,b) {
if(b||this.menutype!=
0) {
y(a,xl(this.menutype));
this.PV(a)
}
};
vl[_P].PV=function (a) {
if(this.menutype==5)for(var b=0;b<ql[E];b++)for(var c=0;c<ql[b][E];c++) {
var d=pl+rl[b][c],e=this.win[mc].getElementById(d);
qb(e,yl(this,d,"white"));
ab(e,yl(this,d,"#c3d9ff"));
z(e,zl(this,d))
}else if(this.menutype==6)for(var b=0;b<tl[E];b++)for(var c=0;c<tl[b][E];c++) {
var d=sl+ul[b][c],e=this.win[mc].getElementById(d);
qb(e,yl(this,d,"white"));
ab(e,yl(this,d,"#c3d9ff"));
z(e,Al(this,d,b==0))
}else {
var f=Bl(this.menutype),g=a[rd][0][pd];
for(var b=
0;b<f[E];b++) {
	var d=f[b];
	qb(g[b],Cl(this,d,"#fff","#5570cc"));
	ab(g[b],Cl(this,d,"#000","#c3d9ff"));
	z(g[b],Dl(this,d))
}
}
};
var Bl=function (a) {
if(a==1)return jl;
else if(a==2)return ml
},wl=function (a) {
Ga(a[J],"pointer");
Gb(a[J],"2px solid");
a[J].borderColor="#e8f1ff #9daecd #9daecd #e8f1ff";
ub(a[J],"2");
a[J].background="#c3d9ff";
Lb(a[J],"2");
Fa(a[J],"absolute")
},xl=function (a,b) {
if(a==1)return El(jl,Fl(),b);
else if(a==2)return El(ml,ol,b);
else if(a==5)return Gl(pl,ql,rl);
else if(a==6)return Gl(sl,tl,
ul)
},El=function (a,b) {
var c="<table border=0 cellpadding=0 cellspacing=0>";
for(var d=0;d<a[E];d++) {
var e=a[d],f=b[e],g="&nbsp;";
c+='<tr><td style="font-size:10pt;font-family:arial;text-decoration:none;display:block;padding:2 9 2 4;color:#000;" id="'+e+'" unselectable=on  >'+g+"&nbsp;"+f+"</td></tr>"
}return c+"</table>"
},Cl=function (a,b,c,d) {
return function () {
Hl(a.win,b,c,d)
}
},Dl=function (a,b) {
return function () {
a.close();
Sa(a,b);
Hl(a.win,b,"#000","#c3d9ff");
a.app.Yk(Il(b,a.menutype),a.styleNm)
}
},Hl=
function (a,b,c,d) {
Jl(a,b,"color",c);
Jl(a,b,"background",d)
},Jl=function (a,b,c,d) {
var e=a[mc].getElementById(b);
e[J][c]=d
},Il=function (a,b) {
if(b==1)return Kl()[a];
else if(b==2)return nl[a]
},yl=function (a,b,c) {
return function () {
Ll(a.win,b,c)
}
},Ll=function (a,b,c) {
Jl(a,b,"borderColor",c)
},Fl=function () {
var a={
},b=il;
for(var c=0;c<b[E];++c) {
var d=b[c];
a[d[0]]='<font face="'+d[1]+'" class='+hl+" unselectable=on>"+d[2]+"</font>"
}return a
},Kl=function () {
var a={
},b=il;
for(var c=0;c<b[E];c++)a[b[c][0]]=b[c][1];
return a
},Gl=function (a,b,c) {
var d=["<table cellspacing=0 cellpadding=0>"];
for(var e=0;e<b[E];e++) {
d[d[E]]="<tr>";
for(var f=0;f<b[e][E];f++)d[d[E]]="<td id="+a+c[e][f]+" unselectable=on style='padding:2;border:1px solid #c3d9ff;'><div style='width:18;height:18;' class='menuToolbarNoSel'><img src='"+fl+"/toolbarAll9.gif' style='position:absolute;left:"+-18*b[e][f]+"'></div></td>";d[d[E]]="</tr>"
}d[d[E]]="</table>";return d.join("")
},zl=function (a,b) {
return function () {
a.close();
Sa(a,b.substr(pl[E]));
Ll(a.win,b,"#c3d9ff");
a.app.Yk(a.selected,a.styleNm)
}
},Al=function (a,b,c) {
return function () {
a.close();
Sa(a,b.substr(sl[E]));
Ll(a.win,b,"#c3d9ff");
if(c)a.app.Yk(a.selected,"textAlign");
else a.app.Yk(a.selected,"verticalAlign")
}
};
function Ml(a,b,c,d,e,f,g) {
if(!g)this.Vba(a[Lc]);
this.lh=Zk(a,b,"dropMenu",0,0,"","");
var h=this.lh,i=[],j=Tk(a,this.lh,"dropMenu",""),k;
for(var m=0;m<c[E];m++) {
k=j.insertRow(m);
var n=new Nl(a,h,this,j,k,c[m],d,m,e,f);
i.push(n)
}this.Gb=i;
this.menuHeight=j[Id];
this.menuWidth=j[tc];
this.Sa("none",null,null);
this.Ka=false;
this.N5=-1
}var Ol=null,Pl=null;
Ml[_P].Vba=function (a) {
if(Pl==null)Pl=S&&!dg("7")||Uf&&ag;
if(!Ol&&Pl)Ol=this.kY(a)
};
Ml[_P].kY=function (a) {
var b=T(a),c="menu_backing_frame",d=b.b("iframe",
{
name:c,id:c,frameBorder:"no",scrolling:"no",marginHeight:0,marginWidth:0,"class":"dropMenu"
});
b.appendChild(a,d);
return d
};
Ml[_P].Fi=function (a) {
var b=this.N5,c=a!=undefined&&a!=null;
if(b>=0&&(!c||a!=b))this.Gb[b].uI("");
this.N5=c?a:-1
};
Ml[_P].ea=function (a,b) {
this.Gb[a].Cj(b)
};
Ml[_P].Sa=function (a,b,c,d,e) {
var f=this.lh;
if(b!=null)Fi(f,b,c);
if(d!=null)Bi(f[rd][0],"width",d);
C(f[J],a);
var g=a[E]==0;
this.Ka=g;
var h=Ol;
if(h!=null&&!e) {
if(b!=null)Fi(h,b,c);
Ki(h,g?f.scrollWidth:0,g?f[dd]:0);
Sb(h[J],
g?"visible":"hidden")
}if(!g)this.Fi();
else this.WX()
};
Ml[_P].WX=function () {
var a=this.Gb,b=a[E];
for(var c=0;c<b;c++)a[c].uI("")
};Ra(Ml[_P],function () {
var a=this.Gb,b=a[E];
for(var c=0;c<b;c++) {
a[c].cleanup();
a[c]=null
}this.gb=null;
var d=this.lh;
y(d,"");
d[O].removeChild(d)
});
function Nl(a,b,c,d,e,f,g,h,i,j) {
this.VP=j;
this.Afa=c;
this.js=e;
this.subMenu=null;
this.Mc=h;
this.$ca=false;
this.bN=null;
this.$M=null;
this.Cn=null;
this.Ic=null;
this.uJ=null;
this.WG=0;
var k=e.insertCell(0),m;
if(f==null||f[4]==3) {
tb(k,2);
r(k,"sep");
if(g) {
	k=e.insertCell(1);
	r(k,"sep")
}this.Ic=3
}else {
this.Cn=f[2];
var n=null;
if(f[3]) {
	n=new Ml(a,b,f[3],g,i,j);
	this.subMenu=n
}var q=0;
if(f[4])q=f[4];
this.Ic=q;
if(q==4) {
	m="<span class='pickerkey'>";
	m+=f[0];
	m+="</span>";
	y(k,m);
	tb(k,2);
	r(k,"picker");
	var p=Ql(a,
	k,f[1],"activepicker"),s=Ql(a,k,f[2],"picker");
	this.uJ=[p,s];
	x(d[J],o.max(k[tc],d[tc]))
}else if(q==2) {
	var u=Tk(a,k,"","border:0; cellpadding:0; cellspacing:0");
	tb(k,2);
	wb(k[J],"3px");
	e=u.insertRow(0);
	k=e.insertCell(0);
	m="<div class='key'>";
	m+=f[0];
	m+="</div>";
	y(k,m);
	k=e.insertCell(1);
	Nb(k,"right");
	var v=Zk(a,k,"input",0,0,"",""),t=Rl(a,v,"","","",0,0,"","",1000,"text");
	t.size=5;
	t.maxLength=4;
	this.bN=t;
	e=u.insertRow(1);
	k=e.insertCell(0);
	Nb(k,"right");
	tb(k,2);
	var w=Zk(a,k,"button",0,0,"","");
	this.$M=
	new Sl(a,k,[[f[1]]]);
	var B=this.$M.X[0],A=B[J];
	Fa(A,"relative");
	ib(A,w[tc]-B[tc]-5)
}else {
	m=q==1?"<div class='symbol'>":"<div class='item'>";
	m+=f[0];
	m+="</div>";
	y(k,m);
	if(q==1)x(k[J],"20%");
	if(g) {
		k=e.insertCell(1);
		m=q==1?"<div class='symbolname'>":(n?"<div class='submenukey'>":"<div class='key'>");
		if(f[1]!=null)m+=f[1];
		if(n)m+=" \u00bb";
		m+="</div>";
		y(k,m)
	}
}
}this.enable(true)
}Nl[_P].K4=function () {
var a=this.subMenu;
if(a)a.Sa("none",null,null,null,true)
};
Nl[_P].BP=function (a) {
Ij(a)
};
Nl[_P].l7=function (a) {
var b=
this.uJ;
r(b[this.WG],"picker");
r(b[a],"activepicker");
this.WG=a
};
Nl[_P].enable=function (a) {
var b=this.js;
if(a) {
qb(b,el(this,this.h_,"#D3E3FE"));
if(this.Ic==2||this.subMenu!=null)b.onmouseup=this.BP;
if(this.Ic==4) {
	b.onmouseup=this.BP;
	var c=this.uJ;
	for(var d=0;d<c[E];d++)z(c[d],el(this,this.l7,d))
}Ga(b[J],"pointer");Za(b[L][0][J],"")
}else {
qb(b,null);
z(b,null);
Ga(b[J],"");
Za(b[L][0][J],"#676767")
}
};
Nl[_P].h_=function (a) {
var b=this.Afa;
if(b)b.Fi(this.Mc);
if(this.Ic!=4)this.ZR(a);
var c=this.subMenu;
if(c) {
if(!this.$ca) {
	this.K4();
	this.$ca=true
}c.Fi();
if(!c.Ka) {
	var d=this.js,e=d[Ed]+2,f=this.VP;
	if(f) {
		var g=c.menuHeight;
		e=o.min(f[Id]-g,e)
	}c.Sa("",d[Cc]+d[tc]-6,e,null,true)
}
}
};
Nl[_P].uI=function (a) {
var b=this.subMenu;
if(b&&b.Ka) {
b.Fi();
b.Sa("none",null,null,null,true)
}this.ZR(a)
};
Nl[_P].ZR=function (a) {
cb(this.js[J],a)
};
Nl[_P].J=function () {
return this.js
};
Nl[_P].l1=function () {
return this.bN!=null?this.bN[I]:null
};
Nl[_P].WA=function () {
return this.$M
};
Nl[_P].jd=function () {
return this.Ic
};
Nl[_P].a2=function () {
return this.js[L][0][rd][0][rc]
};
Nl[_P].Cj=function (a) {
var b=this.js;
if(a==null)C(b[J],"none");
else {
C(b[J],"");
y(b[L][0][rd][0],a)
}
};
Ra(Nl[_P],function () {
this.gb=null;
if(this.subMenu)this.subMenu.cleanup()
});
function Sl(a,b,c,d) {
var e="btn"+(c[E]>1?" btngrp":" onbtn")+(d?" dropdn":"");
this.bfa=d;
this.X=[];
this.bI=null;
this.qc=false;
var f=S?"#":"javascript:;";
if(c[E]>1) {
var g=Ql(a,b,"",e);
this.bI=g;
var h=a.createElement("b");
g.appendChild(h);
var i=a.createElement("b");
h.appendChild(i);
for(var j=0;j<c[E];j++) {
	var k=a.createElement("b");
	i.appendChild(k);
	if(j==c[E]-1)r(k,"last");
	Tl(a,k,f,c[j][0],true);
	if(c[j][1]!=null)Ea(k,c[j][1]);
	this.X.push(k)
}
}else {
var g=Tl(a,b,f,"");
y(g,"<b><b><b>"+c[0][0]+"</b></b></b>");
r(g,e);
if(c[0][1]!=null)Ea(g,c[0][1]);
this.X.push(g);
this.bI=g
}this.Pj=e;
this.enable(true)
}Sl[_P].cg=function (a,b) {
var c=this.X,d=null;
d=b==null&&b==undefined?c[0]:c[b];
if(c[E]>1)y(d[M],a);
else y(d[M][M][M][M],a)
};
Sl[_P].Dx=function (a,b) {
var c=this.X,d=null;
d=b==null&&b==undefined?c[0]:c[b];
if(c[E]>1)Ea(d,a);
else Ea(d[M][M][M],a)
};
Sl[_P].enable=function (a) {
var b=this.X,c=this.Pj;
if(this.X[E]>1)c="";
if(a) {
}else c+=this.bfa?" disableddropdn":" disabled";
for(var d=0;d<b[E];d++) {
if(!a)z(b[d],null);
if(b[E]>
1&&d==b[E]-1)c+=" last";
r(b[d],c)
}this.qc=a
};
C(Sl[_P],function (a) {
C(this.bI[J],a?"":"none")
});
Sl[_P].notify=function (a) {
if(a) {
var b=this.X;
for(var c=0;c<b[E];c++)b[c].className+=" notify"
}else this.enable(this.qc)
};Ra(Sl[_P],function () {
var a=this.X;
for(var b=0;b<a[E];b++)z(a[b],null)
});var Ul=null;function Vl(a,b) {
var c=[];
for(var d=0;d<b[E];d++) {
var e=new Image;
e.src=a+b[d];
c.push(e)
}return c
}function Wl(a) {
return a.replace(/^\s+|\s+$/g,"")
}function Gj(a,b) {
var c=a.getElementById("modalDialogBackground");
if(c==null) {
c=a.createElement("div");
a[Lc].appendChild(c);
if(!S)Ab(c[J],"url("+b+"modalDlgBack.png) !important");
c.id="modalDialogBackground"
}return c
}function Xl(a,b,c) {
var d=a.createElement("input");
Bb(d,"checkbox");
b.appendChild(d);
La(d,c);
return d
}function Yl(a,b,c,d,e) {
var f;
if(S) {
y(b,"<input type=radio name='"+c+"' value="+d+(e?" checked=true>":">"));
f=b[M]
}else {
f=a.createElement("input");
Bb(f,"radio");
Kb(f,c);
Ta(f,d);
b.appendChild(f);
La(f,e)
}return f
}function Zl(a,b,c,d) {
var e=a.createElement("option");
y(e,c);
Ta(e,d);
b.appendChild(e);
return e
}function Wk(a,b,c,d) {
var e=a.createElement("div");
r(e,c);
xa(e[J],"progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+d+"', sizingMethod='scale')");
b.insertBefore(e,b[M]);
return e
}function Vk(a,b,c,d) {
var e=a.createElement(c);
b.appendChild(e);
if(d!=null)r(e,d);
return e
}function $l(a,b) {
var c=a.insertRow(a[pd][E]);
if(b!=null)r(c,b);
return c
}function Uk(a,b,c) {
var d=a.insertRow(a[pd][E]),e=d.insertCell(0);
if(c!=null)r(e,c);
if(b!=null)D(e[J],b);
return e
}function am(a,b,c,d,e) {
var f=a.insertCell(a[L][E]);
if(c!=null)r(f,c);
pb(f[J],b);
if(e!=null)tb(f,e);
if(d!=null)y(f,d);
return f
}function Tl(a,b,c,d,e,f) {
var g=a.createElement("a");
zb(g,c);
if(e)y(g,d);
else g.appendChild(a.createTextNode(d));
if(f!=null)r(g,f);
b.appendChild(g);
return g
}function bm(a,b,c) {
var d=a.createTextNode(c);
b.appendChild(d);
return d
}function Ql(a,b,c,d,e) {
var f=a.createElement("span");
y(f,c);
r(f,d);
if(e!=null)pb(f[J],e);
b.appendChild(f);
return f
}function $k(a,b,c,d,e,f) {
var g=a.createElement("img");
g.src=c;
r(g,d);
pb(g[J],e);
Ea(g,f);
b.appendChild(g);
return g
}function Tk(a,b,c,d) {
var e=a.createElement("table");
r(e,c);
pb(e[J],d);
Ib(e,0);
e.cellSpacing=0;
b.appendChild(e);
return e
}function Zk(a,b,c,d,e,f,g,h,i) {
var j=a.createElement("div");
r(j,c);
var k=
j[J];
ib(k,d+"px");
k.top=e+"px";
if(f!=null)x(k,f);
if(g!=null)D(k,g);
if(!i)if(h==null)b.appendChild(j);
else b.insertBefore(j,h);
return j
}function al(a,b,c,d,e) {
var f=a.createElement("div");
y(f,c);
r(f,d);
if(e!=null)pb(f[J],e);
b.appendChild(f);
return f
}function Rl(a,b,c,d,e,f,g,h,i,j,k) {
var m=null;
if(k==="textarea")m=a.createElement("textarea");
else {
m=a.createElement("input");
Bb(m,k)
}r(m,c);
var n=m[J];
pb(n,d);
Fa(n,e);
if(f!=null)ib(n,f+"px");
if(g!=null)n.top=g+"px";
x(n,h);
D(n,i);
m.tabIndex=j;
b.appendChild(m);
return m
}function cm(a,b) {
var c=a.createElement("iframe");
b.appendChild(c);
return c
}function dm(a,b) {
return function () {
r(a,b)
}
}function em(a,b,c,d) {
var e=a[J];
Ab(e,b==null?"none":"url('"+b+"')");
e.backgroundRepeat=c;
e.backgroundPosition=d
}function Qk(a,b) {
return function () {
return b.call(a)
}
}function el(a,b,c) {
return function () {
return b.call(a,c)
}
}function Rk(a,b,c,d) {
return function () {
return b.call(a,c,d)
}
}function fm(a,b) {
var c=[];
for(var d=2;d<arguments[E];d++)c[d-2]=arguments[d];return function () {
return b.apply(a,
c)
}
}function gm(a,b,c) {
var d=[];
for(var e=3;e<arguments[E];e++)d[e-3]=arguments[e];var f=l.setTimeout(function () {
b.apply(a,d)
},c);
return f
}function hm(a,b,c,d,e) {
var f=null;
try{
f=new XMLHttpRequest
}catch(g) {
try{
	f=new ActiveXObject("Microsoft.XMLHTTP")
}catch(g) {
	return null
}
}try{
if(a!=null) {
	f.open("POST",a,c);
	f.setRequestHeader("Cache-Control","no-cache");
	f.setRequestHeader("Content-Type","application/x-www-form-urlencoded");
	f.setRequestHeader("Content-Length",b[E]);
	if(e)Ba(f,el(d,e,f));
	f.send(b)
}
}catch(g) {
return null
}return f
}
function im(a,b) {
try{
var c=hm(a,b,false);
return c.status==200?c[pc]:null
}catch(d) {
return null
}
}function jm(a,b) {
var c;
c=b==null?l.open(a):l.open(a,"",b);
c.focus();
return c
}function km(a,b,c) {
if(S) {
var d=T(b),e=d.b("iframe",{
	src:a,style:"display: none"
});
d.appendChild(b,e);
fi(R(d.removeNode,d,e),20000)
}else c.open(a)
}function lm(a) {
var b=a[E]-1;
if(a.charAt(b)=="#")a=a.substring(0,b);
return a
}function mm(a,b) {
b=b==null?30:b;
if(a[E]>b)a=a.substring(0,b-3)+"...";
return a
}function nm(a) {
try{
return a.iFrame[Fd][mc][Lc][rc].replace(/&amp;
/mg,
"&")
}catch(b) {
return null
}
}function qi(a,b) {
try{
var c=eval(a);
if(c[0]==0)return c[1];
else {
	ra(c[1]);
	return null
}
}catch(d) {
ra(b);
return null
}
}function om(a,b,c) {
if(S)a[M].removeChild(b);
else a.deleteRow(c)
}function pm(a) {
if(a!=null)C(a[J],"none")
}function qm(a) {
var b="Unknown JS error.";
if(a!=null)b="JS error: "+a[Dc];
return b
}function rm(a,b,c) {
var d="";
for(var e=0;e<a[E];e+=b) {
var f=a.substring(e,e+b);
d+=sm(f,c);
if(e+b>=a[E]) {
	f=a.substring(e+b);
	d+=sm(f,c)
}
}return d
}function sm(a,b) {
var c=b?b.doc:
null,d=b?b.elem:null,e=b?b[gc]:false,f="";
if(d!=null&&c!=null) {
if(e)bm(c,d,a);
else Ql(c,d,a,"");
d.innerHTML+="<wbr></wbr>"
}else {
f+=a;
f+="<wbr></wbr>"
}return f
}function tm(a,b) {
if(a[rc]!=b)y(a,b)
}function _SHU_initPrompt(a) {
Ul=a
}function um(a,b) {
if(Ul!=null&&S&&cg(Yf,"7.0")>=0) {
var c={
};
c._message=a;
c._initialValue=b;
c._newValue=null;
l.showModalDialog(Ul,c,"dialogHeight:120px;dialogWidth:280px;scroll:no;status:no;unadorned:yes");
return c._newValue
}else return l.prompt(a,b)
}function vm(a,b) {
if(Wf) {
for(var c=
0;c<a[E];c++) {
	var d=a[c];
	if(d[yd]==b)return d.content
}return null
}else {
var d=a[b];
return d?d.content:null
}
}var wm;
function xm() {
if(!wm) {
var a=[],b="abcdefghijklmnopqrstuvwxyz";
for(var c=0;c<b[E];c++)a[b.charAt(c)]=b.charAt((c+13)%26);for(var c=0;c<b[E];c++)a[b.charAt(c).toUpperCase()]=b.charAt((c+13)%26).toUpperCase();wm=a
}return wm
}function ym(a) {
var b=xm(),c="";
for(var d=0;d<a[E];d++) {
var e=a.charAt(d);
c+=e>="A"&&e<="Z"||e>="a"&&e<="z"?b[e]:e
}return c
};
var Cm=function (a,b,c,d) {
Xi.call(this,d);
var e=new mj(this);
e.listen(b,"changegrid",this.m2);
e.listen(b,"changeposition",this.n2);
e.listen(b,"changeediting",this.l2);
e.listen(b,"dispose",this.dispose);
this.q=e;
this.fm=null;
this.Ny=null;
if(c) {
this.fm=c;
this.Ny=c
}else {
var f=["#109618","#DD5511","#8C6D8C","#7083A8","#6633CC","#CC3333","#22AA99","#888888","#B08B59","#994499"],g=["#4CB052","#E6804D","#A992A9","#94A2BE","#8C66D9","#D96666","#59BFB3","#AAAAAA","#C4A883","#B373B3"],h=zm;
this.fm=f[h];
this.Ny=
g[h];
zm=++h%f[E]
}this.aF=b;
this.j=a;
Am.push(this);
Bm.set(b.$E,this)
};
Cm.inherits(Xi);
var Am=[],Bm=new $g,Dm=true;
var Em=function (a) {
if(a!=Dm) {
var b=Am;
for(var c=0;c<b[E];c++)b[c].$R(a)
}Dm=a
},Fm=function () {
var a=Am;
for(var b=0;b<a[E];b++)a[b].redraw()
},zm=0;Cm[_P].DX="divOtherCursor";Cm[_P].Vs=null;Cm[_P].z_="#666666";Cm[_P].C=null;Cm[_P].U5="divOtherCursorLegend";Cm[_P].Xf=null;Cm[_P].b=function () {
this.A=this.F.b("div",{
"class":this.DX,style:"border-color: "+this.fm
})
};
Cm[_P].Db=function () {
Cm.B.Db.call(this);
this.$R(Dm);
this.yQ();
this.redraw()
};
Cm[_P].L0=function () {
var a=this.F.b("div",{
"class":this.U5,style:"border-color: "+this.fm
});
if(S) {
a[J].paddingBottom="1px";
cb(a[J],"#ffffff")
}return a
};
Cm[_P].f1=function () {
return this.C=this.C||this.j.pb(this.aF.Kj)
};
Cm[_P].redraw=function () {
if(this.rb) {
var a=false,b=this.f1();
if(b&&b==b.trixApp.activeGrid) {
	var c=this.Xf,d=this.Vs;
	if(!c||!d) {
		var e=this.aF,f=b.info;
		if(f&&f.idsTOrows&&f.idsTOcols) {
			c=this.Xf=f.idsTOrows[e.jB()];
			d=this.Vs=f.idsTOcols[e.iB()]
		}
	}if(c&&
	d) {
		var g=b.Ld(c,d);
		if(g) {
			var h=b.VK(c,g);
			if(h) {
				var i=this.A[J];
				for(var j in h)i[j]=h[j];this.F.appendChild(b.F0(g),this.A);a=true
			}
		}
	}
}this.D(a)
}
};Cm[_P].m2=function () {
this.C=null;
this.Xf=null;
this.Vs=null;
this.redraw()
};
Cm[_P].n2=function () {
this.Xf=null;
this.Vs=null;
this.redraw()
};
Cm[_P].l2=function () {
this.yQ()
};
Cm[_P].yQ=function () {
if(this.rb)cb(this.A[J],this.aF.Zz?this.z_:"")
};
Cm[_P].D=function (a) {
if(this.kb!=a&&this.rb)C(this.A[J],a?"":"none");
this.kb=a
};
Cm[_P].$R=function (a) {
if(this.rb)this.A[J].borderWidth=
a?"2px":"0px"
};
Cm[_P].dispose=function () {
if(!this.N()) {
Bm.remove(this.aF.$E);
Cm.B.dispose.call(this);
this.D(false);
this.C=null
}
};
var Gm=function (a) {
this.je=a;
this.l5=this.wN();
if(!this.l5) {
var b=S&&!dg("7"),c=b?"readystatechange":"load";
this.lw=Dh(this.je,c,this.dM,false,this);
this.iN=l.setInterval(R(this.yX,this),500)
}
};
te(Gm,Xh);
Gm[_P].lw=null;
Gm[_P].EO=function () {
if(this.iN) {
l.clearInterval(this.iN);
this.iN=null
}
};
Gm[_P].yX=function () {
if(this.wN())this.dM()
};
Gm[_P].getIframe=function () {
return this.je
};
Gm[_P].M=function () {
this.je=null;
this.EO();
Ih(this.lw);
Gm.B.M.call(this)
};
Gm[_P].wN=function () {
var a=false;
try{
a=S?this.je[Yc]==
"complete":!(!Hg(this.je)[Lc])
}catch(b) {
}return a
};
Gm[_P].dM=function () {
if(!S||this.je[Yc]=="complete") {
this.EO();
Ih(this.lw);
this.lw=null;
this.l5=true;
this.dispatchEvent("ifload")
}
};
var Hm;
(function () {
var a="ScriptEngine" in Td,b=false,c="0";
if(a) {
b=Td.ScriptEngine()=="JScript";
if(b)c=Td.ScriptEngineMajorVersion()+"."+Td.ScriptEngineMinorVersion()+"."+Td.ScriptEngineBuildVersion()
}Hm=b
})();
var Im=function () {
this.Ci=Hm?[]:"";
this.append.apply(this,arguments)
};
Im[_P].set=function (a) {
this.clear();
this.append(a)
};
if(Hm) {
Im[_P].Py=0;
Im[_P].append=function () {
if(arguments[E]==1)this.Ci[this.Py++]=arguments[0];
else {
	this.Ci[Yb].apply(this.Ci,arguments);
	this.Py=this.Ci[E]
}return this
}
}else Im[_P].append=function () {
for(var a=0;a<arguments[E];a++)this.Ci+=arguments[a];return this
};Db(Im[_P],function () {
if(Hm) {
Da(this.Ci,0);
this.Py=0
}else this.Ci=""
});
ya(Im[_P],function () {
if(Hm) {
var a=this.Ci.join("");
this.clear();
if(a)this.append(a);
return a
}else return this.Ci
});
var Jm=function (a,b) {
var c;
if(ainstanceofJm) {
this.Gl(b==null?a.Kg:b);
this.Bo(a.Ug);
this.Ex(a.Rl);
this.uo(a.ek);
this.xx(a.sj);
this.Wh(a.Yb);
this.Yh(a.Hc.clone());
this.Dr(a.qk)
}else if(a&&(c=ha(a).match(Km()))) {
this.Gl(!(!b));
this.Bo(c[1],true);
this.Ex(c[2],true);
this.uo(c[3],true);
this.xx(c[4]);
this.Wh(c[5],true);
this.Yh(c[6]);
this.Dr(c[7],true)
}else {
this.Gl(!(!b));
this.Hc=new Lm(null,this,this.Kg)
}
};
Jm[_P].Ug="";
Jm[_P].Rl="";
Jm[_P].ek="";
Jm[_P].sj=null;
Jm[_P].Yb="";
Jm[_P].Hc=null;
Jm[_P].qk="";
Jm[_P].zC=
false;
Jm[_P].Kg=false;
ya(Jm[_P],function () {
if(this.Gd)return this.Gd;
var a=[];
if(this.Ug)a.push(Mm(this.Ug,Nm),":");
if(this.ek) {
a.push("//");
if(this.Rl)a.push(Mm(this.Rl,Nm),"@");
a.push(Om(this.ek));
if(this.sj!=null)a.push(":",ha(this.sj))
}if(this.Yb)a.push(Mm(this.Yb,Pm));
var b=ha(this.Hc);
if(b)a.push("?",b);
if(this.qk)a.push("#",Mm(this.qk,Qm));
return this.Gd=a.join("")
});
Jm[_P].resolve=function (a) {
var b=this.clone(),c=a.W3();
if(c)b.Bo(a.Ug);
else c=a.b4();
if(c)b.Ex(a.Rl);
else c=a.O3();
if(c)b.uo(a.ek);
else c=a.U3();
var d=a.Yb;
if(c)b.xx(a.sj);
else {
c=a.T3();
if(c)if(!/^\//.test(d))d=b.Yb.replace(/\/?[^\/]*$/,"/"+d)
}if(c)b.Wh(d);
else c=a.V3();
if(c)b.Yh(a.AB());
else c=a.S3();
if(c)b.Dr(a.qk);
return b
};
Jm[_P].clone=function () {
return Tm(this.Ug,this.Rl,this.ek,this.sj,this.Yb,this.Hc.clone(),this.qk,this.Kg)
};
Jm[_P].Bo=function (a,b) {
this.zg();
delete this.Gd;
this.Ug=b?Um(a):a;
if(this.Ug)this.Ug=this.Ug.replace(/:$/,"");
return this
};
Jm[_P].W3=function () {
return !(!this.Ug)
};
Jm[_P].Ex=function (a,b) {
this.zg();
delete this.Gd;
this.Rl=b?Um(a):a;
return this
};
Jm[_P].b4=function () {
return !(!this.Rl)
};
Jm[_P].uo=function (a,b) {
this.zg();
delete this.Gd;
this.ek=b?Um(a):a;
return this
};
Jm[_P].O3=function () {
return !(!this.ek)
};
Jm[_P].xx=function (a) {
this.zg();
delete this.Gd;
if(a) {
a=ja(a);
if(qa(a)||a<0)throwError("Bad port number "+a);
this.sj=a
}else this.sj=null;
return this
};
Jm[_P].U3=function () {
return this.sj!=null
};
Jm[_P].Wh=function (a,b) {
this.zg();
delete this.Gd;
this.Yb=b?Um(a):a;
return this
};
Jm[_P].T3=function () {
return !(!this.Yb)
};
Jm[_P].V3=function () {
return this.Hc!==null&&this.Hc.toString ()!==""
};
Jm[_P].Yh=function (a) {
this.zg();
delete this.Gd;
if(ainstanceofLm) {
this.Hc=a;
this.Hc.ly=this;
this.Hc.Gl(this.Kg)
}else this.Hc=new Lm(a,this,this.Kg);
return this
};
Jm[_P].AB=function () {
return this.Hc.toString ()
};
Jm[_P].ua=function (a,b) {
this.zg();
delete this.Gd;
this.Hc.set(a,b);
return this
};
Jm[_P].Hl=function (a,b) {
this.zg();
delete this.Gd;
if(!ce(b))b=[ha(b)];
this.Hc.Sba(a,b);
return this
};
Jm[_P].Tp=function (a) {
return this.Hc.get(a)
};
Jm[_P].Dr=function (a,b) {
this.zg();
delete this.Gd;
this.qk=b?Um(a):a;
return this
};
Jm[_P].S3=function () {
return !(!this.qk)
};
Jm[_P].An=function () {
this.zg();
this.ua("zx",o.floor(o.random()*2147483648).toString (36)+(o.floor(o.random()*2147483648)^(new Date).getTime()).toString (36));
return this
};
Jm[_P].Xg=function (a) {
this.zC=a
};
Jm[_P].Da=function () {
return this.zC
};
Jm[_P].zg=function () {
if(this.zC)throwError("Tried to modify a read-only Uri");
};
Jm[_P].Gl=function (a) {
this.Kg=a;
if(this.Hc)this.Hc.Gl(a)
};
var Vm=
function (a,b) {
return ainstanceofJm?a.clone():new Jm(a,b)
},Tm=function (a,b,c,d,e,f,g,h) {
var i=new Jm(null,h);
i.Bo(a);
i.Ex(b);
i.uo(c);
i.xx(d);
i.Wh(e);
i.Yh(f);
i.Dr(g);
return i
},Um=function (a) {
return a?pa(a):""
},Om=function (a) {
if(ee(a))return fa(a);
return null
},Wm=/^[a-zA-Z0-9\-_.!~*'():\/;?]*$/,Mm=function(a,b) {var c=null;if(ee(a)) {c=a;if(!Wm.test(c))c=encodeURI(a);if(c.search(b)>=0)c=c.replace(b,Xm)}return c},Xm=function(a) {var b=a.charCodeAt(0);return"%"+(b>>4&15).toString(16)+(b&15).toString(16)},
Ym=null,Km=function () {
if(!Ym)Ym=/^(?:([^:\/?#]+):)?(?:\/\/(?:([^\/?#]*)@)?([^\/?#:@]*)(?::([0-9]+))?)?([^?#]+)?(?:\?([^#]*))?(?:#(.*))?$/;
return Ym
},Nm=/[#\/\?@]/g,Pm=/[\#\?]/g,Qm=/#/g,Lm=function (a,b,c) {
this.xc=new $g;
this.ly=b;
this.Kg=!(!c);
if(a) {
var d=a.split("&");
for(var e=0;e<d[E];e++) {
	var f=d[e].indexOf("="),g,h;
	if(f>=0) {
		g=d[e].substring(0,f);
		h=d[e].substring(f+1)
	}else g=d[e];
	g=Ge(g);
	g=this.cj(g);
	this.add(g,h?Ge(h):"")
}
}
};
Lm[_P].ub=0;
Lm[_P].Kc=function () {
return this.ub
};
Lm[_P].add=function (a,
b) {
this.jn();
a=this.cj(a);
if(!this.bd(a))this.xc.set(a,b);
else {
var c=this.xc.get(a);
if(ce(c))c.push(b);
else this.xc.set(a,[c,b])
}this.ub++;
return this
};
nb(Lm[_P],function (a) {
a=this.cj(a);
if(this.xc.bd(a)) {
this.jn();
var b=this.xc.get(a);
if(ce(b))this.ub-=b[E];
else this.ub--;
return this.xc.remove(a)
}return false
});
Db(Lm[_P],function () {
this.jn();
this.xc.clear();
this.ub=0
});
Lm[_P].jc=function () {
return this.ub==0
};
Lm[_P].bd=function (a) {
a=this.cj(a);
return this.xc.bd(a)
};
Lm[_P].im=function (a) {
var b=this.Fb();
return jf(b,a)
};
Lm[_P].vd=function () {
var a=this.xc.Fb(),b=this.xc.vd(),c=[];
for(var d=0;d<b[E];d++) {
var e=a[d];
if(ce(e))for(var f=0;f<e[E];f++)c.push(b[d]);else c.push(b[d])
}return c
};Lm[_P].Fb=function (a) {
var b;
if(a) {
var c=this.cj(a);
if(this.bd(c)) {
	var d=this.xc.get(c);
	if(ce(d))return d;
	else {
		b=[];
		b.push(d)
	}
}else b=[]
}else {
var e=this.xc.Fb();
b=[];
for(var f=0;f<e[E];f++) {
	var g=e[f];
	if(ce(g))sf(b,g);
	else b.push(g)
}
}return b
};
Lm[_P].set=function (a,b) {
this.jn();
a=this.cj(a);
if(this.bd(a)) {
var c=this.xc.get(a);
if(ce(c))this.ub-=c[E];
else this.ub--
}this.xc.set(a,b);
this.ub++;
return this
};
Lm[_P].get=function (a,b) {
a=this.cj(a);
if(this.bd(a)) {
var c=this.xc.get(a);
return ce(c)?c[0]:c
}else return b
};
Lm[_P].Sba=function (a,b) {
this.jn();
a=this.cj(a);
if(this.bd(a)) {
var c=this.xc.get(a);
if(ce(c))this.ub-=c[E];
else this.ub--
}if(b[E]>0) {
this.xc.set(a,b);
this.ub+=b[E]
}
};
ya(Lm[_P],function () {
if(this.Gd)return this.Gd;
var a=[],b=0,c=this.xc.vd();
for(var d=0;d<c[E];d++) {
var e=c[d],f=Fe(e),g=this.xc.get(e);
if(ce(g))for(var h=
0;h<g[E];h++) {
	if(b>0)a.push("&");
	a.push(f,"=",Fe(g[h]));
	b++
}else {
	if(b>0)a.push("&");
	a.push(f,"=",Fe(g));
	b++
}
}return this.Gd=a.join("")
});
Lm[_P].jn=function () {
delete this.Gd;
if(this.ly)delete this.ly.Gd
};
Lm[_P].clone=function () {
var a=new Lm;
a.xc=this.xc.clone();
return a
};
Lm[_P].cj=function (a) {
var b=ha(a);
if(this.Kg)b=b.toLowerCase();
return b
};
Lm[_P].Gl=function (a) {
var b=a&&!this.Kg;
if(b) {
this.jn();
Zg(this.xc,function (c,d) {
	var e=d.toLowerCase();
	if(d!=e) {
		this.remove(d);
		this.add(e,c)
	}
},this)
}this.Kg=
a
};
Lm[_P].extend=function () {
for(var a=0;a<arguments[E];a++) {
var b=arguments[a];
Zg(b,function (c,d) {
	this.add(d,c)
},this)
}
};
var Zm=function (a,b,c) {
if(!b)b={
};
var d=c||l,e=typeofa[od]!="undefined"?a[od]:ha(a),f=b[Sc]||a[Sc],g=[];
for(var h in b)switch(h) {
case "width":case "height":case "top":case "left":g.push(h+"="+b[h]);
break;
case "target":break;
default:g.push(h+"="+(b[h]?1:0))
}var i=g.join(","),j=d.open(e,f,i);
return j
};
var $m=function (a) {
af.call(this);
this.xI=a;
this.naa(a.flags)
};
$m.inherits(af);
var an=null,bn=function (a) {
return !a?an:(an=new $m(a))
};
$m[_P].Ia=function (a) {
return this.xI[a]
};
var cn=false,dn="",en=false,fn="",gn=false,hn=false,jn=false,kn=false,ln=false,mn=false,nn=false,on=false,pn=false,qn=1000,rn=0,sn=5000,tn=false,un="",vn="http://documents.google.com/support/spreadsheets/",wn=vn+"bin/answer.py?answer=";
$m[_P].naa=function (a) {
if(a) {
if(a.feg)cn=a.feg;
if(cn&&a.fegr)dn=a.fegr;
if(cn&&a.fegpd)fn=a.fegpd;
if(cn&&a.fegch)en=a.fegch;
if(a.feos)gn=a.feos;
if(a.fsrpfx)un=a.fsrpfx;
if(a.fohp)wn=a.fohp;
if(a.fem)nn=a.fem;
if(a.fecf)on=a.fecf;
if(a.fevf)hn=a.fevf;
if(a.fedem)jn=a.fedem;
if(a.fest)kn=a.fest;
if(a.fefr)ln=a.fefr;
if(a.feac)mn=a.feac;
if(a.fega)pn=a.fega;
if(a.fcpt!=null)qn=a.fcpt;
if(a.fcpemt!=null)rn=a.fcpemt;
if(a.fcpnct!=null)sn=a.fcpnct;
if(a.fcppue!=null)tn=a.fcppue
}
};
var xn=function () {
var a=Yf;
if(S&&cg(a,"5.0")<=0) {
ra("Oops, you must have IE version 6 or higher.");
return false
}if(Uf&&cg(a,"1.7.12")<
0) {
ra("Oops, you must have Firefox version 1.0.7 or higher.");
return false
}if(Wf&&!dg("420"))return la("We only support Safari 3.0+. Would you like to continue anyways?");
if(!S&&!Uf&&!Wf) {
la("Oops, we currently only support Firefox and IE.Would you like to continue anyways?");
return false
}return true
};
$m[_P].dispose=function () {
if(!this.N()) {
$m.B.dispose.call(this);
var a=this.xI.disposables;
if(a)while(a[E]) {
	var b=a.shift();
	if(b)b.dispose()
}this.xI=null
}
};
var W={
};
W.formStatus={
formDataIsPresent:false,formIsTurnedOn:false
};
W.Aw=null;
W.vQ=null;
re(W,"recipientsTable_",W.vQ);
W.UH="/gform";
W.pQ="/viewform";
W.c0=null;
W.vA=null;
W.getFormIndicator=function () {
var a=W.vA;
if(!a) {
a=new yn;
W.vA=a
}return a
};
W.formIndicatorIsRendered=function () {
return W.vA&&W.vA.rb
};
W.WINDOW_HANDLE="formWindow";
W.WINDOW_WIDTH=800;
W.WINDOW_HEIGHT=600;
W.WINDOW_RESIZABLE=true;
W.WINDOW_SCROLLBARS=true;
W.WINDOW_TOOLBAR=true;
W.setFormStatus=function (a,b) {
var c=W.formStatus;
c.formDataIsPresent=
a;
c.formIsTurnedOn=b
};
qe("trix.Forms.setFormStatus",W.setFormStatus);
W.addRecipients=function (a) {
var b=W.getRecipientsMap(),c=W.vQ;
for(var d=0;d<a[E];++d)if(!b.bd(a[d])) {
var e=vg("td",{
	"class":"shareData"
},a[d]);
xg(c.insertRow(c[pd][E]),e);
b.set(a[d],e)
}W.updateRecipientsCountElement()
};
qe("trix.Forms.addRecipients",W.addRecipients);
W.setRecipients=function (a) {
var b=W.getRecipientsMap();
for(var c=0;c<a[E];++c)b.set(a[c],null)
};qe("trix.Forms.setRecipients",W.setRecipients);W.setRecipientsTable=function (a) {
W.vQ=
a
};
W.getRecipients=function () {
return W.getRecipientsMap().vd()
};
W.getRecipientsMap=function () {
if(W.Aw)return W.Aw;
W.Aw=new $g;
return W.Aw
};
W.setRecipientsCountElement=function (a) {
W.Ofa=a
};
W.updateRecipientsCountElement=function () {
y(W.Ofa,W.Aw.Kc())
};
W.dasherizePaths=function (a) {
W.UH=a+W.UH;
W.pQ=a+W.pQ
};
qe("trix.Forms.dasherizePaths",W.dasherizePaths);
W.getPublishedFormBasePath=function () {
return W.pQ
};
W.b0=null;
W.aga=function (a) {
W.b0=a
};
qe("trix.Forms.setFormActionToken",W.aga);
W.formDataIsPresent=
function () {
return W.formStatus.formDataIsPresent
};
W.formIsTurnedOn=function () {
return W.formStatus.formIsTurnedOn
};
W.setFormOnOrOff=function (a,b,c,d,e) {
var f=W.formStatus;
f.formIsTurnedOn=e;
var g=W.getABlankFormUri(a);
g.ua("enable",ja(e));
mi(g,R(c,d),"POST","token="+escape(W.b0)+"&id="+escape(b))
};
W.getABlankFormUri=function (a,b) {
var c=W.hfa;
if(!c) {
c=new Jm(W.UH);
c.ua("key",a);
W.hfa=c
}if(Vd(b))c.ua("hl",b);
return c.clone()
};
W.openFormEditorWindow=function (a,b,c) {
var d=W.getABlankFormUri(a,b);
if(Vd(c)&&
c)d.Dr("invite");
var e=W.c0;
try{
if(e) {
	var f=new Jm(e[xc][od]);
	if(f.AB()==d.AB()&&f.Yb==d.Yb) {
		e.focus();
		return
	}
}
}catch(g) {
}e=Zm(d,{
target:W.WINDOW_HANDLE,toolbar:W.WINDOW_TOOLBAR,width:W.WINDOW_WIDTH,height:W.WINDOW_HEIGHT,resizable:W.WINDOW_RESIZABLE,scrollbars:W.WINDOW_SCROLLBARS
});
if(e==null)ra(_M[509]);
else {
e.focus();
W.c0=e
}return e
};
;
(function () {
var a=null;
if(S) {
function b(e) {
	try{
		new ActiveXObject(e);
		return true
	}catch(f) {
		return false
	}
}if(b("AcroPDF.PDF.1"))a="7";
else if(b("PDF.PdfCtrl.6"))a="6"
}else if(ca[sc]&&ca[sc][E]>0) {
var c=ca[sc]["application/pdf"];
if(c&&c[xd]) {
	var d=c[xd][Gd];
	if(d&&d.indexOf("Adobe")!=-1)a=d.indexOf("Version")!=-1?d.split("Version")[1]:"7"
}
}
})();
var zn;
(function () {
function a(h) {
var i=h.match(/[\d]+/g);
Da(i,3);
return i.join(".")
}var b=false,c="";
if(ca[bc]&&ca[bc][E]) {
var d=ca[bc]["Shockwave Flash"];
if(d) {
	b=true;
	if(d[Gd])c=a(d[Gd])
}if(ca[bc]["Shockwave Flash 2.0"]) {
	b=true;
	c="2.0.0.11"
}
}else if(ca[sc]&&ca[sc][E]) {
var e=ca[sc]["application/x-shockwave-flash"];
b=e&&e[xd];
if(b)c=a(e[xd][Gd])
}else try{
var f=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.7");
b=true;
c=a(f.GetVariable("$version"))
}catch(g) {
try{
	var f=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.6");
	b=true;
	c="6.0.21"
}catch(g) {
	try{
		var f=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");
		b=true;
		c=a(f.GetVariable("$version"))
	}catch(g) {
	}
}
}zn=c
})();
(function () {
var a="";
function b(e) {
var f=e.match(/\d/g);
return f.join(".")
}if(Wf&&ca[sc]&&ca[sc][E]>0) {
var c=ca[sc]["application/photo"];
if(c) {
	var d=c.description;
	if(d)a=b(d)
}
}
})();
var An="hasPicasa";
(function () {
var a=false;
if(S) {
Td[An]=a;
oa.write('<!--[if gte Picasa 2]><script type="text/javascript">this.'+An+"=true;<\/script><![endif]--\>");
a=Td[An];
Td[An]=undefined
}else if(ca[sc]&&ca[sc]["application/x-picasa-detect"])a=true
})();
var Bn=function (a,b,c,d) {
this.Ac=a;
this.kH=b;
this.qW=c;
this.Ma=0;
this.Bg=null;
this.oO=false;
this.X_=false;
this.hg=[];
this.wQ=null;
this.hU=null;
this.H6=d||{
BAD_VERSION_HTML:"Oops!<br><br>The Google Talk Gadget requires Adobe Flash Player version %s or higher.<br>You can install the player <a href='http://www.google.com/url?sa=D&q=http://www.macromedia.com/go/getflashplayer' target='_blank'>here</a>.<br><br>To complete the installation, quit all running instances of your browser.",IE_BAD_VERSION_HTML:"Oops!</span><br><br>The Google Talk Gadget requires Adobe Flash Player version %s or higher.<br>You can install the player <a href='http://www.google.com/url?sa=D&q=http://www.macromedia.com/go/getflashplayer' target='_blank'>here</a>.<br><br>Once you have completed the installation, refresh this page."
};
this.Ifa=$f?"windows":(Zf?"macintosh":(ag?"linux":""))
},Cn,Dn=function () {
if(typeofCn=="undefined")Cn=ca[vc].toLowerCase().indexOf("firefox/1.0")>=0;
return Cn
};
Bn[_P].uV=function () {
return this.kH+this.qW
};
Bn[_P].IV=function (a,b,c,d,e,f,g,h,i,j) {
var k=!(!a);
this.Cfa=!k;
this.kb=k;
this.mb=d;
this.Tb=e;
if(k) {
this.Ob=oa.getElementById(a);
Bi(this.Ob,"z-index","2")
}else if(typeofthis.Ob=="undefined") {
var m=1,n=1;
if(ag&&Dn()) {
	m=d;
	n=o.max(e,0.75*d+150)
}this.Ob=oa.createElement("DIV");
if(i) {
	Bi(this.Ob,"position",
	"absolute");
	Bi(this.Ob,"top",g+"px")
}else {
	Bi(this.Ob,"position","absolute");
	Bi(this.Ob,"top",g+"px")
}Bi(this.Ob,"left",f+"px");
Bi(this.Ob,"width",m+"px");
Bi(this.Ob,"height",n+"px");
Bi(this.Ob,"overflow","hidden")
}fi(R(this.i_,this,k,b,c,h,j),0);
fi(function () {
},0)
};
Bn[_P].i_=function (a,b,c,d,e) {
var f=ag?"9":"8",g,h="<p style='font-family:Arial; color:#666666; font-size:.8em; margin:0; padding:0'>"+ye(S?this.H6.IE_BAD_VERSION_HTML:this.H6.BAD_VERSION_HTML,f)+"</p>";
if(Ye(zn,f)>=0) {
g=this.vV(b,c,"100%",
"100%",d,false,e);
y(this.Ob,g)
}else {
y(this.Ob,h);
this.Po(4)
}if(!a)oa[Lc].appendChild(this.Ob);
this.W0();
if(!S)if(this.Bg==null||this.Bg.src!=c) {
y(this.Ob,h);
this.Po(4)
}
};
Bn[_P].W0=function () {
if(!this.Bg)this.Bg=oa.getElementById("flash_"+this.Ac);
return this.Bg
};
Bn[_P].vV=function (a,b,c,d,e,f,g) {
var h=this,i=function (s) {
h.DG(s)
},j=function (s,u) {
h.xV(s,u)
};
l["Recv_"+this.Ac]=i;
l[this.Ac+"_DoFSCommand"]=j;
if(S) {
var k=oa.createElement("SCRIPT");
k.event="FSCommand(command,args)";
k.htmlFor="flash_"+this.Ac;
Ja(k,this.Ac+"_DoFSCommand(command, args)");
oa[Lc].appendChild(k)
}var m=S?"%s<object classid='clsid:d27cdb6e-ae6d-11cf-96b8-444553540000' codebase='https://fpdownload.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=8,0,0,0' id='%s' name='%s' width='%s' height='%s' style='%s'><param name='scale' value='noScale'/><param name='movie' value='%s'/><param name='quality' value='high'/><param name='bgcolor' value='#ffffff'/><param name='FlashVars' value='%s'/><param name='AllowScriptAccess' value='always'/><param name='allowFullScreen' value='true'/><param name='SeamlessTabbing' value='false'/>%s</object>":
"%s<embed quality='high' id='%s' name='%s' style='width: %s; height: %s; %s' src='%s' FlashVars='%s' AllowScriptAccess='always' allowFullScreen='true' SeamlessTabbing='false' type='application/x-shockwave-flash' pluginspage='http://www.macromedia.com/go/getflashplayer' %s></embed>",n=ye("dbg=%s&ap=%s&nm=%s&cb=%s&os=%s&%s",fa(g?"true":"false"),fa(this.kH),fa(this.qW),fa("Recv_"+this.Ac),fa(this.Ifa),e+"&"),q="",p;
p=S?(f?"<param name='wmode' value='transparent'/>":"<param name='wmode' value='window'/>"):
(f?"wmode='transparent'":"wmode='window'");
return ye(m,a,"flash_"+this.Ac,this.Ac,c,d,q,b,n,p)
};
Bn[_P].DV=function () {
this.Ob[O].removeChild(this.Ob);
this.Ob=null;
this.Bg=null
};
Bn[_P].tV=function () {
if(this.Cfa&&!this.X_) {
this.X_=true;
Bi(this.Ob,"left","-10000px");
Bi(this.Ob,"top","0px");
Bi(this.Ob,"width",this.mb+"px");
Bi(this.Ob,"height",this.Tb+"px")
}
};
Bn[_P].HV=function (a) {
if(Vd(this.hg))this.hg.push(function (b) {
b.HV(a)
});
else {
this.kb=a;
if(!a) {
	this.yG(-10000,0);
	Bi(this.Ob,"width",this.mb+"px");
	Bi(this.Ob,"height",this.Tb+"px")
}
}
};
Bn[_P].xG=function () {
if(S)if(Vd(this.hg))this.hg.push(function (a) {
a.xG()
});
else {
this.Bg.focus();
fi(function () {
	this.Bg.focus()
},0,this)
}
};
Bn[_P].yG=function (a,b) {
if(Vd(this.hg))this.hg.push(function (c) {
c.yG(a,b)
});
else {
if(typeofa!="undefined")Bi(this.Ob,"left",a+"px");
if(typeofb!="undefined")Bi(this.Ob,"top",b+"px")
}
};
Bn[_P].HG=function (a,b,c) {
if(Vd(this.hg))this.hg.push(function (d) {
d.HG(a,b,c)
});
else this.IG(a,b,c)
};
Bn[_P].IG=function (a,b,c) {
this.Bg.SetVariable("msg",
ki([a,b,c]))
};
Bn[_P].xV=function (a,b) {
if(a=="msg"||a=="FSCommand:msg")this.DG(b)
};
Bn[_P].FV=function (a) {
this.wQ=a
};
Bn[_P].DG=function (a) {
var b=Ik(pa(a)),c=b[0],d=b[1],e=b[2];
if(d==this.kH+".")if(e[0]=="f") {
this.xG();
return
}else if(e[0]=="b") {
this.Bg.blur();
return
}else if(e[0]=="loaded") {
this.zG();
return
}else if(e[0]=="pong") {
this.Po(2);
this.tV();
this.zV();
return
}if(this.wQ)this.wQ(c,d,e)
};
Bn[_P].GV=function (a) {
this.hU=a
};
Bn[_P].Po=function (a) {
this.Ma=a;
if(this.hU)this.hU(this)
};
Bn[_P].zG=function () {
if(this.wV())this.yV();
else fi(this.zG,2000,this)
};
Bn[_P].wV=function () {
if(this.oO)return true;
var a=this.Bg;
if(!a)return false;
this.oO=typeofa[Yc]!="undefined"&&a[Yc]==4||typeofa.PercentLoaded!="undefined"&&a.PercentLoaded()==100;
return this.oO
};
Bn[_P].yV=function () {
if(this.Ma==2)this.Po(3);
else {
this.Po(1);
var a=this.uV();
this.IG(a,a,["ping"])
}
};
Bn[_P].zV=function () {
if(Vd(this.hg)) {
var a=this.hg;
delete this.hg;
for(var b=0;b<a[E];++b)a[b](this)
}
};var En=function (a,b,c,d,e) {
var f=this;
f.jh=new Jm(a+"client");
f.gG=new Jm(a+"transport?v=1");
f.gG.ua("silent","true");
var g=new Jm(a+"transport2?v=1");
f.gG.ua("host",g.toString ());
f.Dq=new Date-0;
var h="lcid="+fa(f.Dq);
for(var i in c)h+="&"+i+"="+fa(c[i]);f.jh.ua("sessionParams",h);f.jh.ua("sessionType","jsapi");f.jh.ua("host",l[xc]);var j=b.split("&");f.jh.ua("session",j[0]);for(var k=1;k<j[E];++k) {
var m=j[k].split("=");
f.jh.ua(pa(m[0]),pa(m[1]));
if(m[0]=="u")f.gG.ua("u",pa(m[1]))
}if(f.jh.Yb.substring(0,
3)=="/a/")f.jh.ua("nav","true");
if(e)f.jh.ua("css",e);
f.Bfa=0;
f.P5=-1;
f.yc=-1;
f.xd=d;
f.og={
};
f.zI=null;
f.rI=null;
var n=this.gG.toString ();
this.ls=new Bn("api_"+this.Dq,this.Dq,"t");
this.ls.FV(R(this.V7,this));
this.ls.GV(R(this.g8,this));
this.ls.IV(null,"",n,1,1,0,0,"ap="+this.Dq,false,false)
};
En[_P].T4=function (a) {
this.rI=a;
this.zO()
};
En[_P].sendMessage=function (a,b) {
var c=this.Bfa++;
this.gW(c,b);
this.ls.HG(this.Dq+"s",this.Dq+"s",["mx",a,"s",c])
};
En[_P].gW=function (a,b) {
var c=new Date;
for(var d in this.og)if(c-
this.og[d].when>=600)delete this.og[d];if(b) {
var e={
};
e.when=c;
e.callback=b;
this.og[a]=e
}
};
En[_P].E9=function (a) {
var b=this.og[a];
delete this.og[a];
return b
};
En[_P].g8=function () {
var a=this.ls.Ma;
if(a==4)this.ih(2,3)
};
En[_P].V7=function (a,b,c) {
if(c[0]!="connect-dest"&&c[0]!="connect-ack")this.X2(c)
};
En[_P].X2=function (a) {
switch(a[0]) {
case "cookie-hash":this.zI=a[1];
this.zO();
break;
case "connect-state":switch(a[1]) {
	case "searching":this.ih(0);
	break;
	case "connecting":this.ih(0);
	break;
	case "open":this.ih(0);
	break;
	case "close":this.ih(0);
	break
}break;
case "session-state":switch(a[1]) {
	case "open":this.ih(0);
	break;
	case "close":this.ih(2,2);
	break
}break;
case "js":this.ih(1);
break;
case "je":this.ih(2,1);
break;
case "rp":this.W7(a[1],a[2]=="a");
break;
case "mx":this.D7(a[1],a[2],a[3],a[4]);
break;
case "m":this.i7(a[1]);
break;
case "rc":this.X7(a[1]);
break;
default:break
}
};
En[_P].ih=function (a,b) {
this.yc=b||-1;
if(this.xd&&this.P5!=a) {
this.P5=a;
if(this.xd.onStateChange)this.xd.onStateChange(a);
else this.xd.e8(a)
}
};
En[_P].zO=function () {
if(!this.Ss&&this.zI!=null&&this.rI!=null) {
this.jh.ua("hash",this.zI);
this.Ss=oa.createElement("IFRAME");
D(this.Ss[J],"100%");
x(this.Ss[J],"100%");
this.Ss.src=this.jh.toString ();
this.rI.appendChild(this.Ss)
}
};
En[_P].W7=function (a,b) {
if(this.xd)if(b)if(this.xd.onJoin)this.xd.onJoin(a);
else this.xd.z7(a);
else if(this.xd.onLeave)this.xd.onLeave(a);
else this.xd.B7(a)
};
En[_P].D7=function (a,b,c,d) {
if(c=="r")if(this.xd.onMessageReceived)this.xd.onMessageReceived(a,b);
else if(c=="e") {
var e=
this.E9(d);
if(e)e.callback.onError()
}
};
En[_P].i7=function (a) {
if(this.xd.tP)this.xd.tP(a)
};
En[_P].X7=function (a) {
if(this.xd.HP)this.xd.HP(a)
};
var Fn=function () {
},Gn=null;
Fn[_P].Z3=function (a) {
return a&&a.tabIndex>=1
};
Fn[_P].eA=function (a,b) {
if(a)a.tabIndex=b?o.max(a.tabIndex,1):-1
};
Fn[_P].TA=function () {
return undefined
};
Fn[_P].b=function (a) {
var b=this.au(a);
return a.F.b("div",b?{
"class":b.join(" ")
}:null,a.$())
};
Fn[_P].Ja=function (a) {
return a
};
Fn[_P].bA=function (a,b,c) {
var d=a.Qa();
if(d)lj(d,b,c)
};
Fn[_P].$b=function () {
return true
};
Fn[_P].decorate=function (a,b) {
if(b.id)a.Fr(b.id);
var c=this.Ja(b);
if(c&&c[M])a.Bl(c[M][Dd]?rf(c[rd]):c[M]);
else a.Bl(null);
a.eT(this.Y1(gj(b)));
hj(b,this.Pb());
var d=a.Ag;
if(d)ef(d,function (e) {
this.bA(a,e,true)
},this);
return b
};
Fn[_P].G4=function (a) {
var b=a.Qa();
Vi(b,true,Uf);
lj(b,this.Pb()+"-rtl",a.Nk());
var c=this.TA();
if(c)dj(b,c)
};
Fn[_P].pe=function (a,b,c) {
var d=a.Qa();
if(d) {
var e=this.aB(b);
if(e)lj(d,e,c);
this.Tda(a,b,c)
}
};
Fn[_P].Tda=function (a,b,c) {
var d;
switch(b) {
case 1:d="disabled";
break;
case 4:d="pressed";
break;
case 8:d="selected";
break;
case 16:d="checked";
break;
case 64:d="expanded";
break;
case 2:case 32:default:break
}if(d) {
var e=
a.Qa();
if(e)ej(e,d,c)
}
};
Fn[_P].lc=function (a,b) {
var c=this.Ja(a);
if(c)if(ee(b))Ig(c,b);
else {
yg(c);
if(b) {
	function d(e) {
		if(e) {
			var f=hg(c);
			c.appendChild(ee(e)?f.createTextNode(e):e)
		}
	}if(ce(b))ef(b,d);
	else d(b)
}
}
};
Fn[_P].bj=function (a) {
return a.Qa()
};
Fn[_P].Pb=function () {
return "goog-control"
};
Fn[_P].au=function (a) {
var b=this.x0(a.Ma),c=a.Ag;
return c?b.concat(c):b
};
Fn[_P].x0=function (a) {
var b=[this.Pb()];
if(a)for(var c=1;a;c<<=1)if(a&c) {
b.push(this.aB(c));
a&=~c
}return b
};
Fn[_P].aB=function (a) {
if(a) {
var b=
this.Pb();
switch(a) {
	case 1:return b+"-disabled";
	case 2:return b+"-hover";
	case 4:return b+"-active";
	case 8:return b+"-selected";
	case 16:return b+"-checked";
	case 32:return b+"-focused";
	case 64:return b+"-open"
}
}return null
};
Fn[_P].Y1=function (a) {
var b=0;
if(a)ef(a,function (c) {
b|=this.X1(c)
},this);
return b
};
Fn[_P].X1=function (a) {
if(a) {
var b=cf(a.split("-"));
switch(b) {
	case "disabled":return 1;
	case "hover":return 2;
	case "active":return 4;
	case "selected":return 8;
	case "checked":return 16;
	case "focused":return 32;
	case "open":return 64
}
}return 0
};
var Hn=function () {
Fn.call(this)
};
te(Hn,Fn);
var In=null;
Hn[_P].TA=function () {
return "button"
};
Hn[_P].b=function (a) {
var b={
},c=this.au(a);
if(c)b["class"]=c.join(" ");
if(!a.wc())b.disabled=true;
if(a.Um())b.title=a.Um();
if(a.bq())b.value=a.bq();
return a.F.b("button",b,a.XA()||"")
};
Hn[_P].$b=function (a) {
return a[td]=="BUTTON"||a[td]=="INPUT"&&(a[N]=="button"||a[N]=="submit"||a[N]=="reset")
};
Hn[_P].decorate=function (a,b) {
b=Hn.B.decorate.call(this,a,b);
a.Oba(this.Um(b));
a.Rba(this.bq(b));
if(b.disabled) {
a.eT(a.Ma|
1);
hj(b,this.aB(1))
}return b
};
Hn[_P].pe=function (a,b,c) {
Hn.B.pe.call(this,a,b,c);
if(b==1) {
var d=a.Qa();
if(d&&(d[td]=="BUTTON"||d[td]=="INPUT"))Xa(d,c)
}
};
Hn[_P].bq=function (a) {
return a&&a[I]
};
Hn[_P].ei=function (a,b) {
if(a&&(a[td]=="BUTTON"||a[td]=="INPUT"))Ta(a,b)
};
Hn[_P].Um=function (a) {
return a&&a[ac]
};
Hn[_P].pF=function (a,b) {
if(a)Ea(a,b)
};
Hn[_P].bF=function (a,b) {
var c=a.Nk(),d=this.Pb()+(c?"-collapse-right":"-collapse-left"),e=this.Pb()+(c?"-collapse-left":"-collapse-right");
a.LJ(d,b&1);
a.LJ(e,b&
2)
};
Hn[_P].Pb=function () {
return "goog-button"
};
var Jn=function (a) {
Xh.call(this);
if(a)this.attach(a)
};
te(Jn,Xh);
Jn[_P].A=null;
Jn[_P].yv=null;
Jn[_P].FC=null;
Jn[_P].zv=null;
Jn[_P].Dv=-1;
Jn[_P].Aq=-1;
Jn[_P].cO=0;
var Kn={
"3":13,"12":144,"63232":38,"63233":40,"63234":37,"63235":39,"63236":112,"63237":113,"63238":114,"63239":115,"63240":116,"63241":117,"63242":118,"63243":119,"63244":120,"63245":121,"63246":122,"63247":123,"63248":44,"63272":46,"63273":36,"63275":35,"63276":33,"63277":34,"63289":144,"63302":45
},Ln={
Up:38,Down:40,Left:37,Right:39,Enter:13,
F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,"U+007F":46,Home:36,End:35,PageUp:33,PageDown:34,Insert:45
},Mn={
61:187
},Nn=S||Wf&&dg("525");
Jn[_P].U2=function (a) {
if(Nn&&!oj(a[ed]))this.Nd(a);
else this.Aq=Uf&&a[ed] in Mn?Mn[a[ed]]:a[ed]
};
Jn[_P].W2=function () {
this.Dv=-1
};
Jn[_P].Nd=function (a) {
var b=a.Vd,c,d;
if(S&&a[N]==kh) {
c=this.Aq;
d=c!=13&&c!=27?b[ed]:0
}else if(Wf&&a[N]==kh) {
c=this.Aq;
d=b[$c]>=0&&b[$c]<63232&&pj(c)?b[$c]:0
}else if(Tf) {
c=this.Aq;
d=pj(c)?b[ed]:
0
}else {
c=b[ed]||this.Aq;
d=b[$c]||0
}var e=c,f=b.keyIdentifier;
if(c) {
if(c>=63232&&c in Kn)e=Kn[c];
else if(c==25&&a[sd])e=9
}else if(f&&f in Ln)e=Ln[f];
var g=e==this.Dv;
this.Dv=e;
if(Wf) {
if(g&&b.timeStamp-this.cO<50)return ;
this.cO=b.timeStamp
}var h=new On(e,d,g,b);
try{
this.dispatchEvent(h)
}finally{
h.dispose()
}
};
Jn[_P].attach=function (a) {
if(this.zv)this.detach();
this.A=a;
this.yv=Dh(this.A,kh,this);
this.FC=Dh(this.A,Qh,this.U2,false,this);
this.zv=Dh(this.A,"keyup",this.W2,false,this)
};
Jn[_P].detach=function () {
if(this.yv) {
Ih(this.yv);
Ih(this.FC);
Ih(this.zv);
this.yv=null;
this.FC=null;
this.zv=null
}this.A=null;
this.Dv=-1
};
Jn[_P].M=function () {
Jn.B.M.call(this);
this.detach()
};
var On=function (a,b,c,d) {
gh.call(this,d);
Bb(this,"key");
rb(this,a);
this.charCode=b;
this.repeat=c
};
te(On,gh);
var Pn=function (a,b,c) {
Xi.call(this,c);
this.Q=b||Gn||(Gn=new Fn);
this.Bl(a)
};
te(Pn,Xi);
var Qn={
},Rn=function (a,b) {
Qn[a]=b
};
Pn[_P].Q=null;
Pn[_P].R=null;
Pn[_P].Ma=0;
Pn[_P].Vr=39;
Pn[_P].$W=255;
Pn[_P].Yca=0;
Pn[_P].kb=true;
Pn[_P].G=null;
Pn[_P].sf=null;
Pn[_P].Ag=null;
Pn[_P].Y2=true;
Pn[_P].Sp=function () {
return this.G||(this.G=new mj(this))
};
Pn[_P].bj=function () {
return this.Q.bj(this)
};
Pn[_P].n1=function () {
return this.sf||(this.sf=new Jn)
};
Pn[_P].VV=function (a) {
if(a) {
if(this.Ag)this.Ag.push(a);
else this.Ag=
[a];
this.Q.bA(this,a,true)
}
};
Pn[_P].H9=function (a) {
if(a&&this.Ag) {
qf(this.Ag,a);
if(this.Ag[E]==0)this.Ag=null;
this.Q.bA(this,a,false)
}
};
Pn[_P].LJ=function (a,b) {
if(b)this.VV(a);
else this.H9(a)
};
Pn[_P].b=function () {
this.lx(this.Q.b(this))
};
Pn[_P].Ja=function () {
return this.Q.Ja(this.Qa())
};
Pn[_P].$b=function (a) {
return this.Q.$b(a)
};
Pn[_P].tm=function (a) {
this.lx(this.Q.decorate(this,a));
if(a[J][Cd]=="none")this.kb=false
};
Pn[_P].Db=function () {
Pn.B.Db.call(this);
var a=this.Qa();
this.Q.G4(this);
this.D(this.kb,
true);
if(this.Vr&-2) {
var b;
if(this.Y2) {
	b=this.Sp();
	b.listen(a,ih,this.Mu);
	b.listen(a,Nh,this.Ku);
	b.listen(a,Oh,this.a3);
	b.listen(a,jh,this.Lu)
}if(this.Pk(32)) {
	b=this.Sp();
	var c=this.bj();
	b.listen(c,"focus",this.K2);
	b.listen(c,"blur",this.k2);
	var d=this.n1();
	d.attach(c);
	b.listen(d,"key",this.Of)
}
}
};
Pn[_P].rc=function () {
Pn.B.rc.call(this);
if(this.G)this.G.cc();
if(this.sf)this.sf.detach()
};
Pn[_P].M=function () {
Pn.B.M.call(this);
if(this.G) {
this.G.dispose();
this.G=null
}if(this.sf) {
this.sf.dispose();
this.sf=
null
}this.Q=null;
this.R=null;
this.Ag=null
};
Pn[_P].$=function () {
return this.R
};
Pn[_P].lc=function (a) {
this.Q.lc(this.Qa(),a);
this.Bl(a)
};
Pn[_P].Bl=function (a) {
this.R=a
};
Pn[_P].XA=function () {
if(!this.R||ee(this.R))return this.R;
var a=ce(this.R)?ff(this.R,Qg).join(""):Qg(this.R);
return a&&Be(a)
};
Pn[_P].Ka=function () {
return this.kb
};
Pn[_P].D=function (a,b) {
if(b||this.kb!=a&&this.dispatchEvent(a?"show":"hide")) {
this.kb=a;
var c=this.Qa();
if(c) {
	V(c,a);
	if(a&&this.wc()&&this.Pk(32))this.Q.eA(this.bj(),true);
	else {
		this.Cr(false);
		this.Q.eA(this.bj(),false)
	}
}return true
}return false
};
Pn[_P].wc=function () {
return !this.gj(1)
};
Pn[_P].s5=function () {
var a=this.gb;
return a&&typeofa.wc=="function"&&!a.wc()
};
Pn[_P].Ad=function (a) {
if(!this.s5()&&this.Qk(1,!a)) {
if(this.Pk(32)) {
	if(!a)this.Cr(false);
	var b=a&&this.kb;
	this.Q.eA(this.bj(),b);
	if(!b)this.Cr(false)
}if(!a) {
	this.setActive(false);
	this.Er(false)
}this.pe(1,!a)
}
};
Pn[_P].Er=function (a) {
if(this.Qk(2,a))this.pe(2,a)
};
Pn[_P].Na=function () {
return this.gj(4)
};
Pn[_P].setActive=
function (a) {
if(this.Qk(4,a))this.pe(4,a)
};
Pn[_P].Ok=function () {
return this.gj(8)
};
Pn[_P].lF=function (a) {
if(this.Qk(8,a))this.pe(8,a)
};
Pn[_P].c5=function () {
return this.gj(16)
};
Pn[_P].uaa=function (a) {
if(this.Qk(16,a))this.pe(16,a)
};
Pn[_P].Cr=function (a) {
if(this.Qk(32,a))this.pe(32,a)
};
Pn[_P].isOpen=function () {
return this.gj(64)
};
Pn[_P].nba=function (a) {
if(this.Qk(64,a))this.pe(64,a)
};
Pn[_P].gj=function (a) {
return !(!(this.Ma&a))
};
Pn[_P].pe=function (a,b) {
if(this.Pk(a)&&b!=this.gj(a)) {
this.Q.pe(this,a,b);
this.Ma=b?this.Ma|a:this.Ma&~a
}
};
Pn[_P].eT=function (a) {
this.Ma=a
};
Pn[_P].Pk=function (a) {
return !(!(this.Vr&a))
};
Pn[_P].fT=function (a,b) {
if(b!=this.Pk(a)) {
if(this.rb)throwError($i);
if(!b&&this.gj(a))this.pe(a,false);
this.Vr=b?this.Vr|a:this.Vr&~a
}
};
Pn[_P].Ne=function (a) {
return !(!(this.$W&a))&&this.Pk(a)
};
Pn[_P].Qk=function (a,b) {
return this.Pk(a)&&this.gj(a)!=b&&(!(this.Yca&a)||this.dispatchEvent(bj(a,b)))
};
Pn[_P].Mu=function (a) {
if(a[ec]&&!Gg(this.Qa(),a[ec])&&this.dispatchEvent("enter")&&this.wc()&&
this.Ne(2))this.Er(true)
};
Pn[_P].Lu=function (a) {
if(a[ec]&&!Gg(this.Qa(),a[ec])&&this.dispatchEvent("leave")) {
if(this.Ne(4))this.setActive(false);
if(this.Ne(2))this.Er(false)
}
};
Pn[_P].Ku=function (a) {
if(this.wc()) {
if(this.Ne(2))this.Er(true);
if(this.Ne(4)&&a.kN(0))this.setActive(true)
}var b=this.bj();
if(this.Q.Z3(b)) {
if(!Uf)b.focus()
}else a.preventDefault()
};
Pn[_P].a3=function (a) {
if(this.wc()&&this.Ne(2))this.Er(true);
if(this.Na()&&this.On(a)&&this.Ne(4))this.setActive(false)
};
Pn[_P].On=function () {
if(this.Ne(16))this.uaa(!this.c5());
if(this.Ne(8))this.lF(true);
if(this.Ne(64))this.nba(!this.isOpen());
return this.dispatchEvent(Zi)
};
Pn[_P].K2=function () {
if(this.Ne(32))this.Cr(true)
};
Pn[_P].k2=function () {
if(this.Ne(4))this.setActive(false);
if(this.Ne(32))this.Cr(false)
};
Pn[_P].Of=function (a) {
return this.kb&&this.wc()&&a[ed]==13&&this.On(a)
};
Rn("goog-control",function () {
return new Pn(null)
});
var Sn=function (a,b,c) {
Pn.call(this,a,b||In||(In=new Hn),c)
};
te(Sn,Pn);
Sn[_P].vy=null;
Sn[_P].Df=null;
Sn[_P].bq=function () {
return this.vy
};
Sn[_P].ei=function (a) {
this.vy=a;
this.Q.ei(this.Qa(),a)
};
Sn[_P].Rba=function (a) {
this.vy=a
};
Sn[_P].Um=function () {
return this.Df
};
Sn[_P].pF=function (a) {
this.Df=a;
this.Q.pF(this.Qa(),a)
};
Sn[_P].Oba=function (a) {
this.Df=a
};
Sn[_P].bF=function (a) {
this.Q.bF(this,a)
};
Sn[_P].M=function () {
Sn.B.M.call(this);
this.vy=null;
this.Df=null
};
Rn("goog-button",function () {
return new Sn(null)
});
Sn[_P].Of=function (a) {
return this.wc()&&(a[ed]==13||a[ed]==32)&&this.On(a)
};
var Tn=function () {
Hn.call(this)
};
te(Tn,Hn);
var Un=null,Vn=function () {
return Un||(Un=new Tn)
},Wn="goog-custom-button";
Tn[_P].b=function (a) {
var b=this.au(a),c={
"class":"goog-inline-block "+b.join(" "),title:a.Um()||""
};
return a.F.b("div",c,this.II(a.$(),a.F))
};
Tn[_P].Ja=function (a) {
return a&&a[M]&&a[M][M]
};
Tn[_P].II=function (a,b) {
var c="goog-inline-block "+this.Pb();
return b.b("div",{
"class":c+"-outer-box"
},b.b("div",{
"class":c+"-inner-box"
},a))
};
Tn[_P].$b=function (a) {
return a[td]=="DIV"
};
Tn[_P].M3=
function (a,b) {
var c=a.F.qB(b);
if(c&&c[dc].indexOf(this.Pb()+"-outer-box")!=-1) {
var d=a.F.qB(c);
if(d&&d[dc].indexOf(this.Pb()+"-inner-box")!=-1)return true
}return false
};
Tn[_P].decorate=function (a,b) {
Xn(b,true);
Xn(b,false);
if(!this.M3(a,b))b.appendChild(this.II(b[rd],a.F));
hj(b,"goog-inline-block",this.Pb());
return Tn.B.decorate.call(this,a,b)
};
Tn[_P].Pb=function () {
return Wn
};
var Xn=function (a,b) {
if(a) {
var c=b?a[M]:a[Vc],d;
while(c&&c[O]==a) {
	d=b?c[Dd]:c[Xb];
	if(c[lc]==3) {
		var e=c[Jd];
		if(Be(e)=="")a.removeChild(c);
		else {
			Ob(c,b?Ce(e):De(e));
			break
		}
	}else break;
	c=d
}
}
};
var Yn=function (a,b,c) {
Sn.call(this,a,b||Vn(),c)
};
te(Yn,Sn);
Rn(Wn,function () {
return new Yn(null)
});
var Zn={
},$n="/ui/",ao=function (a) {
$n=a
};
Td.HtmlUtil_setServerBase=ao;
var bo,co,eo,fo=function (a,b) {
var c=307,d;
if(a) {
d=Ii(a);
var e=Li(a);
d.y+=e[P]
}else d=new Of(0,0);
var f=e[F]>c?e[F]:c,g=554,h=313,i=600;
if(b) {
d.x+=b[Tc]-b[Nd];
d.y+=b[Uc]-b[Od]
}if(d.x+h>ta[F])d.x=ta[F]-h;
if(d.y+i>ta[P])d.y=ta[P]-i;
var j=new Qf(d.x,d.y,f,g);
return j
},ho=function (a,b) {
var c=new Jm($n.replace(/ui\/?$/,""));
go(c,a,b)
},go=function (a,b,c,d) {
var e;
if(b) {
b=kg(b);
var e=b.getAttribute("id")
}else e=null;
var f;
f=!Wf&&b?ug(hg(b))||l:l;
var g=fo(b,c),h="toolbar=no,location=no,menubar=no,scrollbars=no,resizable=yes,status=no,width="+
g[F]+",height="+g[P]+",top="+g.top+",left="+g[Mc],i=io(a,e,d);
if(!bo||bo[yc])bo=f.open(i.toString (),"_picker",h);
bo.focus()
},io=function (a,b,c) {
var d=a.resolve(new Jm("ui/ContactPicker"));
if(b)d.ua("inputId",b);
if(c) {
if(c.serviceName)d.ua("service",c.serviceName);
if(c.hl)d.ua("hl",c.hl)
}return d
},ko=function (a,b,c) {
if(co)jo();
var d=fo(a,null),e=io(a,c);
l.iframeDone=jo;
e.ua("done","iframeDone");
var f=kg("picker-iframe-div");
if(f==null) {
var f=vg("div",{
	id:"picker-iframe-div",style:"position: absolute; background-color; #FFF",
	zIndex:10
});
oa[Lc].appendChild(f);
y(f,'<iframe id="picker-iframe" style="display:none; background-color; #FFF; border: 0"></iframe>')
}var g=kg("picker-iframe");
C(g[J],"block");
Ji(f,d[Mc],d.top);
Ki(g,d[F],d[P]);
g.src=e;
eo=f;
co=g
},jo=function () {
Bg(eo);
eo=null;
co=null
};
qe("goog.focus.PickerLauncher.popPicker",ho);
qe("goog.focus.PickerLauncher.popIframe",ko);
var lo=function (a,b) {
this.tga=[];
this.ZE=ee(a)?new Jm(a):a;
if(this.ZE.Yb.charAt(0)!="/")throwError();
this.daa=b;
this.kK=false;
this.QD=[];
this.Ey=null
};
lo[_P].Vh=function (a) {
this.pO=a
};
lo[_P].My=function (a,b) {
if(this.kK)throwError("Cannot create another email Autocomplete. Use attachAutocompleteAlsoTo()");
this.kK=true;
a=kg(a);
var c=b||{
},d=this;
c.serverBase=this.ZE.toString ();
this.S0().P_(function (e) {
var f=e[Fd]||e[ud][vd],g=f._EmailAc_create;
if(g) {
	var h=g(a,c);
	d.Ey=R(h.addInput,h);
	if(d.QD[E]>0) {
		d.Ey(d.QD);
		d.QD=[]
	}
}
})
};
lo[_P].LH=function (a) {
if(!this.kK)throwError("Must call attachAutocompleteTo() first.");
a=kg(a);
if(!this.Ey)this.QD.push(a);
else this.Ey(a)
};
lo[_P].KC=function (a,b) {
var c={
serviceName:this.daa,hl:this.pO
};
go(this.ZE,a,b,c)
};
lo[_P].S0=function () {
if(!this.A_) {
var a=this.ZE.resolve(new Jm("ui/EmailAc"));
a.ua("service",this.daa);
if(this.pO)a.ua("hl",this.pO);
this.A_=this.T6(a.toString ())
}return this.A_
};
lo[_P].T6=function (a) {
return new mo(a)
};
qe("goog.ContactTools",lo);
re(lo[_P],"setLocale",
lo[_P].Vh);
re(lo[_P],"attachAutocompleteTo",lo[_P].My);
re(lo[_P],"attachAutocompleteAlsoTo",lo[_P].LH);
re(lo[_P],"launchPicker",lo[_P].KC);
var mo=function (a) {
this.og=[];
this.Nn=this.RY();
oa[Lc].appendChild(this.Nn);
if(S)Dh(this.Nn,"readystatechange",this.x7,false,this);
else Dh(this.Nn,"load",this.yP,false,this);
this.Nn.src=a
};
mo[_P].P_=function (a) {
if(this.je)a(this.je);
else this.og.push(a)
};
mo[_P].RY=function () {
var a=vg("iframe"),b=a[J];
Sb(b,"hidden");
x(b,D(b,"10px"));
if(!Wf) {
Fa(b,"absolute");
b.top=
ib(b,"-10px")
}else b.marginTop=b.marginLeft="-10px";
return a
};
mo[_P].x7=function () {
if(this.Nn[Yc]=="complete")this.yP()
};
mo[_P].yP=function () {
this.je=this.Nn;
delete this.Nn;
for(var a=0;this.og[a];++a)this.og[a](this.je);delete this.og
};var no=function (a,b,c,d) {
Fj.call(this,a,false,3,true);
this.z=a;
this.pw=b;
this.qa=c;
this.Uc=this.z.pathImg+"print/";
this.WT=true;
this.F=T(this.Ja());
this.Va(d);
var e=this.F;
e.appendChild(this.Ja(),e.b("table",null,e.b("tbody",null,e.b("tr",null,e.b("td",null,this.kZ())),e.b("tr",null,e.b("td",null,this.QY())),e.b("tr",null,e.b("td",null,this.lZ())),e.b("tr",null,e.b("td",null,this.jZ())),e.b("tr",null,e.b("td",{
align:"right"
},this.wY())))));
Dh(this.Az,U,R(this.lk,this));
Dh(this.sH,U,R(this.lk,this));
Dh(this.Ri,U,R(this.eq,this,this.Ri,this.Dm));
Dh(this.Dm,U,R(this.eq,this,this.Ri,this.Dm));
Dh(this.Ro,U,R(this.eq,this,this.Ro,this.ys));
Dh(this.ys,U,R(this.eq,this,this.Ro,this.ys));
Dh(this.un,U,R(this.Ym,this,this.un,this.Vk));
Dh(this.Vk,U,R(this.Ym,this,this.un,this.Vk));
Dh(this.dl,U,R(this.Ym,this,this.dl,this.Qq));
Dh(this.Qq,U,R(this.Ym,this,this.dl,this.Qq));
Dh(this.gE,U,R(this.lk,this));
Dh(this.lV,Rh,R(this.lk,this));
Dh(this.jA,U,R(this.J2,this));
this.D(true);
La(this.Az,true);
La(this.sH,false);
La(this.Ri,true);
this.eq(this.Ri,this.Dm);
La(this.Ro,false);
La(this.gE,true);
La(this.un,true);
this.Ym(this.Ri,this.Vk);
La(this.dl,false);
Ta(this.jA,d?_M[228]:_M[11]);
this.lk()
};
no.inherits(Fj);
no[_P].eq=function (a,b) {
var c=null,d=null;
if(b==this.Dm) {
d=this.Ro;
c=this.ys
}else {
d=this.Ri;
c=this.Dm
}La(d,false);
this.F.Xh(c,{
style:"background: #FFF;"
});
La(a,true);
this.F.Xh(b,{
style:"background: #E0EDFE;"
})
};
no[_P].Ym=function (a,b) {
this.WT=false;
var c=null,d=null;
if(b==this.Vk) {
d=this.dl;
c=this.Qq
}else {
d=
this.un;
c=this.Vk
}La(d,false);
this.F.Xh(c,{
style:"background: #FFF;"
});
La(a,true);
this.F.Xh(b,{
style:"background: #E0EDFE;"
});
this.lk()
};
no[_P].J2=function () {
this.WT=false;
this.D(false);
this.pw.kA(this.qa+this.oL())
};
no[_P].lk=function () {
var a=oo+"=10&atyp="+po+this.oL(),b=hm(this.z.url,a,true);
Ba(b,el(this,this.j9,b))
};
no[_P].oL=function () {
var a="&size="+this.lV[I];
a+="&fzr="+this.gE[ic];
a+="&portrait="+this.dl[ic];
a+="&fitw="+this.Ri[ic];
if(this.Az[ic])a+="&gid="+this.z.activeGrid.id;
return a
};
no[_P].j9=function (a) {
try{
if(a[Yc]==4) {
	var b=eval("("+a[pc]+")"),c=b.info;
	if(c!=null) {
		y(this.lK,"");
		y(this.XG,"");
		y(this.XN,"");
		y(this.cQ,"");
		this.Bx(c.hb0,this.lK);
		this.Bx(c.hb1,this.XG);
		this.Bx(c.ww0,this.XN);
		this.Bx(c.ww1,this.cQ);
		if(this.WT) {
			var d,e;
			if(c.port) {
				d=this.dl;
				e=this.Qq
			}else {
				d=this.un;
				e=this.Vk
			}this.Ym(d,e)
		}
	}
}
}catch(f) {
}
};
no[_P].Bx=function (a,b) {
if(a)y(b,a)
};
no[_P].show=function (a) {
Ta(this.jA,a?_M[228]:_M[11]);
this.Va(a);
this.D(true);
this.lk()
};
no[_P].kZ=function () {
var a=this.F;
this.Az=
a.b("input",{
type:"radio",value:"Current",name:"whatPartsGroup"
});
this.sH=a.b("input",{
type:"radio",value:"All",name:"whatPartsGroup"
});
return a.b("fieldset",null,a.b("legend",null,a.b("b",null,_M[283])),a.b("table",null,a.b("tbody",null,a.b("tr",null,a.b("td",null,this.Az,_M[284]),a.b("td",null,this.sH,_M[285])))))
};
no[_P].QY=function () {
var a=this.F;
this.lK=a.b("span",{
style:"font-size: 90%;"
});
this.Dm=a.b("td",{
"class":"prtDbxGroupOnOff"
},_M[287],a.b("br",null),a.b("img",{
src:this.Uc+"pageTall.gif"
}),
a.b("br",null),this.lK);
this.XG=a.b("span",{
style:"font-size: 90%;"
});
this.ys=a.b("td",{
"class":"prtDbxGroupOnOff"
},_M[288],a.b("br",null),a.b("img",{
src:this.Uc+"pageMulti.gif"
}),a.b("br",null),this.XG);
this.Ri=a.b("input",{
type:"radio"
});
this.Ro=a.b("input",{
type:"radio"
});
this.gE=a.b("input",{
type:"checkbox"
});
return a.b("fieldset",null,a.b("legend",null,a.b("b",null,_M[286])),a.b("table",null,a.b("tbody",null,a.b("tr",null,a.b("td",{
valign:"top"
},this.Ri),this.Dm,a.b("td",{
valign:"top"
},this.Ro),
this.ys))),a.b("table",null,a.b("tbody",null,a.b("tr",null,a.b("td",{
colspan:"4",align:"left"
},this.gE,a.b("span",null,_M[289]))))))
};
no[_P].lZ=function () {
var a=this.F;
this.XN=a.b("span",{
style:"font-size: 90%;"
});
this.Vk=a.b("td",{
"class":"prtDbxGroupOnOff"
},_M[291],a.b("br",null),a.b("img",{
src:this.Uc+"pageWide.gif"
}),a.b("br",null),this.XN);
this.cQ=a.b("span",{
style:"font-size: 90%;"
});
this.Qq=a.b("td",{
"class":"prtDbxGroupOnOff"
},_M[292],a.b("br",null),a.b("img",{
src:this.Uc+"pageTall.gif"
}),
a.b("br",null),this.cQ);
this.un=a.b("input",{
type:"radio"
});
this.dl=a.b("input",{
type:"radio"
});
return a.b("fieldSet",null,a.b("legend",null,a.b("b",null,_M[290])),a.b("table",null,a.b("tbody",null,a.b("tr",null,a.b("td",{
valign:"top"
},this.un),this.Vk,a.b("td",{
valign:"top"
},this.dl),this.Qq))))
};
no[_P].jZ=function () {
var a=this.F;
this.lV=a.b("select",null,a.b("option",{
value:"0"
},_M[294]),a.b("option",{
value:"2"
},_M[295]),a.b("option",{
value:"7"
},_M[296]));
return a.b("fieldset",null,a.b("legend",
null,a.b("b",null,_M[293])),this.lV)
};
no[_P].wY=function () {
this.jA=this.F.b("input",{
type:"button"
});
return this.F.b("div",null,this.jA)
};
no[_P].Va=function (a) {
no.B.Va.call(this,a?_M[10]:_M[600])
};
var qo=function (a,b,c,d) {
af.call(this);
this.ra=d;
this.app=b;
this.doc=a;
var e=c-56,f=T(),g,h=f.b("table",{
"class":"imTable",style:"width: "+e+"; height: 100%",cellPadding:0,cellSpacing:0,align:"center"
},f.b("tbody",{
},f.b("tr",{
},f.b("td",{
style:"height: 10"
})),f.b("tr",{
},f.b("td",{
"class":"imTitle"
},_M[156])),f.b("tr",{
},f.b("td",{
style:"height: 125"
},this.Zea=f.b("div",{
"class":"imUsers",style:"left: 8px; width :"+e+"; height: 100%"
},f.b("table",{
"class":"dlgTblGen"
},this.fda=f.b("tbody"))))),f.b("tr",
{
},f.b("td",{
},g=f.b("a",{
"class":"aBlue",href:"#",style:"visibility: hidden"
},_M[400]))),f.b("tr",{
},f.b("td",{
style:"height: 10"
})),f.b("tr",{
},f.b("td",{
style:"height: 99%"
},this.Wea=f.b("div",{
"class":"imMsgs",style:"width: "+e+"; height: 100%"
},f.b("table",{
"class":"dlgTblGen"
},this.dda=f.b("tbody"))))),f.b("tr",{
},f.b("td",{
"class":"imShowHideDisabled"
},_M[157])),f.b("tr",{
},f.b("td",{
style:"height: 55"
},this.curIM=f.b("textarea",{
style:"position: relative; width: "+e+"; height: 55","class":"imEditBox",
tabIndex:1000
}))),f.b("tr",{
},f.b("td",{
style:"height: 10"
}))));
this.divMain=f.b("div",{
"class":"winChatShare",style:"width: 100%; height: 100%; display: none; overflow: hidden"
},h);
var i=new mj(this),j=this.curIM;
i.listen(j,Qh,this.xf);
i.listen(j,"keyup",this.Ng);
i.listen(j,"focus",this.Hn);
i.listen(j,"blur",this.Gn);
i.listen(g,U,this.z3);
var k=this.ra.ya.Fd;
i.listen(k,"adduser",this.Eu);
i.listen(k,yi,this.Gu);
i.listen(k,xi,this.Du);
i.listen(k,"deletesession",this.z2);
this.q=i;
this.UT=g;
this.sy=
{
};
this.V5={
};
this.clearIM=false;
this.M5=null;
this.Hp=false;
var m=k.e2();
if(m)for(var n=0;n<m[E];n++)this.jH(m[n]);var q=k.Bu();if(q)for(var n=0;n<q[E];n++)this.Vl(q[n])
};qo.inherits(af);qo[_P].z3=function () {
if(!this.ra.ya.Fd.jc()) {
var a=!Dm;
Ig(this.UT,a?_M[400]:_M[399]);
this.ra.Hba(a)
}
};
qo[_P].Nw=function () {
var a=this.dda[J];
C(a,"none");
l.setTimeout(function () {
C(a,"")
},0)
};
qo[_P].xf=function (a) {
var b=a[ed]?a[ed]:(a[wd]?a[wd]:a[$c]),c=this.curIM[I];
if(b==13)if(!a[Zb]&&!a[oc]&&!a[sd]) {
if(c[E]>0) {
	this.cH(_M[158]+
	c,true);
	var d=oo+"=9";
	d+="&atyp="+X.newIM;
	d+="&v="+fa(c);
	this.app.Ab(d,false,true)
}this.clearIM=true
}
};
qo[_P].Ng=function () {
if(this.clearIM) {
Ta(this.curIM,"");
this.clearIM=false
}
};
qo[_P].Hn=function () {
this.Hp=true
};
qo[_P].Gn=function () {
this.Hp=false
};
qo[_P].cH=function (a,b) {
if(a=="")return false;
var c=this.dda,d=c.insertRow(c[pd][E]).insertCell(0),e=a.indexOf(":"),f=a.substr(0,e+1);
a=a.substr(e+1);
if(this.M5==f)y(d,"&nbsp;&nbsp;");
else {
y(d,"<b>"+f+" </b>");
this.M5=f
}d.appendChild(this.doc.createTextNode(a));
wa(this.Wea,2000000);
this.ra.$s(true,b,this.Hp)
};
qo[_P].Eu=function (a) {
var b=a.username;
this.jH(b);
this.ra.bU(b)
};
qo[_P].Gu=function (a) {
var b=a.username,c=this.sy[b];
if(c) {
C(c[J],"none");
this.ra.$s(false)
}if(this.ra.ya.Fd.jc())Sb(this.UT[J],"hidden")
};
qo[_P].Du=function (a) {
var b=this.ra.ya.Fd.Au(a.sessionNum);
this.Vl(b)
};
qo[_P].z2=function (a) {
var b=this.V5[a.sessionNum];
if(b)C(b[J],"none")
};
qo[_P].jH=function (a) {
var b=this.sy[a];
if(!b) {
var c=T();
b=c.b("tr",{
},c.b("td",{
},c.b("div",{
	style:"float: left;"
},
a),c.b("div",{
	style:"float: left; margin-left: 2px"
})));
this.fda.appendChild(b);
if(Uf)this.fda.appendChild(b);
this.sy[a]=b
}C(b[J],"");
wa(this.Zea,2000000);
Sb(this.UT[J],"visible")
};
qo[_P].Vl=function (a) {
if(kn) {
var b=new Cm(this.app,a);
b.render();
var c=this.sy[a.qy],d=c[rd][0][rd][1],e=b.L0();
this.V5[a.$E]=e;
this.q.listen(e,U,R(this.ra.uO,this.ra,a));
d.appendChild(e)
}
};
qo[_P].$=function () {
return this.divMain
};
qo[_P].dispose=function () {
if(!this.N()) {
qo.B.dispose.call(this);
this.q.dispose();
this.sy=
null
}
};
var ro=null,so=["","bg-btn.gif","bg-btn.png","icon-dropdn.gif","icon-disabled-dropdn.gif","close_box.gif","spinWait.gif","closeX.gif"],to=1,uo=3,vo=15,wo=16,xo=17,yo=19;
function zo(a) {
this.j=a;
var b=bn();
this.qa=b.Ia("cmdUrl");
this.$u=b.Ia("inviteUrl");
var c=b.Ia("doc"),d=b.Ia("divOut"),e=b.Ia("isOwner"),f=b.Ia("isSaved"),g=b.Ia("lastSaved"),h=b.Ia("imgPath"),i=b.Ia("logo"),j=b.Ia("os");
this.Nh=j;
this.Oc=e;
this.ra=null;
var k=[];
this.dd=d;
this.Uc=h;
this.Dj=null;
this.Ei=null;
this.uj=null;
this.nE=null;
this.ue=null;
var m=Zk(c,d,"",0,0,q,"");
this.divMenus=m;
var n=j?0:32;
this.heiMenus=n;
this.heiMenusForTabs=n;
this.heiApp=0;
this.leftChat=q-280;
if(j) {
C(m[J],"none");
this.heiApp=this.Nf(d[Id])
}else {
var q=this.Vm(d[tc]);
if(i==null)i="images/tester_sm.gif";
if(ro==null) {
	so[0]=i;
	ro=Vl(h,so)
}this.pfa=oa.getElementById("gears-status-icon");
var p=Tk(c,m,"docbar",""),s=p.insertRow(0),u=s.insertCell(0),v=Tk(c,u,"",""),t=v.insertRow(0);
Aa(t,"bottom");
var w=t.insertCell(0);
wb(w[J],"6px");
Eb(w[J],"7px");
r(w,"name");
k[to]=w;
var B="";
if(f)B=_M[220](g);
w=t.insertCell(1);
w[J].paddingBottom="3px";
r(w,"small");
y(w,B);
k[vo]=w;
w=t.insertCell(2);
k[wo]=Ql(c,w,"","small");
k[xo]=Ql(c,w,"","small");
u=s.insertCell(1);
Nb(u,"right");
wb(u,"8px");
var A=Tk(c,u,"","");
s=A.insertRow(0);
u=s.insertCell(0);
Nb(u,"right");
var G=Tk(c,u,"","");
x(G,"100%");
s=G.insertRow(0);
u=s.insertCell(0);
wb(u[J],"4px");
k[uo]=new Sl(c,u,[["<strong>"+_M[207]+"</strong>",_M[210]]]);
u=s.insertCell(1);
wb(u[J],"4px");
k[yo]=new Sl(c,u,[[_M[208],_M[208]]]);
D(m[J],32);
var H=this.Nf(d[Id]-32)+32;
this.heiApp=H-32
}var Q=new Ao(this.qa,a,d,e,f,h,k,this.$u,i,g,this);
this.ra=Q;
if(!j) {
var K=oa.getElementById("id_logo");
z(K,el(Q,Q.cz,true))
}this.Ae=Zk(c,d,"",0,0,q,this.heiApp);
this.Fd=new vi(b.Ia("userList"))
}zo[_P].setConnectionParams=function (a,b,c) {
if(c)this.ra.Taa(c.hl);
this.j.setConnectionParams(a,b,c)
};
zo[_P].getDivApp=function () {
return this.Ae
};
zo[_P].Pa=function () {
return this.j
};
zo[_P].Vm=function (a) {
return o.max(a,this.j.MIN_APP_WIDTH+280)
};
zo[_P].Nf=
function (a) {
return o.max(a,this.j.MIN_APP_HEIGHT)
};
zo[_P].z1=function () {
return bn().Ia("nickname")
};
za(zo[_P],function (a,b) {
if(a==null&&this.Nh)return ;
var c=this.ue&&this.ue.Xt();
if(S)this.heiMenusForTabs=this.j.Da()?60:32;
if(a==null) {
a=this.divMenus[tc]-(c?280:0);
b=this.heiApp
}else {
a=this.Vm(a);
b=this.Nf(b-this.heiMenus);
this.heiApp=b;
x(this.divMenus[J],a);
if(c)a-=280
}this.leftChat=a;
var d=a;
if(c) {
d+=280;
this.ra.Qw()
}this.j.resize(a,b,d,true)
});
zo[_P].xY=function (a,b) {
var c=new Sl(a,b,[[_M[206],
""]],true);
this.ra.Wba(c);
return c
};
zo[_P].iZ=function (a,b) {
if(this.Nh)return ;
var c=this.j,d=bn(),e=new bl(a,b,this.Uc,true),a=c.W(),f=d.Ia("spDashDom");
this.Dj=new Bo(a,c,this.Uc,this.qa,this.$u,this.Oc,f,d.Ia("focusConfig"),d.Ia("friendInvHelpUrl"));
this.Ei=d.Ia("t4tBaseUrl")?new Co(a,c,280,this.ra):new qo(a,c,280,this.ra);
this.uj=new Do(a,c,this.Uc,this.qa,f);
var g=new Eo(this,this.ra),h=new Yk(this.Ei.$(),{
doc:a,elem:this.dd,name:_M[246],width:280,height:this.heiApp,pathImg:this.Uc,chrome:true,
dark:true
});
Fa(h.$()[J],"absolute");
var i=e.zi(_M[243],h,{
handler:g,closer:new Fo(this,h.$())
});
h.nF(i);
if(!this.Fd.jc())fi(R(zo[_P].RG,this,i,true),0);
h=new Yk(this.Dj.$(),{
doc:a,elem:this.dd,name:_M[247],width:280,height:this.heiApp,pathImg:this.Uc,chrome:true,dark:true
});
Fa(h.$()[J],"absolute");
i=e.zi(_M[244],h,{
handler:g
});
h.nF(i);
h=new Yk(this.uj.$(),{
doc:a,elem:this.dd,name:_M[248],width:280,height:this.heiApp,pathImg:this.Uc,chrome:true,dark:true
});
Fa(h.$()[J],"absolute");
i=e.zi(_M[245],h,
{
handler:g
});
h.nF(i);
this.ue=e;
this.ra.ez();
var j=d.Ia("tab");
if(j==this.Yi().Lc())this.Yi().activate(true);
else if(j==this.Yd().Lc()) {
this.Yd().activate(true);
var k=d.Ia("userstoinvite");
if(k!=null)this.Dj.Raa(k)
}else if(j==this.Rm().Lc())this.Rm().activate(true)
};
zo[_P].RG=function (a,b) {
if(!this.j.wf)a.activate(b)
};
zo[_P].aZ=function (a,b) {
if(this.Nh)return ;
return new Go(this.j,a,b)
};
zo[_P].hv=function () {
return this.j.emailAddress!=""
};
zo[_P].wu=function () {
if(this.nE==null) {
var a=new Ho(this.j.W(),
this.j,this.Uc,this.qa,this.ra,bn().Ia("revisUrl")),b=a.$(),c=b[J];
Fa(c,"absolute");
c.top="0px";
ib(c,"0px");
gm(this.j,this.j.Wn,0);
this.nE=a
}return this.nE
};
zo[_P].Yi=function () {
return this.ue.Gj[0]
};
zo[_P].Yd=function () {
return this.ue.Gj[1]
};
zo[_P].Rm=function () {
return this.ue.Gj[2]
};
zo[_P].N0=function () {
return bn().Ia("docsUrl")
};
zo[_P].Naa=function (a) {
var b=this.pfa;
if(b)r(b,a?"gears-status-online":"gears-status-offline")
};
Ra(zo[_P],function () {
if(this.ra)this.ra.cleanup();
var a=this.Ei;
if(a) {
a.dispose();
this.Ei=null
}if(this.Dj)this.Dj.cleanup();
this.Ei=null;
this.Dj=null;
this.uj=null;
this.nE=null;
this.j=null;
this.ra=null;
var b=this.Fd;
if(b)b.dispose();
this.Fd=null
});
function Fo(a,b) {
this.ya=a;
this.yg=b
}Fo[_P].show=function () {
ib(this.yg[J],this.ya.leftChat)
};
Fo[_P].hide=function () {
ib(this.yg[J],-5000)
};
zo[_P].getHelper=function () {
return this.ra
};
function Do(a,b,c,d,e) {
this.visible=false;
this.Jl=e;
this.Zj=e!=null&&e[E]>0;
var f=Zk(a,null,"winChatShare",0,0,"100%","100%",null,true);
this.divMain=f;
C(f[J],"none");
$a(f[J],"center");
Ql(a,f,"<p style='height:100'></p><p style='font-size:10pt'>"+_M[163]+"</p><img src='"+c+"spinWait.gif' />","");
this.Ux=null;
this.j=b;
this.oa=a;
this.Uc=c;
this.qa=d;
this.Ub=false;
this.wga=null;
this.JW=null;
this.s$=null;
this.W5=null;
this.Z5=null;
this.v4=null;
this.I5=null;
this.WN=null;
this.UC=null;
this.H5=null;
this.eda=
null;
this.Uq=false;
this.Qy=null;
this.aI=null;
this.Ry=null;
this.Is=false;
this.zX=null;
this.xm=null;
this.BX=null;
this.oQ=null;
this.aJ=null;
this.ym=null;
this.Bt={
};
this.Z8=null
}Do[_P].show=function (a) {
var b=this.divMain;
if(!a) {
y(b,"");
return false
}if(!this.Ub) {
y(b,"");
var c=b[J];
C(c,"none");
this.Tf(true);
var d=hm(this.qa+"&fmcmd="+Io,"",false),e=qi(eval(d[pc]),_M[148]);
if(e!=null) {
	this.vga=e.e;
	this.JW=e.a
}this.ZU();
C(c,"")
}
};
Do[_P].p8=function () {
jm(this.JW,"height=520,width=450,toolbar=0,location=0,menubar=0,resizable=0")
};
Do[_P].QP=function () {
jm(this.s$)
};
Do[_P].ZU=function () {
if(this.Ub) {
var a=hm(this.qa+"&fmcmd="+Jo,"",false),b=qi(eval(a[pc]),_M[148]);
if(b!=null)this.bea(b)
}
};
Do[_P].tL=function (a) {
var b=this.UC;
if(a)b=b+"&oid="+a+"&output=image";
return b
};
Do[_P].bea=function (a) {
var b=a.p,c=this.Jl,d=a.da?a.da:false;
this.oQ=a.u;
this.aJ=a.du?a.du:"";
var e=this.BX;
if(e) {
Xa(e,d&&!a.al);
La(e,d)
}this.xm=a.da;
if(b&&a.a&&!a.sa)if(a.s[E]<1||this.Dp(a.s[0])==null) {
this.publish({
	enable:false,auto:false,sheet:-1
});
return
}this.j.setDasherPrefixForPublish(a.dpfp);
var f=this.UC;
zb(f,d?this.aJ:this.oQ);
tm(f,rm(f[od],40));
C(f[J],b?"":"none");
this.s$=a.r;
var g=this.H5;
tm(g,b?_M[269](a.d):rm(f[od],40));
var h=_M[263];
if(b)h=_M[265];
tm(this.I5,"<strong>"+h+"</strong>");
var i=this.WN;
tm(i,b?(d?_M[259](c):_M[392]):(d?_M[258](c):_M[264]));
var j=this.Qy;
j.cg("<strong>"+_M[b?272:270]+"</strong>");
j.Dx(_M[b?275:273]);
if(b) {
var k=this.Dp(a.sa||a.s[E]<1?-1:a.s[0]);
if(k==null)k=this.Dp(-1);
Sa(k,true);
this.Z8=k[I]
}this.Ry.display(b);
this.Uq=b;
this.D_(a.a);
this.Is=a.a;
C(this.eda[J],
b?"":"none");
if(!this.Zj) {
C(this.Z5[J],b?"":"none");
C(this.v4[J],b?"":"none")
}C(this.W5[J],b?"":"none")
};
Do[_P].bH=function (a,b) {
if(this.Ub) {
Zl(this.oa,this.ym,Pe(_M[279](b)),a);
this.Bt[a]=_M[405](b);
if(S) {
	Sb(this.ym[J],"hidden");
	Sb(this.ym[J],"inherit")
}
}
};
Do[_P].Q9=function (a,b) {
if(this.Ub) {
var c=this.Dp(a);
if(c!=null) {
	Ja(c,_M[279](b));
	this.Bt[a]=_M[405](b)
}
}
};
Do[_P].J9=function (a) {
if(this.Ub) {
var b=this.Dp(a);
if(b!=null) {
	this.ym.remove(b[fc]);
	this.Bt[a]=null
}
}
};
Do[_P].Dp=function (a) {
if(this.Ub) {
var b=
this.ym[Zc];
for(var c=0;c<b[E];c++)if(b[c][I]==a)return b[c]
}return null
};Do[_P].T_=function (a) {
return this.Ub?this.Bt[a]:null
};
Do[_P].publish=function (a) {
var b=a!=null&&a.enable!=null?a.enable:this.Uq,c=a!=null&&a.sheet!=null?a.sheet:this.ym[I],d=this.T_(c);
if(!this.Ub)return null;
if(this.Zj&&a!=null&&a.alertUser!=null&&a.alertUser) {
var e=b?(this.Uq?_M[262](d):_M[260](this.Jl,d)):_M[261];
if(!la(e))return null
}var f=a!=null&&a.auto!=null?a.auto:this.Is,g=this.xm;
return this.$$(b,f,c,g)
};
Do[_P].$$=
function (a,b,c,d) {
var e=c==-1,f="enable="+(a?"true":"false")+"&auto="+(b?"true":"false")+"&all="+(e?"true":"false")+(e?"":"&grids="+c);
if(d)f+="&domain="+(d?"true":"false");
var g=hm(this.qa+"&fmcmd="+Ko,f,false);
return qi(eval(g[pc]),_M[148])
};
Do[_P].D_=function (a) {
var b=this.Uq,c=this.Qy;
if(b) {
c.cg("<strong>"+_M[271]+"</strong>");
c.Dx(_M[a?276:274]);
La(this.zX,a)
}var d=!b||!a;
c.enable(d);
if(d)z(c.X[0],this.aI)
};
Do[_P].zD=function () {
var a=this.Qy;
a.enable(true);
z(a.X[0],this.aI);
a.notify(true);
a.Dx(_M[277])
};
Do[_P].yda=function () {
this.Is=!this.Is;
this.zD()
};
Do[_P].zda=function () {
this.xm=!this.xm;
var a=this.WN;
tm(a,this.xm?_M[259](this.Jl):_M[392]);
var b=this.UC;
zb(b,this.xm?this.aJ:this.oQ);
tm(b,rm(b[od],40));
this.zD()
};
Do[_P].Tf=function (a) {
if(!a) {
this.Ub=false;
return false
}this.Ub=true;
var b=this.oa,c=this.Jl,d=Tk(b,this.divMain,"imTable","");
this.Ux=d;
x(d[J],"100%");
Nb(d,"center");
var e=Uk(d);
y(e,"<strong>"+_M[263]+"</strong>");
Aa(e,"top");
this.I5=e;
e=Uk(d);
Aa(e,"top");
var f=Tk(b,e,"","");
e=Uk(f);
this.WN=Ql(b,e,"","");
e=Uk(f);
var g=Tl(b,e,"","",false,"aBlue");
Va(g[J],"9pt");
jb(g,"_blank");
this.UC=g;
e=Uk(f,"","imSmallTxt");
this.H5=Ql(b,e,"","");
e=Uk(d,30);
e=Uk(d);
Aa(e,"top");
var h=new Sl(b,e,[["<strong>"+_M[270]+"</strong>",_M[273]]]),i=new el(this,this.publish,{
enable:true,alertUser:true
});
z(h.X[0],i);
this.Qy=h;
this.aI=i;
this.Ry=new Sl(b,e,[["<strong>"+_M[272]+"</strong>",_M[275]]]);
z(this.Ry.X[0],new el(this,this.publish,{
enable:false,alertUser:true
}));
this.Ry.display(false);
e=Uk(d,10);
e=
Uk(d);
var j=Tk(b,e,"imTable","");
C(j[J],"none");
this.eda=j;
e=Uk(j,null,"imRegText");
var k=Xl(b,e,this.Is);
z(k,new Qk(this,this.yda));
this.zX=k;
bm(b,e,_M[266]);
if(this.Zj) {
e=Uk(j,null,"imRegText");
var m=Xl(b,e,this.xm);
this.BX=m;
z(m,new Qk(this,this.zda));
bm(b,e,_M[393](c))
}e=Uk(j,20);
e=Uk(j,25,"imRegText");
y(e,"<strong>"+_M[278]+"</strong>");
e=Uk(j,25);
var n=b.createElement("select");
e.appendChild(n);
x(n[J],"100%");
va(n,Qk(this,this.zD));
this.ym=n;
Zl(b,n,_M[280],-1);
this.Bt[-1]=_M[406];
var q=this.j.Aa,
p=q.yh();
for(var s=0;s<p[E];s++) {
var u=p[s];
this.bH(u.id,u[yd])
}e=Uk(d,60);
var v;
if(!this.Zj||Be(this.Jl)=="google.com") {
e=Uk(d);
v=Tl(b,e,"",_M[282],false,"aOrange");
wb(v[J],"5px");
C(v[J],"none");
zb(v,"#");
z(v,Qk(this,this.QP));
this.Z5=v;
var t=$k(b,e,this.Uc+"subscribe.gif","","",_M[282]);
C(t[J],"none");
z(t,Qk(this,this.QP));
this.v4=t
}e=Uk(d,5);
e=Uk(d);
v=Tl(b,e,"",_M[281],false,"aBlue");
C(v[J],"none");
zb(v,"#");
z(v,Qk(this,this.p8));
this.W5=v
};
Do[_P].$=function () {
return this.divMain
};
Do[_P].wc=function () {
return this.Uq
};
Do[_P].J1=function () {
if(this.Uq)return this.Z8;
return null
};
function Ho(a,b,c,d,e,f) {
this.ra=e;
this.kb=false;
this.Ux=null;
var g=Zk(a,null,"winChatShare",0,0,"100%","100%",null,true);
b.Nq.lW(g);
var h=g[J];
cb(h,"#FFFFFF");
C(h,"none");
Lb(h,2);
this.R=g;
this.Ux=null;
this.cda=null;
this.j=b;
this.oa=a;
this.qa=d;
this.Ub=false;
this.Sfa=f;
this.bX=null;
this.Rfa=null;
this.xs=null;
this.nU=null;
this.t4=null;
this.mU=null;
this.kX=null;
this.iX=null;
this.jX=null;
this.hX=null;
this.Eea=null;
this.Ni=null
}Ho[_P].show=function (a) {
var b=this.R;
if(!a) {
y(b,"");
return false
}if(!this.Ub) {
y(b,
"");
var c=b[J];
C(c,"none");
this.Tf();
this.$U();
C(c,"")
}
};
za(Ho[_P],function (a,b,c) {
var d=this.R[J];
if(d[Cd]!="none") {
x(d,a+"px");
D(d,b+"px");
d.top=c+"px";
if(this.nU!=null)D(this.nU[J],b-30);
else this.mU=b-30
}
});
C(Ho[_P],function (a) {
C(this.R[J],a?"":"none");
var b=this.j;
if(a) {
var c=this.Ub;
this.show(this.ra.isSaved());
if(c)this.$U();
if(W.formStatus.formIsTurnedOn)b.YB()
}else if(W.formStatus.formIsTurnedOn)b.uF();
b.Wn();
b.Nq.YZ(a)
});
Ho[_P].$U=function () {
if(this.Ub) {
var a=null;
try{
	var b=hm(this.qa+"&fmcmd="+
	Lo,"",false);
	a=qi(eval(b[pc]),_M[148])
}catch(c) {
}if(a!=null)this.dea(a)
}
};
Ho[_P].dea=function (a) {
var b=this.Ni,c=b[Zc];
this.bX=a.u;
a=a.r;
while(c[E]>0)b.remove(0);
for(var d=0;d<a[E];d++)this.nW(a[d]);var e=a[E]==0;C(this.Ux[J],e?"none":"");C(this.cda[J],e?"":"none");if(!e) {
var f=this.xs==null?null:this.V_(this.xs);
if(f==null)gm(this,this.zE,0,0);
else gm(this,this.zE,0,f[fc])
}this.Rfa=a
};
Ho[_P].nW=function (a) {
if(this.Ub) {
var b=Zl(this.oa,this.Ni,a.tf+" - "+a.c.join()+" - "+a.d,a.t);
b.revision=a
}
};
Ho[_P].V_=
function (a) {
if(this.Ub) {
var b=this.Ni[Zc];
for(var c=0;c<b[E];c++)if(b[c][I]==a.t)return b[c]
}return null
};Ho[_P].p$=function (a) {
if(la(_M[303])) {
var b=a!=null&&a.time!=null?a.time:this.Ni[I];
return this.caa(b)
}return null
};
Ho[_P].caa=function (a) {
var b="t="+a,c=hm(this.qa+"&fmcmd="+Mo,b,false);
return qi(eval(c[pc]),_M[148])
};
Ho[_P].ZT=function (a) {
var b=this.Ni,c=b[cc]+(a?1:-1);
if(c>=0&&c<b[E])this.zE(c)
};
Ho[_P].e6=function (a) {
var b=this.bX+a.t+"&pt="+a.pt;
this.t4[Fd][xc].replace(b)
};
Ho[_P].zE=function (a) {
Ha(this.Ni,
a);
this.FP()
};
Ho[_P].kT=function (a) {
var b=this.Ni;
if(b)Sb(b[J],a?"visible":"hidden")
};
Ho[_P].FP=function () {
var a=this.Ni,b=a[Zc][a[cc]].revision,c=this.xs;
if(this.xs==null||c.t!=b.t) {
this.xs=b;
this.e6(b)
}var d=a[cc],e=this.iX,f=this.kX;
e.enable(d!=0);
z(e.X[0],d!=0?this.hX:null);
f.enable(d!=a[E]-1);
z(f.X[0],d!=a[E]-1?this.jX:null)
};
Ho[_P].Tf=function () {
this.Ub=true;
var a=this.oa,b=Tk(a,this.R,"revisionsTable","");
this.Ux=b;
x(b[J],"100%");
Nb(b,"center");
var c=$l(b);
D(c[J],"30px");
Aa(c,"middle");
var d=
am(c,""),e=al(a,d,"","revisionsBar","position:relative;width:100%;height:100%");
if(Wf)D(e[J],"2.2em");
var f=al(a,e,"","","position:absolute;right:6px;top:4px;"),g=new Sl(a,f,[[_M[302],""]]);
z(g.X[0],new Qk(this,this.p$));
this.Eea=g;
f=al(a,e,"","","position:absolute;left:6px;top:2px;width:600px;height:100%");
var h=Tk(a,f,"","");
c=$l(h);
d=am(c,"");
var i=Ql(a,d,_M[299],"");
wb(i[J],"4px");
var j=a.createElement("select");
d.appendChild(j);
va(j,Qk(this,this.FP));
x(j[J],"300px");
this.Ni=j;
d=am(c,"");
var k=
d[J];
Eb(k,"6px");
Wa(k,"2px");
var m=new Sl(a,d,[["&laquo; "+_M[300],""]]),n=new el(this,this.ZT,true);
z(m.X[0],n);
this.kX=m;
this.jX=n;
var q=new Sl(a,d,[[_M[301]+" &raquo;",""]]);
n=new Qk(this,this.ZT);
z(q.X[0],n);
this.iX=q;
this.hX=n;
d=Uk(b);
if(this.mU!=null)D(d[J],this.mU);
this.nU=d;
var p=cm(a,d);
r(p,"revisionsFrame");
x(p,"100%");
D(p,"100%");
p.frameBorder="0px";
p.marginWidth="0px";
p.marginHeight="0px";
p.scrolling="no";
this.t4=p;
b=Tk(a,this.R,"revisionsTable","");
this.cda=b;
x(b[J],"100%");
C(b[J],"none");
Nb(b,"center");
d=Uk(b);
var s=Tk(a,d,"revisionsTable revisionsBarNoRevisions","");
x(s[J],"100%");
Nb(s,"center");
d=Uk(s);
bm(a,d,_M[304]);
k=d[J];
Eb(k,"6px");
Wa(k,"8px");
d=Uk(s,40);
d=Uk(s,null,"revisionsOlderText");
Nb(d,"middle");
bm(a,d,_M[305]);
var u=Tl(a,d,this.Sfa,_M[306],false,"aBlue");
Eb(u[J],"4px");
jb(u,"_blank");
d=Uk(s,10);
d=Uk(b,100);
d=Uk(b,100,"revisionsOlderText");
Nb(d,"middle");
Ql(a,d,_M[307]("&copy;2007"),"")
};
Ho[_P].$=function () {
return this.R
};
function Go(a,b,c) {
this.j=a;
this.vf=b;
this.yg=c;
this.Wb=S;
this.Fh=5;
this.cga=null;
this.R=null;
this.Nc(a.doc,c)
}Go[_P].Nc=function (a,b) {
var c=Zk(a,b,"menuDivs",0,0,"100%","34");
this.R=c;
var d=Tk(a,c,"menuMainTbl","left: "+this.Fh+"px;top:3px;width:100%;height:100%"),e=d.insertRow(0),f=e.insertCell(0);
r(f,"menuMainLabel");
var g="border: 2px solid #ffa82d;background-color: #ffd396; padding: 2px;";
this.cga=Ql(a,f,"<strong>"+_M[298]+"</strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"+_M[655]("<span style='"+g+"'>",
"</span>"),"")
};
Go[_P].We=function (a) {
if(a==null)this.Rc()
};
Go[_P].Rc=function () {
};
Go[_P].$=function () {
return this.R
};
Ra(Go[_P],function () {
if(this.R!=null)y(this.R,"")
});
function Bo(a,b,c,d,e,f,g,h,i) {
this.Oc=f;
this.Jl=g;
this.Zj=g!=null&&g[E]>0;
this.visible=false;
var j=Zk(a,null,"winChatShare",0,0,"100%","100%",null,true);
this.divMain=j;
C(j[J],"none");
$a(j[J],"center");
Ql(a,j,"<p style='height:100'></p><p style='font-size:10pt'>"+_M[163]+"</p><img src='"+c+"spinWait.gif' />","");
this.j=b;
this.oa=a;
this.Uc=c;
this.qa=d;
this.$u=e;
this.Ub=false;
this.yp=false;
this.ffa=h;
this.jfa=i;
this.rq=null;
this.Bv=null;
this.Cv=null;
this.bJ=null;
this.Cz=null;
this.zga=null;
this.Yr=null;
this.UQ=[];
this.jU=null;
this.bda=null;
this.pw=null;
this.E5=null;
this.rga=null;
this.GC=null;
this.jg=false;
this.hh=false;
this.WI=null;
this.UF=null;
this.Ts=0;
this.hp=0;
this.G5=null;
this.E8=null;
this.$y=null;
this.Ps=null;
this.Zy=null;
this.Xz=null;
this.Tt=null;
this.D5=null;
this.C5=null;
this.J5=null;
this.B_=null;
this.C_=null;
this.JJ=null;
this.UX=null;
this.VX=null;
this.jea=null;
this.d0=null;
this.nC=null;
this.mZ=0;
this.bt=null;
this.QI=null;
this.$x=null;
this.sK=null;
this.rK=null;
this.lO=null;
this.tK=null;
this.e0=null;
this.G=new mj(this);
this.F=T(a);
this.ep=null
}var No="https://spreadsheets.google.com/a/google.com/viewform?key=plNQInvRNPhLsQXsR0gzjXg";
Bo[_P].show=function (a) {
if(!a) {
y(this.divMain,"");
return false
}if(!this.Ub) {
y(this.divMain,"");
this.Tf();
var b=hm(this.qa+"&fmcmd="+Oo,"",false),c=qi(eval(b[pc]),_M[148]);
this.WI=c!=null?c:null;
this.BU()
}if(this.ep)this.ep.refresh()
};
Bo[_P].BU=function () {
if(this.Ub) {
this.oM();
var a=hm(this.qa+"&fmcmd="+Po,"",false),b=qi(eval(a[pc]),_M[148]);
if(b!=null)this.fH(b)
}
};
Bo[_P].Raa=function (a) {
Ta(this.rq,a)
};
Bo[_P].T2=function () {
var a=this.mZ;
if(a==0||a==1) {
var b=a==0,c=this.rq,d=b?c[I]:"",e=b?"":c[I],f=fa(d),g=fa(e),h=this.XE(d,e);
if(h!=null) {
	this.oM();
	this.fH(h);
	var i="&to="+f,j="&cc="+g,k=this.$u+i+j;
	l.open(k,"InviteDialog","toolbar=no,width=700,height=500,resizable=yes");
	Ta(c,"")
}
}else {
var m=this.j;
W.openFormEditorWindow(m.Ze,m.zM,W.formDataIsPresent());
W.setFormStatus(true,true);
this.Lr(0);
this.IU()
}
};
Bo[_P].$z=function (a,b) {
var c=this.$u;
c+="&update=true";
if(a)c+=
"&editors=true";
if(b)c+="&viewers=true";
l.open(c,"EmailDialog","toolbar=no,width=700,height=500,resizable=yes")
};
Bo[_P].XE=function (a,b) {
var c=fa(a),d=fa(b);
if(c[E]==0&&d[E]==0) {
ra(_M[140]);
return null
}var e="edit="+c+"&view="+d,f=this.qa+"&fmcmd="+Qo,g=false;
do{
var h=hm(f,e,false),i=eval(h[pc]),j=i[0];
if(j!=2)return qi(i,_M[148]);
g=la(i[1]);
e+="&warned=true"
}while(g)
};
Bo[_P].fH=function (a) {
var b=this.bJ,c=this.Cz,d=0,e=0,f=a[1];
a=a[0];
this.UF=null;
this.UQ=[];
this.jg=false;
this.hh=false;
for(var g=
0;g<a[E];g++) {
var h=a[g].i,i=h=="*"||h=="*D";
if(a[g].o==true) {
	if(this.pw==null) {
		this.pw=h;
		y(this.E5,_M[185](this.pw))
	}
}else if(a[g].t==0) {
	if(i) {
		this.hh=true;
		this.jg=false
	}if(!i) {
		this.Cy(b,a[g],d,true);
		d++
	}
}else if(i) {
	this.hh=false;
	this.jg=true
}else {
	this.Cy(c,a[g],e,false);
	e++
}
}this.aA(this.jg,this.hh);
var j=this.Zy,k=this.Xz;
if(!this.jg&&!this.hh) {
La(j,false);
if(k)Xa(k,true)
}else if(this.jg) {
La(j,true);
if(k) {
	Xa(k,false);
	Ta(k,"view")
}
}else if(this.hh) {
La(j,true);
if(k) {
	Xa(k,false);
	Ta(k,"edit")
}
}this.Ts=
d;
this.hp=e;
Ig(this.D5,d>0||e>0||this.hh||this.jg?_M[373]:_M[374]);
if(f.e) {
La(this.$y,f.e);
this.zp(f.e);
this.dF(f.e);
this.yp=f.e
}else {
La(this.$y,false);
this.zp(false);
this.dF(false);
this.yp=false
}if(f.f) {
La(this.Ps,f.f);
this.Tt=f.f
}else {
La(this.Ps,false);
this.Tt=false
}var m=false,n=false;
if(this.Ts>0) {
m=true;
if(this.Oc&&this.Yr!=null)C(this.Yr[J],"")
}if(this.hp>0||this.jg&&!this.yp&&!this.Oc)n=true;
gm(this,this.XZ,0,m,n,f.e)
};
Bo[_P].XZ=function (a,b,c) {
if(this.Oc)c=true;
C(this.Bv[J],"");
Ig(this.Bv,
_M[375](this.Ts));
var d=a&&c;
C(this.C5[J],d?"":"none");
C(this.B_[J],d?"":"none");
C(this.Cv[J],"");
Ig(this.Cv,_M[378](this.hp));
var e=b&&c;
C(this.J5[J],e?"":"none");
C(this.C_[J],e?"":"none");
C(this.JJ[J],e&&d?"":"none")
};
Bo[_P].Y$=function (a) {
var b=hm(this.qa+"&fmcmd="+Ro,"value="+(a?"true":"false"),false);
return qi(eval(b[pc]),_M[148])
};
Bo[_P].Z$=function (a) {
var b=hm(this.qa+"&fmcmd="+So,"value="+(a?"true":"false"),false);
return qi(eval(b[pc]),_M[148])
};
Bo[_P].E_=function (a) {
var b=false;
if(this.Oc==
false||this.Y$(a)==null)b=true;
if(b)this.zp(!a);
else {
this.yp=a;
this.zp(a);
this.dF(a)
}
};
Bo[_P].F_=function (a) {
if(this.Oc==false||this.Z$(a)==null) {
}else this.Tt=a
};
Bo[_P].zp=function (a) {
if(this.Oc)a=true;
var b=this.bda[J],c=this.jU[J];
if(a) {
C(b,"none");
C(c,"")
}else {
C(c,"none");
C(b,"");
if(this.jg)this.Cy(this.Cz,{
	u:[_M[168],_M[168]]
},this.hp,false)
}var d=this.UQ,e=a?"":"none";
for(var f=0;f<d[E];f++)C(d[f][J],e)
};Bo[_P].xda=function () {
this.zp(!this.yp);
gm(this,this.E_,0,!this.yp)
};
Bo[_P].dF=function (a) {
var b=
a?_M[455]:_M[376];
Ig(this.UX,b)
};
Bo[_P].Bda=function () {
if(this.Tt)if(!la(_M[386])) {
La(this.Ps,true);
return
}gm(this,this.F_,0,!this.Tt)
};
Bo[_P].uU=function () {
var a=this.Zy,b=this.Xz,c=this.jg,d=this.hh;
if(a)if(a[ic])if(b) {
if(b[I]=="edit")this.Et(false,true,c,d);
else if(b[I]=="view")this.Et(true,false,c,d)
}else this.Et(true,false,c,d);
else this.Et(false,false,c,d)
};
Bo[_P].Et=function (a,b,c,d) {
var e=this.Zj?"*D":"*",f=false;
if(a) {
if(this.XE("",e)==null)f=true
}else if(b) {
if(this.XE(e,"")==null)f=true
}else if(this.XR(e)!=
true)f=true;
if(f)this.aA(c,d);
else this.aA(a,b)
};
Bo[_P].aA=function (a,b) {
this.jg=a;
this.hh=b;
var c=this.Zj,d=this.Jl,e=_M[176],f=_M[175],g=c?_M[170](d):_M[169],h="",i="";
if(b) {
f=_M[177];
g=c?_M[174](d):_M[173]
}else if(a) {
e=_M[178];
g=c?_M[172](d):_M[171];
if(this.UF!=null)this.h4(this.UF,true)
}if(b||a)if(this.WI==null) {
}else {
h=this.WI;
i=rm(h,40)
}if(this.GC) {
zb(this.GC,h);
y(this.GC,i)
}
};
Bo[_P].Cy=function (a,b,c,d) {
var e=null;
if(a[pd][E]<=c)e=Uk(a,null,"shareData");
else {
e=a[pd][c][L][0];
C(e[J],"")
}var f=
b.u[1]!=""?b.u[1]:b.u[0];
y(e,f);
Ea(e,b.u[0]);
var g=Ql(this.oa,e,"","");
bm(this.oa,g," - ");
var h=Tl(this.oa,g,"#",_M[166],false,"aBlue");
z(h,fm(this,this.D9,b.i,e,d));
this.UQ.push(g);
if(b.i=="*"||b.i=="*D") {
this.UF=e;
this.hh=true
}
};
Bo[_P].XR=function (a) {
var b=hm(this.qa+"&fmcmd="+To,"tid="+fa(a),false);
return qi(eval(b[pc]),_M[148])
};
Bo[_P].aaa=function () {
var a=hm(this.qa+"&fmcmd="+Uo,"dummypost=true",false);
return qi(eval(a[pc]),_M[148])
};
Bo[_P].baa=function () {
var a=hm(this.qa+"&fmcmd="+Vo,"dummypost=true",
false);
return qi(eval(a[pc]),_M[148])
};
Bo[_P].D9=function (a) {
this.XR(a)
};
Bo[_P].h4=function (a,b) {
if(a[J][Cd]!="none") {
C(a[J],"none");
if(b) {
	this.Ts--;
	if(this.Ts<=0) {
		C(this.Bv[J],"none");
		if(this.Yr!=null)C(this.Yr[J],"none")
	}
}else {
	this.hp--;
	if(this.hp<=0)C(this.Cv[J],"none")
}
}
};
Bo[_P].oM=function () {
C(this.Bv[J],"none");
C(this.Cv[J],"none");
if(this.Yr!=null)C(this.Yr[J],"none");
var a=this.bJ[pd];
for(var b=0;b<a[E];b++)C(a[b][L][0][J],"none");a=this.Cz[pd];for(var b=0;b<a[E];b++)C(a[b][L][0][J],"none")
};
Bo[_P].Tf=function () {
this.Ub=true;
var a=this.oa,b=Tk(a,this.divMain,"imTable",""),c=$l(b),d=am(c,"vertical-align:top;");
x(d,"55%");
b=Tk(a,d,"imTable","");
var e=Uk(b,15);
this.E5=Ql(a,e,_M[185](""),"imBlackSmallTxt");
this.bda=b;
if(jn)this.$G(b);
C(b[J],"none");
b=Tk(a,d,"imTable","");
this.jU=b;
C(this.jU[J],"none");
x(b[J],"100%");
d=Uk(b,20,"imRegText");
y(d,_M[179]);
Qb(d[J],"bold");
d=Uk(b,20);
var f=Ql(a,d,"",""),g=Yl(a,f,"share-mode",0,true);
z(f,el(this,this.Lr,0));
Bi(f,"cursor","pointer");
bm(a,f,_M[180]);
Ql(a,d,"&nbsp;&nbsp;&nbsp;","");
this.VX=g;
f=Ql(a,d,"","");
g=Yl(a,f,"share-mode",1,false);
z(f,el(this,this.Lr,1));
Bi(f,"cursor","pointer");
bm(a,f,_M[181]);
this.jea=g;
this.OV(d);
Uk(b,10);
d=Uk(b,55);
var h=Rl(a,d,"shareEditBox","","relative",0,0,"300",55,1000,"textarea");
h.id="people";
this.rq=h;
d=Uk(b,null,"imSmallTxt");
y(d,_M[167]);
d=Uk(b,15,"imSmallTxt");
Aa(d,"top");
var i=Tl(a,d,"#",_M[190],false,"aBlue");
i.contactId="people";
var j=Lj(this,this.s8);
Jj(i,"click",j);
this.G5=i;
this.E8=j;
Uk(b,10);
d=Uk(b,
30);
var k=new Yn(_M[365]);
k.render(d);
this.G.listen(k,Zi,this.T2);
this.nC=k;
if(this.Oc==false) {
this.$y={
};
this.Ps={
};
this.Zy={
};
this.Xz={
}
}else {
this.ZV(b);
d=Uk(b,20,"imRegText");
y(d,_M[367]);
Qb(d[J],"bold");
d=Uk(b,20);
var m=Xl(a,d,false);
z(m,el(this,this.xda,true));
bm(a,d,_M[368]);
this.$y=m;
d=Uk(b,20);
m=Xl(a,d,false);
z(m,el(this,this.Bda,true));
bm(a,d,_M[369]);
d=Uk(b,S?30:15,"imSmallTxt");
ub(d[J],"0 0 10 20");
bm(a,d,_M[370]);
Ql(a,d,"&nbsp;&nbsp;","");
var n=Tl(a,d,this.jfa,_M[371]);
r(n,"aBlue");
jb(n,
"_blank");
this.Ps=m;
d=Uk(b);
m=Xl(a,d,false);
z(m,Qk(this,this.uU));
this.Zy=m;
var q=Ql(a,d,"",""),p="<select id=anyoneCanDropdown><option value=view>"+_M[383]+"</option><option value=edit>"+_M[384]+"</option></select>";
q.innerHTML+=this.Zj?_M[372](this.Jl,p):_M[676](p,"<font style='font-size:8pt'>","</font>");
var s=a.getElementById("anyoneCanDropdown");
va(s,Qk(this,this.uU));
this.Xz=s;
d=Uk(b);
ub(d[J],"0 0 10 20");
r(d,"imSmallTxt");
var u=Tl(a,d,"","");
z(u,this.y_);
r(u,"imSmallTxt");
this.GC=u
}d=Uk(b);
var v=new Wo(this.j,this.F);
this.ep=v;
Dh(v,Xo,this.vW,null,this);
v.render(d);
if(jn)this.$G(b);
d=am(c,"width:30px;");
d=am(c,"width:1px;background-color:#7799BB;");
d=am(c,"width:30px;");
d=am(c,"width:350px;vertical-align:top;");
b=Tk(a,d,"imTable","");
d=Uk(b,40,"imTitle");
Va(d[J],"12pt");
this.D5=d;
d=Uk(b,20,"imTitle");
this.Bv=Ql(this.oa,d,"","");
this.C5=this.EK(d,Qk(this,this.aaa));
d=Uk(b,15,"imSmallTxt");
this.UX=Ql(this.oa,d,"","");
var t=Tk(a,Uk(b),"","");
this.bJ=t;
Uk(b,10);
d=Uk(b,15,"imSmallTxt");
y(d,"<img align=top src='"+this.Uc+"icon_email.gif' />&nbsp;&nbsp;");
var w=Tl(a,d,"#",_M[377],false,"aBlue");
z(w,Rk(this,this.$z,true,false));
C(d[J],"none");
this.B_=d;
Uk(b,10);
d=Uk(b,20,"imTitle");
this.Cv=Ql(this.oa,d,"","");
this.J5=this.EK(d,Qk(this,this.baa));
d=Uk(b,15,"imSmallTxt");
bm(a,d,_M[379]);
t=Tk(a,Uk(b),"","");
this.Cz=t;
Uk(b,10);
d=Uk(b,15,"imSmallTxt");
y(d,"<img align=top src='"+this.Uc+"icon_email.gif' />&nbsp;&nbsp;");
w=Tl(a,d,"#",_M[380],false,"aBlue");
z(w,Rk(this,this.$z,false,true));
C(d[J],"none");
this.C_=d;
Uk(b,10);
d=Uk(b,15,"imSmallTxt");
y(d,"<img align=top src='"+this.Uc+"icon_email.gif' />&nbsp;&nbsp;");
w=Tl(a,d,"#",_M[382],false,"aBlue");
z(w,Rk(this,this.$z,true,true));
C(d[J],"none");
this.JJ=d;
Uk(b,10);
if(Zn&&lo) {
this.bt=new lo(this.ffa.serverBase,"wise");
this.bt.My(this.rq);
this.bt.Vh(this.j.userLocale.l)
}if(!W.formDataIsPresent())this.eQ();
this.Lr(0)
};
Bo[_P].vW=function () {
var a=this.j,b=a.gooffiLink;
if(b) {
b.ya.Yd().close();
a.QT()
}
};
Bo[_P].OV=function (a) {
var b=this.F,c=
null,d=null,e=b.b("span");
y(e,"&nbsp;&nbsp;&nbsp;");
a.appendChild(e);
var f=b.b("sup",{
"class":"red-super"
},_M[524]);
a.appendChild(c=b.b("span",null,d=b.b("input",{
type:"radio",name:"share-mode"
}),_M[519],f));
Bi(c,"cursor","pointer");
this.G.listen(c,U,this.L2);
this.d0=d
};
Bo[_P].L2=function () {
this.Lr(2)
};
Bo[_P].R9=function (a) {
var b=this.F,c=new Yn,d=W.formStatus.formIsTurnedOn,e=new Yn(b.b("span",{
"class":"ss-lite-btn"
},d?_M[514]:_M[515]));
c.lc(_M[510]);
c.render(a);
a.appendChild(b.createTextNode(" "));
e.render(a);
a.appendChild(b.createTextNode(" "));
var f=this.G;
f.listen(c,Zi,this.v2);
f.listen(e,Zi,this.f3);
this.$x=e;
this.QI=c
};
Bo[_P].v2=function () {
var a=this.j;
W.openFormEditorWindow(a.Ze,a.zM,false)
};
Bo[_P].f3=function () {
var a=this.$x,b=W.formStatus.formIsTurnedOn,c=a.$(),d=this.j,e=new fg(d.W());
e.Co(c,b?_M[518]:_M[517]);
Za(c[J],"#666");
a.lc(c);
W.setFormOnOrOff(d.Ze,d.dj(),this.IU,this,!b)
};
Bo[_P].IU=function () {
var a=this.j,b=this.F,c=W.formStatus.formDataIsPresent,d=this.$x,e=this.lO;
if(!c) {
this.vT(false);
a.YB();
return
}var f=W.formStatus.formIsTurnedOn,g=d.$();
b.Co(g,f?_M[514]:_M[515]);
Za(g[J],"#222");
d.lc(g);
var h=f?"aGrey":"aBlue",i=f?"aBlue":"aGrey";
jj(e,h,i);
if(f) {
var j=new Jm(W.getPublishedFormBasePath());
j.ua("key",a.Ze);
b.Co(e,_M[512]);
zb(e,j);
jb(e,"_BLANK");
a.uF()
}else {
b.Co(e,_M[516]);
zb(e,"#");
jb(e,"");
a.YB()
}this.vT(true)
};
Bo[_P].vT=function (a) {
V(this.QI.Qa(),a);
V(this.$x.Qa(),a);
V(this.lO,a)
};
Bo[_P].zY=function () {
var a=this.F,b=W.getRecipients(),c=b[E],d=a.b("span",null,c.toString ()),e=
W.formStatus.formIsTurnedOn,f=new Jm(W.getPublishedFormBasePath());
f.ua("key",this.j.Ze);
var g=a.b("a",{
href:e?f:"#","class":e?"aBlue":"aGrey",target:e?"_BLANK":""
},e?_M[512]:_M[516]);
Qb(g[J],"normal");
var h=W.formDataIsPresent();
V(g,h);
this.lO=g;
var i=a.b("table",{
"class":"form-count-table"
},a.b("tbody")),j=a.b("td",{
"class":"imTitle",height:"20px"
},a.b("span",null,_M[417]+" (",d,")")," ",g);
a.appendChild(i.insertRow(i[pd][E]),j);
W.setRecipientsCountElement(d);
j=a.b("td",{
"class":"imSmallTxt",height:"15px"
},
_M[418]);
a.appendChild(i.insertRow(i[pd][E]),j);
j=a.b("td");
this.R9(j);
V(this.QI.Qa(),h);
V(this.$x.Qa(),h);
a.appendChild(i.insertRow(i[pd][E]),j);
W.setRecipientsTable(i);
var k=W.getRecipientsMap();
for(var m=0;m<c;++m) {
j=a.b("td",{
	"class":"shareData"
},b[m]);
k.set(b[m],j);
a.appendChild(i.insertRow(i[pd][E]),j)
}W.updateRecipientsCountElement();
var n=this.JJ[O][O][O],q=n.insertRow(n[pd][E]);
V(q,false);
a.appendChild(q,a.b("td",{
"class":"form-count-td"
},i));
this.rK=q
};
Bo[_P].Lr=function (a) {
var b=this.nC;
switch(a) {
case 0:b.lc(_M[365]);
La(this.VX,true);
break;
case 1:b.lc(_M[366]);
La(this.jea,true);
break;
case 2:if(W.formDataIsPresent())b.lc(_M[513]);
else b.lc(_M[527]);
La(this.d0,true);
break;
default:throwError("Invalid sharing mode.");
}var c=a==2;
this.dca(c==false);
var d=W.formDataIsPresent();
this.mca(d||c);
this.nca(!d&&c);
this.Bca(d||!c);
this.mZ=a
};
Bo[_P].nca=function (a) {
if(!this.sK)this.AY();
V(this.sK,a)
};
Bo[_P].mca=function (a) {
if(!this.rK)this.zY();
V(this.rK,a)
};
Bo[_P].eQ=function () {
if(!this.tK||
!this.formStepTwoImage) {
var a=this.Uc,b=new Image(90,80);
b.src=a+"sharepane-form-step1.gif";
this.tK=b;
b=new Image(90,80);
b.src=a+"sharepane-form-step2.gif";
this.e0=b
}
};
Bo[_P].AY=function () {
var a=this.rq[O][O][O][O],b=this.nC.Qa()[O][O],c=Cg(b[Xb],false),d=df(a[pd],c),e=a.insertRow(d);
V(e,false);
var f=this.F;
this.eQ();
var g=f.b("td",{
"class":"form-howto-td"
},f.b("span",{
"class":"form-howto-title"
},_M[530]),f.b("br"),f.b("table",{
width:"330"
},f.b("tbody",null,f.b("tr",null,f.b("td",null,this.tK),f.b("td",
null,f.b("span",{
"class":"form-howto-step"
},_M[525]))),f.b("tr",null,f.b("td",null,this.e0),f.b("td",null,f.b("span",{
"class":"form-howto-step"
},_M[526]))))));
xg(e,g);
this.sK=e
};
Bo[_P].Bca=function (a) {
var b=this.rq,c=b[O][O];
V(c,a);
c=Eg(c);
V(c,a);
c=Eg(c);
V(c,a)
};
Bo[_P].dca=function (a) {
var b=Eg(this.nC.Qa()[O][O]);
while(b) {
V(b,a);
b=Eg(b)
}
};
Bo[_P].EK=function (a,b) {
var c=Ql(this.oa,a,"","imSmallTxt");
Qb(c[J],"normal");
bm(this.oa,c," - ");
var d=Tl(this.oa,c,"#",_M[381],false,"aBlue");
z(d,b);
C(c[J],"none");
return c
};
Bo[_P].y_=function () {
return false
};
Bo[_P].ZV=function (a) {
var b=Uk(a,20);
y(b,"<hr size=1 color='#cccccc' noshade/>")
};
Bo[_P].$=function () {
return this.divMain
};
Bo[_P].s8=function (a) {
var b=a[Sc];
if(b!=null&&b.contactId!=null)if(this.bt)this.bt.KC(b.contactId,a);
Ij(a);
return false
};
Bo[_P].$G=function (a) {
var b=this.j,c=b.Bh()[xc][od],d=c.substring(0,c.lastIndexOf("/")+1),e=d+"em?key="+b.Ze,f=new fg(this.j[mc]),g=f.b("a",{
href:No,"class":"btn onbtn"
},f.b("b",null,f.b("b",null,f.b("b",null,f.b("strong",
null,_M[680]))))),h=f.b("span",{
style:"padding-right: 10px;"
},"and then"),i=f.b("td",null,f.b("div",{
"class":"formCreatorOptions"
},f.b("div",{
style:"margin-bottom: 0.7em;"
},f.b("span",{
style:"font-weight: bold;color: #CC0000;"
},_M[677]),f.b("br"),f.b("span",{
style:""
},_M[678]),f.b("br"),f.b("span",{
style:""
},f.b("a",{
href:e,target:"_blank"
},e)),f.b("br"),f.b("div",{
style:"height:4pt;"
}),f.b("span",{
style:"color: #676767;font-size: 8pt;text-decoration:none;"
},_M[679])),f.b("table",{
style:""
},f.b("td",
{
style:"vertical-align:middle;"
},h),f.b("td",{
style:"veritcal-align:middle;"
},g))));
f.appendChild(a.insertRow(a[pd][E]),i)
};
Ra(Bo[_P],function () {
var a=this.G5,b=this.E8;
if(a!=null)Kj(a,"click",b);
this.G.cc();
this.G.dispose();
this.G=null;
if(this.ep) {
this.ep.dispose();
this.ep=null
}
});
function Eo(a,b) {
this.ya=a;
this.ra=b
}Eo[_P].Ks=function (a) {
var b=this.ra,c=this.ya;
if(c.Yi()==a)return true;
else {
if(!c.hv()) {
	ra(_M[675]);
	return false
}if(b.Oc)return b.save();
else if(b.isSaved()&&!this.ya.Pa().Da())return true
}return false
};
Eo[_P].dp=function (a,b) {
var c=this.ra,d=this.ya;
if(!b) {
c.Qw(d.Yi().Ll);
c.Qw(d.Yd().Ll);
c.Qw(d.Rm().Ll)
}d.Pa().cellSelection.Id(true);
d.wu().kT(a!=d.Yd());
d.Pa().gooffiLink.eF(a!=d.Yd())
};
Eo[_P].Ds=function (a) {
var b=this.ya;
b.resize();
if(Zf&&Uf) {
a.vm(false);
l.setTimeout(el(a,
a.vm,true),0)
}var c=this.ra.isSaved();
if(a==b.Yd())b.Dj.show(c);
else if(a==b.Rm())b.uj.show(c)
};
Eo[_P].VH=function (a) {
this.dp(a,true);
var b=this.ya;
if(a==b.Yd()) {
b.wu().kT(true);
b.Pa().gooffiLink.eF(true)
}
};
Eo[_P].qH=function () {
var a=this.ya;
a.Pa().L(true);
a.resize()
};
var Co=function (a,b,c,d) {
af.call(this);
this.ra=d;
this.j=b;
this.GO={
};
this.py={
};
this.Xr=null;
var e=T();
this.lh=e.b("div",{
"class":"winChatShare",id:"trixclient",style:"border:0px !important; width: 100%; height: 100%; display: none; overflow: hidden"
},"");
var f=this.ra.ya.Fd;
this.q=new mj(this);
this.q.listen(f,xi,this.Du);
this.q.listen(f,"adduser",this.Eu);
this.q.listen(f,yi,this.Gu);
var g=f.Bu();
if(g) {
for(var h=0;h<g[E];h++)this.Vl(g[h]);if(g[E]>0)if(S)Fh(b.Bh(),"load",R(this.Ly,this));else this.Ly()
}
};
Co.inherits(af);var Yo=ag?"9":"8";Co[_P].Ly=function () {
fi(this.Zba,0,this)
};
Co[_P].Zba=function () {
if(this.Xr)return ;
var a=bn(),b=a.Ia("t4tBaseUrl"),c=a.Ia("t4tArgs"),d={
title:_M[243],roster:"presence"
},e="",f=new En(b,c,d,this,e);
f.T4(this.lh);
this.Xr=f
};
Co[_P].Du=function (a) {
var b=this.ra.ya.Fd.Au(a.sessionNum);
this.Vl(b);
if(!this.Xr)this.Ly()
};
Co[_P].Eu=function (a) {
this.ra.bU(a.username)
};
Co[_P].Gu=function (a) {
delete this.py[a.username]
};
Co[_P].Vl=function (a) {
this.py[a.qy]=a;
if(kn) {
var b=new Cm(this.j,
a);
b.render()
}
};
Co[_P].$=function () {
return this.lh
};
Co[_P].dispose=function () {
if(!this.N()) {
Co.B.dispose.call(this);
this.GO=null;
this.py=null;
var a=this.q;
if(a) {
	a.dispose();
	this.q=null
}this.ra=null;
this.j=null;
this.lh=null;
var b=this.Xr;
if(b) {
	b.ls.DV();
	this.Xr=null
}
}
};
Co[_P].e8=function (a) {
if(a==2&&this.Xr.yc==3) {
var b=T();
b.zf(this.lh);
var c=b.b("div",{
	"class":"winChatError"
});
y(c,_M[472](Yo,"http://www.google.com/url?sa=D&q=http://www.macromedia.com/go/getflashplayer"));
b.appendChild(this.lh,c)
}
};
Co[_P].z7=function (a) {
this.GO[a]=true
};
Co[_P].B7=function (a) {
delete this.GO[a]
};
Co[_P].tP=function (a) {
var b=!this.py[a];
this.ra.$s(true,b)
};
Co[_P].HP=function (a) {
try{
var b=this.py[a];
if(b)this.ra.uO(b);
else {
	var c=this.j.activeGrid;
	if(c) {
		var d=c.Ga,e=c.Ea;
		c.Vc(d,e)
	}
}
}catch(f) {
this.j.log("Error in roster click: "+f)
}
};
Co[_P].Nw=function () {
};
var Zo="toastSaveAs",$o=1,ap=2,bp=3,cp=9,dp=11,ep=12,Mo=14,fp=16,gp=17,hp=21,Po=41,Qo=42,To=43,Ro=44,So=45,Uo=46,Vo=47,li=50,pi=51,ri=52,Ko=60,Jo=61,Io=62,Lo=70,Oo=101,ip=200,jp=201,kp=250,mp=251,np=252,op=253,pp=254,qp=270,rp=271,sp=272,tp=273,up=274;
function Ao(a,b,c,d,e,f,g,h,i,j,k) {
var m=bn(),n=m.Ia("docName");
this.Nh=m.Ia("os");
b.gooffiLink=this;
this.ya=k;
this.qa=a;
var q=a.lastIndexOf("/");
this.Ko=a.substring(0,q+1)+"ccc?";
this.Uz=n;
this.Oc=d;
this.logo=f+i;
this.j=b;
this.oa=b.W();
this.Wa=b.Bh();
this.Gc=e;
this.tR=false;
if(b.Da())this.tR=true;
this.Xw=j;
this.xv=g;
this.dd=c;
this.Zk=null;
this.Mn=null;
this.Ez=null;
this.Dz=null;
this.Gz=null;
this.dJ=null;
this.rO=null;
this.Jt=new Xh(this);
this.Ky=[[_M[213],,["New",0],null,null,2],[_M[250],,["Import",gp],null,null,2],[_M[214],,["Open",$o],null,null,2],[_M[207],,["Save",ap],null,null,2],[_M[221],,["Saveas",bp],null,null,2],,[_M[228],,["Print",ep],null,null,0],[_M[222],,["Export",0],[[_M[224],_M[233],["ExpCSV",5],null,null,0],[_M[226],_M[233],["ExpHTML",
7],null,null,0],[_M[227],,["ExpODS",13],null,null,0],[_M[225],,["ExpPDF",ep],null,null,0],[_M[347],_M[233],["ExpTXT",23],null,null,0],[_M[223],,["ExpXLS",4],null,null,0]],null,0],,[_M[229],,["Replace",15],null,null,1],[_M[230],,["Rename",cp],null,null,1],[_M[322],,["Settings",23],null,null,0]];
this.SW={
save:3,replace:9,rename:10,settings:11,deleteIt:-1
};
var p=this.Ky,s=this.SW,u={
notifications:[_M[485],,["Notifications",24],null,null,2],maestro:[ym("Znpebf")+"<sup class='red-super'>EXPERIMENTAL!</sup>",
,["Maestro",0],[[ym("Rqvg Znpebf..."),,["Maestro",qp],null,null,0],[ym("Eha Znpeb..."),,["RnMaestro",sp],null,null,0],[ym("Erpbeq Znpeb..."),,["RcMaestro",up],null,null,0]],null,0],close:[_M[232],,["Close",19],null,null,0]
};
p.push(u.notifications);
s.notifications=p[E]-1;
if(on) {
p.push(u.maestro);
s.maestro=p[E]-1
}p.push(u.close);
this.uR=false;
this.aw=false;
this.lU=false;
if(!this.Nh) {
if(n[E]==0) {
	this.Yg(_M[234],"");
	this.aw=true;
	this.Gc=false
}else if(!this.Gc)this.Yg(n,_M[237]);
else this.Yg(n,null);
this.fz();
z(g[to],d?Qk(this,this.WQ):"")
}this.iQ=null;
this.Cp=null;
this.pT()
}var vp="&fmcmd=";
Ao[_P].Taa=function (a) {
if(a) {
var b=this.Ko;
if(b.charAt(b[E]-1)!="?")b+="&";
this.Ko=b+"hl="+a+"&"
}
};
Ao[_P].Wba=function (a) {
var b=a.X[0];
z(b,Qk(this,this.oJ));
this.Cp=a
};
Ao[_P].$s=function (a,b,c) {
var d=this.ya.Yi();
if(c) {
d.notify(false);
return
}if(this.Gc) {
d.enable(true);
if(a&&!b&&!c)d.notify(true)
}else d.enable(false)
};
Ao[_P].bU=function (a) {
if(!this.ya.Yi().Na()) {
var b=_M[137](mm(a,25)),c=this.j;
if(!c.Da()) {
	b+="<br><a class='toastShare";
	b+="' href='#'>"+_M[138]+"</a>"
}c.Hg().gi(_M[136],b,5000,false)
}
};
Ao[_P].uO=function (a) {
var b=this.j,c=a.Kj;
if(c>=0) {
var d=b.pb(c);
if(c!=b.activeGrid.id)b.Nv(d[fc]);
b.Dy(c,R(function (e,f,g) {
	var h=e.info,i=h.idsTOrows[f],j=h.idsTOcols[g];
	if(i!=null&&j!=null)e.Vc(i,j)
},this,d,a.jB(),a.iB()))
}
};
Ao[_P].Qw=function (a) {
var b=this.ya.ue.Xt();
if(a==null) {
if(b==null)return ;
a=b.Ll
}var c=this.j.isIE;
if(!c&&b==this.ya.Yi())this.ya.Ei.Nw();
var d=a.$()[J],e=this.ya,f=c&&this.j.Da()?29:0;
if(a==this.ya.Yd().Ll) {
ib(d,
0);
var g=e.ue.J();
Lb(d,80);
a.Pd(e.heiApp-g[Id]);
x(d,"100%")
}else {
ib(d,e.leftChat);
var g=e.ue.J();
a.Pd(e.heiApp+(e.heiMenus-e.heiMenusForTabs)-g[Id]+f)
}d.top=e.heiMenusForTabs+g[Ed]+g[Id]+(c?38:37)-f
};
Ao[_P].xZ=function (a) {
var b=hm(this.qa+vp+dp+"&otherkey="+a,"",false),c=qi(eval(b[pc]),_M[148]);
if(c!=null)return true;
return false
};
Ao[_P].NJ=function (a,b) {
var c=this.Gc&&this.Oc,d=a.Gb;
for(var e=0;e<d[E];e++) {
var f=d[e];
if(f!=null&&f.jd()!=3)if(!f.subMenu)if(b[e][5]==0||c||b[e][5]==2&&this.ya.hv())z(f.J(),
el(this,this.HO,f));
else f.enable(false);
else if(f&&f.subMenu)this.NJ(f.subMenu,b[e][3])
}
};
Ao[_P].oJ=function () {
if(!this.ev())return false;
var a=this.Zk;
if(a==null) {
var a=new Ml(this.j.W(),this.dd,this.Ky,true);
this.NJ(a,this.Ky);
this.Zk=a
}if(this.Gc||!this.Oc)this.fz();
if(a.Ka)this.P();
else {
this.j.P();
var b=this.ya.getDivApp(),c=this.Cp.X[0];
a.Sa("",b[Cc]+c[Cc],b[Ed]+(S?35:0)+c[Id]+6)
}this.j.L(false,true)
};
Ao[_P].HO=function (a) {
var b=this.j,c=a.Cn,d=c[0];
this.P();
if(d=="New")this.W6(false);
else if(d==
"Open")this.yca();
else if(d=="Save")this.Tg(false);
else if(d=="Saveas")this.Tg(true);
else if(d=="Print")this.wF(true);
else if(d=="ExpHTML")b.hQ();
else if(d=="Settings")this.Gca();
else {
var e=this.qa+vp+c[1];
if(d=="ExpXLS"||d=="ExpODS")this.kA(e);
else if(d=="ExpPDF")this.wF(false);
else if(d=="ExpCSV"||d=="ExpTXT")this.kA(e+"&gid="+this.j.activeGrid.id,true);
else if(d=="Replace")this.Eca(e);
else if(d=="Import")this.tca(e);
else if(d=="Rename")this.WQ(e);
else if(d=="Delete")this.zZ(e);
else if(d=="Close")this.cz();
else if(d=="Notifications")this.vca();
else if(d=="Maestro")this.Fca();
else if(d=="RnMaestro")this.t$();
else if(d=="RcMaestro")this.k9()
}
};
Ao[_P].wF=function (a) {
if(this.iQ==null)this.iQ=new no(this.j,this,this.qa+vp+ep,a);
else this.iQ.show(a)
};
Ao[_P].v$=function () {
this.j.Ya(false,true);
if(this.save())this.cz()
};
Ao[_P].cz=function (a) {
var b=this.Wa;
if(!a&&b.opener&&!b.opener[yc])b.close();
else zb(b[xc],this.ya.N0())
};
Ao[_P].W6=function (a) {
if(!this.ev())return false;
this.yn(this.Ko+"new=true",a)
};
Ao[_P].zZ=
function (a) {
if(!la(_M[141](this.Uz,"\n")))return false;
var b=hm(a,"",false),c=qi(eval(b[pc]),_M[148]);
if(c!=null)this.yn(this.Ko+"new=true",true)
};
Ao[_P].t8=function (a) {
this.Mn.D(false);
this.yn(this.Ko+"key="+a,this.aw)
};
Ao[_P].WQ=function (a) {
if(!a) {
if(!this.Gc) {
	this.save();
	return
}a=this.qa+vp+cp
}if(!this.Gc) {
ra(_M[143]);
return false
}var b=um(_M[144],this.Uz);
if(!b)return false;
var c=hm(a+"&name="+fa(b),"",false),d=qi(eval(c[pc]),_M[148]);
if(d!=null)this.Yg(b,null)
};
Ao[_P].mba=function (a) {
var b=this.j,
c=this.ya;
if(!a) {
b.P();
c.Fd.HX()
}this.eF(a);
if(a) {
this.Yg(null,this.Gc?_M[220](this.Xw):"");
this.j.activeGrid.nj()
}c.ue.display(a);
if(b.uh)c.Naa(a);
b.Wn()
};
Ao[_P].eF=function (a) {
var b=this.Cp;
b.enable(a);
if(a)z(b.X[0],Qk(this,this.oJ));
var c={
type:a?"fileMenuEnabled":"fileMenuDisabled"
};
this.Jt.dispatchEvent(c)
};
Ao[_P].Uaa=function (a) {
if(this.Gc&&a!=null)this.Yg(null,_M[220](a))
};
Ao[_P].Yg=function (a,b) {
this.eba(a);
this.hba(b)
};
Ao[_P].eba=function (a) {
if(a!=null) {
this.Uz=a;
if(!this.Nh) {
	a=mm(a,40);
	wp(this.oa,this.xv[to],a);
	Ea(oa,a+" - "+_M[256]+(this.tR?_M[242]:""))
}
}
};
Ao[_P].hba=function (a) {
if(a!=null&&!this.Nh) {
var b=this.xv[vo];
y(b,this.j.Da()?_M[152]:(a!=null&&this.isSaved()?a:""))
}
};
Ao[_P].yn=function (a,b) {
if(b) {
this.fE(true);
var c=this.oa[xc];
if(a==null)c.replace(lm(c[od]));
else zb(c,a)
}else jm(a)
};
Ao[_P].yca=function () {
if(!this.ev())return false;
this.j.P();
var a=this.Mn;
if(!a) {
a=new xp(this.j,this.qa+vp+fp,this);
this.Mn=a
}a.D(true);
var b=hm(this.qa+vp+$o,"",true);
Ba(b,el(this,this.xca,
b))
};
Ao[_P].Gca=function () {
var a=this.Gz;
if(!a) {
a=new yp(this.j);
this.Gz=a
}a.D(true)
};
Ao[_P].Eca=function (a) {
var b=this.Ez;
if(!b) {
b=new zp(this.j,a,this);
this.Ez=b
}b.D(true)
};
Ao[_P].tca=function (a) {
var b=this.Dz;
if(!b) {
b=new Ap(this.j,a,this);
this.Dz=b
}b.D(true)
};
Ao[_P].RM=function (a,b,c) {
b.Ye(0);
if(b.screen)b.screen.hide();
else b.D(false);
if(this.Mn==b||binstanceofAp)if(a==null)this.yn(null,true);
else this.yn(this.Ko+"key="+a,c)
};
Ao[_P].xca=function (a) {
if(a[Yc]==4) {
var b=eval(a[pc]);
this.Mn.show(b)
}
};
Ao[_P].save=function () {
if(!this.Gc)this.Tg(false);
return this.Gc
};
Ao[_P].Tg=function (a) {
this.uR=true;
this.j.Hg().e4(Zo);
if(!this.ev())return false;
var b=this.qa,c=um(_M[145],a?_M[236](this.Uz):_M[235]);
if(c) {
var d=fa(c);
b+=this.Gc?vp+bp+"&name="+d:vp+ap+"&name="+d
}else return false;
var e=this.oa[Lc][J];
Ga(e,"wait");
var f=hm(b,"",false);
Ga(e,"auto");
var g=qi(f[pc],_M[148]);
if(g!=null)if(a&&this.Gc) {
this.fE(true);
zb(this.oa[xc],this.Ko+"key="+g)
}else {
this.Gc=true;
this.Yg(c,_M[220](g));
this.fz()
}
};
Ao[_P].vca=
function () {
this.j.QT()
};
Ao[_P].Fca=function () {
if(!this.dJ)this.dJ=new Bp(this.j);
this.dJ.show()
};
Ao[_P].t$=function () {
if(!this.rO)this.rO=new Cp(this.j);
this.rO.run()
};
Ao[_P].k9=function () {
if(!this.oZ)this.oZ=new Dp(this.j);
this.oZ.show()
};
Ao[_P].fz=function () {
this.dY();
this.cY();
this.eY()
};
Ao[_P].dY=function () {
var a=this.SW,b=this.Gc;
if(b&&this.Oc)this.dA(a.rename);
var c=this.j.Da();
if(b&&!c)this.dA(a.replace);
if(b||!this.Oc) {
var d=this.Zk;
if(d!=null) {
	var e=d.Gb;
	e[a.save].enable(false);
	d.ea(a.save,
	_M[238]);
	if(c) {
		e[a.replace].enable(false);
		e[a.settings].enable(false)
	}else this.dA(a.settings)
}
}
};
Ao[_P].cY=function () {
if(this.Nh)return ;
var a=this.xv;
if(!a[yo].X[0].onclick)z(a[yo].X[0],el(this,this.v$,false));
var b=uo;
if(this.Gc||!this.Oc) {
a[b].enable(false);
a[b].cg("<strong>"+_M[238]+"</strong>");
a[b].Dx(_M[239])
}else {
a[b].enable(true);
z(a[b].X[0],el(this,this.Tg,false))
}
};
Ao[_P].eY=function () {
if(this.Nh)return ;
if(this.Gc||!this.Oc)if(this.lU)this.ez()
};
Ao[_P].ez=function () {
var a=this.ya.Yd(),
b=this.ya.Yi(),c=this.ya.Rm(),d=this.Oc||this.Gc&&!this.j.Da();
a.enable(d);
c=a.enable(d);
if(!this.lU)b.enable(false);
this.$s();
this.lU=true
};
Ao[_P].dA=function (a) {
var b=this.Zk;
if(b!=null) {
var c=b.Gb[a];
c.enable(true);
z(c.J(),el(this,this.HO,c))
}
};
Ao[_P].kA=function (a,b) {
this.fE(false);
if(b)this.Wa.open(a);
else km(a,this.oa,this.Wa);
this.pT()
};
Ao[_P].fE=function (a) {
if(a)this.Ay();
this.Wa.onbeforeunload=null;
this.Wa.onunload=null
};
Ao[_P].pT=function () {
this.Wa.onbeforeunload=Qk(this,this.Rda)
};
Ao[_P].Rda=
function () {
if(this.k_()) {
this.Wa.onunload=Qk(this,this.Ay);
return _M[147]
}else this.Ay()
};
Ao[_P].k_=function () {
return !this.aw&&!this.Gc
};
Ao[_P].Ay=function () {
this.j.OF();
var a=this.qa+vp+hp;
hm(a,"",false)
};
Ao[_P].Hba=function (a) {
var b=this.qa+vp+ip,c="soc="+a;
hm(b,c,true);
Em(a)
};
Ao[_P].Xd=function (a) {
return this.qa+vp+a
};
Ao[_P].Tx=function (a,b) {
var c=new Lm;
c.set("fmcmd",jp);
c.set("oid",a);
c.set("gups",b);
mi(this.qa,null,"POST",c.toString ())
};
Ao[_P].e7=function (a,b,c) {
if(a!=null) {
if(!this.uR&&!this.Gc) {
	var d=
	b!=null;
	for(var e=0;!d&&e<a[E];e++)if(a[e].t==null)d=true;else if(a[e].t<X.toast)d=true;if(d&&c) {
		var f=this.j;
		if(!f.Da())f.Hg().gi(_M[133],_M[134]+"<br><a class='"+Zo+"' href='#'>"+_M[135]+"</a>",-1,true,Zo);
		this.uR=true
	}
}if(c)this.aw=false;
for(var e=0;e<a[E];e++)if(a[e].g==null) {
	var g=a[e].t,h=this.ya;
	switch(g) {
		case X.addUser:var i=h.Fd;
		if(i.jc()) {
			var j=this.j.activeGrid;
			gm(j,j.nj,sn)
		}i.iH(a[e].tu,a[e].ts);
		break;
		case X.deleteUser:h.Fd.tp(a[e].ts);
		break;
		case X.setUsers:h.Fd.hT(a[e].v);
		break;
		case X.newIM:if(h.Ei)h.Ei.cH(a[e].v);
		break;
		case X.errorReload:var k=a[e].msg;
		if(k!=null) {
			this.j.OF();
			ra(a[e].msg)
		}gm(this,this.yn,50,null,true);
		break;
		case X.renameDoc:this.Yg(a[e].v,null);
		break;
		case X.lastSaved:this.Yg(null,_M[220](a[e].v));
		this.Xw=a[e].v;
		break;
		case X.mode:if(a[e].u==1)if(h.Dj)h.Dj.BU();
		this.j.Z6();
		break;
		case X.publish:if(a[e].u==1)if(h.uj)h.uj.ZU();
		break;
		case X.aclRulesUpdate:this.j.log("aclRulesUpdate: "+a[e].v);
		break;
		default:break
	}
}else {
	var g=a[e].t;
	if(X[kc]==g) {
		if(kn) {
			var m=a[e],n=this.ya.Fd.Au(m.ts);
			n.lG(m.g,m.ar,
			m.ac,m.edit)
		}
	}else {
		var q=this.ya.uj;
		if(q)switch(g) {
			case X.newGrid:q.bH(a[e].ng,a[e].nm);
			break;
			case X.removeGrid:q.J9(a[e].g);
			break;
			case X.renameGrid:q.Q9(a[e].g,a[e].nm);
			break;
			default:break
		}
	}
}
}
};
Ao[_P].Xg=function (a) {
if(this.Nh)return ;
var b=this.xv;
this.tR=a;
if(this.Xw!=null&&this.Xw!="")this.Yg(null,_M[220](this.Xw));
var c=this.ya,d=!a;
b[uo].display(d);
b[yo].display(d);
c.Yd().display(d);
c.Rm().display(d);
if(!a)this.ez()
};
Ao[_P].P=function () {
if(this.Zk!=null) {
this.Zk.Fi();
this.Zk.Sa("none")
}
};
Ao[_P].ev=
function () {
return this.j.Ya(false)
};
Ao[_P].Zx=function (a) {
if(!this.j.Da())switch(a) {
case Zo:this.save();
break;
case "toastShare":this.ya.Yd().activate(true);
break;
default:break
}
};
Ao[_P].isSaved=function () {
return this.Gc
};
Ao[_P].xN=function () {
return !this.aw
};
Ra(Ao[_P],function () {
var a;
a=this.Mn;
if(a)a.dispose();
this.Mn=null;
a=this.Gz;
if(a)a.dispose();
this.Gz=null;
a=this.Ez;
if(a)a.dispose();
this.Ez=null;
a=this.Dz;
if(a)a.dispose();
this.Dz=null;
if(this.dd)y(this.dd,"");
if(this.Cp)this.Cp.cleanup();
if(this.Jt) {
this.Jt.dispose();
this.Jt=null
}this.ya=null;
this.j=null;
this.dd=null;
this.Wa=null;
this.oa=null;
this.xv=null;
this.Zk=null;
this.Ky=null;
this.Cp=null;
if(this.j)this.j.cleanup()
});
var Ep=function (a,b,c,d,e) {
if(/[;
=]/.test(a))throwError('Invalid cookie name "'+a+'"');
if(/;
/.test(b))throwError('Invalid cookie value "'+b+'"');
if(!Vd(c))c=-1;
var f=e?";domain="+e:"",g=d?";path="+d:"",h;
if(c<0)h="";
else if(c==0) {
var i=new Date(1970,1,1);
h=";expires="+i.toUTCString()
}else {
var j=new Date((new Date).getTime()+c*1000);
h=";expires="+j.toUTCString()
}oa.cookie=a+"="+b+f+g+h
},Fp=function (a,b) {
var c=a+"=",d=ha(oa.cookie).split(/\s*;
\s/);
for(var e=0,f;f=d[e];e++)if(f.indexOf(c)==0)return f.substr(c[E]);
return b
},Hp=function (a,b,c) {
var d=Gp(a);
Ep(a,"",0,b,c);
return d
},Gp=function (a) {
var b={
};
return Fp(a,b)!==b
};
var Ip={
},Jp=false,Kp="",Lp=function (a) {
Jp=a
},Mp=function () {
try{
Hp(Jp?"HUSER":"GAUSER")
}catch(a) {
Kp=""
}
};
var Np=function () {
this.Pi=[]
};
Np[_P].Pf=0;
Np[_P].Hj=0;
Np[_P].enqueue=function (a) {
this.Pi[this.Hj++]=a
};
Np[_P].dequeue=function () {
if(this.Pf==this.Hj)return undefined;
var a=this.Pi[this.Pf];
delete this.Pi[this.Pf];
this.Pf++;
return a
};
Np[_P].peek=function () {
if(this.Pf==this.Hj)return undefined;
return this.Pi[this.Pf]
};
Np[_P].Kc=function () {
return this.Hj-this.Pf
};
Np[_P].jc=function () {
return this.Hj-this.Pf==0
};
Db(Np[_P],function () {
this.Pi=[];
this.Pf=0;
this.Hj=0
});
Cb(Np[_P],function () {
return Yg(this.Pi)
});
nb(Np[_P],function (a) {
var b=df(this.Pi,a);
if(b<0)return false;
if(b==this.Pf)this.dequeue();
else {
nf(this.Pi,b);
this.Hj--
}return true
});
Np[_P].Fb=function () {
var a=[];
for(var b=this.Pf;b<this.Hj;b++)a.push(this.Pi[b]);return a
};var Op=function (a) {
this.yO=a||100;
this.Sj=[]
};
Op[_P].Iq=0;
Op[_P].add=function (a) {
this.Sj[this.Iq]=a;
this.Iq=(this.Iq+1)%this.yO
};
Op[_P].get=function (a) {
a=this.nP(a);
return this.Sj[a]
};
Op[_P].set=function (a,b) {
a=this.nP(a);
this.Sj[a]=b
};
Op[_P].Kc=function () {
return this.Sj[E]
};
Op[_P].jc=function () {
return this.Sj[E]==0
};
Db(Op[_P],function () {
Da(this.Sj,0);
this.Iq=0
});
Op[_P].Fb=function () {
return this.u1(this.Kc())
};
Op[_P].u1=function (a) {
var b=this.Kc(),c=this.Kc()-a,d=[];
for(var e=c;e<b;e++)d[e]=this.get(e);
return d
};Op[_P].vd=function () {
var a=[],b=this.Kc();
for(var c=0;c<b;c++)a[c]=c;return a
};Op[_P].bd=function (a) {
return a<this.Kc()
};
Op[_P].im=function (a) {
var b=this.Kc();
for(var c=0;c<b;c++)if(this.get(c)==a)return true;return false
};Op[_P].nP=function (a) {
if(a>=this.Sj[E])throwError("Out of bounds exception");
if(this.Sj[E]<this.yO)return a;
return (this.Iq+ja(a))%this.yO
};
var Qp=function (a,b) {
var c=b;
if(!c) {
c=new Jm("http://www.google.com/url");
c.An();
c.Hl("q","http://www.google.com/images/cleardot.gif")
}Pp(c.toString (),10000,a)
},Sp=function (a,b,c,d,e) {
var f=new Rp;
f.debug("TestLoadImageWithRetries: "+e);
if(d==0) {
c(false);
return
}if(!e)e=0;
d--;
Pp(a,b,function (g) {
if(g)c(true);
else Td.setTimeout(function () {
	Sp(a,b,c,d,e)
},e)
})
},Pp=function (a,b,c) {
var d=new Rp;
d.debug("TestLoadImage: loading "+a);
var e=new Image;
ua(e,function () {
try{
	d.debug("TestLoadImage: loaded");
	Tp(e);
	c(true)
}catch(f) {
	d.Oi(f)
}
});
e.onerror=function () {
try{
	d.debug("TestLoadImage: error");
	Tp(e);
	c(false)
}catch(f) {
	d.Oi(f)
}
};
e.onabort=function () {
try{
	d.debug("TestLoadImage: abort");
	Tp(e);
	c(false)
}catch(f) {
	d.Oi(f)
}
};
e.ontimeout=function () {
try{
	d.debug("TestLoadImage: timeout");
	Tp(e);
	c(false)
}catch(f) {
	d.Oi(f)
}
};
Td.setTimeout(function () {
if(e.ontimeout)e.ontimeout()
},b);
e.src=a
},Tp=function (a) {
ua(a,null);
a.onerror=null;
a.onabort=null;
a.ontimeout=null
};
var Rp=function () {
this.La=rk("goog.net.BrowserChannel")
};
Rp[_P].sea=function (a,b,c,d,e) {
this.La.info("XMLHTTP REQ ("+c+") [attempt "+d+"]: "+a+"\n"+b+"\n"+this.y6(e))
};
Rp[_P].tea=function (a,b,c,d,e,f) {
this.La.info("XMLHTTP RESP ("+c+") [ attempt "+d+"]: "+a+"\n"+b+"\n"+e+" "+f)
};
Rp[_P].Oo=function (a,b,c) {
this.La.info("XMLHTTP TEXT ("+a+"): "+this.xQ(b)+(c?" "+c:""))
};
Rp[_P].Jda=function (a,b,c,d) {
this.La.info("TRIDENT REQ ("+c+") [ attempt "+d+"]: "+a+"\n"+b)
};
Rp[_P].Lda=function (a,b) {
this.La.info("TRIDENT TEXT ("+
a+"): "+this.xQ(b))
};
Rp[_P].Kda=function (a,b) {
this.La.info("TRIDENT TEXT ("+a+"): "+b?"success":"failure")
};
Rp[_P].oda=function (a) {
this.La.info("TIMEOUT: "+a)
};
Rp[_P].info=function (a) {
this.La.info(a)
};
Rp[_P].debug=function (a) {
this.La.info(a)
};
Rp[_P].warning=function (a) {
this.La.warning(a)
};
Rp[_P].Oi=function (a,b) {
this.La.severe(b||"Exception",a)
};
Rp[_P].xQ=function (a) {
if(!a||a=="y2f%")return a;
try{
var b=ni(a);
for(var c=0;c<b[E];c++)if(ce(b[c]))this.x6(b[c]);return ki(b)
}catch(d) {
this.debug("Exception parsing expected JS array - probably was not JS");
return a
}
};
Rp[_P].x6=function (a) {
if(a[E]<2)return ;
var b=a[1];
if(!ce(b))return ;
if(b[E]<1)return ;
var c=b[0];
if(c!="c"&&c!="noop"&&c!="stop")for(var d=1;d<b[E];d++)b[d]=""
};Rp[_P].y6=function (a) {
if(!a)return null;
var b="",c=a.split("&");
for(var d=0;d<c[E];d++) {
var e=c[d],f=e.split("=");
if(f[E]>1) {
	var g=f[0],h=f[1],i=g.split("_");
	b+=i[E]>=2&&i[1]=="type"?g+"="+h+"&":g+"=redacted&"
}
}return b
};
var Up=function (a,b,c,d) {
this.Kb=a;
this.U=b;
this.Ej=c;
this.Rg=d;
this.pR=45000
};
Up[_P].wO=0;
Up[_P].dg=false;
Up[_P].Mo=null;
Up[_P].rG=null;
Up[_P].xj=0;
Up[_P].Ic=null;
Up[_P].Qj=null;
Up[_P].Se=null;
Up[_P].Sq=null;
Up[_P].xe=null;
Up[_P].yy=null;
Up[_P].eg=null;
Up[_P].Lo=null;
Up[_P].yc=null;
Up[_P].kc=-1;
Up[_P].RR=true;
Up[_P].Yl=false;
var Vp={
},Wp={
};
Up[_P].ux=function (a) {
this.wO=a
};
Up[_P].zba=function (a) {
this.pR=a
};
Up[_P].qV=function (a,b,c) {
this.Ic=1;
this.Qj=a.clone().An();
this.Sq=b;
this.rZ=c;
this.UE()
};
Up[_P].uG=function (a,b,c) {
this.Ic=1;
this.Qj=a.clone().An();
this.Sq=null;
this.rZ=b;
if(c)this.RR=false;
this.UE()
};
Up[_P].UE=function () {
this.Se=this.Qj.clone();
this.Se.Hl("t",this.xj+1);
this.yy=0;
this.xe=new Mk;
Dh(this.xe,Nj,this.pV,false,this);
if(this.Sq) {
this.Lo="POST";
var a={
};
a["Content-Type"]="application/x-www-form-urlencoded";
this.xe.send(this.Se,this.Lo,this.Sq,a)
}else {
this.Lo="GET";
var a={
};
if(this.RR)a.Connection="close";
this.xe.send(this.Se,this.Lo,null,a)
}this.U.sea(this.Lo,this.Se,this.Rg,
this.xj+1,this.Sq);
this.Ap()
};
Up[_P].pV=function (a) {
var b=a[Sc];
Xp();
try{
if(b==this.xe)this.n8();
else this.U.warning("Called back with an unexpected xmlhttp")
}catch(a) {
this.U.debug("Failed call to OnXmlHttpReadyStateChanged_");
if(this.xe&&this.xe.Gg())this.U.Oi(a,"ResponseText: "+this.xe.Gg());
else this.U.Oi(a,"No response text")
}finally{
Yp()
}
};
Up[_P].n8=function () {
var a=this.xe.Sm();
if(S||Wf&&cg(Yf,"420+")<0) {
if(a<4)return
}else if(a<3)return ;
this.Ls();
var b=this.xe.Ck();
this.kc=b;
var c=this.xe.Gg();
if(!c)this.U.debug("No response text for uri "+this.Se+" status "+b);
this.dg=b==200;
this.U.tea(this.Lo,this.Se,this.Rg,this.xj+1,a,b);
if(!this.dg) {
if(b==400&&c.indexOf("Unknown SID")>0) {
	this.yc=3;
	Zp(13)
}else {
	this.yc=0;
	Zp(14)
}this.U.Oo(this.Rg,c);
this.$l();
this.aD();
return
}if(a==4)this.$l();
if(this.rZ) {
while(!this.Yl&&this.yy<c[E]) {
	var d=this.v1(c);
	if(d==Wp) {
		if(a==4) {
			this.yc=4;
			Zp(15);
			this.dg=false
		}this.U.Oo(this.Rg,null,"[Incomplete Response]");
		break
	}else if(d==Vp) {
		this.yc=4;
		Zp(16);
		this.U.Oo(this.Rg,
		c,"[Invalid Chunk]");
		this.dg=false;
		break
	}else {
		this.U.Oo(this.Rg,d,null);
		this.tE(d)
	}
}if(a==4&&c[E]==0) {
	this.yc=1;
	Zp(17);
	this.dg=false
}
}else {
this.U.Oo(this.Rg,c,null);
this.tE(c)
}if(!this.dg) {
this.U.Oo(this.Rg,c,["Invalid Chunked Response"]);
this.$l();
this.aD();
return
}if(!this.Yl)if(a==4)this.Kb.In(this);
else {
this.dg=false;
this.Ap()
}
};
Up[_P].v1=function (a) {
var b=this.yy,c=a.indexOf("\n",b);
if(c==-1)return Wp;
var d=a.substring(b,c),e=ja(d);
if(qa(e))return Vp;
var f=c+1;
if(f+e>a[E])return Wp;
var g=a.substr(f,
e);
this.yy=f+e;
return g
};
Up[_P].xU=function (a,b) {
this.Ic=3;
this.Qj=a.clone().An();
this.Mda(b)
};
Up[_P].Mda=function (a) {
this.eg=new ActiveXObject("htmlfile");
var b="",c="<html>";
if(a) {
b=l[xc][Hc];
c+='<script>document.domain="'+b+'"<\/script>'
}c+="</html>";
this.eg.open();
this.eg.write(c);
this.eg.close();
this.eg[qd].m=R(this.j8,this);
this.eg[qd].d=R(this.IP,this,true);
this.eg[qd].rpcClose=R(this.IP,this,false);
var d=this.eg.createElement("div");
this.eg.appendChild(d);
this.Se=this.Qj.clone();
this.Se.ua("DOMAIN",
b);
this.Se.ua("t",this.xj+1);
y(d,'<iframe src="'+this.Se+'"></iframe>');
this.U.Jda("GET",this.Se,this.Rg,this.xj+1);
this.Ap()
};
Up[_P].j8=function (a) {
$p(R(this.i8,this,a),0)
};
Up[_P].i8=function (a) {
if(this.Yl)return ;
this.U.Lda(this.Rg,a);
this.Ls();
this.tE(a);
this.Ap()
};
Up[_P].IP=function (a) {
$p(R(this.h8,this,a),0)
};
Up[_P].h8=function (a) {
if(this.Yl)return ;
this.U.Kda(this.Rg,a);
this.Ls();
this.$l();
this.dg=a;
this.Kb.In(this)
};
Up[_P].S$=function (a) {
this.Ic=2;
this.Qj=a.clone().An();
this.w4()
};
Up[_P].w4=
function () {
var a=new Image;
a.src=this.Qj;
this.Ap()
};
Up[_P].cancel=function () {
this.Yl=true;
this.Ls();
this.$l()
};
Up[_P].Ap=function () {
this.rG=ne()+this.pR;
this.fU(this.pR)
};
Up[_P].fU=function (a) {
if(this.Mo!=null)throwError("WatchDog timer not null");
this.Mo=$p(R(this.k8,this),a)
};
Up[_P].Ls=function () {
if(this.Mo) {
Td.clearTimeout(this.Mo);
this.Mo=null
}
};
Up[_P].k8=function () {
this.Mo=null;
var a=ne();
if(a-this.rG>0)this.C3();
else {
this.U.warning("WatchDog timer called too early");
this.fU(this.rG-a)
}
};
Up[_P].C3=
function () {
if(this.dg)this.U.debug("Received watchdog timeout even though request loaded successfully");
this.U.oda(this.Se);
this.$l();
this.yc=2;
Zp(18);
this.aD()
};
Up[_P].aD=function () {
if(this.Kb.mv()||this.Yl)return ;
this.U.debug("Maybe retrying, last error: "+this.L_(this.yc));
if(this.yc==3||this.yc==0) {
this.U.debug("Not retrying due to error type");
this.Kb.In(this)
}else if(this.xj>=this.wO) {
this.U.debug("Exceeded max number of retries");
this.Kb.In(this)
}else {
this.U.debug("Going to retry");
var a=5000+
o.floor(o.random()*10000);
if(!this.Kb.Na()) {
	this.U.debug("Inactive channel");
	a=a*2
}a=a*(this.xj+1);
$p(R(this.o$,this),a)
}
};
Up[_P].o$=function () {
this.xj++;
if(this.Ic==1)this.UE()
};
Up[_P].L_=function (a) {
switch(a) {
case 0:return "Non-200 return code ("+this.kc+")";
case 1:return "XMLHTTP failure (no data)";
case 2:return "HttpConnection timeout";
default:return "Unknown error"
}
};
Up[_P].$l=function () {
if(this.xe) {
var a=this.xe;
this.xe=null;
Gh(a,Nj,this.pV,false,this);
a.abort()
}if(this.eg)this.eg=null
};
Up[_P].dj=
function () {
return this.Ej
};
Up[_P].tE=function (a) {
try{
this.Kb.FD(this,a)
}catch(b) {
this.U.Oi(b,"Error in httprequest callback")
}
};
var aq=function (a,b) {
this.Kb=a;
this.U=b
};
aq[_P].Te=null;
aq[_P].zw=false;
aq[_P].Cm=null;
aq[_P].JC=null;
aq[_P].Yb=null;
aq[_P].Ma=null;
aq[_P].kc=-1;
aq[_P].hj=null;
aq[_P].Oy=null;
aq[_P].connect=function (a) {
this.Yb=a;
var b=this.Kb.bL(this.Yb);
Zp(3);
b.Hl("MODE","init");
this.Te=new Up(this,this.U);
this.Te.ux(0);
this.Te.uG(b,false,true);
this.Ma=0
};
aq[_P].wX=function () {
var a=this.Kb.lz(this.Oy,"/mail/images/cleardot.gif");
a.An();
Sp(a,5000,R(this.vX,this),3,2000)
};
aq[_P].vX=function (a) {
if(a) {
this.Ma=2;
this.yI()
}else {
Zp(4);
this.Kb.hda(this)
}
};
aq[_P].yI=function () {
this.U.debug("TestConnection: starting stage 2");
this.Te=new Up(this,this.U);
this.Te.ux(0);
var a=this.Kb.JK(this.hj,this.Yb);
Zp(5);
if(S) {
a.Hl("TYPE","html");
this.Te.xU(a,da(this.hj))
}else {
a.Hl("TYPE","xmlhttp");
this.Te.uG(a,false)
}
};
aq[_P].abort=function () {
if(this.Te) {
this.Te.cancel();
this.Te=null
}this.kc=-1
};
aq[_P].mv=function () {
return false
};
aq[_P].FD=function (a,b) {
this.kc=a.kc;
if(this.Ma==0) {
this.U.debug("TestConnection: Got data for stage 1");
if(!b) {
	this.U.debug("TestConnection: Null responseText");
	this.Kb.VF(this,4);
	return
}try{
	var c=ni(b)
}catch(d) {
	this.U.Oi(d);
	this.Kb.VF(this,4);
	return
}this.hj=this.Kb.uH?c[0]:null;
this.Oy=c[1]
}else if(this.Ma==2)if(this.zw) {
Zp(7);
this.JC=ne()
}else if(b=="11111") {
Zp(6);
this.zw=true;
this.Cm=ne()
}else {
Zp(8);
this.Cm=this.JC=ne();
this.zw=false
}
};
aq[_P].In=function () {
this.kc=this.Te.kc;
if(!this.Te.dg) {
this.U.debug("TestConnection: request failed, in state "+this.Ma);
if(this.Ma==0)Zp(9);
else if(this.Ma==2)Zp(10);
this.Kb.VF(this,this.Te.yc);
return
}if(this.Ma==0) {
this.U.debug("TestConnection: request complete for initial check");
if(this.Oy) {
	this.Ma=1;
	this.wX()
}else {
	this.Ma=2;
	this.yI()
}
}else if(this.Ma==2) {
this.U.debug("TestConnection: request complete for stage 2");
var a=false;
if(S) {
	var b=this.JC-this.Cm;
	a=b<200?false:true
}else a=this.zw;
if(a) {
	this.U.debug("Test connection succeeded; using streaming connection");
	Zp(12);
	this.Kb.oU(this,true)
}else {
	this.U.debug("Test connection failed; not using streaming");
	Zp(11);
	this.Kb.oU(this,false)
}
}
};
aq[_P].Na=function () {
return this.Kb.Na()
};
var bq=function (a) {
this.OX=a;
this.Ma=1;
this.mw=[];
this.U=new Rp
};
bq[_P].nA=null;
bq[_P].Lf=null;
bq[_P].Gf=null;
bq[_P].Yb=null;
bq[_P].St=null;
bq[_P].QH=null;
bq[_P].hj=null;
bq[_P].uH=true;
bq[_P].Yv=0;
bq[_P].G=null;
bq[_P].yA=null;
bq[_P].hm=null;
bq[_P].fV=null;
bq[_P].FW=true;
bq[_P].YN=-1;
bq[_P].kc=-1;
var cq=new Xh,dq=function (a,b) {
eh.call(this,"statevent",a);
this.stat=b
};
te(dq,eh);
var eq=function () {
},fq=function () {
};
bq[_P].connect=function (a,b,c) {
this.U.debug("connect()");
Zp(0);
this.Yb=b;
this.nA=c;
this.gY(a)
};
bq[_P].disconnect=function () {
this.U.debug("disconnect()");
this.eI();
if(this.Ma==3) {
var a=this.Yv++,b=this.St.clone();
b.ua("SID",this.Ej);
b.ua("RID",a);
b.ua("TYPE","terminate");
this.So(b);
var c=new Up(this,this.U,this.Ej,a);
c.S$(b);
this.vP()
}
};
bq[_P].dj=function () {
return this.Ej
};
bq[_P].gY=function (a) {
this.U.debug("connectTest_()");
this.hm=new aq(this,this.U);
this.hm.connect(a)
};
bq[_P].fY=function () {
this.U.debug("connectChannel_()");
this.I_(1);
this.St=this.bL(this.Yb);
this.PJ()
};
bq[_P].eI=function () {
if(this.hm) {
this.hm.abort();
this.hm=null
}if(this.Gf) {
this.Gf.cancel();
this.Gf=null
}if(this.Lf) {
this.Lf.cancel();
this.Lf=null
}
};
bq[_P].Sp=function () {
return this.G
};
bq[_P].xo=function (a) {
this.G=a
};
bq[_P].mv=function () {
return this.Ma==0
};
bq[_P].PJ=function () {
if(this.Lf)return ;
if(this.yA)return ;
this.yA=$p(R(this.d8,this),0)
};
bq[_P].d8=function () {
this.yA=null;
this.Sca()
};
bq[_P].Sca=function () {
this.U.debug("startForwardChannel_");
if(this.Ma==1) {
this.v8();
this.Ma=2
}else if(this.Ma==3) {
this.H_();
if(!this.rP())return ;
if(this.mw[E]==
0) {
	this.U.debug("startForwardChannel_ returned: nothing to send");
	return
}if(this.Lf) {
	this.U.debug("startForwardChannel_ returned: connection already in progress");
	return
}this.m6();
this.U.debug("startForwardChannel_ finished, sent request")
}
};
bq[_P].v8=function () {
this.U.debug("open_()");
this.Ma=2;
this.Yv=o.floor(o.random()*100000);
var a=this.Yv++,b=new Up(this,this.U,"",a),c=this.jJ(),d=this.St.clone();
d.ua("RID",a);
if(this.OX)d.ua("CVER",this.OX);
this.So(d);
b.qV(d,c,true);
this.Lf=b
};
bq[_P].m6=function () {
var a=
this.Yv++,b=this.St.clone();
b.ua("SID",this.Ej);
b.ua("RID",a);
this.So(b);
var c=this.jJ(),d=new Up(this,this.U,this.Ej,a);
d.ux(2);
d.zba(o.round(10000)+o.round(10000*o.random()));
this.Lf=d;
d.qV(b,c,true)
};
bq[_P].So=function (a) {
if(this.G) {
var b=this.G.RA(this);
if(b)Zg(b,function (c,d) {
	a.ua(d,c)
})
}
};
bq[_P].jJ=function () {
var a=["count="+this.mw[E]];
for(var b=0;b<this.mw[E];b++) {
var c=this.mw[b];
Zg(c,function (d,e) {
	a.push("req"+b+"_"+e+"="+fa(d))
})
}Da(this.mw,0);
return a.join("&")
};
bq[_P].H_=function () {
if(this.Gf)return ;
if(!this.rP())return ;
this.U.debug("Creating new HttpRequest");
this.Gf=new Up(this,this.U,this.Ej,"rpc");
var a=this.QH.clone();
a.ua("RID","rpc");
a.ua("SID",this.Ej);
a.ua("CI",this.fV?"0":"1");
a.ua("AID",this.YN);
this.So(a);
if(S) {
a.ua("TYPE","html");
this.Gf.xU(a,da(this.hj))
}else {
a.ua("TYPE","xmlhttp");
this.Gf.ux(3);
this.Gf.uG(a,true)
}this.U.debug("New Request created")
};
bq[_P].rP=function () {
if(this.G) {
var a=0;
if(a!=0) {
	this.U.debug("Handler returned error code from okToMakeRequest");
	this.ah(a);
	return false
}
}return true
};
bq[_P].oU=function (a,b) {
this.U.debug("Test Connection Finished");
this.fV=this.FW&&b;
this.kc=a.kc;
this.fY()
};
bq[_P].VF=function (a) {
this.U.debug("Test Connection Failed");
this.kc=a.kc;
this.ah(2)
};
bq[_P].hda=function () {
this.U.debug("Test Connection Blocked");
this.kc=this.hm.kc;
this.ah(9)
};
bq[_P].FD=function (a,b) {
if(this.Ma==0||this.Gf!=a&&this.Lf!=a)return ;
this.kc=a.kc;
if(this.Lf==a&&this.Ma==3) {
if(b!="y2f%") {
	this.U.debug("Bad data returned - missing/invald magic cookie");
	this.ah(11)
}
}else if(!ze(b)) {
var c=
ni(b);
this.y7(c)
}
};
bq[_P].In=function (a) {
this.U.debug("Request complete");
var b=false;
if(this.Gf==a) {
this.Gf=null;
b=true
}else if(this.Lf==a) {
this.Lf=null;
b=true
}if(!b)return ;
this.kc=a.kc;
if(this.Ma==0)return ;
if(!a.dg) {
this.U.debug("Error: HTTP request failed");
switch(a.yc) {
	case 1:this.ah(5);
	break;
	case 4:this.ah(10);
	break;
	case 3:this.ah(6);
	break;
	default:this.ah(2);
	break
}return
}this.PJ()
};
bq[_P].y7=function (a) {
var b=this.G&&this.G.Wy?[]:null;
for(var c=0;c<a[E];c++) {
var d=a[c];
this.YN=d[0];
d=d[1];
if(this.Ma==
2) {
	if(d[0]=="c") {
		this.Ej=d[1];
		this.hj=this.uH?d[2]:null;
		this.Ma=3;
		if(this.G)this.G.Xy(this);
		this.QH=this.JK(this.hj,this.Yb)
	}else if(d[0]=="stop")this.ah(7)
}else if(this.Ma==3)if(d[0]=="stop") {
	if(b&&b[E]) {
		this.G.Wy(this,b);
		Da(b,0)
	}this.ah(7)
}else if(d[0]=="noop") {
}else if(b)b.push(d);
else if(this.G)this.G.Vy(this,d)
}if(b&&b[E])this.G.Wy(this,b)
};
bq[_P].I_=function (a) {
if(this.Ma!=a)throwError("Invalid operation: expected channel state "+a+" got channel state "+this.Ma);
};
bq[_P].ah=function (a) {
this.U.info("Error code "+
a);
if(a==2||a==9) {
var b=null;
if(this.G)b=null;
Qp(R(this.ida,this,a),b)
}else this.xD(a)
};
bq[_P].ida=function (a,b) {
if(b) {
this.U.info("Successfully pinged google.com");
this.xD(a)
}else {
this.U.info("Failed to ping google.com");
this.xD(8)
}
};
bq[_P].xD=function (a) {
this.U.debug("HttpChannel: error - "+a);
if(a==8)Zp(1);
else Zp(2);
this.Ma=0;
this.vP();
this.eI()
};
bq[_P].vP=function () {
this.Ma=0;
this.kc=-1;
if(this.G)this.G.Uy(this)
};
bq[_P].bL=function (a) {
var b=this.lz(null,a);
this.U.debug("GetForwardChannelUri: "+
b);
return b
};
bq[_P].JK=function (a,b) {
var c=this.lz(S?a:null,b);
this.U.debug("GetBackChannelUri: "+c);
return c
};
bq[_P].lz=function (a,b,c) {
var d=l[xc],e;
e=a?a+"."+d[Hc]:d[Hc];
var f=c||d.port,g=Tm(d[cd],null,e,f,b);
if(this.nA)Zg(this.nA,function (h,i) {
g.ua(i,h)
});
g.ua("VER",6);
this.So(g);
return g
};
bq[_P].Na=function () {
return this.G.Na()
};
var $p=function (a,b) {
if(!ge(a))throwError("Fn must not be null and must be a function");
return Td.setTimeout(function () {
Xp();
try{
	a()
}finally{
	Yp()
}
},b)
},Xp=function () {
eq()
},
Yp=function () {
fq()
},Zp=function (a) {
var b=cq;
b.dispatchEvent(new dq(b,a))
},gq=function () {
};
gq[_P].Wy=null;
gq[_P].Xy=function () {
};
gq[_P].Vy=function () {
};
gq[_P].Uy=function () {
};
gq[_P].RA=function () {
return {
}
};
gq[_P].Na=function () {
return true
};
var hq=function (a) {
Xh.call(this);
this.fn={
};
this.G=new mj(this);
this.gb=a
};
te(hq,Xh);
hq[_P].cW=function (a,b) {
var c=ee(b)?b:b.src;
if(c)this.fn[a]=c
};
ob(hq[_P],function () {
xf(this.fn,this.d6,this)
});
hq[_P].d6=function (a,b) {
var c;
if(this.gb) {
var d=T(this.gb);
c=d.b("img")
}else c=new Image;
this.fn[b]=c;
var e=S?Nj:"load";
this.G.listen(c,[e,"abort","error"],this.R7);
c.id=b;
c.src=a
};
hq[_P].R7=function (a) {
var b=a[Kc];
if(b) {
if(S)if(b[Yc]==Mj)Bb(a,"load");
else return ;
if(a[N]=="load") {
	if(typeofb.naturalWidth==
	"undefined")b.naturalWidth=b[F];
	if(typeofb.naturalHeight=="undefined")b.naturalHeight=b[P]
}this.dispatchEvent({
	type:a[N],target:b
});
Cf(this.fn,b.id);
if(Bf(this.fn)) {
	this.dispatchEvent(Mj);
	if(this.G)this.G.cc()
}
}
};
hq[_P].M=function () {
if(this.fn)this.fn=null;
if(this.G) {
this.G.dispose();
this.G=null
}hq.B.M.call(this)
};
var iq=function (a,b,c,d) {
gq.call(this);
this.j=a;
this.jda=b;
this.rX=c;
this.y8=d;
this.Kb=null;
this.uA=false;
this.XB=null;
this.at=0;
this.di=null;
var e=a.uh,f=e?new Mk:null;
if(f)f.headers.set("Cache-Control","no-cache");
this.KA=f;
var g=e?new mj(this):null;
this.q=g;
if(g)g.listen(f,["success","error"],this.Nu)
};
iq.inherits(gq);
iq[_P].disconnect=function (a) {
this.uA=a;
if(a) {
ei(this.XB);
this.XB=null
}if(this.Kb!=null) {
this.Kb.disconnect();
this.Kb.xo(null)
}this.Kb=null
};
iq[_P].connect=function () {
var a=this.j;
if(a.uh&&a.wf)this.KA.send("./checkauth?r="+o.random());
this.g_()
};
iq[_P].g_=function () {
if(this.di) {
ei(this.di);
this.di=null
}if(this.uA)return false;
if(typeofbq=="undefined")l.status="Operating in non-collaborative mode!";
else {
this.at++;
var a=new bq("1");
a.xo(this);
a.connect(this.jda,this.rX,this.y8);
var b=this.Kb;
if(b)b.xo(null);
this.Kb=a
}
};
iq[_P].Nu=function () {
var a=this.KA;
if(a.vv()&&a.Gg()=="no") {
var b=this.j;
Lp(!ze(b.gV==null?"":ha(b.gV)));
Mp();
b.Bh()[xc].reload()
}
};
iq[_P].Oda=function () {
if(!this.uA) {
var a=
this.j;
if(a.getDivWholeApp().trixNode===a) {
	if(!a.uh)a.Bb(_M[348],true);
	if(this.at>(S?2:5))if(!a.wf)a.setDisconnectedMode(true);
	var b=500*o.pow(2,this.at);
	b=o.min(b,45000);
	this.di=fi(this.connect,b,this)
}else a.cleanup()
}
};
iq[_P].Xy=function () {
var a=this.j;
a.ai(_M[125]);
this.at=0;
a.Qu(false);
if(a.wf) {
a.setDisconnectedMode(false);
a.Bb(_M[349],true)
}
};
iq[_P].Vy=function (a,b) {
this.j.ZD(b[0])
};
iq[_P].Uy=function (a) {
if(a.mv()&&!this.uA) {
ei(this.XB);
var b=6000+o.random()*1000;
if(this.at>0)b=0;
this.XB=fi(this.Oda,
b,this)
}
};
iq[_P].dispose=function () {
if(this.Kb)this.disconnect(true);
this.j=null;
this.jda=null;
this.rX=null;
this.y8=null;
var a=this.KA;
if(a) {
a.dispose();
this.KA=null
}var b=this.q;
if(b) {
b.dispose();
this.q=null
}
};
iq[_P].RA=function () {
var a={
},b=this.j;
a.lsq=b.Cq;
var c=b.eh;
if(c)a.tfe=c;
return a
};
var kq=function (a,b,c,d,e,f,g,h) {
af.call(this);
this.qa=a;
this.hY=b;
this.iU=c;
this.ZJ=d;
this.NM=e;
this.impatienceTime=f;
this.qU=g;
this.ega=h;
this.hC=null;
this.$F=null;
this.R="";
this.qf=jq++
};
kq.inherits(af);
var jq=0;
kq[_P].NB=function () {
return this.qa
};
kq[_P].getContext=function () {
return this.hY
};
kq[_P].$=function () {
return this.R
};
kq[_P].lc=function (a) {
this.R=a
};
kq[_P].FS=function (a) {
this.hC=a
};
kq[_P].gT=function (a) {
this.$F=a
};
kq[_P].LX=function () {
if(this.hC) {
ei(this.hC);
this.hC=null
}if(this.$F) {
ei(this.$F);
this.$F=null
}
};
kq[_P].bb=function () {
return this.qf
};
kq[_P].dispose=function () {
if(!this.N()) {
af[_P].dispose.call(this);
this.LX();
this.NM=null;
this.iU=null;
this.ZJ=null;
this.qU=null;
this.hY=null;
this.R=null
}
};
var lq=function () {
af.call(this);
this.fg=new Np
};
lq.inherits(af);
lq[_P].Lg=function (a) {
this.fg.enqueue(a);
if(a.NM) {
var b=R(this.x4,this,a),c=fi(b,a.yga);
a.FS(c)
}if(this.fg.Kc()==1)this.jK()
};
lq[_P].jK=function () {
var a=this.fg.peek();
if(a) {
hm(a.NB(),a.$(),true,this,this.b$);
if(a.qU) {
	var b=R(this.Sc,this,a),c=fi(b,a.ega);
	a.gT(c)
}
}
};
lq[_P].x4=function (a) {
var b=this.fg.peek();
if(b&&b.bb()==a.bb()) {
a.NM.call(a.getContext(),a);
a.FS(null)
}
};
lq[_P].Sc=function (a) {
var b=this.fg.peek();
if(b&&b.bb()==a.bb()) {
a.qU.call(a.getContext(),
a);
a.gT(null);
a.dispose()
}
};
lq[_P].b$=function (a) {
if(a[Yc]==4) {
var b=this.fg.dequeue();
try{
	if(!b||b.N())return ;
	var c=a[pc],d=qi(c,_M[148]);
	if(d) {
		if(b.iU)b.iU.call(b.getContext(),d)
	}else if(b.ZJ)b.ZJ.call(b.getContext())
}finally{
	this.jK();
	if(b)b.dispose()
}
}
};
Db(lq[_P],function () {
if(!this.fg)return ;
var a=this.fg.dequeue();
while(a) {
a.dispose();
a=this.fg.dequeue()
}
});
lq[_P].dispose=function () {
if(!this.N()) {
af[_P].dispose.call(this);
this.clear();
if(this.fg) {
	this.fg.clear();
	this.fg=null
}
}
};
var mq=function (a,b,c) {
af.call(this);
this.qa=a;
this.Wv=b;
this.z=c;
var d=new Mk;
d.headers.set("Cache-Control","no-cache");
Dh(d,Mj,this.I3,true,this);
this.Xa=d
};
mq.inherits(af);
mq[_P].di=null;
mq[_P].Sh=0;
mq[_P].uv=false;
mq[_P].uq=false;
mq[_P].Tr=0;
mq[_P].execute=function () {
if(this.uv||this.uq)return ;
if(this.di) {
ei(this.di);
this.di=null
}var a=this.Xa;
if(a.Na())a.abort();
try{
this.Tr=ne();
a.send(this.qa,"POST",this.Wv)
}catch(b) {
a.abort();
this.retry()
}
};
mq[_P].I3=function () {
var a=this.Xa;
if(a.vv()) {
this.uq=
true;
var b=this.z;
if(b!=null) {
	var c=eval(a.Gg());
	for(var d=0;d<c[E];d++)b.ZD(c[d],null)
}
}else this.retry()
};mq[_P].A0=function () {
var a=this.Wv.split("&");
for(var b=0;b<a[E];b++) {
var c=a[b].split("=");
if(c[0]=="atyp")return c[1]
}return -1
};
mq[_P].retry=function () {
if(this.uv||this.uq)return ;
if(this.Sh==5) {
var a=this.z;
if(!a.wf)a.setDisconnectedMode(true);
this.TS(true)
}var b=500*o.pow(2,this.Sh);
this.Sh++;
b=o.min(b,60000);
this.di=fi(this.execute,b,this)
};
mq[_P].Q3=function () {
return !this.uv&&!this.uq&&
this.Sh>0
};
mq[_P].TS=function (a) {
this.uv=a;
var b=this.Xa;
if(a&&b.Na())b.abort();
if(!a&&!this.uq) {
this.Sh=0;
this.execute()
}
};
mq[_P].dispose=function () {
if(!this.N()) {
Xk.B.dispose.call(this);
this.z=null;
Kh(this.Xa);
this.Xa.dispose();
this.Xa=null
}
};
var pq=function (a,b) {
if(nq(a))a.selectionStart=b;
else if(S) {
var c=oq(a),d=c[0],e=c[1];
if(d.inRange(e)) {
	if(a[N]=="textarea") {
		var f=a[I].substring(0,b);
		b=Ae(f)[E]
	}d.collapse(true);
	d.move("character",b);
	d.select()
}
}
},rq=function (a) {
return qq(a,true)[0]
},sq=function (a,b,c) {
var d=b.duplicate(),e=a[gc],f=e,g=d[gc],h=g,i=false;
while(!i)if(a.compareEndPoints("StartToEnd",a)==0)i=true;
else {
a.moveEnd("character",-1);
if(a[gc]==e)f+="\r\n";
else i=true
}if(c)return [f[E],-1];
var j=false;
while(!j)if(d.compareEndPoints("StartToEnd",
d)==0)j=true;
else {
d.moveEnd("character",-1);
if(d[gc]==g)h+="\r\n";
else j=true
}return [f[E],f[E]+h[E]]
},qq=function (a,b) {
var c=0,d=0;
if(nq(a)) {
c=a[Oc];
d=b?-1:a.selectionEnd
}else if(S) {
var e=oq(a),f=e[0],g=e[1];
if(f.inRange(g)) {
	f.setEndPoint("EndToStart",g);
	if(a[N]=="textarea")return sq(f,g,b);
	c=f[gc][E];
	d=!b?f[gc][E]+g[gc][E]:-1
}
}return [c,d]
},tq=function (a,b) {
if(nq(a))a.selectionEnd=b;
else if(S) {
var c=oq(a),d=c[0],e=c[1];
if(d.inRange(e)) {
	var f=rq(a);
	if(a[N]=="textarea") {
		var g=a[I].substring(0,b);
		b=
		Ae(g)[E];
		var h=a[I].substring(0,f);
		f=Ae(h)[E]
	}e.collapse(true);
	e.moveEnd("character",b-f);
	e.select()
}
}
},uq=function (a) {
return qq(a,false)[1]
},vq=function (a,b) {
var c=a[Nc]||a[mc];
if(nq(a)) {
a.selectionStart=b;
a.selectionEnd=b
}else if(c[kc]&&a.createTextRange) {
var d=a.createTextRange();
d.collapse(true);
d.move("character",b);
d.select()
}
},wq=function (a,b) {
if(nq(a)) {
var c=a[I],d=a[Oc],e=c.substr(0,d),f=c.substr(a.selectionEnd);
Ta(a,e+b+f);
a.selectionStart=d;
a.selectionEnd=d+b[E]
}else if(S) {
var g=oq(a),
h=g[0],i=g[1];
if(!h.inRange(i))return ;
var j=i.duplicate();
Ja(i,b);
i.setEndPoint("StartToStart",j);
i.select()
}else throwError("Cannot set the selection end");
},oq=function (a) {
var b=a[Nc]||a[mc],c=b[kc].createRange(),d;
if(a[N]=="textarea") {
d=c.duplicate();
d.moveToElementText(a)
}else d=a.createTextRange();
return [d,c]
},nq=function (a) {
try{
return typeofa[Oc]=="number"
}catch(b) {
return false
}
};
var Cq=function (a) {
var b={
};
a=ha(a);
var c=a.charAt(0)=="#"?a:"#"+a;
if(xq(c)) {
b.hex=yq(c);
Bb(b,"hex");
return b
}else {
var d=zq(a);
if(d[E]) {
	b.hex=Aq(d[0],d[1],d[2]);
	Bb(b,"rgb");
	return b
}else if(Bq.hasOwnProperty (a.toLowerCase())) {
	b.hex=Bq[a.toLowerCase()];
	Bb(b,"named");
	return b
}
}throwError(a+" is not a valid color string");
},Dq=/#(.)(.)(.)/,yq=function (a) {
if(!xq(a))throwError("'"+a+"' is not a valid hex color");
if(a[E]==4)a=a.replace(Dq,"#$1$1$2$2$3$3");
return a.toLowerCase()
},Aq=function (a,b,c) {
a=
ja(a);
b=ja(b);
c=ja(c);
if(qa(a)||a<0||a>255||qa(b)||b<0||b>255||qa(c)||c<0||c>255)throwError('"('+a+","+b+","+c+'") is not a valid RGB color');
var d=Eq(a.toString (16)),e=Eq(b.toString (16)),f=Eq(c.toString (16));
return "#"+d+e+f
};
var Fq=/^#(?:[0-9a-f]{
3
}) {
1,2
}$/i,xq=function (a) {
return Fq.test(a)
},Gq=/^(?:rgb)?\((0|[1-9]\d{
0,2
}),\s?(0|[1-9]\d{
0,2
}),\s?(0|[1-9]\d{
0,2
})\)$/i,zq=function (a) {
var b=a.match(Gq);
if(b) {
var c=ja(b[1]),d=ja(b[2]),e=ja(b[3]);
if(c>=0&&c<=255&&d>=0&&d<=255&&e>=0&&e<=255)return [c,
d,e]
}return []
},Eq=function (a) {
return a[E]==1?"0"+a:a
};
var Bq={
aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",
darkgray:"#a9a9a9",darkgrey:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",
fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",grey:"#808080",green:"#008000",greenyellow:"#adff2f",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgrey:"#d3d3d3",lightgreen:"#90ee90",
lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370d8",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",
mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#d87093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",
sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"
};
var Hq=function () {
Fn.call(this)
};
te(Hq,Fn);
var Iq=null,Jq=0,Kq=function () {
return Iq||(Iq=new Hq)
};
Hq[_P].b=function (a) {
var b=this.au(a);
return a.F.b("div",b?{
"class":b.join(" ")
}:null,this.NY(a.$(),a.Tm(),a.F))
};
Hq[_P].NY=function (a,b,c) {
var d=[];
for(var e=0,f=0;e<b[P];e++) {
var g=[];
for(var h=0;h<b[F];h++) {
	var i=a&&a[f++];
	g.push(this.kz(i,c))
}d.push(this.xz(g,c))
}return this.hZ(d,c)
};
Hq[_P].hZ=function (a,b) {
var c=b.b("table",{
"class":this.Pb()+"-table"
},b.b("tbody",{
"class":this.Pb()+"-body"
},a));
c.cellSpacing=0;
Ib(c,0);
dj(c,"grid");
return c
};
Hq[_P].xz=function (a,b) {
return b.b("tr",{
"class":this.Pb()+"-row"
},a)
};
Hq[_P].kz=function (a,b) {
var c=b.b("td",{
"class":this.Pb()+"-cell",id:this.Pb()+"-cell-"+Jq++
},a);
dj(c,"gridcell");
return c
};
Hq[_P].$b=function () {
return false
};
Hq[_P].decorate=function () {
return null
};
Hq[_P].lc=function (a,b) {
if(a) {
var c=mg("tbody",this.Pb()+"-body",a)[0];
if(c) {
	var d=0;
	ef(c[pd],function (j) {
		ef(j[L],function (k) {
			yg(k);
			if(b) {
				var m=b[d++];
				if(m)xg(k,m)
			}
		})
	});
	if(d<b[E]) {
		var e=
		[],f=T(a),g=c[pd][0][L][E];
		while(d<b[E]) {
			var h=b[d++];
			e.push(this.kz(h,f));
			if(e[E]==g) {
				var i=this.xz(e,f);
				xg(c,i);
				Da(e,0)
			}
		}if(e[E]>0) {
			while(e[E]<g)e.push(this.kz("",f));
			var i=this.xz(e,f);
			xg(c,i)
		}
	}
}Vi(a,true,Uf)
}
};
Hq[_P].fB=function (a,b) {
var c=a.Qa();
while(b&&b[lc]==1&&b!=c) {
if(b[td]=="TD"&&kj(b,this.Pb()+"-cell"))return b[M];
b=b[O]
}return null
};
Hq[_P].sM=function (a,b,c) {
if(b) {
var d=b[O];
lj(d,this.Pb()+"-cell-hover",c);
var e=a.Qa()[M];
ej(e,"activedescendent",d.id)
}
};
Hq[_P].Ua=function (a,b,c) {
if(b) {
var d=
b[O];
lj(d,this.Pb()+"-cell-selected",c)
}
};
Hq[_P].Pb=function () {
return "goog-palette"
};
var Lq=function (a) {
Xh.call(this);
this.Qb=[];
this.dH(a)
};
te(Lq,Xh);
Lq[_P].Qb=null;
Lq[_P].xl=null;
Lq[_P].ao=null;
Lq[_P].Dba=function (a) {
this.ao=a
};
Lq[_P].z4=function (a) {
return a?df(this.Qb,a):-1
};
Lq[_P].m1=function (a) {
return this.Qb[a]
};
Lq[_P].dH=function (a) {
if(a) {
ef(a,function (b) {
	this.Yf(b,false)
},this);
sf(this.Qb,a)
}
};
Lq[_P].Bs=function (a) {
this.dW(a,this.Qb[E])
};
Lq[_P].dW=function (a,b) {
if(a) {
this.Yf(a,false);
mf(this.Qb,a,b)
}
};
Lq[_P].yu=function () {
return this.xl
};
Lq[_P].Jr=function (a) {
if(a!=this.xl) {
this.Yf(this.xl,
false);
this.xl=a;
this.Yf(a,true)
}this.dispatchEvent("select")
};
Lq[_P].Bk=function () {
return this.z4(this.xl)
};
Lq[_P].$h=function (a) {
this.Jr(this.m1(a))
};
Db(Lq[_P],function () {
kf(this.Qb);
this.xl=null
});
Lq[_P].M=function () {
Lq.B.M.call(this);
this.Qb=null;
this.xl=null
};
Lq[_P].Yf=function (a,b) {
if(a)if(typeofthis.ao=="function")this.ao(a,b);
else if(typeofa.lF=="function")a.lF(b)
};
var Mq=function (a,b,c) {
Pn.call(this,a,b||Kq(),c)
};
te(Mq,Pn);
Mq[_P].Cf=null;
Mq[_P].Ik=-1;
Mq[_P].md=null;
Mq[_P].M=function () {
Mq.B.M.call(this);
if(this.md) {
this.md.dispose();
this.md=null
}this.Cf=null
};
Mq[_P].Bl=function (a) {
Mq.B.Bl.call(this,a);
this.pH();
if(this.md) {
this.md.clear();
this.md.dH(a)
}else {
this.md=new Lq(a);
this.md.Dba(R(this.Yf,this));
this.Sp().listen(this.md,"select",this.v3)
}this.Ik=-1
};
Mq[_P].XA=function () {
return null
};
Mq[_P].Mu=function (a) {
Mq.B.Mu.call(this,a);
var b=this.Q.fB(this,a[Sc]);
if(b&&a[ec]&&Gg(b,a[ec]))return ;
if(b!=this.pu())this.zS(b)
};
Mq[_P].Lu=function (a) {
Mq.B.Lu.call(this,a);
var b=this.Q.fB(this,a[Sc]);
if(b&&a[ec]&&Gg(b,a[ec]))return ;
if(b==this.pu())this.Q.sM(this,b,false)
};
Mq[_P].Ku=function (a) {
Mq.B.Ku.call(this,a);
if(this.Na()) {
var b=this.Q.fB(this,a[Sc]);
if(b!=this.pu())this.zS(b)
}
};
Mq[_P].On=function () {
var a=this.pu();
if(a) {
this.Jr(a);
return this.dispatchEvent(Zi)
}return false
};
Mq[_P].Of=function (a) {
var b=this.$(),c=b?b[E]:0,d=this.Cf[F];
if(c==0||!this.wc())return false;
if(a[ed]==13||a[ed]==32)return this.On(a);
if(a[ed]==36) {
this.Fl(0);
return true
}else if(a[ed]==35) {
this.Fl(c-1);
return true
}var e=this.Ik<0?this.Bk():this.Ik;
switch(a[ed]) {
case 37:if(e==-1)e=c;
if(e>0) {
	this.Fl(e-1);
	a.preventDefault();
	return true
}break;
case 39:if(e<c-1) {
	this.Fl(e+1);
	a.preventDefault();
	return true
}break;
case 38:if(e==-1)e=c+d-1;
if(e>=d) {
	this.Fl(e-d);
	a.preventDefault();
	return true
}break;
case 40:if(e==-1)e=-d;
if(e<c-d) {
	this.Fl(e+d);
	a.preventDefault();
	return true
}break
}return false
};
Mq[_P].v3=
function () {
};
Mq[_P].Tm=function () {
return this.Cf
};
Mq[_P].Hb=function (a,b) {
if(this.Qa())throwError($i);
this.Cf=fe(a)?new Rf(a,b):a;
this.pH()
};
Mq[_P].pu=function () {
var a=this.$();
return a&&a[this.Ik]
};
Mq[_P].Fl=function (a) {
if(a!=this.Ik) {
this.tM(this.Ik,false);
this.Ik=a;
this.tM(a,true)
}
};
Mq[_P].zS=function (a) {
var b=this.$();
this.Fl(b?df(b,a):-1)
};
Mq[_P].Bk=function () {
return this.md?this.md.Bk():-1
};
Mq[_P].yu=function () {
return this.md&&this.md.yu()
};
Mq[_P].$h=function (a) {
if(this.md)this.md.$h(a)
};
Mq[_P].Jr=
function (a) {
if(this.md)this.md.Jr(a)
};
Mq[_P].tM=function (a,b) {
if(this.Qa()) {
var c=this.$();
if(c&&a>=0&&a<c[E])this.Q.sM(this,c[a],b)
}
};
Mq[_P].Yf=function (a,b) {
if(this.Qa())this.Q.Ua(this,a,b)
};
Mq[_P].pH=function () {
var a=this.$();
if(a)if(this.Cf&&this.Cf[F]) {
var b=o.ceil(a[E]/this.Cf[F]);
if(!fe(this.Cf[P])||this.Cf[P]<b)D(this.Cf,b)
}else {
var c=o.ceil(o.sqrt(a[E]));
this.Cf=new Rf(c,c)
}else this.Cf=new Rf(0,0)
};
var Nq=function (a,b,c) {
this.Gi=a||[];
Mq.call(this,null,b||Kq(),c);
this.oo(this.Gi)
};
te(Nq,Mq);
Nq[_P].$v=null;
Nq[_P].Xi=function () {
return this.Gi
};
Nq[_P].oo=function (a) {
this.Gi=a;
this.$v=null;
this.lc(this.pY())
};
Nq[_P].Wp=function () {
var a=this.yu();
if(a) {
var b=a[J][Ci("background-color")];
return Oq(b)
}else return null
};
Nq[_P].Ir=function (a) {
var b=Oq(a);
if(!this.$v)this.$v=ff(this.Gi,function (c) {
return Oq(c)
});
this.$h(b?df(this.$v,b):-1)
};
Nq[_P].pY=function () {
var a=this.F;
return ff(this.Gi,function (b) {
return a.b("div",
{
	"class":"goog-palette-colorswatch",style:"background-color:"+b
})
})
};
var Oq=function (a) {
if(a)try{
return Cq(a).hex
}catch(b) {
}return null
};
var Pq=function (a) {
Xi.call(this,a);
this.G=new mj(this);
this.G.listen(this,Zi,this.m7)
};
te(Pq,Xi);
Pq[_P].$_=true;
Pq[_P].Xi=function () {
return this.bc?this.bc.Xi():null
};
Pq[_P].oo=function (a) {
if(!this.bc)this.OI(a);
else this.bc.oo(a)
};
Pq[_P].Hb=function (a) {
if(!this.bc)this.OI([]);
this.bc.Hb(a)
};
Pq[_P].Tm=function () {
return this.bc?this.bc.Tm():null
};
Pq[_P].Bk=function () {
return this.bc?this.bc.Bk():-1
};
Pq[_P].$h=function (a) {
if(this.bc)this.bc.$h(a)
};
Pq[_P].Wp=function () {
return this.bc?this.bc.Wp():null
};
Pq[_P].Ir=function (a) {
if(this.bc)this.bc.Ir(a)
};
Pq[_P].$b=function () {
return false
};
Pq[_P].Db=function () {
Pq.B.Db.call(this);
if(this.bc)this.bc.render(this.Qa());
this.Qa().unselectable="on"
};
Pq[_P].M=function () {
Pq.B.M.call(this);
if(this.bc) {
this.bc.dispose();
this.bc=null
}this.G.dispose();
this.G=null
};
Pq[_P].focus=function () {
if(this.bc)this.bc.Qa().focus()
};
Pq[_P].m7=function (a) {
a.stopPropagation();
this.dispatchEvent("change")
};
Pq[_P].OI=function (a) {
var b=new Nq(a,null,this.F);
b.Hb(5);
b.fT(32,this.$_);
this.Ca(b);
this.bc=b;
if(this.rb)this.bc.render(this.Qa())
};
var Qq=function (a) {
var b=new Pq(a);
b.Hb(7);
b.oo(["#ffffff","#cccccc","#c0c0c0","#999999","#666666","#333333","#000000","#ffcccc","#ff6666","#ff0000","#cc0000","#990000","#660000","#330000","#ffcc99","#ff9966","#ff9900","#ff6600","#cc6600","#993300","#663300","#ffff99","#ffff66","#ffcc66","#ffcc33","#cc9933","#996633","#663333","#ffffcc","#ffff33","#ffff00","#ffcc00","#999900","#666600","#333300","#99ff99","#66ff99","#33ff33","#33cc00","#009900",
"#006600","#003300","#99ffff","#33ffff","#66cccc","#00cccc","#339999","#336666","#003333","#ccffff","#66ffff","#33ccff","#3366ff","#3333ff","#000099","#000066","#ccccff","#9999ff","#6666cc","#6633ff","#6600cc","#333399","#330099","#ffccff","#ff99ff","#cc66cc","#cc33cc","#993399","#663366","#330033"]);
return b
};
var Rq=function (a,b) {
this.G=new mj(this);
this.tS(a);
if(b)this.Qba(b)
};
te(Rq,Xh);
var Sq="toggle_display";
Rq[_P].A=null;
Rq[_P].XW=true;
Rq[_P].NH=null;
Rq[_P].Pc=false;
Rq[_P].aca=false;
Rq[_P].bO=-1;
Rq[_P].HC=-1;
Rq[_P].Ic=Sq;
Rq[_P].jd=function () {
return this.Ic
};
Rq[_P].Qba=function (a) {
this.Ic=a
};
Rq[_P].Qa=function () {
return this.A
};
Rq[_P].tS=function (a) {
this.J_();
this.A=a
};
Rq[_P].J_=function () {
if(this.Pc)throwError("Can not change this state of the popup while showing.");
};
Rq[_P].Ka=function () {
return this.Pc
};
Rq[_P].q5=function () {
return this.Pc||ne()-this.HC<150
};
Rq[_P].D=function (a) {
if(a) {
if(!this.A)throwError("Caller must call setElement before trying to show thepopup");
this.Mca()
}else this.pf()
};
Rq[_P].reposition=function () {
};
Rq[_P].Mca=function () {
if(this.Pc)return ;
if(!this.h7())return ;
this.reposition();
if(this.XW) {
var a=hg(this.A);
this.G.listen(a,Nh,this.wD,true);
if(S) {
	var b=a.activeElement;
	while(b&&b[Jc]=="IFRAME") {
		try{
			var c=Hg(b)
		}catch(d) {
			break
		}a=c;
		b=a.activeElement
	}this.G.listen(a,Nh,this.wD,true);
	this.G.listen(a,"deactivate",this.wP)
}else this.G.listen(a,"blur",this.wP)
}if(this.Ic==Sq) {
Sb(this.A[J],"visible");
V(this.A,true)
}else if(this.Ic=="move_offscreen")this.reposition();
this.Pc=true;
this.jw()
};
Rq[_P].pf=function (a) {
if(this.Pc) {
if(!this.g7(a))return ;
if(this.G)this.G.cc();
if(this.Ic==Sq)if(this.aca)fi(this.pM,0,this);
else this.pM();
else if(this.Ic=="move_offscreen")this.R6();
this.Pc=false;
this.ew(a)
}
};
Rq[_P].pM=function () {
Sb(this.A[J],"hidden");
V(this.A,false)
};
Rq[_P].R6=function () {
ib(this.A[J],
"-200px");
this.A[J].top="-200px"
};
Rq[_P].h7=function () {
return this.dispatchEvent("beforeshow")
};
Rq[_P].jw=function () {
this.bO=ne();
this.HC=-1;
this.dispatchEvent("show")
};
Rq[_P].g7=function (a) {
return this.dispatchEvent({
type:"beforehide",target:a
})
};
Rq[_P].ew=function (a) {
this.HC=ne();
this.dispatchEvent({
type:"hide",target:a
})
};
Rq[_P].wD=function (a) {
if(!Gg(this.A,a[Sc])&&(!this.NH||Gg(this.NH,a[Sc])))this.pf(a[Sc])
};
Rq[_P].wP=function (a) {
var b=hg(this.A);
if(S) {
var c=b.activeElement;
if(c&&Gg(this.A,c))return
}else if(a[Sc]!=
b)return ;
if(ne()-this.bO<150)return ;
this.pf()
};
Rq[_P].M=function () {
Rq.B.M.call(this);
this.G.dispose();
this.A=null;
this.G=null
};
var Tq=function (a,b) {
this.G8=5;
this.UD=b;
Rq.call(this,a)
};
te(Tq,Rq);
Tq[_P].vO=null;
Tq[_P].qba=function (a) {
this.G8=a;
if(this.Pc)this.reposition()
};
Tq[_P].Fg=function () {
return this.UD
};
Tq[_P].setPosition=function (a) {
this.UD=a;
if(this.Pc)this.reposition()
};
Tq[_P].Waa=function (a,b,c,d) {
this.vO=a==null||ainstanceofJf?a:new Jf(a,b,c,d);
if(this.Pc)this.reposition()
};
Tq[_P].reposition=function () {
if(!this.UD)return ;
if(!this.Pc) {
Sb(this.A[J],"hidden");
V(this.A,true)
}this.UD.reposition(this.A,this.G8,this.vO);
if(!this.Pc)V(this.A,false)
};
var Wq=function (a,b,c,d,e,f,g) {
var h=Ii(c),i=Ii(a),j=new Of(i.x-h.x+c[Cc],i.y-h.y+c[Ed]),k=1,m=1,n=Li(a),q=Uq(a,b);
switch(q) {
case 1:break;
case 2:j.x+=n[F];
k=-1;
break;
case 3:j.y+=n[P];
m=-1;
break;
case 4:j.x+=n[F];
j.y+=n[P];
k=-1;
m=-1;
break
}if(e) {
j.x+=k*e.x;
j.y+=m*e.y
}return Vq(j,c,d,f,g)
},Vq=function (a,b,c,d,e) {
var f=Uq(b,c);
if(d||f!=1) {
var g=Li(b);
switch(f) {
	case 1:a.x+=d[Mc];
	a.y+=d.top;
	break;
	case 2:a.x-=g[F];
	if(d) {
		a.x-=d[Qd];
		a.y+=d.top
	}break;
	case 3:a.y-=g[P];
	if(d) {
		a.x+=
		d[Mc];
		a.y-=d[ld]
	}break;
	case 4:a.x-=g[F];
	a.y-=g[P];
	if(d) {
		a.x-=d[Qd];
		a.y-=d[ld]
	}break
}
}var h=e||0;
if(h!=0) {
var i=hg(b),j=ug(i)||l,k=Li(b),m=sg(j),n=tg(j),q=a.x-n.x,p=m[F]-q,s=a.y-n.y,u=m[P]-s;
if(k[F]>p)if(h&1)a.x-=k[F]-p;
else if(h&2)return false;
if(k[P]>u)if(h&4)a.y-=k[P]-u;
else if(h&8)return false;
if(a.x-n.x<0)if(h&1)a.x-=a.x-n.x;
else if(h&2)return false;
if(a.y-n.y<0)if(h&4)a.y-=a.y-n.y;
else if(h&8)return false
}Fi(b,a);
return true
},Uq=function (a,b) {
var c=Pi(a);
switch(b) {
case 1:case 2:case 3:case 4:return b;
case 5:return c?2:1;
case 6:return c?1:2;
case 7:return c?4:3;
case 8:return c?3:4
}
},Xq=function () {
};
Xq[_P].reposition=function () {
};
var Yq=function (a,b) {
this.element=a;
this.corner=b
};
te(Yq,Xq);
Yq[_P].reposition=function (a,b,c) {
Wq(this.element,this.corner,a,b,null,c)
};
var Zq=function (a,b,c) {
Sn.call(this,a,b||Vn(),c);
this.fT(16,true)
};
te(Zq,Sn);
var $q=function () {
return new Zq(null)
};
Rn("goog-toggle-button",$q);
var br=function (a,b,c) {
this.j=a;
this.oa=b;
this.e_=c;
var d=T(c);
this.qr=d.b("div",{
"class":"dragDropIcon",style:"display: none;"
},d.b("div",{
"class":ar+" icon-arrow"
}));
d.appendChild(c,this.qr);
this.Mx=d.b("div",{
"class":"sortBarDropTarget",style:"display: none;"
},d.b("div",{
"class":ar+" icon-sortbar"
}));
d.appendChild(c,this.Mx);
this.Ws=d.b("div",{
"class":"columnBarDropTarget",style:"display: none;"
},d.b("div",{
title:"columnBar","class":"icon-columnbar "+ar
}));
d.appendChild(c,this.Ws)
},ar="img-sprite";
br[_P].Rf=function () {
cr(this.qr);
cr(this.Mx);
cr(this.Ws)
};
br[_P].uT=function (a,b,c) {
var d=a.Ld(b,1),e=a.Vi(d),f=this.qr,g=f[J];
C(g,"");
ib(g,e[0]-f[tc]+1);
g.top=e[1]-4+c
};
br[_P].tT=function (a,b,c) {
this.uT(a,b,c?0:a.I.K(b)[Id])
};
br[_P].DF=function (a,b) {
var c=a.Xb;
this.uT(a,b,0);
var d=this.Mx[J];
C(d,"");
ib(d,1);
d.top=a.Vi(a.Ld(b,1))[1]-(b==c+1?13:0)
};
br[_P].tF=function (a,b) {
var c=a.Ra,d=a.xa.Wi(b,true),e=a.Vi(d),f=this.Ws[J];
C(f,"");
ib(f,b==c+1?e[0]-7+1:e[0]-3+1);
f.top=0
};
Ra(br[_P],function () {
var a=
T(this.qr);
a.removeNode(this.qr);
this.qr=null;
a.removeNode(this.Mx);
this.Mx=null;
a.removeNode(this.Ws);
this.Ws=null
});
var dr=function (a) {
af.call(this);
this.z=a;
this.Lz=a.Da();
this.Ig={
};
this.IW=false;
this.fe=vg("div",{
"class":"divHiddenAutoFillHandle",style:"visibility:hidden"
});
a.divGrids.appendChild(this.fe);
this.K$=[[-1,-1],[-1,-1]];
this.L8()
};
dr.inherits(af);
dr[_P].Za=null;
dr[_P].q=null;
dr[_P].zb=null;
dr[_P].cd=null;
dr[_P].Mk=null;
dr[_P].qC=null;
dr[_P].lA=null;
dr[_P].mA=null;
dr[_P].Vb=false;
dr[_P].gt=function () {
var a=vg("div",{
"class":"divAutoFillHandle",style:"display: none;"
});
return a
};
dr[_P].jt=function () {
return vg("div",
{
"class":"divAutoFillSelection",style:"display: none;"
})
};
var er=Wf?-4:-5,fr=Uf?-5:-4,gr={
HANDLE:"handle",HANDLE_IN_HEADER:"handleInHeader",HANDLE_IN_ROWHEADER:"handleInRowHeader",HANDLE_IN_FROZEN_ROWHEADER:"handleInFFRowHeader",SELECTION:"selection",SELECTION_IN_HEADER:"selectionInHeader",SELECTION_IN_ROWHEADER:"selectionInRowHeader",SELECTION_IN_FROZEN_ROWHEADER:"selectionInFFROwHeader"
};
dr[_P].kS=function (a) {
this.ge();
this.cd=a
};
dr[_P].Zda=function (a,b) {
var c=this.Ig[a];
this.Ig[b]=c;
if(a!=b)this.Ig[a]=
null
};
dr[_P].K8=function (a) {
this.cd=a;
var b=gr,c={
};
c[b.SELECTION]=this.jt();
c[b.SELECTION_IN_HEADER]=this.jt();
c[b.SELECTION_IN_ROWHEADER]=this.jt();
c[b.SELECTION_IN_FROZEN_ROWHEADER]=this.jt();
c[b.HANDLE]=this.gt();
c[b.HANDLE_IN_HEADER]=this.gt();
c[b.HANDLE_IN_ROWHEADER]=this.gt();
c[b.HANDLE_IN_FROZEN_ROWHEADER]=this.gt();
var d=a.id;
this.Ig[d]=c;
var e=a.wp;
e.appendChild(c[b.HANDLE]);
e.appendChild(c[b.SELECTION]);
var f=this;
this.z.Dy(d,function () {
f.kS(a)
});
if(this.Lz) {
this.ge();
this.ZB();
this.jq()
}
};
dr[_P].L8=function () {
var a=new mj(this);
a.listen(this.fe,Mh,this.Hu);
a.listen(this.fe,Nh,this.B2);
this.q=a
};
dr[_P].jx=function (a) {
this.Lz=a;
if(a) {
this.ge();
this.ZB();
this.jq()
}else {
this.Zc();
this.gy(this.cd)
}
};
dr[_P].ge=function () {
var a=this.Ig[this.cd.id],b=gr;
C(a[b.HANDLE][J],"none");
C(a[b.HANDLE_IN_HEADER][J],"none");
C(a[b.HANDLE_IN_ROWHEADER][J],"none");
C(a[b.HANDLE_IN_FROZEN_ROWHEADER][J],"none");
Sb(this.fe[J],"hidden")
};
dr[_P].ZB=function () {
Sb(this.fe[J],"hidden")
};
dr[_P].jq=function () {
var a=
this.Ig[this.cd.id],b=gr;
C(a[b.SELECTION][J],"none");
C(a[b.SELECTION_IN_HEADER][J],"none");
C(a[b.SELECTION_IN_ROWHEADER][J],"none");
C(a[b.SELECTION_IN_FROZEN_ROWHEADER][J],"none")
};
dr[_P].Zc=function () {
if(this.Lz)return ;
var a=this.cd,b=this.Ig[a.id];
if(b==null)return ;
this.gy(a);
var c=gr,d=b[c.HANDLE][J],e=b[c.HANDLE_IN_HEADER];
if(!e[O])a.xa.xg.appendChild(e);
var f=e[J],g=b[c.HANDLE_IN_ROWHEADER];
if(!g[O])a.I.jf.appendChild(g);
var h=g[J],i=b[c.HANDLE_IN_FROZEN_ROWHEADER];
if(!i[O])a.I.hf.appendChild(i);
var j=i[J],k=a.Md(),m=a.divSelection,n=a.g1(),q=a.M1(),p=a.a1(),s,u,v=false;
if(m[J][Cd]!="none") {
u=m;
s=d;
v=true
}else if(n&&n[J][Cd]!="none") {
u=n;
s=f
}else if(q&&q[J][Cd]!="none") {
u=q;
s=h
}else if(p&&p[J][Cd]!="none") {
u=p;
s=j
}else if(k) {
var t=k[O],w=t.isFrozenCol||t.getAttribute("isFrozenCol"),B=t.isFrozenCol==true||t.getAttribute("isFrozenRow");
if(w&&B) {
	u=a.I.divActiveCellInFFH;
	s=j
}else if(w) {
	u=a.I.divActiveCellInH;
	s=h
}else if(B) {
	u=a.xa.divActiveCellInH;
	s=f
}else {
	u=a.Rz;
	s=d;
	v=true
}
}else return ;
s.top=
u[Ed]+u[Id]+er;
ib(s,u[Cc]+u[tc]+fr);
if(v&&a.J$()) {
D(s,"2px");
Fb(s,"0")
}else {
D(s,"");
Fb(s,"")
}C(j,C(h,C(f,C(d,"none"))));
C(s,"")
};
dr[_P].gy=function (a) {
if(this.Lz||!a.vq())return ;
var b=a.ma,c=a.Z,d=b>0||c>0,e=d?a.O+b-1:a.Ga,f=d?a.Y+c-1:a.Ea,g=a.Ld(e,f);
while(f>1&&g&&a.kd(g))g=a.Ld(e,--f);
if(!g)return ;
if(a.tq(e,f,g[tc]-20)) {
this.ZB();
return
}var h=this.fe[J],i=a.Vi(g),j=i[0]-1,k=i[1];
j+=g[tc];
k+=g[Id];
var m=g[O];
if(m.isFrozenCol==true||m.getAttribute("isFrozenRow"))k-=2;
ib(h,j);
h.top=k;
Sb(h,"visible")
};
dr[_P].B2=function (a) {
var b=this.z,c=b.Da();
if(!this.Vb&&!c&&!b.modalDbox) {
this.Vb=true;
var d=new tj(this.fe);
this.Za=d;
var e=hg(this.fe),f=this.q;
f.listen(this.fe,Ph,this.Iu);
f.listen(this.fe,Oh,this.Ju);
f.listen(e,Ph,this.Iu);
f.listen(e,Oh,this.Ju);
d.re(a)
}
};
dr[_P].Iu=function (a) {
jb(a,this);
var b=this.fe,c=b[J],d=this.cd,e=this.z,f=e.mouseSelection,g=f.$d(a,d);
ib(c,g[0]+"px");
c.top=g[1]+"px";
var h=f.Ie(d,g[0],g[1]);
this.zb=h;
var i=[d.Ga,d.Ea],j=d.tq(h[0],h[1]);
if(j) {
var k=d.divMain[Ub];
this.Za.deltaY-=
k+j[0];
d.Vc(h[0],h[1])
}if(this.zb[0]==i[0]&&this.zb[1]==i[1]) {
this.jq();
return
}var m=d.Z,n=d.ma,q=d.O,p=d.Y;
if(q<=this.zb[0]&&this.zb[0]<=q+n-1&&p<=this.zb[1]&&this.zb[1]<=p+m-1) {
this.jq();
return
}var s,u,v,t,w=p>this.zb[1],B=q>this.zb[0];
this.lA=w;
this.mA=B;
u=w?this.zb[1]:p+m;
t=w?p-1:this.zb[1];
s=B?this.zb[0]:q+n;
v=B?q-1:this.zb[0];
if(m>1) {
this.Mk=p<=this.zb[1]&&this.zb[1]<=p+m-1;
this.qC=q<=this.zb[0]&&this.zb[0]<=q+n-1
}else {
this.Mk=this.zb[1]==i[1];
this.qC=this.zb[0]==i[0]
}if(!this.Mk&&!this.qC)this.Mk=
o.abs(v-s)-n-1>o.abs(t-u)-m-1;
var A=this.K$[0],G=this.K$[1];
if(this.Mk) {
A[0]=s;
A[1]=p,G[0]=v;
G[1]=p+m-1
}else {
A[0]=q;
A[1]=u;
G[0]=q+n-1;
G[1]=t
}var H=this.Ig[d.id],Q=gr,K=H[Q.SELECTION_IN_HEADER];
if(!K[O])d.xa.xg.appendChild(K);
var sa=H[Q.SELECTION_IN_ROWHEADER];
if(!sa[O])d.I.jf.appendChild(sa);
var aa=H[Q.SELECTION_IN_FROZEN_ROWHEADER];
if(!aa[O])d.I.hf.appendChild(aa);
d.Li(A[0],A[1],G[0],G[1],H[Q.SELECTION]);
this.Zc()
};
dr[_P].m$=function (a,b,c,d) {
var e=this.cd,f=this.Ig[e.id],g=gr,h=f[g.SELECTION][J],
i=f[g.SELECTION_IN_HEADER][J],j=f[g.SELECTION_IN_ROWHEADER][J],k=f[g.SELECTION_IN_FROZEN_ROWHEADER][J];
Gb(h,Gb(i,Gb(j,Gb(k,"2px dashed gray"))));
if(a)Ua(h,Ua(i,"0"));
if(b)Pa(h,Pa(j,"0"));
if(c)Ka(k,Ka(j,"0"));
if(d)Fb(k,Fb(i,"0"));
if(this.Mk)if(this.mA)Fb(h,Fb(i,Fb(j,Fb(k,"0"))));
else Pa(h,Pa(i,Pa(j,Pa(k,"0"))));
else if(this.lA)Ka(h,Ka(i,Ka(j,Ka(k,"0"))));
else Ua(h,Ua(i,Ua(j,Ua(k,"0"))))
};
dr[_P].Ju=function (a) {
this.IW=Zf?a[Zb]:a[oc];
jb(a,this);
if(this.zb!=null) {
var b=this.cd,c=this.z,d=b.info.colsTOids,
e=b.info.rowsTOids,f=[];
f.push(oo,"=",9);
var g=this.IW?X.alternateAutoFill:X.autoFill;
f.push("&atyp=",g);
var h=b.O,i=b.Y,j=h+b.ma-1,k=i+b.Z-1;
f.push("&rn0gid=",b.id);
f.push("&rn0srow=",e[h]);
f.push("&rn0scol=",d[i]);
f.push("&rn0erow=",e[j]);
f.push("&rn0ecol=",d[k]);
f.push("&rn1gid=",b.id);
f.push("&rn1srow=",e[j]);
f.push("&rn1scol=",d[k]);
if(this.Mk) {
	f.push("&rn1erow=",e[this.zb[0]]);
	f.push("&rn1ecol=",d[k]);
	if(this.mA) {
		b.dc(j,k,this.zb[0],i);
		b.Ua(this.zb[0],i,false)
	}else b.dc(h,i,this.zb[0],k)
}else {
	f.push("&rn1erow=",
	e[j]);
	f.push("&rn1ecol=",d[this.zb[1]]);
	if(this.lA) {
		b.dc(j,k,h,this.zb[1]);
		b.Ua(h,this.zb[1],false)
	}else b.dc(h,i,j,this.zb[1])
}this.jq();
this.Zc();
c.Ab(f.join(""),false)
}var m=hg(this.fe),n=this.q;
n.unlisten(this.fe,Ph,this.Iu);
n.unlisten(this.fe,Oh,this.Ju);
n.unlisten(m,Ph,this.Iu);
n.unlisten(this.cd.divTop,Oh,this.Ju);
this.Za.dispose();
this.Vb=false;
this.zb=null;
a.preventDefault();
a.stopPropagation()
};
dr[_P].Hu=function (a) {
a.preventDefault()
};
dr[_P].e1=function (a) {
return this.Ig[a]
};
dr[_P].dispose=
function () {
if(!this.N()) {
dr.B.dispose.call(this);
this.Za.dispose();
this.Za=null;
this.q.dispose();
this.q=null;
this.Ig=null;
this.z=null;
this.fe=null
}
};
var ir=function (a,b,c) {
this.j=a;
this.oa=b;
this.e_=c;
this.cC=hr(b,c,"divIcon img-sprite icon-hyperlink","divIconUp","divIconDown",20,20);
this.Vj=this.yY();
this.ov=false;
this.Ns=hr(b,c,"cellPresenceDiv","","")
};
ir[_P].Rf=function () {
cr(this.cC);
cr(this.Ns);
this.nM()
};
ir[_P].nM=function () {
if(!this.ov)cr(this.Vj)
};
ir[_P].j4=function () {
var a=this.Vj;
V(a.userComTxtAreaElem,false);
V(a.userComTdElem,false)
};
ir[_P].zca=function (a) {
this.Rf();
this.sca(a)
};
ir[_P].w0=function (a,b,c) {
var d=a.info.rowsTOids[b],e=
a.info.colsTOids[c],f=[];
if(d!=null&&e!=null) {
var g=this.j.gooffiLink;
if(g&&!this.j.wf) {
	var h=g.ya.Fd,i=h.Bu();
	for(var j=0;j<i[E];j++) {
		var k=i[j];
		if(k&&a.id==k.Kj&&d==k.jB()&&e==k.iB())f.push(k)
	}
}
}return f
};
ir[_P].fca=function (a,b) {
V(this.Ns,false);
if(!b)return ;
var c=b[0],d=b[1];
if(!c||!d)return ;
var e=this.w0(a,c,d);
if(!this.j.modalDbox&&e[E]>0) {
var f=Bm.get(e[e[E]-1].$E),g=[];
for(var h=0;h<e[E];h++)g.push(e[h].qy);var i=g.join(" ");if(i[E]>70)i=i.substr(0,70)+"...";var j=a.Ld(c,d),k=this.Ns;Ig(k,
i);var m=k[J],n=this.YK(k),q=o.max(n[0],50);x(m,q);C(m,"none");var p=a.Vi(j),s=p[0];s+=j[tc]-q;s=o.max(35,s);var u=this.vL(a,s,q);if(u>0)s-=u;ib(m,s);m.top=p[1]-n[1]+2;if(f&&f.Ny)cb(m,f.Ny);C(m,"")
}
};ir[_P].vL=function (a,b,c) {
return b+c-a.mainGridWid-a.I.Mb()+a.scrollDepth
};
ir[_P].sca=function (a) {
if(!this.j.modalDbox&&a.jM()) {
var b=a.Md();
if(!a.tq(a.Ga,a.Ea,b[tc]-20,S?null:o.min(b[Id],5))) {
	var c=this.cC,d=a.Vi(b),e=c[J];
	C(e,"");
	ib(e,d[0]-c[tc]+1);
	e.top=d[1]+1;
	z(c,Qk(a,a.hyperlink))
}
}
};
ir[_P].wT=function (a,
b) {
this.nM();
if(b&&!this.j.modalDbox) {
var c=b[0],d=b[1],e=a.info.UK(c,d);
if(e)if(this.ov) {
	this.hK();
	this.ov=true
}else this.xT(a,c,d,e,false,false)
}
};
ir[_P].up=function (a,b) {
var c=true,d=new Im(_M[353]);
d.append(" --");
d.append(b);
d.append(" ");
d.append(this.j.E0());
var e=d.toString (),f={
},g=a.info.UK(a.Ga,a.Ea);
if(g) {
f.a=g.a;
f.u=g.u
}if(f.u)if(ue(f.u,e))c=false;
else {
var h=new Im(e);
h.append(" ");
h.append(f.u);
f.u=h.toString ()
}else f.u=e;
this.xT(a,a.Ga,a.Ea,f,true,c)
};
ir[_P].gp=function (a,b) {
var c=
a.Ga,d=a.Ea,e=a.Z,f=a.ma,g=a.info;
for(var h=0;h<f;h++)for(var i=0;i<e;i++) {
var j=a.info.Cg(c+h,d+i);
if(j&&j.co&&j.co.u) {
	g.setUserComment(c+h,d+i,"");
	g.ix(c+h,d+i,false)
}
}a.Zf(b,"",_M[4])
};
ir[_P].xT=function (a,b,c,d,e,f) {
var g=this.Vj,h=g[J];
x(h,150);
x(g.userComTxtAreaElem[J],150);
if(d.u) {
this.Hfa=d.u;
this.fea=a.id;
this.oga=b;
this.nga=c;
Ta(g.userComTxtAreaElem,d.u);
C(g.userComTxtAreaElem[J],"");
C(g.userComTdElem[J],"");
g.userComTxtAreaElem.readOnly=this.j.Da()
}else fi(this.j4,0,this);
if(d.a) {
y(g.attrComTdElem,
d.a);
C(g.attrComTdElem[J],"")
}else C(g.attrComTdElem[J],"none");
var i=a.Ld(b,c),j=a.Vi(i),k=i[tc],m=j[0]+k,n=j[1]+1,q=this.YK(g),p=Sf(q[0],150,500);
x(h,p);
x(g.userComTxtAreaElem[J],p);
if(this.vL(a,m,p)>0)m-=k+p;
if(d.u) {
var s=Sf(q[1],48,200);
D(h,s);
var u=a.mainGridHei+a.fd();
if(n-32>u-s)n=u-s
}C(h,"none");
h.top=n;
ib(h,m);
C(h,"");
if(e)g.userComTxtAreaElem.focus();
if(f) {
var v=_M[353][E];
pq(g.userComTxtAreaElem,0);
tq(g.userComTxtAreaElem,v)
}
};
ir[_P].YK=function (a) {
var b=a[J];
ib(b,-500);
C(b,"");
D(b,"");
x(b,"");
return [a[tc],a[Id]]
};
ir[_P].yY=function () {
var a=hr(this.oa,this.e_,"commentDiv","",""),b=Tk(this.oa,a,"",null);
a.userComTdElem=Uk(b,48,"");
a.userComTxtAreaElem=Rl(this.oa,a.userComTdElem,"userCommentTextArea","","relative",0,0,150,"100%",1000,"textarea");
Dh(a.userComTxtAreaElem,"focus",this.Qca,true,this);
Dh(a.userComTxtAreaElem,"blur",this.hK,true,this);
a.attrComTdElem=Uk(b,null,"attrCommentDivTd");
return a
};
ir[_P].Qca=function () {
this.ov=true
};
ir[_P].hK=function () {
this.ov=false;
var a=this.Vj.userComTxtAreaElem[I];
if(a!=this.Hfa) {
var b=this.j.Aa.pb(this.fea),c=b.info,d=this.oga,e=this.nga;
c.setUserComment(d,e,a);
var f=new Im(oo);
f.append("=");
f.append(9);
f.append("&atyp=");
f.append(X.setUserComment);
f.append("&gid=");
f.append(this.fea);
f.append("&srow=");
f.append(c.rowsTOids[d]);
f.append("&scol=");
f.append(c.colsTOids[e]);
f.append("&v=");
f.append(fa(a));
this.j.Ab(f.toString (),true)
}
};
Ra(ir[_P],function () {
var a=T(this.Vj);
Kh(this.Vj.userComTxtAreaElem);
a.removeNode(this.Vj);
this.Vj=null;
a.removeNode(this.cC);
this.cC=null;
a.removeNode(this.Ns);
this.Ns=null
});
var yn=function (a) {
Xi.call(this,a);
this.G=new mj(this)
};
yn.inherits(Xi);
var jr;
yn[_P].i6=null;
yn[_P].kO=null;
yn[_P].zm=null;
yn[_P].wv=false;
yn[_P].jT=function (a) {
var b=this.wv;
this.wv=a;
if(b==a||!this.A)return ;
var c=this.F;
if(a) {
var d=this.zm;
this.G.unlisten(d,U,this.Xm);
c.removeNode(d);
this.zm=null
}else {
var d=c.b("a",{
	href:"#"
},_M[510]);
c.appendChild(this.A,d);
this.G.listen(d,U,this.Xm);
this.zm=d
}
};
yn[_P].b=function () {
var a=this.F,b=new Jm(W.getPublishedFormBasePath());
b.ua("key",l.trixApp.Ze);
var c=
a.b("div",{
"class":"formIndicator"
},_M[511]+" ",this.kO=a.b("a",{
href:b,target:"_BLANK"
},a.b("img",{
src:"/images/pop-out.png"
}),_M[512]));
a.appendChild(c,a.createTextNode(" "));
if(!this.wv)a.appendChild(c,this.zm=a.b("a",{
href:"#"
},_M[510]));
this.A=c
};
yn[_P].Lb=function () {
var a=this.A;
if(!a||!this.rb||a[J][Cd]=="none")return 0;
return this.A[Id]
};
yn[_P].Db=function () {
yn.B.Db.call(this);
if(!this.wv)this.G.listen(this.zm,U,this.Xm)
};
yn[_P].D=function (a) {
C(this.A[J],a?"":"none")
};
yn[_P].Xm=function (a) {
a.preventDefault();
this.dispatchEvent("edit_form")
};
yn[_P].rc=function () {
this.G.cc();
yn.B.rc.call(this)
};
yn[_P].dispose=function () {
this.G.dispose();
this.G=null;
this.i6=null;
this.kO=null;
this.zm=null
};
var kr=function (a) {
this.Tq=a||"";
this.zfa=0;
this.dC={
}
};
te(kr,af);
var lr=function (a) {
this.id=a;
this.node=null
};
kr[_P].Eb=function (a) {
var b=a||this.n6();
return this.dC[b]=new lr(b)
};
kr[_P].n6=function () {
return this.Tq+++this.zfa
};
kr[_P].jF=function (a) {
this.zU();
Lg(a,R(this.kea,this))
};
kr[_P].zU=function () {
var a=this.dC;
for(var b in a)a[b].node=null
};kr[_P].kea=function (a) {
var b=this.dC;
if(a[lc]==1) {
var c=a.id;
if(c&&c in b)b[c].node=a
}return false
};
kr[_P].dispose=function () {
if(!this.N()) {
af[_P].dispose.call(this);
this.zU();
this.dC=null
}
};
var mr=function (a,b,c,d) {
Fj.call(this,a,false,d||2,true);
this.Ce=new kr("le");
var e=this.Ce;
this.q9=e.Eb();
this.Pfa=e.Eb();
this.DQ=e.Eb();
this.Zq=e.Eb();
this.Dw=e.Eb();
this.Ew=e.Eb();
this.bE=e.Eb();
this.Gw=e.Eb();
this.n9=e.Eb();
this.Cw=e.Eb();
this.o9=e.Eb();
this.vM=null;
this.Qb=[];
this.zq=[];
this.rv=true;
this.QX=false;
this.cI=null;
this.IJ=null;
var f=this.Ja();
this.De=T(f);
var g=this.sY(b,c);
xg(f,g);
this.q=new mj(this);
this.K_()
};
mr.inherits(Fj);
var nr="dialog-ranges",or=nr+"-tr-normal";
mr[_P].sY=
function (a,b) {
var c=this.Pa().pathImg,d=R(this.De.b,this.De),e=d("table",{
className:nr,style:"width: 500px;"
},d("tbody",null,d("tr",null,d("td",null,d("div",{
id:this.q9.id
},"")),d("td",{
align:"right"
},d("a",{
target:"_blank",href:a,id:this.Pfa.id
},_M[345]))),d("tr",null,d("td",{
colSpan:"2",style:"border: 1px solid #999;"
},d("div",{
id:this.DQ.id,style:"height: 300px; overflow-y: auto; overflow-x: hidden;"
},d("table",{
id:this.Zq.id,cellPadding:"0",cellSpacing:"0",style:"width: 100%; padding: 0;"
},d("tbody")),
d("div",{
id:this.Ew.id,style:"text-align: center; padding: 1em 0;"
},b),d("div",{
id:this.Dw.id
}),d("table",{
id:this.bE.id,style:"height: 100%; width: 100%; padding: 1em 0;"
},d("tbody",null,d("tr",null,d("td",{
style:"vertical-align: middle; text-align: center"
},d("img",{
src:c+"spinWait.gif"
})))))))),d("tr",{
id:this.Gw.id
},d("td",null,"+",d("span",{
id:this.n9.id,className:"menuMainLink"
},_M[334])),d("td",{
style:"text-align: right;"
},d("button",{
name:"done"
},_M[339]))),d("tr",{
id:this.Cw.id
},d("td",null,
d("span",{
id:this.o9.id,className:"menuMainLink"
},"View all")),d("td",{
style:"text-align: right;"
},d("button",{
name:"save"
},_M[337]),d("button",{
name:"cancel"
},_M[338])))));
this.Ce.jF(e);
return e
};
mr[_P].K_=function () {
this.q.listen(this.n9.node,U,this.kW);
this.q.listen(this.o9.node,U,this.Bf);
this.q.listen(this.Gw.node,U,this.C7);
this.q.listen(this.Cw.node,U,this.u7)
};
var pr=function (a,b,c) {
af.call(this);
var d=a.Qa(),e,f,g=R(b.De.b,b.De);
d.appendChild(g("td",{
style:"vertical-align: middle; text-align: center;"
},
e=g("span",{
className:"menuMainLink"
},_M[483])));
d.appendChild(g("td",{
style:"vertical-align: middle; text-align: center;"
},f=g("span",{
className:"menuMainLink"
},_M[482])));
r(d,or);
for(var h=d[M];h;h=h[Dd]) {
Bi(h,"border-bottom","1px solid #C1D9FF");
Bi(h,"padding","4px")
}var i=new mj;
i.listen(e,U,R(b.v7,b,this));
i.listen(f,U,R(b.r7,b,this));
i.listen(d,U,R(b.uP,b,this));
this.lr=a;
this.q=i;
this.Mc=c
};
pr.inherits(af);
pr[_P].dispose=function () {
if(!this.N()) {
pr.B.dispose.call(this);
this.q.dispose();
this.q=
null;
this.lr.dispose();
this.lr=null
}
};
mr[_P].EF=function () {
V(this.bE.node,true);
V(this.Zq.node,false);
V(this.Ew.node,false);
V(this.Dw.node,false);
V(this.Gw.node,this.rv);
V(this.Cw.node,!this.rv);
this.D(true)
};
mr[_P].Bf=function () {
if(!this.Ft(this.Bf,this))return ;
this.rv=true;
var a=this.Qb,b=this.zq,c=this.Zq.node[M];
for(var d=0;d<a[E];d++) {
var e=b[d];
if(!e) {
	var f=this.qz(this.De);
	f.render(c);
	e=new pr(f,this,d);
	b[d]=e
}e.lr.ey(a[d])
}for(var d=a[E];d<b[E];d++) {
b[d].dispose();
b[d]=null
}Da(b,a[E]);
var g=
b[E]==0;
D(this.DQ.node[J],"300px");
V(this.bE.node,false);
V(this.Zq.node,!g);
V(this.Ew.node,g);
V(this.Dw.node,false);
V(this.Gw.node,true);
V(this.Cw.node,false);
this.D(true)
};
mr[_P].Pr=function (a,b) {
if(!this.Ft(this.Pr,this,b))return ;
this.rv=false;
this.QX=da(b);
var c=df(this.Qb,a);
this.IJ=c>=0?a:null;
var d=this.B5;
if(!d) {
d=this.pz(this.De);
d.render(this.Dw.node);
this.B5=d
}d.ey(a,c<0);
D(this.DQ.node[J],"");
V(this.bE.node,false);
V(this.Zq.node,false);
V(this.Ew.node,false);
V(this.Dw.node,true);
V(this.Gw.node,
false);
V(this.Cw.node,true);
this.D(true)
};
mr[_P].k4=function (a) {
if(this.Qb) {
var b=df(this.Qb,a);
if(b>=0)this.uP(this.zq[b])
}
};
mr[_P].kW=function () {
this.Pr(this.mz())
};
mr[_P].Ft=function () {
var a=this.XC();
if(a) {
this.Qb=a;
return true
}else {
this.cI=R.apply(null,arguments);
this.EF();
return false
}
};
mr[_P].Saa=function () {
var a=this.cI;
this.cI=null;
if(this.Ka())if(a)a();
else if(this.rv)this.Bf()
};
mr[_P].XC=function () {
};
mr[_P].qz=function () {
};
mr[_P].pz=function () {
};
mr[_P].mz=function () {
};
mr[_P].vD=function () {
};
mr[_P].HD=function () {
};
mr[_P].v7=function (a) {
this.Pr(this.Qb[a.Mc])
};
mr[_P].r7=function (a) {
var b=a.Mc,c=this.zq;
if(c[b]!==a)throwError("ListEditor itemRows got out of sync!");
if(!this.vD(this.Qb[b]))return ;
this.Qb.splice(b,1);
c.splice(b,1);
a.dispose();
for(var d=b;d<c[E];d++)c[d].Mc--;var e=c[E]==0;V(this.Zq.node,!e);V(this.Ew.node,e)
};mr[_P].uP=function (a) {
var b=this.vM;
if(!a||a===b)return ;
if(b&&b.lr)r(b.lr.Qa(),or);
r(a.lr.Qa(),nr+"-tr-hilight");
this.vM=a
};
mr[_P].C7=function (a) {
if(a[Sc][td]=="BUTTON") {
var b=
a[Sc][yd];
if(b=="done")this.D(false)
}
};
mr[_P].u7=function (a) {
if(a[Sc][td]=="BUTTON") {
var b=a[Sc][yd];
if(b=="cancel")if(this.QX)this.D(false);
else this.Bf();
else if(b=="save") {
	var c=this.B5.Z7();
	if(c)this.HD(c,this.IJ)
}
}
};
mr[_P].dispose=function () {
if(!this.N()) {
mr.B.dispose.call(this);
ef(this.zq,bf);
kf(this.zq);
this.zq=null;
this.q.dispose();
this.q=null;
this.Ce.dispose();
this.Ce=null;
this.vM=null;
this.Qb=null;
this.IJ=null;
this.De=null
}
};
var qr=function (a,b) {
Xi.call(this,b);
this.Nb=a.Ti();
this.PD=a.pathImg;
this.Ce=new kr("acl_ul");
var c=this.Ce;
this.KQ=c.Eb();
this.JQ=c.Eb();
this.Fw=c.Eb();
this.Iw=c.Eb();
this.Qb=new $g;
this.bx=new bh;
this.q=new mj(this);
this.wq=false;
this.qv=true;
this.QM=[];
this.x8=[]
};
qr.inherits(Xi);
var rr=function (a,b) {
this.principal=a;
this.div=b;
this.Ok=false;
this.numSelectedMemberships=0
};
qr[_P].$b=function () {
return false
};
qr[_P].b=function () {
var a=R(this.F.b,this.F),b=a("table",{
cellspacing:"0",cellpadding:"0"
},
a("tbody",null,a("tr",null,a("td",{
style:"vertical-align: top;"
},a("div",{
style:"padding: 0.2em;"
},a("img",{
src:this.PD+"gadgets/togglearrow-up.gif",id:this.KQ.id,height:11,width:11
}))),a("td",null,a("div",{
id:this.JQ.id,style:"color: #A0A0A0;"
}),a("div",{
id:this.Fw.id,style:"padding-bottom: 0.5em;"
}),a("div",{
id:this.Iw.id
})))));
this.lx(b);
this.Ce.jF(b)
};
qr[_P].Db=function () {
qr.B.Db.call(this);
this.q.listen(this.Fw.node,U,this.Kq);
this.q.listen(this.Iw.node,U,this.Kq);
this.q.listen(this.Nb,ji,this.EU);
this.q.listen(this.KQ.node,U,this.f8);
this.EU()
};
qr[_P].rc=function () {
qr.B.rc.call(this);
this.q.cc()
};
qr[_P].WY=function (a) {
var b=R(this.F.b,this.F);
return b("div",{
style:"cursor: pointer;",title:a.email,"class":"aclUserEntry"
},b("input",{
type:"checkbox",value:a.id
}),a[yd])
};
qr[_P].EU=function () {
if(!this.Nb.DC())return ;
var a=this.Nb.Qn.Fb();
a.sort(function (f,g) {
return uf(f[yd],g[yd])
});
var b=this.Qb;
b.clear();
yg(this.Fw.node);
yg(this.Iw.node);
for(var c=0;c<a[E];c++) {
var d=a[c],e=this.WY(d);
b.set(d.id,
new rr(d,e));
if(d.members)xg(this.Fw.node,e);
else xg(this.Iw.node,e)
}this.kG();
this.jy()
};
qr[_P].Yf=function (a,b,c) {
if(a.Ok==b)return ;
if(b)this.bx.add(a.principal.id);
else this.bx.remove(a.principal.id);
a.Ok=b;
var d=b?1:-1;
if(a.principal.members) {
var e=a.principal.members.Fb();
for(var f=0;f<e[E];f++) {
	var g=this.Qb.get(e[f]);
	if(g) {
		g.numSelectedMemberships+=d;
		if(c)this.Ov(g)
	}
}
}if(c)this.Ov(a)
};
qr[_P].Ov=function (a) {
var b=a.div;
if(b) {
var c=Dg(b);
La(c,a.Ok||a.numSelectedMemberships>0);
Xa(c,!a.Ok&&a.numSelectedMemberships>
0);
cb(b[J],a.Ok?"#E0EDFE":"#FFFFFF")
}
};
qr[_P].Bf=function (a) {
this.wq=a;
this.KQ.node.src=this.PD+(a?"gadgets/togglearrow-down.gif":"gadgets/togglearrow-up.gif");
this.jy()
};
qr[_P].$S=function (a,b) {
this.QM=b||[];
this.x8=a||this.QM;
this.kG();
this.jy()
};
qr[_P].px=function (a) {
this.qv=a;
this.kG();
this.jy();
this.Bf(!a)
};
qr[_P].EL=function () {
return this.bx.Fb()
};
qr[_P].kG=function () {
var a=this.bx;
a.clear();
a.To(this.qv?this.QM:this.x8);
var b=this.Qb.Fb();
for(var c=0;c<b[E];c++) {
var d=b[c];
this.Yf(d,a.contains(d.principal.id),
false)
}for(var c=0;c<b[E];c++)this.Ov(b[c])
};qr[_P].jy=function () {
V(this.Iw.node,this.wq);
V(this.Fw.node,this.wq);
V(this.JQ.node,this.qv||!this.wq);
var a;
if(!this.wq)a="Currently: "+this.bx.Fb().join(", ");
else if(this.qv)a="According to parent object";
y(this.JQ.node,a)
};
qr[_P].f8=function () {
this.Bf(!this.wq)
};
qr[_P].Kq=function (a) {
if(this.qv) {
a.preventDefault();
return
}var b=a[Sc];
while(b&&b[td]!="DIV")b=b[O];
if(!b||b[dc]!="aclUserEntry")return ;
var c=Dg(b),d=c[I],e=this.Qb.get(d);
if(!e)throwError("Principal not found");
this.Yf(e,!e.Ok,true);
fi(R(this.Ov,this,e),0);
a.preventDefault()
};
qr[_P].dispose=function () {
if(!this.N()) {
qr.B.dispose.call(this);
this.q.dispose();
this.q=null;
this.Qb.clear();
this.Qb=null;
this.Ce.dispose();
this.Ce=null;
this.Nb=null
}
};
var sr=function (a,b) {
Xi.call(this,b);
this.j=a;
this.Nb=a.Ti();
this.vs=null;
this.Ce=new kr("acl_ed");
var c=this.Ce;
this.EQ=c.Eb();
this.p9=c.Eb();
this.CQ=c.Eb();
this.HQ=c.Eb();
this.$q=c.Eb();
this.aE=c.Eb();
this.Hw=c.Eb();
this.$D=c.Eb();
this.Xq=c.Eb();
this.r9=c.Eb();
this.zQ=c.Eb();
this.Yq=c.Eb();
this.s9=c.Eb();
this.q=new mj(this);
this.ns=new qr(a,b);
this.Ca(this.ns);
this.qs=new qr(a,b);
this.Ca(this.qs)
};
sr.inherits(Xi);
sr[_P].$b=function () {
return false
};
sr[_P].b=function () {
var a=R(this.F.b,this.F),b=
a("table",null,a("tbody",null,a("tr",null,a("td",{
colspan:"2"
},a("b",null,"Protect "),a("span",{
id:this.EQ.id
},a("b",{
id:this.p9.id
},""),a("span",{
id:this.CQ.id,style:"font-size: smaller; padding-top: 0;",className:"menuMainLink"
},"change")),a("span",{
id:this.HQ.id
},a("select",{
id:this.$q.id
},a("option",null,"Sheet"),a("option",null,"Range"))," ",a("select",{
id:this.aE.id
}),a("input",{
id:this.Hw.id,type:"text",size:"15"
})))),a("tr",null,a("td",{
style:"vertical-align: top;"
},a("input",{
type:"checkbox",
value:"1",id:this.$D.id
})),a("td",null,a("label",{
"for":this.$D.id
}," Prevent accidental changes"),a("div",{
style:"color: #A0A0A0;"
},"Collaborators will need to unlock from toolbar to edit."))),a("tr",null,a("td",{
style:"vertical-align: top;"
},a("input",{
type:"checkbox",value:"1",id:this.Xq.id
})),a("td",null,a("label",{
"for":this.Xq.id
}," Let only certain people edit"),a("div",{
id:this.r9.id
}))),a("tr",{
id:this.zQ.id
},a("td",{
style:"vertical-align: top;"
},a("input",{
type:"checkbox",value:"1",id:this.Yq.id
})),
a("td",null,a("label",{
"for":this.Yq.id
}," Let others manage protection"),a("div",{
id:this.s9.id
})))));
this.lx(b);
this.Ce.jF(b);
this.ns.render(this.r9.node);
this.qs.render(this.s9.node)
};
sr[_P].Db=function () {
sr.B.Db.call(this);
var a=this.q;
a.listen(this.CQ.node,U,this.RT);
a.listen(this.Xq.node,U,this.j7);
a.listen(this.Yq.node,U,this.k7);
a.listen(this.$q.node,Rh,this.DP);
a.listen(this.j.mouseSelection,tr,this.b8)
};
sr[_P].rc=function () {
sr.B.rc.call(this);
this.q.cc()
};
sr[_P].ey=function (a,b) {
this.vs=
a;
if(b)this.RT();
else {
V(this.EQ.node,true);
V(this.HQ.node,false);
var c=a[Xc]==null;
V(this.CQ.node,!c);
var d;
if(c)d="the whole spreadsheet";
else {
	var e=this.j.Aa,f=e.pb(a[Xc]).Lc();
	d=a.range?ur(f,a.range):f
}Ig(this.p9.node,d)
}var g=a.permissions[di.ADVISORY_LOCK];
La(this.$D.node,da(g&&g[E]>0));
var h=a.permissions[di.EDIT],i=this.Nb.pL(a,di.EDIT);
La(this.Xq.node,da(h));
this.ns.$S(h,i);
this.ns.px(!da(h));
h=a.permissions[di.MANAGE_ACLS];
var i=this.Nb.pL(a,di.MANAGE_ACLS);
La(this.Yq.node,da(h));
this.qs.$S(h,
i);
this.qs.px(!da(h));
var j=a.range==null;
V(this.zQ.node,j)
};
sr[_P].RT=function () {
var a=this.j.Aa,b=this.vs;
this.vs=null;
var c=b?b[Xc]:a.Ui().id,d;
if(b&&b.range)d=ur(a.pb(c).Lc(),b.range);
var e=this.$q.node;
Ha(e,d?1:0);
var f=this.aE.node;
yg(f);
Da(f[Zc],0);
var g=a.yh();
for(var h=0;h<g[E];h++) {
var i=g[h].Lc();
f.appendChild(this.F.b("option",{
	value:i
},i));
if(g[h].id==c)Ha(f,h)
}var j=this.Hw.node;
Ta(j,d?d:"");
V(f,!d);
V(j,da(d));
V(this.EQ.node,false);
V(this.HQ.node,true)
};
sr[_P].DP=function () {
var a=this.$q.node[cc];
if(a>=0&&a<=1) {
var b=a==0;
V(this.aE.node,b);
V(this.Hw.node,!b);
V(this.zQ.node,b)
}
};
sr[_P].j7=function () {
this.ns.px(!this.Xq.node[ic])
};
sr[_P].k7=function () {
this.qs.px(!this.Yq.node[ic])
};
sr[_P].b8=function (a) {
var b=this.j,c=new si(b,a.address),d=b.Aa.pb(c[Xc]);
if(d)if(c.i5()) {
c.Rd=1;
c.nf=d.Ba
}else if(c.h5()) {
Ca(c,1);
Rb(c,d.Ha())
}var e=this.$q.node;
if(e[cc]!=1) {
Ha(e,1);
this.DP()
}Ta(this.Hw.node,c.toString ())
};
sr[_P].Z7=function () {
var a=this.j,b=this.vs,c=new ci;
if(b) {
mb(c,b[Xc]);
c.range=b.range
}else {
var d=
a.Aa,e=this.$q.node[cc];
if(e==0) {
	var f=this.aE.node[I],g=d.ou(f);
	if(!g) {
		a.cb(_M[332]);
		return null
	}mb(c,g.id)
}else if(e==1) {
	var h=this.Hw.node[I],i=new si(a,h);
	if(!i.Tk()) {
		a.cb(i.Qi);
		return null
	}mb(c,i[Xc]);
	c.range=vr(i.toString ())
}if(c[Xc]==null) {
	a.cb("Invalid selection");
	return null
}
}var j={
};
if(this.Xq.node[ic])j[di.EDIT]=this.ns.EL();
if(!c.range&&this.Yq.node[ic])j[di.MANAGE_ACLS]=this.qs.EL();
j[di.ADVISORY_LOCK]=this.$D.node[ic]?["@collabs"]:[];
c.permissions=j;
return c
};
sr[_P].dispose=function () {
if(!this.N()) {
sr.B.dispose.call(this);
this.Ce.dispose();
this.Ce=null;
this.q.dispose();
this.q=null;
this.vs=null;
this.Nb=null;
this.j=null
}
};
var wr=function (a) {
var b="http://docs.google.com/support/spreadsheets/",c="No special rules: all collaborators can edit.",d="Access Control";
mr.call(this,a,b,c);
this.j=a;
this.Nb=a.Ti();
this.Va(d);
var e=this.q9.node,f=T(e);
e.appendChild(f.b("span",null,f.b("span",{
style:"color: #C00000; font-weight: bold;"
},"Experimental! "),f.b("a",{
href:"mailto:trix-feedback@google.com?subject=granular permissions feedback: [ Fill in 1-line summary ]&body=Describe your issue or feedback:%0A%0A%0A%0AWhat were you attempting to do with this feature? Did it work for you?%0A%0A%0A%0AThanks a lot for the feedback! We might not be able to reply individually, but we'll be sure to look into your issue.%0A%0ASpreadsheets Team",
target:"_blank"
},"Email us with feedback")));
Dh(this.Nb,ji,this.Y7,false,this)
};
wr.inherits(mr);
wr[_P].aK=function (a) {
if(!this.Ft(this.aK,this,a))return ;
var b=this.j.activeGrid,c;
if(a)c=xr(b.O,b.Y,b.ma,b.Z);
var d=this.Nb.Gp(b.id,c);
if(!d) {
d=new ci;
d.permissions={
};
d.permissions[di.ADVISORY_LOCK]=[];
mb(d,b.id);
d.range=c
}this.Pr(d,true)
};
wr[_P].FT=function (a) {
if(!this.Ft(this.FT,this,a))return ;
this.Bf();
this.k4(this.Nb.Gp(a[Xc],a.range))
};
wr[_P].Y7=function () {
if(this.Nb.DC())this.Saa()
};
wr[_P].XC=function () {
this.Nb.nO(false);
return this.Nb.DC()?this.Nb.HB():null
};
wr[_P].mz=function () {
var a=this.j.activeGrid,b=new ci;
b.permissions={
};
b.permissions[di.ADVISORY_LOCK]=[];
mb(b,a.id);
if(a.ma>1||a.Z>1)b.range=xr(a.O,a.Y,a.ma,a.Z);
return b
};
wr[_P].qz=function (a) {
return new yr(this.j,a)
};
wr[_P].pz=function (a) {
return new sr(this.j,a)
};
wr[_P].HD=function (a,b) {
var c=R(this.EF,this),d=R(this.FT,this,a),e=R(this.Pr,this,a);
this.Nb.z$(a,b,c,d,e)
};
wr[_P].vD=function (a) {
var b=R(this.EF,this),c=R(this.Bf,this),d=R(this.Bf,this);
return this.Nb.deleteRule(a,
b,c,d)
};
wr[_P].dispose=function () {
if(!this.N()) {
wr.B.dispose.call(this);
this.j=null;
this.Nb=null
}
};
var yr=function (a,b) {
Xi.call(this,b);
this.j=a;
this.Nb=a.Ti()
};
yr.inherits(Xi);
yr[_P].$b=function () {
return false
};
yr[_P].b=function () {
var a=this.F,b=a.b("tr",{
style:"vertical-align: top;"
},a.b("td",null,a.b("div",{
style:"font-weight: bold;"
}),a.b("div",{
style:"padding-left: 2em;"
})));
this.tm(b)
};
yr[_P].ey=function (a) {
var b;
if(a[Xc]==null)b="Default for all sheets";
else {
var c=this.j.Aa.pb(a[Xc]),b=c?c.Lc():
"<Sheet #"+a[Xc]+">";
if(a.range)b+=" range "+a.range
}var d=this.Nb.G1(a),e=this.Qa()[L];
y(e[0][M],b);
y(e[0][Vc],d.join("<br>"));
if(a[Xc]==null)y(e[2],"&nbsp;")
};
yr[_P].dispose=function () {
if(!this.N()) {
yr.B.dispose.call(this);
this.j=null
}
};
var zr=function (a) {
Fj.call(this,a,false,1,true);
this.z=a;
this.F=T(this.Ja());
this.q=new mj(this);
this.gI={
};
this.b1();
this.Va(_M[118]);
var b=this.F;
b.appendChild(this.Ja(),b.b("table",{
"class":"function-picker-table",cellspacing:"0",cellpadding:"0"
},b.b("tbody",null,b.b("tr",null,b.b("td",null,this.mY()),b.b("td",null,this.HY())),b.b("tr",null,b.b("th",{
colSpan:2
},this.OY())),b.b("tr",null,b.b("th",{
colSpan:2
},this.vY())))));
this.wr(this.nq,this.lm);
this.zR(this.nq,this.Vu,this.mm)
};
zr.inherits(Fj);
zr[_P].yz=null;
zr[_P].rp=null;
zr[_P].lm=null;
zr[_P].mm=null;
zr[_P].gq=null;
zr[_P].nq=null;
zr[_P].Vu="ABS";
var Ar={
},Br="function-picker-function",Cr="function-picker-category";
zr[_P].b1=function () {
var a=this.z.Pp();
for(var b=0;b<a[E];b++) {
var c=a[b][0],d=a[b][1],e=a[b][2],f=a[b][3];
if(c==this.Vu)this.nq=d;
if(!Ar[d])Ar[d]=[];
Ar[d].push([c,e,f])
}
};
zr[_P].mY=function () {
var a=this.F.b("div",{
"class":"function-picker-left-panel"
});
for(var b in Ar)this.F.appendChild(a,this.Wj(b));return a
};zr[_P].Wj=function (a) {
var b=
this.F.b("div",{
"class":Cr
},a);
if(a==this.nq) {
this.lm=b;
this.yz=this.nq
}this.q.listen(b,U,R(this.wr,this,a,b));
return b
};
zr[_P].OY=function () {
var a=this.F;
this.gq=a.b("td",{
"class":"function-picker-function-usage"
});
this.q.listen(this.gq,U,this.aH,false,this);
var b=a.b("span",{
"class":"function-picker-more-text"
},_M[119]+"\u00bb");
this.q.listen(b,U,this.u8,false,this);
return a.b("div",{
"class":"function-picker-down-panel"
},a.b("table",{
"class":"function-picker-help-table",cellpadding:"0",cellspacing:"0"
},
a.b("tbody",null,a.b("tr",null,this.gq),a.b("tr",{
height:"100%"
},a.b("td",{
"class":"function-picker-more-link",align:"right"
},b)))))
};
zr[_P].vY=function () {
return this.F.b("div",{
"class":"function-picker-explanation-text"
},_M[531])
};
zr[_P].HY=function () {
var a=this.F,b=a.b("div",{
"class":"function-picker-right-panel"
});
for(var c in Ar) {
var d=Ar[c],e=a.b("div",{
	id:c
});
this.gI[c]=e;
a.appendChild(b,e);
for(var f=0;f<d[E];f++) {
	var g=d[f][0],h=a.b("div",{
		"class":Br
	},a.b("span",{
		"class":"function-picker-function-link"
	},
	g));
	if(g==this.Vu) {
		this.mm=h;
		this.rp=this.Vu
	}this.q.listen(h,U,R(this.zR,this,c,g,h));
	a.appendChild(e,h);
	this.q.listen(h,Mh,R(this.aH,this));
	a.appendChild(e,h)
}
}this.iq();
return b
};
zr[_P].aH=function () {
var a=Ar[this.yz],b=null;
for(var c=0;c<a[E];c++)if(a[c][0]==this.rp)b=a[c][2];this.z.eN(this.rp,b)
};zr[_P].zR=function (a,b,c) {
if(this.mm)this.F.Xh(this.mm,{
"class":Br
});
this.mm=c;
this.rp=b;
this.F.Xh(this.mm,{
"class":Br+" function-picker-function-selected"
});
var d=Ar[a],e=null,f=null;
for(var g=0;g<d[E];g++)if(d[g][0]==
b) {
e=d[g][1];
f=d[g][2]
}y(this.gq,Pe("="+b+"("+f+")"))
};
zr[_P].wr=function (a,b) {
if(this.lm)this.F.Xh(this.lm,{
"class":Cr
});
this.lm=b;
this.yz=a;
y(this.gq,"");
this.iq();
this.F.Xh(this.lm,{
"class":Cr+" function-picker-category-selected"
});
V(this.gI[a],true)
};
zr[_P].iq=function () {
var a=this.gI;
for(var b in a) {
V(a[b],false);
this.F.Xh(a[b],{
	"class":Cr
})
}
};
zr[_P].u8=function () {
var a="http://docs.google.com/support/spreadsheets/bin/static.py?page=functionlist_en.html";
jm(a+"#"+this.rp)
};
zr[_P].dispose=function () {
if(!this.N())this.q.dispose()
};
var Er=function (a,b,c,d,e,f,g) {
Fj.call(this,a);
this.q=new mj(this);
this.oa=a.W();
this.qa=b;
this.ra=c;
this.lP=g;
var h=this.Ja(),i=T(h);
this.Va(d);
var j,k,m,n,q=i.b("span",{
});
y(q," &raquo;");
var p=i.b("div",{
style:"width: 376px; font-size: 10pt"
},e,j=i.b("span",{
}),k=i.b("span",{
"class":"dlgUploadIn"
},_M[193],i.b("img",{
src:a.pathImg+"spinWait.gif"
})),m=i.b("span",{
"class":"dlgUploadIn"
},i.b("br",{
}),_M[194]," ",n=i.b("a",{
href:"#"
},i.b("b",{
},_M[203],q))));
i.appendChild(h,p);
this.Ox=j;
this.Px=k;
this.Nx=
m;
this.gC=n;
if(!Dr) {
var s=new Ej;
s.set("cancel",_M[155],true,true);
Dr=s
}this.od(Dr);
this.q.listen(this,zj,this.ic);
this.Ye(0)
},Dr;
Er.inherits(Fj);
Er[_P].$c=null;
Er[_P].D=function (a) {
Er.B.D.call(this,a);
if(a) {
if(!this.$c) {
	this.$c=new Pk(this.oa,this.Ox,this.lP?"importFromOpen2":"importAndReplace");
	this.$c.uS(this,this.qa,this.ww,this.fl)
}this.iR();
this.Ye(0)
}
};
Er[_P].ic=function (a) {
if(S&&a.key==Aj)this.iR()
};
Er[_P].iR=function () {
this.$c.jE()
};
Er[_P].ww=function () {
var a=this.$c;
if(a.initFileUpload) {
var b=
qi(nm(a),_M[148]);
if(b!=null) {
	if(this.lP) {
		this.q.cc();
		this.q.listen(this.gC,U,R(this.ra.RM,this.ra,b,this,!this.ra.xN()))
	}else {
		this.q.cc();
		this.q.listen(this.gC,U,R(this.D,this,false))
	}this.Ye(2);
	this.UB()
}else this.Ye(0);
a.initFileUpload=false
}
};
Er[_P].UB=function () {
};
Er[_P].fl=function (a) {
if(a)this.Ye(1);
else ra(_M[146]("\n"))
};
Er[_P].Ye=function (a) {
var b=this.Px[J],c=this.Nx[J],d=this.gC[J];
if(a==0) {
C(b,"none");
C(c,"none");
C(d,"none")
}else if(a==1) {
C(b,"");
C(c,"none");
C(d,"none")
}else if(a==2) {
C(b,
"none");
C(c,"");
C(d,"")
}
};
Er[_P].dispose=function () {
if(!this.N()) {
Er.B.dispose.call(this);
this.q.dispose();
if(this.$c)this.$c.cleanup();
this.q=null;
this.$c=null;
this.oa=null;
this.qa=null;
this.ra=null;
this.lP=null;
this.Ox=null;
this.Px=null;
this.Nx=null;
this.gC=null
}
};
var Ap=function (a,b,c) {
var d=T(),e=d.b("div",{
},_M[252],d.b("span",{
"class":"dlgOpenImport2"
},_M[253]));
Er.call(this,a,b,c,_M[251],e,_M[254],true)
};
Ap.inherits(Er);
var Dp=function (a) {
Fj.call(this,a,false,1);
this.j=a;
this.Y9=false;
this.Us=false;
this.FF=false;
this.mM=null;
this.jb={
};
this.G=new mj(this);
this.Zb=null;
this.Lw=null;
this.Ib=new lq
},Fr;
Dp.inherits(Fj);
Dp[_P].show=function () {
var a=false;
if(!this.Y9) {
a=true;
this.Va(ym("Erpbeq Znpeb")+" (Experimental!)");
var b=this.Ja(),c=T(b);
if(!Fr) {
	var d=new Ej;
	Fr=d
}this.od(Fr);
var e=c.b("textarea",{
	disabled:true,cols:"65",rows:"15",style:"font-size: 18px; font-family: serif; padding: 2px; margin:2px; color:#000;"
},
""),f=c.b("input",{
	type:"checkbox",name:"maestrorelative",id:"maestrorelative"
}),g=c.b("table",{
	cellSpacing:"0"
},c.b("tbody",{
},c.b("tr",{
},c.b("td",{
	width:"0"
},f),c.b("td",{
},c.b("label",{
	"for":"maestrorelative"
},ym("Hfr Eryngvir Ersreraprf")))))),h=new Zq("Pause");
h.render();
var i=c.b("button",{
	name:"Save"
},ym("Fgbc Erpbeqvat")),j=c.b("button",{
	name:"Cancel"
},ym("Pnapry Erpbeqvat")),k=c.b("button",{
	name:"HideShow"
},"Show "+ym("Pbqr")),m=c.b("table",{
	cellSpacing:"0"
},c.b("tbody",{
},c.b("tr",{
},c.b("td",
{
	align:"left"
},h.Qa()),c.b("td",{
	align:"left"
},i),c.b("td",{
	align:"left"
},j)))),n=ym("uggcf")+"://"+ym("fvgrf.tbbtyr.pbz/n/tbbtyr.pbz/znrfgeb/hfre-znahny"),q=c.b("a",{
	target:"_blank",href:n
},ym("Yrnea Zber")),p=c.b("table",{
	width:"512px",cellSpacing:"0"
},c.b("tbody",{
},c.b("tr",{
},c.b("td",{
	align:"right",colspan:"2"
},q)),c.b("tr",{
},c.b("td",{
	colspan:"2"
},e)),c.b("tr",{
},c.b("td",{
},g)),c.b("tr",{
},c.b("td",{
	align:"left"
},m),c.b("td",{
	align:"right"
},k))));
this.mM=k;
this.Vg=e;
this.Lw=f;
this.FF=false;
c.appendChild(b,p);
var s=this.G;
s.listen(k,U,this.g4);
s.listen(f,U,this.OQ);
s.listen(h,Zi,this.D8);
s.listen(j,U,this.pX);
s.listen(i,U,this.Zca);
s.listen(this,zj,this.ic);
this.Y9=true;
V(this.Vg,this.Us)
}this.Ib.clear();
this.Tca();
this.D(true);
if(a) {
La(this.Lw,true);
this.OQ()
}
};
var Gr=ym("TRG_FPEVCG"),Hr=ym("ERPBEQVAT");
Dp[_P].Tca=function () {
var a=this.j.activeGrid,b=a.FL();
b.relative=this.Lw[ic];
Kb(b,"myTask");
this.FF=false;
Ta(this.Vg,"");
this.jb=b;
this.$f("START",this.QB)
};
Dp[_P].$f=function (a,b,
c) {
if(!b)b=this.XU;
var d=ki(this.s1()),e=this.j.gooffiLink.Xd(tp);
e=e+"&action="+a;
var f=new kq(e,this,b,c);
f.lc("v="+fa(d));
this.Ib.Lg(f)
};
Dp[_P].s1=function () {
var a={
},b=this.jb;
for(var c in b)a[c]=b[c];a.script="";return a
};Dp[_P].Q_=function () {
this.$f(Gr,this.QB)
};
Dp[_P].QB=function (a) {
this.V8(a);
if(this.jb.state==Hr&&!this.FF)this.Zb=fi(this.Q_,1000,this)
};
Dp[_P].V8=function (a) {
if(this.N())return ;
this.XU(a);
var b=this.Vg;
if(b[I]!=a.script) {
Ta(b,a.script);
wa(b,b[dd])
}
};
Dp[_P].OQ=function () {
var a=
this.Lw[ic];
this.jb.relative=a;
this.$f("UPDATE_CONFIG")
};
Dp[_P].Av=function () {
if(this.Zb) {
ei(this.Zb);
this.Zb=null;
this.FF=true
}
};
Dp[_P].Zca=function () {
this.Av();
this.$f("STOP",this.pf)
};
Dp[_P].pf=function () {
this.D(false,true)
};
Dp[_P].g4=function () {
this.Us=!this.Us;
V(this.Vg,this.Us);
var a=ym("Pbqr");
Ig(this.mM,this.Us?"Hide "+a:"Show "+a)
};
Dp[_P].D=function (a,b) {
if(a==false) {
if(!b)if(!la("Are you certain you want to discard this "+ym("erpbeqvat")+"?"))return ;
this.Av();
this.jb.state="IDLE"
}Dp.B.D.call(this,
a)
};
Dp[_P].XU=function (a) {
this.jb=a
};
Dp[_P].D8=function (a) {
var b=a[Sc],c=(b.Ma&16)!=0,d=c?"PAUSE":"UNPAUSE";
this.$f(d,this.QB)
};
Dp[_P].pX=function () {
if(!la("Are you certain you want to discard this "+ym("erpbeqvat")+"?"))return ;
this.Av();
this.$f("CANCEL",this.pf)
};
Dp[_P].ic=function (a) {
if(a.key=="save")this.$f("STOP",this.pf);
else this.$f("CANCEL",this.pf)
};
Dp[_P].dispose=function () {
if(!this.N()) {
this.Av();
Dp.B.dispose.call(this);
this.Ib.dispose();
this.G.dispose();
this.mM=null;
this.Lw=null
}
};
var Cp=function (a) {
this.j=a;
this.Ib=new lq
};
Cp[_P].run=function () {
var a=this.j.activeGrid,b=a.FL();
Kb(b,"myTask");
this.$f(b)
};
Cp[_P].$f=function (a,b,c) {
var d=ki(a),e=this.j.gooffiLink.Xd(sp),f=new kq(e,this,b,c);
f.lc("v="+fa(d));
this.Ib.Lg(f)
};
Cp[_P].dispose=function () {
if(!this.N()) {
this.Ib.dispose();
this.j=null
}
};
var xp=function (a,b,c) {
Fj.call(this,a);
this.qa=b;
this.ra=c;
this.q=new mj(this);
this.QC=new mj(this);
a=this.Pa();
this.Va(_M[195]);
var d=this.Ja(),e=T(d),f,g,h,i,j,k,m=e.b("span",{
});
y(m," &raquo;");
var n=e.b("div",{
"class":"dlgOpenContent"
},e.b("b",{
},_M[196]),e.b("table",{
"class":"dlgOpenHead",cellpadding:0,cellspacing:0
},e.b("tbody",{
},e.b("tr",{
},e.b("td",{
"class":"dlgOpenColName"
},e.b("a",{
},_M[197])),e.b("td",{
"class":"dlgOpenColOwn"
},e.b("a",{
},_M[198])),e.b("td",{
"class":"dlgOpenColDate"
},e.b("a",
{
},_M[199]))))),e.b("div",{
style:"left: 0px; top: 0px;"
},f=e.b("div",{
"class":"dlgOpenData"
},e.b("div",{
"class":"loadingMsg"
},_M[200],this.Yj(e),e.b("img",{
src:a.pathImg+"spinWait.gif"
}))),g=e.b("div",{
"class":"dlgOpenData"
})),e.b("div",{
style:"left: 0px; top: 0px;"
},e.b("div",{
"class":"dlgOpenImport1"
},e.b("b",{
},_M[201]),e.b("span",{
"class":"dlgOpenImport2"
},"(",_M[202],")"),h=e.b("span",{
}),i=e.b("span",{
},e.b("img",{
src:a.pathImg+"spinWait.gif"
})),j=e.b("span",{
},this.Yj(e),this.Yj(e),_M[194],
k=e.b("a",{
href:"#"
},e.b("b",{
},_M[203],m))))));
C(g[J],"none");
e.appendChild(d,n);
this.Bz=g;
this.hV=f;
this.Ox=h;
this.Px=i;
this.Nx=j;
this.X5=k;
if(!Ir) {
var q=new Ej;
q.set("cancel",_M[155],true,true);
Ir=q
}this.od(Ir);
this.q.listen(this,zj,this.ic);
this.Ye(0)
};
xp.inherits(Fj);
var Ir=null;
xp[_P].$c=null;
xp[_P].Ye=function (a) {
var b=this.Px[J],c=this.Nx[J];
if(a==0) {
C(b,"none");
C(c,"none")
}else if(a==1) {
C(b,"");
C(c,"none")
}else if(a==2) {
C(b,"none");
C(c,"")
}
};
xp[_P].show=function (a) {
var b=this.Bz,c=T(b);
if(a[E]==
0)y(b,_M[204]);
else {
var d,e=c.b("table",{
	"class":"dlgFileList"
},d=c.b("tbody",{
})),f=a;
for(var g=0;g<f[E];g++) {
	var h,i,j;
	h=c.b("tr",{
	},j=c.b("td",{
		"class":"dlgOpenColNameVal"
	},f[g].n),c.b("td",{
		"class":"dlgOpenColOwn dlgColSmallVals"
	},f[g].o),c.b("td",{
		"class":"dlgOpenColDate dlgColSmallVals"
	},c.createTextNode(f[g].l)),i=c.b("td",{
		"class":"dlgOpenColRemove"
	}),c.b("td",{
		"class":"dlgOpenColLast"
	}));
	if(g%2>0)r(h,"dlgOpenDataEvenRow");
	if(!f[g].me) {
		var k=this.cZ(c);
		c.appendChild(i,k);
		this.q.listen(k,U,
		R(this.yZ,this,f[g].n,f[g].k,e,h))
	}this.q.listen(j,U,R(this.ra.t8,this.ra,f[g].k));
	c.appendChild(d,h)
}c.zf(b);
c.appendChild(b,e)
}C(this.hV[J],"none");
C(this.Bz[J],"")
};
xp[_P].Yj=function (a) {
var b=a.b("span",{
});
y(b," &nbsp;");
return b
};
xp[_P].cZ=function (a) {
var b=a.b("img",{
"class":"dlgOpenImgX",src:this.Pa().pathImg+"closeX.gif",title:_M[205]
});
return b
};
xp[_P].eca=function () {
C(this.Bz[J],"none");
C(this.hV[J],"")
};
xp[_P].yZ=function (a,b,c,d) {
if(!la(_M[142](a,"\n")))return false;
if(this.ra.xZ(b)) {
var e=
c[pd];
om(c,d,d.rowIndex);
for(var f=0;f<e[E];f++)r(e[f],f%2>0?"dlgOpenDataEvenRow":"")
}
};xp[_P].D=function (a) {
xp.B.D.call(this,a);
if(a) {
if(!this.$c) {
	this.$c=new Pk(this.Pa().W(),this.Ox,"importFromOpen");
	this.$c.uS(this,this.qa,this.ww,this.fl)
}this.jR();
this.Ye(0);
this.eca()
}
};
xp[_P].ic=function (a) {
if(S&&a.key==Aj)this.jR()
};
xp[_P].jR=function () {
this.$c.jE()
};
xp[_P].ww=function () {
var a=this.$c,b=this.ra;
if(a.initFileUpload) {
var c=qi(nm(a),_M[148]);
if(c!=null) {
	this.QC.cc();
	this.QC.listen(this.X5,U,
	R(b.RM,b,c,this,!b.xN()));
	this.Ye(2)
}else this.Ye(0);
a.initFileUpload=false
}
};
xp[_P].fl=function (a) {
if(a)this.Ye(1);
else ra(_M[146]("\n"))
};
xp[_P].dispose=function () {
if(!this.N()) {
xp.B.dispose.call(this);
this.q.dispose();
this.QC.dispose();
if(this.$c)this.$c.cleanup();
this.q=null;
this.QC=null;
this.$c=null;
this.ra=null;
this.qa=null;
this.Px=null;
this.Nx=null;
this.Ox=null;
this.X5=null;
this.hV=null;
this.Bz=null
}
};
var Lr=function (a,b) {
Fj.call(this,a,false,2);
this.cE=false;
this.Ql=null;
this.yl=null;
this.VJ=[];
this.Bi=null;
this.Va(_M[311]);
var c=this.Ja(),d=T(c);
this.Sz=d.b("div",{
className:Jr+"-div"
},this.$Y(d));
var e=d.b("span",{
className:"menuMainLink"
},_M[334]);
this.xi(e,R(this.rt,this,true,null));
this.iO=e;
var f=d.b("a",{
target:"_blank",href:b
},_M[345]),g=d.b("table",{
},d.b("tbody",{
},d.b("tr",{
},d.b("td",{
},_M[335]),d.b("td",{
align:"right"
},f)),d.b("tr",{
},d.b("td",{
colSpan:"2"
},this.Sz)),d.b("tr",{
},d.b("td",
{
colSpan:"2"
},"+",e))));
d.appendChild(c,g);
if(!Kr) {
var h=new Ej;
h.set("done",_M[339],false,true);
Kr=h
}this.od(Kr)
};
Lr.inherits(Fj);
var Jr="dialog-ranges",Kr=null;
Lr[_P].$Y=function (a) {
this.SF=a.b("table",{
cellPadding:"4",cellSpacing:"0",width:"100%"
},a.b("tbody"));
return this.SF
};
Lr[_P].u9=function () {
if(this.cE) {
this.cE=false;
this.PQ();
this.Mm().getElementsByTagName("button")[0].focus()
}
};
Lr[_P].PQ=function (a) {
var b=this.Pa(),c=b.zd,d=c.GK(),e=T(f),f=this.SF[M];
e.zf(f);
this.oI();
this.Bi=null;
var g=
null;
if(a)this.yl=null;
else {
g=this.yl;
if(g) {
	g=g.rangeName;
	this.yl=null
}
}var h,i=null;
for(var j=0;j<d[E];j++) {
h=e.b("tr");
h.rangeName=d[j];
this.Vn(h,0);
e.appendChild(f,h);
if(h.rangeName==g) {
	this.$w(h);
	i=this.Bi
}
}this.Bi=i;
this.Ql=null;
r(this.iO,"menuMainLink")
};
Lr[_P].Vn=function (a,b) {
var c=this.Pa(),d=c.zd,e=a.rangeName,f=T(a),g=c.W(),h,i,j,k,m,n,q;
k=d.CB(e);
f.zf(a);
a.mode=b;
r(a,b==0?Jr+"-tr-normal":Jr+"-tr-hilight");
Aa(a,"top");
h=f.b("td");
f.appendChild(a,h);
r(h,Jr+"-td-name");
if(b==2) {
var p=f.b("td",
{
	style:"padding-top:4px"
}),s=f.b("table",{
	width:"95%",cellPadding:"0",cellSpacing:"0"
},f.b("tbody",{
},f.b("tr",{
},f.b("td",{
},k.n)),f.b("tr",{
},p)));
f.appendChild(h,s);
n=(new Sl(g,p,[[_M[337]]])).X[0];
q=(new Sl(g,p,[[_M[338]]])).X[0]
}else {
f.appendChild(h,f.createTextNode(k.n));
this.xi(h,R(this.$w,this,a,false))
}i=f.b("td");
f.appendChild(a,i);
r(i,Jr+"-td-area");
m=k.r1Pos<0?"#REF":xr(k.r1Pos,k.c1Pos,k.r2Pos-k.r1Pos+1,k.c2Pos-k.c1Pos+1);
if(b==2) {
var u=f.b("input",{
	type:"text",value:m,style:"width: 100px"
});
this.Bi=u;
f.appendChild(i,u);
u.setAttribute("autocomplete","off");
this.zs(u,R(this.yD,this,u,R(this.hG,this,e,u)),Qh);
fi(R(this.Hp,this,u),100);
this.xi(n,R(this.hG,this,e,u));
this.xi(q,R(this.Vn,this,a,1))
}else {
f.appendChild(i,f.createTextNode(m));
this.xi(i,R(this.$w,this,a,false));
this.Bi=null
}j=f.b("td");
f.appendChild(a,j);
r(j,Jr+"-td-del");
if(b!=2) {
f.appendChild(j,f.createTextNode("\u00d7"));
this.xi(j,R(this.EZ,this,a))
}
};
Lr[_P].$w=function (a,b) {
var c=this.yl;
if(a==c) {
if(!b)this.Vn(a,2)
}else {
if(c)this.Vn(c,
0);
this.Vn(a,1);
this.yl=a;
var d=this.Pa().zd;
d.DR(a.rangeName)
}if(a.mode==1||a.mode==2) {
var e=this.Sz;
if(e[hd]<a[hd]+a[Ed])wa(e,a[Ed])
}if(this.Ql!=null)this.rt(false,null)
};
Lr[_P].EZ=function (a) {
this.$w(a,true);
var b=a.rangeName;
if(la(_M[336](b))) {
this.cE=true;
var c=this.Pa().zd;
c.P$(b);
this.yl=null
}
};
Lr[_P].rt=function (a,b) {
var c=this.SF[M],d=this.iO,e=T(c);
if(a&&!this.Ql) {
var f=this.Pa(),g=f.W();
r(d,Jr+"-link-disabled");
var h=this.yl;
if(h!=null) {
	this.Vn(h,0);
	this.yl=null
}this.Ql=e.b("tr");
var i=
this.Ql,j,k,m,n,q;
i.mode=3;
r(i,Jr+"-tr-hilight");
Aa(i,"top");
j=e.b("td");
e.appendChild(i,j);
r(j,Jr+"-td-name");
var p=e.b("table",{
},e.b("tbody"));
e.appendChild(j,p);
x(p,"95%");
Ib(p,"1");
var s=e.b("td"),u=e.b("tr",{
},s);
n=(new Sl(g,s,[[_M[337]]])).X[0];
q=(new Sl(g,s,[[_M[338]]])).X[0];
var v=e.b("tr",{
},e.b("td"));
e.appendChild(p[M],v);
var t=e.b("input",{
	type:"text",style:"width: 120px; color: #676767",tabindex:"1",value:_M[343]
});
e.appendChild(v[M],t);
t.setAttribute("autocomplete","off");
t.initstat=
true;
fi(R(this.Y_,this,t),100);
e.appendChild(p[M],u);
k=e.b("td");
e.appendChild(i,k);
r(k,Jr+"-td-area");
var w=e.b("input",{
	type:"text",style:"width: 100px",tabindex:"1"
});
e.appendChild(k,w);
this.Bi=w;
w.setAttribute("autocomplete","off");
if(b)Ta(w,b);
else {
	w.initstat=true;
	Ta(w,_M[344]);
	Za(w[J],"#676767")
}this.zs(t,R(this.yD,this,t,R(this.Fy,this,t,w)),Qh);
this.zs(w,R(this.yD,this,w,R(this.Fy,this,t,w)),Qh);
this.xi(n,R(this.Fy,this,t,w));
this.xi(q,R(this.rt,this,false,null));
m=e.b("td");
e.appendChild(i,
m);
r(m,Jr+"-td-del");
e.appendChild(c,i);
wa(this.Sz,i[Ed])
}else if(!a&&this.Ql) {
var i=this.Ql;
e.removeNode(i);
this.Ql=null;
this.Bi=null;
r(d,"menuMainLink")
}
};
Lr[_P].pd=function (a,b) {
var c=this.Bi;
if(c)if(b) {
Ta(c,a);
if(c.initstat) {
	c.initstat=null;
	Za(c[J],"")
}
}else this.Pa().zF(this,a)
};
Lr[_P].Y_=function (a) {
a.focus();
pq(a,0);
tq(a,0)
};
Lr[_P].fba=function (a) {
this.rt(true,a)
};
Lr[_P].Fy=function (a,b) {
var c=a[I],d=this.Pa().zd;
if(a.initstat)c="";
var e=d.iea(c);
if(!e)if(d.CB(c.toLowerCase()))e=_M[333];
if(e) {
ra(e);
a.focus();
return
}this.hG(c,b)
};
Lr[_P].hG=function (a,b) {
var c=this.Pa().zd,d=b[I];
if(b.initstat)d="";
var e=c.Pq(d,true);
if(!e) {
b.focus();
return
}var f=a+":"+e.gid+":"+e.fromRowPos+":"+e.fromColPos+":"+e.toRowPos+":"+e.toColPos;
this.cE=true;
c.M$(f)
};
Lr[_P].yD=function (a,b,c) {
var d=c[ed]?c[ed]:(c[wd]?c[wd]:c[$c]);
if(d==13&&b) {
if(!c[Zb]&&!c[oc]&&!c[sd])b()
}else if(a.initstat) {
a.initstat=null;
Ta(a,"");
Za(a[J],"")
}
};
Lr[_P].Hp=function (a) {
a.focus()
};
Lr[_P].xi=function (a,b) {
this.zs(a,b,U)
};
Lr[_P].zs=function (a,
b,c) {
Dh(a,c,b,true,this);
this.VJ.push(a)
};
Lr[_P].oI=function () {
var a=this.VJ,b;
for(var c;c<a[E];c++) {
b=a[c];
if(b) {
	Kh(b);
	z(b,null)
}
}this.VJ=[]
};
Lr[_P].dispose=function () {
if(!this.N()) {
Lr.B.dispose.call(this);
this.oI();
this.SF=null;
this.Sz=null;
this.iO=null;
this.Bi=null
}
};
var zp=function (a,b,c) {
Er.call(this,a,b,c,_M[191],_M[192],_M[255],false)
};
zp.inherits(Er);
zp[_P].UB=function () {
this.D(false)
};
var Bp=function (a) {
Fj.call(this,a);
this.j=a;
this.Ib=new lq;
this.q=new mj(this);
this.Vg=null
};
Bp.inherits(Fj);
Bp[_P].show=function () {
var a=this.Vg;
if(!a) {
this.Va("Create or Modify "+ym("Fpevcg")+" (Experimental!)");
var b=this.Ja(),c=T(b),d=new Sn(_M[337]),e=new Sn(_M[338]);
a=c.b("textarea",{
	cols:"65",rows:"20",style:"font-size: 18px; font-family: serif; padding: 2px; margin:2px;"
});
var f,g=ym("uggcf")+"://"+ym("fvgrf.tbbtyr.pbz/n/tbbtyr.pbz/znrfgeb/hfre-znahny"),h=c.b("a",{
	target:"_blank",href:g
},
ym("Yrnea Zber")),i=c.b("table",{
	cellSpacing:"0"
},c.b("tbody",{
},c.b("tr",{
},c.b("td",{
	align:"right"
},h)),c.b("tr",{
},c.b("td",{
},a)),c.b("tr",{
},c.b("td",{
},f=c.b("div",{
})))));
this.Vg=a;
c.appendChild(b,i);
this.q.listen(d,Zi,this.Tg,this);
this.q.listen(e,Zi,R(this.D,this,false),this);
d.render(f);
e.render(f);
var j=new Ej;
this.od(j)
}Xa(a,true);
var k=this.Rp(this.eea,this.uQ);
this.Ib.Lg(k);
this.D(true)
};
Bp[_P].Rp=function (a,b) {
var c=this.j.gooffiLink.Xd(qp);
return new kq(c,this,a,b)
};
Bp[_P].Q1=function (a,
b,c) {
var d=this.j.gooffiLink.Xd(rp),e=new kq(d,this,a,b);
e.lc("v="+fa(c));
return e
};
Bp[_P].eea=function (a) {
var b=this.Vg;
Ta(b,a.script||"");
Xa(b,false)
};
Bp[_P].J8=function () {
this.j.C$();
this.D(false)
};
Bp[_P].Tg=function () {
var a=this.Vg;
Xa(a,true);
var b=a[I],c=this.Q1(this.J8,this.uQ,b);
this.Ib.Lg(c)
};
Bp[_P].D=function (a) {
fi(R(Bp.B.D,this,a),0,this)
};
Bp[_P].uQ=function () {
Xa(this.Vg,false)
};
Bp[_P].dispose=function () {
if(!this.N()) {
Bp.B.dispose.call(this);
if(this.q) {
	this.q.dispose();
	this.q=null
}if(this.Ib) {
	this.Ib.dispose();
	this.Ib=null
}this.Vg=null
}
};
var Mr=function (a) {
Fj.call(this,a,false,2);
this.Va(_M[325]);
var b=this.Ja(),c=T(b),d=c.b("div",{
},this.Wu=c.b("input",{
className:"dialog-selection-editbox"
}));
Mb(d[J],"auto");
this.Wu.setAttribute("autocomplete","off");
c.appendChild(b,d);
var e=this.RZ;
if(!this.RZ) {
var e=new Ej;
e.set("ok",_M[360],true);
e.set("cancel",_M[338],false,true);
this.RZ=e
}this.od(e);
Kh(this);
Dh(this,zj,R(this.ic,this))
};
Mr.inherits(Fj);
Mr[_P].xb=null;
Mr[_P].bv=false;
Mr[_P].$o=null;
Mr[_P].qw=null;
Mr[_P].uw=null;
Mr[_P].activate=
function (a,b) {
this.xb=a;
Ta(this.Wu,b);
if(!this.bv) {
this.bv=true;
this.Iy(0)
}
};
Mr[_P].reposition=function () {
var a=this.qw;
Fi(this.zk(),a.x,a.y)
};
Mr[_P].Iy=function (a) {
var b=this.Ja(),c=T(b),d=this.xb.zk();
if(a==0) {
var e=Gi(d),f=Li(d);
this.xb.D(false);
var g=c.b("div",{
	style:"border: 1px solid black; position: absolute; display: block;  z-index: 1000; top:"+e.y+"px; left:"+e.x+"px; width:"+f[F]+"px; height:"+f[P]+"px;"
});
c.appendChild(oa[Lc],g);
this.$o=g;
this.qw=e;
this.uw=f;
fi(R(this.Iy,this,1),25)
}else if(a==
5) {
c.removeNode(this.$o);
this.D(true);
this.$o=null;
this.qw=null;
this.uw=null
}else {
var f=this.uw,h=(5-a)/5,i=o.round((f[F]-200)*h)+200,j=o.round((f[P]-100)*h)+100,k=this.$o[J];
x(k,i+"px");
D(k,j+"px");
fi(R(this.Iy,this,a+1),25)
}
};
Mr[_P].pd=function (a) {
Ta(this.Wu,a)
};
Mr[_P].ic=function (a) {
if(a[N]==zj) {
var b=this.xb;
this.bv=false;
this.D(false);
b.D(true);
if(a.key=="ok") {
	var c=this.Wu;
	if(b&&b.pd)b.pd(c[I],true)
}
}
};
Mr[_P].dispose=function () {
if(!this.N()) {
Mr.B.dispose.call(this);
this.xb=null;
this.Wu=null;
this.bv=null;
this.$o=null;
this.qw=null;
this.uw=null
}
};
var yp=function (a) {
Fj.call(this,a);
this.qF=new $g;
this.Ub=false;
this.Y5=false;
this.j_="";
this.Va(_M[315]);
var b=this.Ja(),c=T(b),d=c.b("table",{
className:Nr
},c.b("tbody",{
},this.UI(c,_M[316]),this.RI(c,_M[318]('<a class="aBlue" id="ds-settings-link" target="_blank">',"</a>"),0,true),this.UI(c,_M[317]),this.RI(c,_M[319],1)));
c.appendChild(b,d);
if(!Or) {
var e=new Ej;
e.set("save",_M[320],true);
e.set("cancel",_M[321],false,true);
Or=e
}this.od(Or);
Dh(this,zj,R(this.ic,this))
};
yp.inherits(Fj);
var Nr="dialog-settings",
Or=null;
yp[_P].UI=function (a,b) {
return a.b("tr",{
},a.b("td",{
className:Nr+"-label"
},b))
};
yp[_P].RI=function (a,b,c,d) {
var e=Nr,f=null,g,h=a.b("tr",{
},a.b("td",{
className:e+"-input"
},f=a.b("select",{
})),g=a.b("td",{
className:e+"-text"
},!d?b:""));
if(d)y(g,b);
this.qF.set(c,f);
return h
};
yp[_P].D=function (a) {
if(a) {
var b=this.Pa();
if(!this.Ub) {
	this.Ub=true;
	var c=b.OE(Pr);
	if(c&&c.l&&c.tz) {
		this.VM(0,c.l);
		this.VM(1,c.tz);
		this.j_=c.dls
	}
}var d=b.Kl;
this.cT(0,d.loc);
this.cT(1,d.t)
}yp.B.D.call(this,a);
if(this.Ub&&
!this.Y5) {
var e=kg("ds-settings-link");
if(e)zb(e,this.j_);
this.Y5=true
}
};
yp[_P].VM=function (a,b) {
var c=this.qF.get(a),d=b[E],e=T(c);
for(var f=0;f<d;f++) {
var g=b[f],h=e.b("option",{
	value:g[0]
},g[1]);
e.appendChild(c,h)
}
};
yp[_P].cT=function (a,b) {
var c=this.qF.get(a);
if(c) {
var d=c[Zc],e=d[E];
for(var f=0;f<e;f++)if(d[f][I]==b) {
	Sa(d[f],true);
	break
}
}
};
yp[_P].ic=function (a) {
if(a[N]==zj)if(a.key=="save") {
var b=this.qF,c=this.Pa(),d=oo+"=9";
d+="&atyp="+X.localeChange;
d+="&v="+b.get(1)[I];
d+="&l="+b.get(0)[I];
c.Ab(d,false)
}
};
yp[_P].dispose=function () {
if(!this.N())yp.B.dispose.call(this)
};
var Qr=function (a,b) {
Tq.call(this);
this.j=a;
var c=T(b);
this.De=c;
this.q=new mj(this);
var d=this.q,e,f,g,h=c.b("div",{
"class":"addRowsPopupContainer"
},g=c.b("div",{
"class":"insertRowsErrorDiv",style:"display: none;"
}),c.b("table",{
},c.b("tbody",{
},c.b("tr",{
},c.b("td",{
},e=c.b("span",{
"class":"addRowsPopupText"
})),f=c.b("td",{
})))));
y(e,_M[394]('<input type="text" size="2" maxlength="3" value="2" class="insertRowsInput"/>'));
V(h,false);
c.appendChild(b,h);
this.VP=h;
this.Bp=g;
this.rD=c.qB(e);
d.listen(this.rD,
kh,this.V2);
var i=c.nL(h),j=new Sl(i,f,[[_M[360]]]);
d.listen(j.X[0],U,this.Lh);
this.tS(h)
};
Qr.inherits(Tq);
Qr[_P].Lh=function () {
this.cM()
};
Qr[_P].V2=function (a) {
if(a[ed]==13)this.cM()
};
Qr[_P].cM=function () {
var a=ga(this.rD[I],10);
if(qa(a))this.ZQ(_M[395]);
else if(a<1||a>500)this.ZQ(_M[396](500));
else {
this.D(false);
V(this.Bp,false);
var b=this.j,c=b.activeGrid;
b.cN(X.rowInsertAfter,c.Ha(),a);
c.Vc(c.Ha(),1);
b.L()
}
};
Qr[_P].ZQ=function (a) {
var b=this.De;
this.D(false);
b.zf(this.Bp);
var c=b.createTextNode(a);
b.appendChild(this.Bp,c);
V(this.Bp,true);
this.D(true)
};
Qr[_P].ew=function () {
Qr.B.ew.call(this);
this.De.zf(this.Bp)
};
Qr[_P].jw=function () {
Qr.B.jw.call(this);
var a=this.De.nL(this.Qa());
if(S)this.q.listen(a,U,R(this.wD,this),true);
var b=this.rD;
b.focus();
b.select()
};
Qr[_P].dispose=function () {
if(!this.N()) {
Qr.B.dispose.call(this);
this.q.dispose();
this.q=null;
this.j=null;
this.rD=null;
this.Bp=null;
this.VP=null;
this.De=null
}
};
var Sr=function (a) {
Fj.call(this,a);
this.ZO=null;
var b=this.Ja(),c=T(b),d=c.b("div",{
style:"width:376px; font-size: 10pt;"
});
c.appendChild(b,d);
this.ZO=d;
if(!Rr) {
var e=new Ej;
e.set("ok",_M[154],false,true);
Rr=e
}this.od(Rr)
};
Sr.inherits(Fj);
var Rr=null;
Sr[_P].HS=function (a,b) {
this.Va(a);
y(this.ZO,b)
};
Sr[_P].dispose=function () {
if(!this.N()) {
Sr.B.dispose.call(this);
this.ZO=null;
this.Fea=null
}
};
var Ur=function (a) {
af.call(this);
var b=a.getDivApp(),c=T(b);
this.z=a;
this.G=new mj(this);
var d=this.G;
this.wI=null;
var e,f,g,h=c.b("div",{
"class":"cp-outer-div",style:"display: none;"
},c.b("table",{
"class":"cp-main-table"
},c.b("tbody",{
},c.b("tr",{
},e=c.b("td",{
})),f=c.b("tr",{
},g=c.b("td",{
})))));
c.appendChild(b,h);
this.Ys=null;
var i=c.b("input",{
type:"checkbox"
});
this.Ys=i;
c.appendChild(g,i);
var j=c.b("span",{
},_M[423]);
c.appendChild(g,j);
d.listen(j,U,this.u2);
d.listen(i,U,this.t2);
this.wI=f;
d.listen(f,
ih,this.fq);
d.listen(f,jh,this.Z2);
this.w8=h;
var k=Tr(e);
d.listen(k,"change",this.s2);
this.vg=k;
this.Zs=null;
this.ZI=null;
this.dn=false
};
Ur.inherits(af);
Ur[_P].eB=function () {
var a=this.Zs;
if(!a) {
a=new Vr(this.z);
this.Zs=a
}return a
};
Ur[_P].D=function (a,b,c,d) {
var e=this.w8[J];
this.ZI=null;
if(a&&b) {
ib(e,c);
e.top=d;
this.ZI=b;
var f=this.z.activeGrid,g=f.info,h=g.dB(f.Ga,f.Ea,true),i=h!=null&&h[E]>0;
La(this.Ys,i);
this.dn=true;
try{
	if(!i&&!S)this.vg.Ir(Di(f.Md(),b));
	else this.vg.$h(-1)
}catch(j) {
}this.dn=
false
}if(e[Cd][E]==0!=a)C(e,a?"":"none")
};
Ur[_P].s2=function (a) {
if(!this.dn) {
var b=a[Sc].Wp(),c=this.ZI;
if(b&&c) {
	var d=this.z;
	d.activeGrid.Tc(c,b);
	d.L(false,true)
}
}
};
Ur[_P].u2=function () {
La(this.Ys,true);
this.D(false);
this.eB().show()
};
Ur[_P].t2=function () {
if(this.Ys[ic]) {
this.D(false);
this.eB().show()
}else {
Wr(this.z,"");
this.D(true)
}
};
Ur[_P].fq=function () {
var a=this.wI;
if(a)fj(a,"cp-mouseover")
};
Ur[_P].Z2=function () {
var a=this.wI;
if(a)fj(a,"cp-mouseout")
};
var Tr=function (a) {
var b=new Qq;
b.oo(["#ffffff",
"#dddddd","#c0c0c0","#969696","#808080","#333333","#e1c7e1","#cc99ff","#993366","#800080","#6666cc","#333399","#c2d1f0","#99ccff","#00ccff","#3366ff","#0000ff","#000080","#ccffff","#bde6e1","#00ffff","#33cccc","#008080","#003366","#ccffcc","#b3d580","#00ff00","#339966","#008000","#003300","#ffff99","#ebd780","#ffff00","#99cc00","#808000","#333300","#fadcb3","#ffcc99","#ffcc00","#ff9900","#ff6600","#993300","#ff99cc","#e69999","#ff00ff","#ff0000","#800000","#000000"]);
b.Hb(6);
b.render(a);
return b
};
Ur[_P].dispose=function () {
if(!this.N()) {
Ur.B.dispose.call(this);
this.G.cc();
this.G.dispose();
this.G=null;
if(this.Zs) {
	this.Zs.dispose();
	this.Zs=null
}this.vg.dispose();
this.vg=null;
this.w8=null;
this.Ys=null
}
};
var Vr=function (a) {
af.call(this);
this.z=a;
this.wg=null
};
Vr.inherits(af);
Vr[_P].show=function () {
var a=this.wg;
if(!a) {
a=new Xr(this.z);
this.wg=a;
a.D(true);
a.D(false)
}var b=this.z.activeGrid,c=b.Ga,d=b.Ea,e=b.info,f=e.dB(c,d,true)||"",g=e.dB(c,d,false)||"",h="MC";
if(f.indexOf(h)==0)f=f.substring(h[E]);
var i="MF";
if(g.indexOf(i)==0)g=g.substring(i[E]);
a.zaa(f,g);
a.D(true)
};
var Wr=function (a,b) {
a.activeGrid.Zf(X.conditionalFormat,b,_M[4])
};
Vr[_P].dispose=function () {
if(!this.N()) {
Vr.B.dispose.call(this);
this.z=null;
if(this.wg) {
	this.wg.dispose();
	this.wg=null
}
}
};
var Xr=function (a) {
Fj.call(this,a);
this.z=a;
this.kU=this.Zp();
this.cJ=this.fu();
this.Lv=null;
this.Vo=null;
this.sD=1;
this.wl=[];
this.G=null;
this.XX=null;
this.vg=null;
this.dI=null;
this.dn=false;
this.wj();
this.Bj()
};
Xr.inherits(Fj);
var Yr=null;
Xr[_P].wj=function () {
var a=this.Ja(),b=T(a);
this.Va(_M[424]);
if(!Yr) {
var c=new Ej;
c.set("save",_M[450],true);
c.set(Aj,_M[321],false,true);
Yr=c
}this.od(Yr);
this.Lv=b.b("table",{
cellSpacing:"0"
},b.b("tbody",{
}));
b.appendChild(a,this.Lv);
this.rz();
var d=b.b("span",
{
className:"menuMainLink cf-add"
},"+ "+_M[436]);
b.appendChild(a,d);
this.Vo=d;
var e=b.b("div",{
style:"position:absolute;display:none;"
});
b.appendChild(a,e);
this.XX=e;
var f=Tr(e);
this.vg=f
};
Xr[_P].Bj=function () {
this.G=new mj(this);
var a=this.G;
a.listen(this,zj,this.ic);
a.listen(this.vg,"change",this.yaa);
a.listen(this.Vo,U,this.i2)
};
Xr[_P].rz=function () {
var a=new Zr(this);
this.wl.push(a)
};
Xr[_P].GZ=function (a) {
var b=this.wl;
for(var c=0;c<b[E];c++)if(a==b[c]) {
b.splice(c,1);
this.sD--;
C(this.Vo[J],"");
a.dispose();
this.Ow();
break
}
};
Xr[_P].nB=function () {
return T(this.Ja())
};
Xr[_P].Pm=function () {
return this.Lv
};
Xr[_P].fu=function () {
var a=this.cJ;
if(!a) {
var a=[{
	txt:_M[444],code:"td"
},{
	txt:_M[445],code:"tom"
},{
	txt:_M[446],code:"yes"
},{
	txt:"-----"
},{
	txt:_M[447],code:"ipw"
},{
	txt:_M[448],code:"ipm"
},{
	txt:_M[449],code:"ipy"
},{
	txt:"-----"
},{
	txt:_M[443]
}];
this.cJ=a
}return a
};
Xr[_P].Zp=function () {
var a=this.kU;
if(!a) {
var a=[{
	txt:_M[437],code:"tc",type:0
},{
	txt:_M[438],code:"ntc",type:0
},{
	txt:_M[439],code:"te",
	type:0
},{
	txt:_M[458],code:"ce",type:-1
},{
	txt:"-----"
},{
	txt:_M[440],code:"de",type:3
},{
	txt:_M[441],code:"deb",type:3
},{
	txt:_M[442],code:"dea",type:3
},{
	txt:"-----"
},{
	txt:_M[427],code:"gt",type:1
},{
	txt:_M[428],code:"lt",type:1
},{
	txt:_M[429],code:"eq",type:1
},{
	txt:_M[432],code:"neq",type:1
},{
	txt:_M[430],code:"bw",type:2
},{
	txt:_M[431],code:"nbw",type:2
}];
this.kU=a
}return a
};
Xr[_P].zo=function (a,b,c,d) {
if(b) {
this.dn=true;
try{
	if(S)this.vg.$h(-1);
	else this.vg.Ir(Di(b,"backgroundColor"))
}catch(e) {
}this.dn=
false
}var f=this.XX[J];
if(c!=null)f.top=c;
if(d!=null)ib(f,d);
C(f,a?"":"none");
this.dI=b
};
Xr[_P].zaa=function (a,b) {
var c=this.wl,d=c[E],e,f,g=1;
if(a) {
e=a.split(";");
f=b.split(";");
g=o.min(o.min(e[E],f[E]),5)
}for(var h=g;h<d;h++)c[h].D(false);for(var h=d;h<g;h++)this.rz();for(var h=0;h<g;h++) {
var i=c[h];
i.D(true);
if(e&&f&&e[h]&&f[h])i.zx(e[h],f[h]);
else i.zx()
}C(this.Vo[J],g==5?"none":"");
this.sD=g
};
Xr[_P].Ow=function () {
if(!S)Xr.B.lE.call(this)
};
Xr[_P].i2=function () {
this.zo(false);
var a=this.sD;
if(a<
5) {
var b=this.wl,c=b[E];
if(a<c)b[a].D(true);
else this.rz();
this.wl[a].zx();
this.Ow();
this.sD++;
a++;
if(a==5)C(this.Vo[J],"none")
}
};
Xr[_P].yaa=function (a) {
if(!this.dn) {
var b=a[Sc].Wp()||"#FFFFFF",c=this.dI;
$r(c,b);
this.zo(false)
}
};
Xr[_P].ic=function (a) {
this.zo(false);
if(a.key=="save") {
var b="MC",c="MF",d=this.wl;
for(var e=0;e<d[E];e++) {
	var f=d[e],g=f.T0();
	if(g) {
		b+=g;
		c+=f.U0()
	}
}var h=b=="MC"?"":b+"|"+c;
Wr(this.z,h)
}
};
Xr[_P].dispose=function () {
if(!this.N()) {
Xr.B.dispose.call(this);
var a=this.wl;
for(var b=
0;b<a[E];b++)a[b].dispose();this.wl=null;this.Lv=null;this.vg.dispose();this.vg=null;this.dI=null;this.G.cc();this.G.dispose();this.G=null;this.Vo=null;this.Lv=null;this.Fea=null;this.cJ=null;this.kU=null
}
};var Zr=function (a) {
af.call(this);
this.xb=a;
this.hs=null;
this.It=null;
this.$n=null;
this.Zn=null;
this.oq=null;
this.pq=null;
this.aN=null;
this.Ml=null;
this.em=null;
this.Oj=null;
this.dm=null;
this.wZ=null;
this.G=null;
this.wj();
this.Bj()
};
Zr.inherits(af);
var as="cf-td-rules";
Zr[_P].wj=function () {
var a=this.xb,b,c,d,e,f,g,h,i,j,k,m=a.nB(),n=m.b("tr",{
"class":"cf-tr-rules"
},m.b("td",{
},b=m.b("select",{
})),m.b("td",{
},m.b("div",{
style:"overflow:auto"
},h=m.b("input",{
type:"text","class":"cf-editbox1"
}),j=m.b("span",
{
"class":"cf-separator"
},_M[435]),k=m.b("select",{
}),i=m.b("input",{
type:"text","class":"cf-editbox2"
}))),m.b("td",{
"class":as
},c=m.b("input",{
type:"checkbox"
}),m.b("span",{
},_M[425])),m.b("td",{
},d=m.b("div",{
"class":"cf-color-divs"
})),m.b("td",{
"class":as
},e=m.b("input",{
type:"checkbox"
}),m.b("span",{
},_M[426])),m.b("td",{
},f=m.b("div",{
"class":"cf-color-divs"
})),m.b("td",{
"class":as
},g=m.b("span",{
"class":"cf-delete"
},"x"))),q,p,s=m.b("tr",{
"class":"cf-tr-example"
},p=m.b("td",{
"class":"cf-example"
}),
q=m.b("td",{
"class":"cf-example",colspan:"6"
}),m.b("td",{
}),m.b("td",{
}),m.b("td",{
}),m.b("td",{
}),m.b("td",{
}));
y(p,"&nbsp;");
var u=a.Pm()[rd][0];
m.appendChild(u,n);
m.appendChild(u,s);
var v=a.Zp();
for(var t=0;t<v[E];t++)m.appendChild(b,m.b("option",{
value:t
},v[t].txt));
v=a.fu();
for(var t=0;t<v[E];t++)m.appendChild(k,m.b("option",{
value:t
},v[t].txt));
this.hs=n;
this.It=q;
this.$n=b;
this.Zn=k;
this.oq=h;
this.pq=i;
this.aN=j;
this.Ml=c;
this.em=d;
this.Oj=e;
this.dm=f;
this.wZ=g
};
Zr[_P].Bj=function () {
this.G=
new mj(this);
var a=this.G;
a.listen(this.$n,Rh,this.$L);
a.listen(this.Zn,Rh,this.$L);
a.listen(this.em,U,this.B3);
a.listen(this.dm,U,this.j2);
a.listen(this.Ml,U,this.p2);
a.listen(this.Oj,U,this.o2);
a.listen(this.wZ,U,this.IZ);
a.listen(this.xb.zk(),U,this.A3)
};
Zr[_P].D=function (a) {
var b=a?"":"none";
C(this.hs[J],b);
C(this.It[O][J],b)
};
Zr[_P].Pc=function () {
return this.hs[J][Cd]==""
};
Zr[_P].zx=function (a,b) {
Ha(this.$n,0);
Ta(this.oq,"");
var c=this.pq;
Ta(c,"");
var d=this.Zn;
Ha(d,0);
var e=this.Ml;
La(e,false);
$r(this.em,"#FFFFFF");
var f=this.Oj;
La(f,false);
$r(this.dm,"#FFFFFF");
if(a&&b) {
var g=a.split(":"),h=this.xb.Zp(),i=0;
for(var j=0;j<h[E];j++)if(g[0]==h[j][Ad]) {
	i=h[j][N];
	Ha(this.$n,j);
	break
}if(i==-1) {
}else if(i==3) {
	var k=this.xb.fu(),m=true;
	for(var j=0;j<k[E];j++)if(g[1]==k[j][Ad]) {
		Ha(d,j);
		m=false;
		break
	}if(m) {
		Ha(d,d[E]-1);
		Ta(c,this.kB(g[1]))
	}
}else {
	Ta(this.oq,this.kB(g[1]));
	if(g[2]!=null)Ta(c,this.kB(g[2]))
}var n=b.split(",");
for(var j=0;j<o.min(2,n[E]);j++) {
	g=n[j].split(":");
	if(g[0]=="f") {
		La(e,true);
		$r(this.em,g[1])
	}else if(g[0]=="b") {
		La(f,true);
		$r(this.dm,g[1])
	}
}
}this.DT()
};
Zr[_P].T0=function () {
if(!this.Pc())return null;
var a=this.$n[I],b=this.xb.Zp(),c=b[a],d=c.txt;
if(!this.Ml[ic]&&!this.Oj[ic]||"-----"==d)return null;
var e=c[Ad];
e+=":";
var f=c[N];
if(f==-1) {
}else if(f==3) {
var g=this.Zn[I],h=this.xb.fu(),i=h[g];
if("-----"==i.txt)return null;
e+=this.oN()?this.pB(this.pq[I]):i[Ad]
}else {
e+=this.pB(this.oq[I]);
if(c[N]==2) {
	e+=":";
	e+=this.pB(this.pq[I])
}
}return e+";"
};
Zr[_P].pB=function (a) {
var b=
"";
for(var c=0;c<a[E];c++)switch(a.charAt(c)) {
case ":":b+="\\c";
break;
case ";":b+="\\s";
break;
case "\\":b+="\\\\";
break;
default:b+=a.charAt(c);
break
}return b
};
Zr[_P].kB=function (a) {
var b="",c=0;
while(c<a[E]) {
if(a.charAt(c)=="\\")switch(a.charAt(c+1)) {
	case "c":b+=":";
	c++;
	break;
	case "s":b+=";";
	c++;
	break;
	case "\\":b+="\\";
	c++;
	break;
	default:b+="\\"+a.charAt(c+1);
	c++;
	break
}else b+=a.charAt(c);
c++
}return b
};
Zr[_P].U0=function () {
var a="";
if(this.Oj[ic]) {
a="b:";
a+=this.dm.fm
}if(this.Ml[ic]) {
if(a[E]>0)a+=
",";
a+="f:";
a+=this.em.fm
}a+=";";
return a
};
Zr[_P].DT=function () {
var a=this.xb.Zp()[this.$n[cc]],b="none",c="none",d="none",e="none",f=a[N],g="";
if(f==-1) {
}else if(f==3) {
e="";
if(this.oN()) {
	c="";
	g=_M[454]
}
}else {
b="";
switch(f) {
	case 2:c="";
	d="";
	g=_M[452];
	break;
	case 1:g=_M[451];
	break;
	case 0:g=_M[453];
	break
}
}C(this.oq[J],b);
C(this.pq[J],c);
C(this.aN[J],d);
C(this.Zn[J],e);
Ig(this.It,g)
};
Zr[_P].oN=function () {
var a=this.Zn;
return a[cc]==a[E]-1
};
Zr[_P].$L=function () {
this.DT();
this.xb.Ow()
};
Zr[_P].p2=function (a) {
if(this.Ml[ic])this.Fu(a,
this.em)
};
Zr[_P].o2=function (a) {
if(this.Oj[ic])this.Fu(a,this.dm)
};
Zr[_P].B3=function (a) {
La(this.Ml,true);
this.Fu(a,a[Sc])
};
Zr[_P].j2=function (a) {
La(this.Oj,true);
this.Fu(a,a[Sc])
};
Zr[_P].Fu=function (a,b) {
var c=this.xb.Pm(),d=this.hs,e=d[Ed]+b[Id]+c[Ed]+9,f=b[O][Cc]+c[Cc]+6;
this.xb.zo(true,b,e,f);
a.stopPropagation()
};
var $r=function (a,b) {
cb(a[J],b);
a.fm=b
};
Zr[_P].A3=function () {
this.xb.zo(false)
};
Zr[_P].IZ=function () {
var a=this.xb;
a.zo(false);
if(a.Pm()[pd][E]>2) {
Bg(this.hs);
Bg(this.It[O]);
a.GZ(this)
}else {
this.zx("",
"");
a.Ow()
}
};
Zr[_P].dispose=function () {
if(!this.N()) {
Zr.B.dispose.call(this);
this.xb=null;
this.hs=null;
this.It=null;
this.$n=null;
this.Zn=null;
this.oq=null;
this.pq=null;
this.aN=null;
this.Ml=null;
this.em=null;
this.Oj=null;
this.dm=null;
this.G.cc();
this.G.dispose();
this.G=null
}
};
var bs=function () {
af.call(this)
};
bs.inherits(af);
var cs=17;
bs[_P].Iba=function (a,b,c,d) {
fj(b,"sortBarOn");
var e=b[tc]-cs-c-1,f=a.b("div",{
"class":"sortBarLeft",style:"width: "+e+"px;"
},_M[456]),g=a.b("div",{
"class":"sortBarRight"
},a.b("img",{
src:d+"menu-downarrow.gif","class":"sortImgTriangle",id:"sortMenuImage"
}));
return [f,g]
};
bs[_P].gZ=function (a,b,c,d,e,f,g,h,i) {
var j=S?"->":"&rarr;",k=[[_M[82](j)],[_M[83](j)]];
if(h) {
var m=[h];
k.push(m)
}var n=new Ml(a,b,k,false),q=n.Gb;
z(q[0].J(),R(c,d,e,g));
z(q[1].J(),
R(c,d,f,g));
if(h)z(q[2].J(),R(i,d));
return n
};
var ds=function (a,b,c) {
bs.call(this);
this.Xf=a;
this.C=b;
this.Jh=c;
this.q=new mj(this);
var d=b.divTop[O],e=T(d),f=e.b("div",{
"class":"sortBarHandle"
},e.b("div",{
"class":"img-sprite icon-sortbar"
})),g=e.b("div",{
style:"display: none;"
});
this.Jg=f;
this.Ki=g;
this.bga=a[L];
this.O5=-1;
e.appendChild(d,this.Jg);
e.appendChild(d,this.Ki);
this.q.listen(this.Jg,Nh,this.Qx);
this.Zc()
};
ds.inherits(bs);
ds[_P].Za=null;
ds[_P].vI=0;
ds[_P].Zc=function () {
Bi(this.Jg,"top",this.Xf[Ed]-(S?0:1))
};
ds[_P].Qx=function (a) {
var b=
this.C,c=b.eb(),d=c.Da();
if(!this.Vb&&!d&&!c.modalDbox) {
this.Vb=true;
var e=this.Ki;
c.mouseSelection.Hk();
b.vc(1);
var f=new Qf(0,undefined,0,undefined),g=new tj(e,undefined,f);
this.Za=g;
var h=hg(e),i=this.q;
i.listen(h,Ph,this.Qe);
i.listen(h,Oh,this.Ee);
g.re(a)
}Ga(b.divTop[J],"move")
};
ds[_P].Qe=function (a) {
jb(a,this);
var b=this.Jh,c=this.C,d=b.$d(a,c),e=b.Ie(c,1,d[1]);
c.Vc(e[0],1);
var f;
f=!e?(this.Jj?this.Jj:0):(this.Jj=e[0]);
var g=11;
if(f<0) {
c.trixApp.appOverlayManager.DF(c,1);
f=this.Jj=0
}else if(f<=
g)c.trixApp.appOverlayManager.DF(c,f);
else c.trixApp.appOverlayManager.DF(c,g)
};
ds[_P].Ee=function (a) {
jb(a,this);
this.Vb=false;
var b=this.C,c=b.trixApp;
b.vc(0);
c.appOverlayManager.Rf();
var d=this.Ki,e=hg(d),f=this.q;
f.unlisten(e,Ph,this.Qe);
f.unlisten(e,Oh,this.Ee);
var g=this.Za;
g.dispose();
V(d,false);
var h=this.Jj-1;
if(qa(h))h=b.Xb;
else if(h<0)h=0;
else if(h>10)h=10;
Ga(b.divTop[J],"");
b.freezeRows(h);
b.gr();
b.Ua(1,1,false);
a.preventDefault();
a.stopPropagation()
};
ds[_P].Ica=function (a) {
var b=this.C,
c=this.Xf[L][a],d=T(c),e=ds.B.Iba.call(this,d,c,5,b.trixApp.pathImg);
d.appendChild(c,e[0]);
d.appendChild(c,e[1])
};
ds[_P].Jca=function (a,b,c,d) {
var e=this.C,f=e.trixApp,g=this.Xf[L][a];
this.vI=a;
var h=this.Gga;
if(!h)h=ds.B.gZ.call(this,f.W(),f.getDivApp(),this.Aj,this,1,0,null);
f.P();
fj(g,"sortBarOn");
h.Sa("",c+2,b+f.divGrids[Ed]+14,d);
f.menuMain.Wg(h)
};
ds[_P].Aj=function (a) {
if(this.mea())return ;
var b=this.vI,c=this.C.trixApp,d=c.gooffiLink.ya.Fd,e=this.Xf[L][b];
if(!d.jc()&&!la(_M[401])) {
fj(e,"sortBar");
yg(e);
return
}yg(e);
fj(e,"sortBar");
c.Aj(a,b);
this.O5=ne()
};
ds[_P].yk=function (a) {
return this.bga[a]
};
ds[_P].mea=function () {
return ne()-this.O5<1000
};
ds[_P].dispose=function () {
if(this.N())return ;
ds.B.dispose.call(this);
Bg(this.Jg);
this.Ki=null;
this.Jg=null;
this.Or=null;
this.Jh=null;
this.Xf=null;
this.C=null;
if(this.q)this.q.dispose();
this.q=null
};
var es=function (a,b) {
this.trixApp=a;
this.Cc=b
};
Kb(es[_P],null);
es[_P].Qd=null;
es[_P].Pa=function () {
return this.trixApp
};
es[_P].Sa=function () {
throwError("Can't call abstract method setDisplay");
};
var fs=function (a,b,c) {
af.call(this);
this.Vfa=a;
this.C=b;
this.Jh=c;
this.q=new mj(this);
var d=b.divTop[O],e=T(d),f=e.b("div",{
"class":"columnBarHandle"
},e.b("div",{
"class":"img-sprite icon-columnbar"
})),g=e.b("div",{
style:"display: none;"
});
this.Jg=f;
this.Ki=g;
e.appendChild(d,this.Jg);
e.appendChild(d,this.Ki);
this.q.listen(this.Jg,Nh,this.Qx);
this.Zc()
};
fs.inherits(af);
fs[_P].Za=null;
fs[_P].Zc=function () {
ib(this.Jg[J],this.Vfa.Mb()-1-(this.C.Ra==0?7:0))
};
fs[_P].Qx=function (a) {
var b=this.C,c=b.eb(),
d=c.Da();
if(!this.Vb&&!d&&!c.modalDbox) {
this.Vb=true;
var e=this.Ki;
c.mouseSelection.Hk();
b.vc(1);
var f=new Qf(undefined,0,undefined,0),g=new tj(e,undefined,f);
this.Za=g;
var h=hg(e),i=this.q;
i.listen(h,Ph,this.Qe);
i.listen(h,Oh,this.Ee);
g.re(a)
}Ga(b.divTop[J],"move")
};
fs[_P].Qe=function (a) {
jb(a,this);
var b=this.Jh,c=this.C,d=b.$d(a,c)[0],e=b.cB(c,d);
e=e||this.rU;
c.Vc(1,e);
var f=d+c.Dg(),g=(c.vh(e,false)+c.vh(e,true))/2;
if(f>g)e=c.Nl(e+1);
var h=6;
if(e<0) {
c.trixApp.appOverlayManager.tF(c,1);
e=this.rU=
0
}else if(e<=h)c.trixApp.appOverlayManager.tF(c,e);
else c.trixApp.appOverlayManager.tF(c,h);
this.rU=e
};
fs[_P].Ee=function (a) {
jb(a,this);
this.Vb=false;
var b=this.C,c=b.trixApp;
b.vc(0);
c.appOverlayManager.Rf();
var d=this.Ki,e=hg(d),f=this.q;
f.unlisten(e,Ph,this.Qe);
f.unlisten(e,Oh,this.Ee);
var g=this.Za;
g.dispose();
V(d,false);
var h=this.rU-1;
if(qa(h))h=b.Ra;
else if(h<0)h=0;
else if(h>5)h=5;
Ga(b.divTop[J],"");
b.freezeColumns(h);
b.gr();
b.Ua(1,1,false);
a.preventDefault();
a.stopPropagation()
};
fs[_P].dispose=
function () {
if(this.N())return ;
fs.B.dispose.call(this);
Bg(this.Jg);
this.Ki=null;
this.Jg=null;
this.Or=null;
this.Jh=null;
this.Xf=null;
this.C=null;
if(this.q)this.q.dispose();
this.q=null
};
var is=function (a) {
Fj.call(this,a,false,1);
var b=this.Ja(),c=T(b);
this.oy=c.b("div",{
className:gs+"-div"
},"");
var d=c.b("msg",{
className:gs+"-msg"
},_M[404]);
c.appendChild(b,d);
c.appendChild(b,this.oy);
if(!hs) {
var e=new Ej;
e.set("done",_M[339],false,true);
hs=e
}this.od(hs)
};
is.inherits(Fj);
is[_P].oy=null;
var gs="dialog-publishobject",hs=null;
is[_P].Daa=function (a,b) {
if(a==1)this.Va(_M[403]);
else if(a==2)this.Va(_M[598]);
y(this.oy,this.Pa().activeGrid.$a.Zi(b))
};
is[_P].dispose=function () {
if(!this.N()) {
is.B.dispose.call(this);
this.oy=null
}
};
var js=function (a) {
af.call(this);
var b=T(a);
this.pr=b.b("div",{
"class":"divRowResize",visibility:"hidden"
});
a.appendChild(this.pr);
this.kp=b.b("div",{
"class":"divColResize",visibility:"hidden"
});
a.appendChild(this.kp);
this.uN=false;
this.rf=false;
this.cd=null;
this.yj=0;
this.q$=null;
this.r$=0;
this.oE=0;
this.Vb=false;
this.Uw=new tj(this.pr,null,new Qf(1,undefined,0,undefined));
this.Xs=new tj(this.kp,null,new Qf(undefined,1,undefined,0));
this.q=new mj(this);
this.Bj(this.pr,this.Uw);
this.Bj(this.kp,this.Xs)
};
js.inherits(af);
js[_P].Bj=function (a,b) {
var c=this.q;
c.listen(b,"start",this.c8);
c.listen(b,"end",this.w7);
c.listen(b,"beforedrag",this.f7);
c.listen(b,"drag",this.t7);
c.listen(a,Mh,this.cw);
c.listen(a,jh,this.L7)
};
js[_P].c8=function () {
Ga(this.cd.divTop[J],this.rf?"n-resize":"e-resize")
};
js[_P].w7=function () {
var a=this.cd;
if(this.Vb) {
this.Vb=false;
Ga(a.divTop[J],"");
var b,c;
if(this.rf) {
	b=a.O;
	c=b+a.ma-1
}else {
	b=a.Y;
	c=b+a.Z-1
}if(this.yj<b||this.yj>c)b=c=this.yj;
a.Q$(this.yj,b,c,this.rf);
if(this.rf&&S) {
	var d=
	a.I.K(this.yj);
	ij(d,"equalize")
}a.kE()
}a.eb().L()
};
js[_P].f7=function (a) {
this.Vb=true;
var b=this.cd,c=this.yj,d=this.rf?a.top:a[Mc],e=o.max(1,d-this.r$);
if(e!=this.oE) {
if(this.rf) {
	var f=b.I.K(c);
	D(f[L][0][J],"");
	if(S)hj(f,"equalize")
}b.Pw(c,c,this.rf,e,false)
}var g=this.rf?b.xL(c):this.q$[tc];
if(this.rf&&g!=e) {
b.Pw(c,c,this.rf,g,false);
g=b.xL(c)
}if(g!=this.oE) {
this.oE=g;
return true
}return false
};
js[_P].t7=function () {
var a=this.cd,b=this.rf?a.I:a.xa;
b.Rb.Re(false);
a.vj()
};
js[_P].cw=function () {
if(!this.rf) {
var a=
this.cd,b=this.yj,c=b,d=a.Y,e=d+a.Z-1;
if(d<=b&&e>=b) {
	b=d;
	c=e
}a.N$(b,c);
this.ge()
}
};
js[_P].L7=function () {
if(!this.Vb)this.ge()
};
js[_P].rca=function (a,b) {
var c=a.eb();
if(c.modalDbox||c.Da()) {
this.ge();
return false
}var d=a.xa;
if(b[0]>=0&&b[1]<-(a.fd()+d.JF)) {
var e=b[0]-3,f=c.mouseSelection.Ie(a,e,0,1);
if(f&&f[1]<=a.Ba) {
	var g=d.Wi(f[1],true),h=g[Cc],i=g[tc];
	if(e>h+i-6) {
		this.zT(a,false,f[1],g,h+a.Dg()-a.divMain[jd]-1,i);
		return true
	}
}
}else if(b[1]>0&&b[0]<=-(a.Dg()-35)) {
var j=b[1]-3,f=c.mouseSelection.Ie(a,
0,j,2);
if(f&&f[0]<=a.Ha()) {
	var k=a.I,g=k.K(f[0]),h=k.hd(g),i=g[Id];
	if(j>h+i-6) {
		this.zT(a,true,f[0],g,h+32-a.divMain[Ub]+a.fd()-1,i);
		return true
	}
}
}this.ge();
return false
};
js[_P].ge=function () {
if(this.uN) {
this.uN=false;
Sb(this.pr[J],"hidden");
Sb(this.kp[J],"hidden");
this.Uw.Ad(false);
this.Xs.Ad(false)
}
};
js[_P].zT=function (a,b,c,d,e,f) {
this.ge();
this.cd=a;
this.rf=b;
this.yj=c;
this.q$=d;
this.r$=e;
this.oE=f;
this.uN=true;
var g;
if(b) {
g=this.pr[J];
g.top=e+f;
this.Uw.Ad(true)
}else {
g=this.kp[J];
ib(g,e+f);
this.Xs.Ad(true)
}Sb(g,
"visible")
};
js[_P].dispose=function () {
if(!this.N()) {
js.B.dispose.call(this);
this.q.dispose();
this.q=null;
this.Uw.dispose();
this.Uw=null;
this.pr=null;
this.Xs.dispose();
this.Xs=null;
this.kp=null
}
};
var Wo=function (a,b) {
Xi.call(this,b);
this.j=a;
this.q=new mj(this);
this.Ib=new lq
};
Wo.inherits(Xi);
var Xo="advanced";
Wo[_P].b=function () {
var a=this.F,b=null,c=null,d=a.b("span",{
});
y(d,"&nbsp;");
var e=a.b("span",{
});
y(e,"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;");
var f=a.b("table",null,a.b("tbody",null,a.b("tr",null,a.b("td",null,b=a.b("input",{
type:"checkbox",id:"notificationBox"
}),d,a.b("label",{
"for":"notificationBox"
},_M[602](this.j.emailAddress)))),a.b("tr",null,a.b("td",null,e,c=this.YY(a)))));
this.qD=
b;
this.bw=c;
this.q.listen(b,U,this.oP);
this.q.listen(c,Rh,this.oP);
this.A=f
};
Wo[_P].refresh=function () {
this.D(false);
var a=this.j.gooffiLink.Xd(mp),b=new kq(a,this,this.jG);
this.jC(b)
};
Wo[_P].jC=function (a) {
this.Ad(false);
this.Ib.Lg(a)
};
Wo[_P].Ad=function (a) {
var b=this.qD;
if(b)Xa(b,!a);
var c=this.bw;
if(c&&b)Xa(c,!a||!b[ic])
};
Wo[_P].HZ=function (a) {
var b=this.Efa;
if(b[E]>0) {
var c=b[0],d=this.j.gooffiLink.Xd(np)+"&v="+fa(ki(c)),e=new kq(d,this,a);
this.jC(e)
}
};
Wo[_P].Pda=function () {
var a=this.bw[I];
if(a==
Xo)this.wW();
else {
var b=this.j.gooffiLink.Xd(pp)+"&v="+a,c=new kq(b,this,this.jG);
this.jC(c)
}
};
Wo[_P].wW=function () {
this.dispatchEvent({
type:Xo
})
};
Wo[_P].oP=function () {
var a=this.qD[ic];
Xa(this.bw,!a);
if(a)this.Pda();
else this.HZ(this.jG)
};
Wo[_P].jG=function (a) {
var b=a[Tb];
this.Efa=b;
var c=b[E]==1&&this.y5(b[0]);
if(b[E]!=0&&!c) {
La(this.qD,true);
var d=this.bw;
Ta(d,Xo);
this.D(true);
this.Ad(false)
}else {
this.D(true);
La(this.qD,c);
var d=this.bw,e=this.ju(b),f=null;
if(e[E]==1) {
	var g=this.ju(b[0].actions);
	if(g[E]==1)f=g[0][N]
}if(!f)f=ks;
Ta(d,f);
Xa(d,!c);
this.Ad(true)
}
};
Wo[_P].ju=function (a) {
var b=[];
if(!a)return b;
for(var c=0;c<a[E];c++)if(a[c][fd])b.push(a[c]);return b
};Wo[_P].YY=function (a) {
var b=a.b("select",{
}),c=a.b("option",{
value:ls
},_M[604]);
a.appendChild(b,c);
c=a.b("option",{
value:ks,selected:"true"
},_M[603]);
a.appendChild(b,c);
c=a.b("option",{
value:"",disabled:"true"
},"------------------------");
a.appendChild(b,c);
c=a.b("option",{
value:Xo
},_M[605]);
a.appendChild(b,c);
return b
};
Wo[_P].y5=
function (a) {
var b=this.ju(a.tests);
if(b[E]!=1||b[0][N]!=ms)return false;
var c=this.ju(a.actions);
if(c[E]==1) {
var d=c[0][N];
return d==ls||d==ks
}return false
};
Wo[_P].D=function (a) {
if(this.A)V(this.A,a)
};
Wo[_P].dispose=function () {
if(!this.N()) {
Xi[_P].dispose.call(this);
if(this.q) {
	this.q.dispose();
	this.q=null
}if(this.Ib) {
	this.Ib.dispose();
	this.Ib=null
}
}
};
var ns=function (a) {
Xi.call(this,a);
this.q=new mj(this);
this.rj=new mj(this)
};
ns.inherits(Xi);
ns[_P].b=function () {
var a=this.F,b=a.b("div",{
}),c=a.b("table",{
className:os
},a.b("tbody",{
},a.b("tr",{
},a.b("td",{
},b))));
this.rr=b;
this.A=c
};
var os="dialog-notifications-list";
ns[_P].X9=function (a,b) {
if(!this.rb)this.render(b);
this.sJ();
this.vx(a);
var c=null,d=this.F,e=d.b("table",{
className:os,width:"100%"
},c=d.b("tbody",{
})),f=a[Tb];
if(f[E]==0)d.appendChild(c,d.b("tr",{
},d.b("td",{
align:"center"
},_M[486])));
else for(var g=0;g<f[E];g++) {
var h=a[Tb][g];
d.appendChild(c,this.dZ(h))
}d.appendChild(this.rr,e)
};
ns[_P].sJ=function () {
this.q.cc();
if(this.F&&this.rr)this.F.zf(this.rr)
};
ns[_P].D=function setVisible(a) {
if(this.A)V(this.A,a)
};
ns[_P].dZ=function (a) {
var b="notification-rule";
if(!a[fd])b=b+"-disabled";
var c=this.F,d=null,e=null,f=c.b("tr",{
valign:"center"
},c.b("td",{
},c.b("span",{
className:b
},a.gloss)),c.b("td",{
align:"right"
},c.b("table",{
},c.b("tbody",{
},c.b("tr",{
},c.b("td",{
},d=c.b("span",{
className:"menuMainLink notifications-add"
},
_M[483])),c.b("td",{
width:"50px"
},e=c.b("span",{
className:"menuMainLink notifications-add"
},_M[482])))))));
this.q.listen(d,U,R(this[Fc],this,{
type:"edit",ruleModel:a
}));
this.q.listen(e,U,R(this.xX,this,a));
return f
};
ns[_P].xX=function (a) {
var b=la(_M[484]);
if(!b)return ;
this.dispatchEvent({
type:"del",ruleModel:a
})
};
ns[_P].dispose=function () {
if(!this.N()) {
Xi[_P].dispose.call(this);
if(this.q) {
	this.q.dispose();
	this.q=null
}if(this.rj) {
	this.rj.dispose();
	this.rj=null
}if(this.rr) {
	yg(this.rr);
	this.rr=null
}
}
};
var ts=function (a,b) {
Xi.call(this,b);
this.j=a;
this.q=new mj(this);
this.ed=new $g;
this.Kf=new $g;
this.Kf.set(ms,this.oY);
this.Kf.set(ps,this.jY);
this.Kf.set(qs,this.DY);
this.Kf.set(rs,this.lY);
this.Kf.set(ss,this.fZ);
this.Kf.set(ls,this.uY);
this.Kf.set(ks,this.rY);
this.rj=new mj(this)
};
ts.inherits(Xi);
var ms="CellChangeTest",rs="BoundedCellChangeTest",ps="AclChangeTest",ss="SheetChangeTest",qs="FormSubmitTest",ls="EmailRuleAction",ks="DigestEmailRuleAction",us="rangeField",vs="sheetField",ws="frequencyDropdown";
ts[_P].b=function () {
var a=this.F,b=null,c=null,d=new Sn(_M[337]);
this.x$=d;
this.rj.listen(this.x$,Zi,this.Tg,this);
var e=new Sn(_M[338]);
this.Sd=e;
this.rj.listen(this.Sd,Zi,R(this[Fc],this,{
type:"cancelRuleEdit"
}));
var f=a.b("table",{
className:xs
},a.b("tbody",{
},a.b("tr",{
},a.b("td",{
},b=a.b("div",{
}))),a.b("tr",{
},a.b("td",{
},c=a.b("div",{
})))));
d.render(c);
e.render(c);
this.sR=b;
this.A=f
};
ts[_P].W9=function (a,b) {
if(!this.rb)this.render(b);
this.vx(a);
var c=xs,d=this.F,e=null,f=null,g=null,h=null,
i=null,j=null,k=null,m=null,n=null,q=null,p=null;
yg(this.sR);
var s=this.FY(d),u=d.b("table",{
className:xs
},e=d.b("tbody",{
},d.b("tr",{
id:"toprow"
},d.b("td",{
className:c+"-toplabel"
},d.b("span",{
"for":"emailon"
},_M[491](this.j.emailAddress)))),d.b("tr",{
},d.b("td",{
className:c+"-input"
},g=d.b("input",{
type:"checkbox",id:"anych"
}),d.b("label",{
"for":"anych"
},_M[493]))),d.b("tr",{
},d.b("td",{
className:c+"-input"
},q=d.b("input",{
type:"checkbox",id:"sheet"
}),d.b("label",{
"for":"sheet"
},_M[601]),this.Yj(d),
p=this.eZ(d))),d.b("tr",{
},d.b("td",{
className:c+"-input"
},n=d.b("input",{
type:"checkbox",id:"anycell"
}),d.b("label",{
"for":"anycell"
},_M[494]),this.Yj(d),f=d.b("input",{
type:"text",id:"range"
}))),d.b("tr",{
},d.b("td",{
className:c+"-input"
},h=d.b("input",{
type:"checkbox",id:"anyacl"
}),d.b("label",{
"for":"anyacl"
},_M[495]))),i=d.b("tr",{
},d.b("td",{
className:c+"-input"
},j=d.b("input",{
type:"checkbox",id:"formsubmit"
}),d.b("label",{
"for":"formsubmit"
},_M[537]))),d.b("tr",{
},d.b("td",{
},d.b("div",{
style:"padding: 5px"
}))),
d.b("tr",{
},d.b("td",{
className:c+"-label"
},d.b("span",{
},_M[490]))),d.b("tr",{
},d.b("td",{
className:c+"-input"
},k=d.b("input",{
type:"checkbox",id:"ddig"
}),d.b("label",{
"for":"ddig"
},_M[497]))),d.b("tr",{
},d.b("td",{
className:c+"-input"
},m=d.b("input",{
type:"checkbox",id:"rtaw"
}),d.b("label",{
"for":"rtaw"
},_M[498])))));
V(i,W.formIsTurnedOn());
var v=this.ed;
v.set(ws,s);
v.set(us,f);
v.set("tree",e);
v.set(ms,g);
v.set(ps,h);
v.set(qs,j);
v.set(rs,n);
v.set(ss,q);
v.set(vs,p);
v.set(ls,m);
v.set(ks,k);
var t=
this.q;
t.listen(f,U,this.c9);
t.listen(f,Rh,this.d9);
t.listen(g,U,R(this.Zr,this,ms));
t.listen(h,U,R(this.Zr,this,ps));
t.listen(j,U,R(this.Zr,this,qs));
t.listen(q,U,R(this.Zr,this,ss));
t.listen(n,U,R(this.Zr,this,rs));
t.listen(p,Rh,this.$ba);
t.listen(m,U,R(this.JG,this,ls));
t.listen(k,U,R(this.JG,this,ks));
t.listen(s,Rh,this.l0);
for(var w=0;w<this.jb.tests[E];w++) {
var B=this.jb.tests[w];
if(B[N]==rs) {
	La(n,B[fd]);
	Ta(f,B.range||"")
}else if(B[N]==ss) {
	La(q,B[fd]);
	Ta(p,B.range||"")
}else if(B[N]==ms)La(g,
B[fd]);
else if(B[N]==ps)La(h,B[fd]);
else if(B[N]==qs)La(j,B[fd])
}for(var w=0;w<this.jb.actions[E];w++) {
var A=this.jb.actions[w];
if(A[N]==ls) {
	La(m,A[fd]);
	Ta(s,A.frequency);
	Xa(s,!A[fd])
}else if(A[N]==ks)La(k,A[fd])
}d.appendChild(this.sR,u);
this.uy();
this.D(true)
};
ts[_P].rJ=function () {
this.q.cc();
this.D(false);
this.ed.clear()
};
ts[_P].D=function (a) {
if(this.A)if(a)V(this.A,a);
else fi(this.pf,0,this)
};
ts[_P].pf=function () {
V(this.A,false)
};
ts[_P].Tg=function () {
this.dispatchEvent({
type:"saveRule",ruleModel:this.jb
})
};
ts[_P].$ba=function () {
var a=this.ed.get(vs),b=hf(this.jb.tests,this.Op(ss),this);
b.range=a[I]
};
ts[_P].l0=function () {
var a=this.ed.get(ws),b=hf(this.jb.actions,this.Op(ls),this);
b.frequency=a[I]
};
ts[_P].d9=function (a) {
var b=a[Sc][I];
this.lI(b)
};
ts[_P].Zr=function (a) {
var b=this.jb.tests,c=this.ed.get(a),d=hf(b,this.Op(a),this);
if(d)sb(d,c[ic]);
else if(c[ic]) {
var e=this.Kf.get(a);
d=e.call(this);
b.push(d)
}this.uy()
};
ts[_P].Op=function (a) {
return function (b) {
return b!=null&&b[N]==a
}
};
ts[_P].oY=function () {
var a=
this.jb;
return {
type:ms,enabled:true,localeTz:a.localeTz,localeLc:a.localeLc
}
};
ts[_P].fZ=function () {
var a=this.jb,b=this.ed.get(vs);
return {
type:ss,enabled:true,range:b[I],localeTz:a.localeTz,localeLc:a.localeLc
}
};
ts[_P].jY=function () {
var a=this.jb;
return {
type:ps,enabled:true,localeTz:a.localeTz,localeLc:a.localeLc
}
};
ts[_P].DY=function () {
var a=this.jb;
return {
type:qs,enabled:true,localeTz:a.localeTz,localeLc:a.localeLc
}
};
ts[_P].lY=function () {
var a={
type:rs,enabled:true,localeTz:this.jb.localeTz,localeLc:this.jb.localeLc
};
a.range="";
return a
};
ts[_P].JG=function (a) {
var b=this.jb.actions,c=this.ed.get(a),d=hf(b,this.Op(a),this);
if(d)sb(d,c[ic]);
else if(c[ic]) {
var e=this.Kf.get(a);
d=e.call(this);
b.push(d)
}this.uy()
};
ts[_P].uY=function () {
var a=this.ed.get(ws);
return {
type:ls,localeTz:this.jb.localeTz,localeLc:this.jb.localeLc,enabled:true,frequency:a[I]
}
};
ts[_P].rY=function () {
return {
type:ks,localeTz:this.jb.localeTz,localeLc:this.jb.localeLc,enabled:true,frequency:"DAILY"
}
};
ts[_P].uy=function () {
var a=true;
if(this.jb[fd]) {
var b=
false,c=this.jb.tests;
for(var d=0;d<c[E];d++) {
	var e=c[d];
	if(e[fd])b=true;
	if(e[N]==rs)if(e[fd]&&(!e.range||e.range==""))a=false
}if(!b)a=false;
var f=false,g=this.jb.actions;
for(var d=0;d<g[E];d++) {
	var h=g[d];
	if(h[fd])f=true
}if(!f)a=false;
var i=this.ed.get(vs),j=this.ed.get(ss);
Xa(i,!j[ic]);
var k=this.ed.get(rs),m=this.ed.get(us);
Xa(m,!k[ic])
}this.x$.Ad(a)
};
ts[_P].c9=function () {
var a=this.ed.get(us);
this.dispatchEvent({
type:"rangeClick",field:a
})
};
ts[_P].pd=function (a,b) {
if(b)this.lI(a)
};
ts[_P].lI=function (a) {
var b=
this.ed.get(rs);
if(!b||!b[ic])return ;
var c=this.ed.get(us);
if(!c||c.disabled)return ;
var d=this.j.zd.Pq(a,true);
if(!d)a="";
else if(!ys(a).Bd)a=d.Bd+"!"+a;
Ta(c,a);
var e=hf(this.jb.tests,this.Op(rs),this);
if(e)e.range=a;
this.uy()
};
var xs="dialog-notifications";
ts[_P].FY=function (a) {
var b=a.b("select",{
}),c=[["HOURLY",_M[500]],["EVERY6HOURS",_M[501]],["DAILY",_M[502]],["WEEKLY",_M[503]]],d=c[E],a=this.F;
for(var e=0;e<d;e++) {
var f=c[e],g=a.b("option",{
	value:f[0]
},f[1]);
a.appendChild(b,g)
}return b
};
ts[_P].eZ=
function (a) {
var b=a.b("select",{
}),c=this.j.Aa,d=c.yh(),e=c.wi;
for(var f=0;f<d[E];f++) {
var g=d[f].Lc(),h=a.b("option",{
	value:g
},g);
a.appendChild(b,h)
}if(e<d[E]&&e>0)Ta(b,d[e].Lc());
return b
};
ts[_P].Yj=function (a) {
var b=a.b("span",{
});
y(b,"&nbsp;");
return b
};
ts[_P].dispose=function () {
if(!this.N()) {
Xi[_P].dispose.call(this);
if(this.q) {
	this.q.dispose();
	this.q=null
}if(this.rj) {
	this.rj.dispose();
	this.rj=null
}if(this.ed) {
	this.ed.clear();
	this.ed=null
}if(this.Kf) {
	this.Kf.clear();
	this.Kf=null
}this.Cga=null;
this.sR=null;
yg(this.pc)
}
};
var As=function (a,b,c) {
Xi.call(this,c);
this.q=new mj(this);
this.Ib=new lq;
this.xb=b;
b.Va(_M[485]);
this.j=a;
this.YM=true;
this.le=new ts(this.j);
this.Ca(this.le);
this.Kh=new ns;
var d=new Ej;
d.set("cancel",_M[339],false,true);
zs=d;
this.xb.od(d)
},zs;
As.inherits(Xi);
As[_P].b=function () {
var a=this.F;
this.Fv=a.b("div",{
});
this.Ct=a.b("div",{
});
var b=a.b("div",{
"class":"loadingMsg"
},a.b("img",{
src:this.j.pathImg+"spinWait.gif"
}));
this.YP=b;
var c=wn+"91588",d=this.j.userLocale;
if(d&&d.l)c=c+"&hl="+d.l;
var e=
a.b("a",{
target:"_blank",href:c
},_M[345]),f=a.b("span",{
className:"menuMainLink"
},"+"+_M[334]),g=a.b("table",{
className:"dialog-notifications-bounds"
},a.b("tbody",{
},a.b("tr",{
style:"vertical-align:top;"
},a.b("td",{
},this.Fv)),a.b("tr",{
style:"vertical-align:top;"
},a.b("td",{
},this.Ct)),a.b("tr",{
style:"vertical-align:top;"
},a.b("td",{
},this.YP)))),h=a.b("table",{
},a.b("tbody",{
},a.b("tr",{
},a.b("td",{
},""),a.b("td",{
align:"right"
},e)),a.b("tr",{
},a.b("td",{
colSpan:"2"
},g)),a.b("tr",{
},a.b("td",{
colSpan:"2"
},
f))));
this.A=h;
this.eW=f;
this.xb.pd=R(this.le.pd,this.le);
this.Ca(this.Kh);
this.q.listen(this.Kh,"edit",this.GJ);
this.q.listen(this.Kh,"del",this.cX);
this.q.listen(f,U,this.WH);
this.q.listen(this.le,"saveRule",this.A$);
this.q.listen(this.le,"cancelRuleEdit",this.oX);
this.q.listen(this.le,"rangeClick",this.b9)
};
As[_P].hca=function () {
this.Ib.clear();
this.$B();
this.le.D(false);
this.tx(false);
var a=this.Rp(this.ica,null,this.Rr);
this.Ib.Lg(a)
};
As[_P].ica=function (a) {
this.vx(a);
if(a[Tb][E]==0) {
this.YM=
true;
this.WH()
}else {
this.YM=false;
this.Gx(a)
}
};
As[_P].Rr=function () {
V(this.YP,true)
};
As[_P].$B=function () {
V(this.YP,false)
};
As[_P].cca=function (a) {
V(this.eW,a)
};
As[_P].b9=function (a) {
this.j.zF(this.xb,a.field[I])
};
As[_P].A$=function (a) {
this.le.rJ();
this.le.D(false);
var b=this.N1(a.ruleModel,this.Gx,null,this.Rr);
this.Ib.Lg(b)
};
As[_P].oX=function () {
fi(this.f9,0,this)
};
As[_P].f9=function () {
this.le.rJ();
this.le.D(false);
var a=this.jb;
if(a[Tb][E]==0&&this.YM)this.xb.D(false);
else this.dX()
};
As[_P].dX=
function () {
var a=this.Rp(this.Gx,null,this.Rr);
this.Ib.Lg(a)
};
As[_P].Gx=function (a) {
this.vx(a);
if(a)this.Kh.X9(a,this.Fv);
this.$B();
this.tx(true)
};
As[_P].GJ=function (a) {
this.$B();
this.tx(false);
this.Kh.sJ();
this.le.W9(a.ruleModel,this.Ct)
};
As[_P].waa=function (a) {
var b=this.xb.Mm();
V(b,a)
};
As[_P].cX=function (a) {
this.Kh.D(false);
var b=this.K0(a.ruleModel,this.Gx,null,this.Rr);
this.Ib.Lg(b)
};
As[_P].tx=function (a) {
this.Kh.D(a);
this.waa(a);
this.cca(a)
};
As[_P].WH=function () {
this.tx(false);
var a=this.C0(this.D2,
null,this.Rr);
this.Ib.Lg(a)
};
As[_P].D2=function (a) {
this.GJ({
ruleModel:a
})
};
As[_P].Rp=function (a,b,c) {
var d=this.j.gooffiLink.Xd(mp);
return new kq(d,this,a,b,c,1000)
};
As[_P].C0=function (a,b,c) {
var d=this.j.gooffiLink.Xd(op);
return new kq(d,this,a,b,c,1000)
};
As[_P].N1=function (a,b,c,d) {
var e=this.j.gooffiLink.Xd(kp)+"&v="+fa(ki(a));
return new kq(e,this,b,c,d,1000)
};
As[_P].K0=function (a,b,c,d) {
var e=this.j.gooffiLink.Xd(np)+"&v="+fa(ki(a));
return new kq(e,this,b,c,d,1000)
};
As[_P].dispose=function () {
if(!this.N()) {
Xi[_P].dispose.call(this);
if(this.q) {
	this.q.dispose();
	this.q=null
}if(this.xb) {
	this.xb.D(false);
	this.xb.dispose();
	this.xb=null
}if(this.Kh) {
	this.Kh.dispose();
	this.Kh=null
}if(this.le) {
	this.le.dispose();
	this.le=null
}if(this.Fv) {
	yg(this.Fv);
	this.Fv=null
}if(this.Ct) {
	yg(this.Ct);
	this.Ct=null
}if(this.Ib) {
	this.Ib.dispose();
	this.Ib=null
}this.eW=null;
this.j=null
}
};
var Bs=function (a,b,c) {
af.call(this);
this.C=a;
this.Ou=b;
this.qh=c;
this.Rb=[];
this.c4=this.qh?this.Ou.jf:this.Ou.xg;
this.q=new mj(this)
};
Bs.inherits(af);
Bs[_P].nD=false;
Bs[_P].Xv=false;
Bs[_P].dr=null;
Bs[_P].rV=23;
Bs[_P].AV=17;
Bs[_P].Re=function (a) {
this.nD=true;
if(a)this.Xv=true
};
Bs[_P].lH=function () {
var a=this.Xv;
if(this.Xv) {
this.Xv=false;
this.g9()
}if(this.nD) {
this.nD=false;
this.cR(true)
}if(a&&this.dr) {
var b=this.C;
b.dc.apply(b,this.dr);
this.dr=null
}
};
Bs[_P].mH=function () {
this.cR(false)
};
Bs[_P].l6=
function (a,b) {
var c=Cs(a);
if(b!=a)c+="-"+Cs(b);
return c
};
Bs[_P].k5=function (a) {
return this.qh?this.C.Mg(a):this.C.Lk(a)
};
Bs[_P].g9=function () {
var a=this.C,b=a.Be,c=T(b),d=0,e=0,f=this.qh?a.Xb+1:1,g=this.qh?a.Ha():a.Ba;
for(var h=f;h<=g+1;h++)if(h<=g&&this.k5(h))d++;else if(d>0) {
var i=h-d,j=h-1,k=this.Rb[e];
if(!k)k=this.Rb[e]={
};
e++;
d=0;
if(k[ad]!=i||k.end!=j) {
	ob(k,i);
	k.end=j;
	var m=this.qh?"":this.l6(k[ad],k.end);
	if(k.div) {
		Oa(k.div[M],m);
		this.q.unlisten(k.link,U,k.handler)
	}else {
		k.link=!a.eb().Da()?c.b("a",
		{
			href:"#"
		}," "):c.b("span",{
		}," ");
		k.div=c.b("div",{
			"class":this.qh?"rowUnhideButton":"colUnhideButton"
		},m,k.link);
		b.appendChild(k.div)
	}k.handler=R(this.G3,this,k[ad],k.end);
	this.q.listen(k.link,U,k.handler)
}
}this.QQ(e)
};
Bs[_P].QQ=function (a) {
for(var b=a;b<this.Rb[E];b++) {
var c=this.Rb[b];
if(c.div) {
	this.q.unlisten(c.link,U,c.handler);
	c.link=null;
	Bg(c.div);
	c.div=null
}
}Da(this.Rb,a)
};
Bs[_P].cR=function (a) {
var b=this.Ou.Vp(),c=this.c4,d,e,f;
if(this.qh) {
d=c[Ed];
e=d+c[Id]-this.C.scrollDepth;
f=o.floor(this.AV/
2)
}else {
d=c[Cc]-1;
e=d+c[tc];
f=o.floor(this.rV/2)
}for(var g=0;g<this.Rb[E];g++) {
var h=this.Rb[g];
if(a)h.pos=this.lX(h);
var i=h.pos-b;
if(i<d||i>e)V(h.div,false);
else {
	V(h.div,true);
	if(this.qh)h.div[J].top=i-f;
	else ib(h.div[J],i-f)
}
}
};
Bs[_P].lX=function (a) {
var b=this.C,c=this.Ou;
if(this.qh) {
var d=b.fd();
if(S)if(!d)d=3;
else d+=1;
var e=32+d;
if(a[ad]-1>b.Xb) {
	var f=c.K(a[ad]-1);
	e+=c.hd(f)+f[Id]
}return e
}else {
var g=c.Wi(a.end+1,true)[Cc];
if(a[ad]>b.Ra)g+=b.Dg();
return g
}
};
Bs[_P].G3=function (a,b,c) {
var d,e=
this.C;
if(this.qh) {
this.dr=[a,1,b,e.Ba];
d=X.hideUnhideRows
}else {
this.dr=[1,a,e.Ha(),b];
d=X.hideUnhideCols
}e.eb().lq(d,0,a,b);
c.preventDefault();
c.stopPropagation()
};
Bs[_P].dispose=function () {
if(!this.N()) {
Bs.B.dispose.call(this);
this.QQ(0);
this.C=null;
this.Ou=null;
this.c4=null;
this.q.dispose();
this.q=null
}
};
;
;
;
;
;
var Ds=function (a,b,c,d) {
this.z=a;
this.Jh=b;
this.$ea=c==null?0:c;
this.ufa=d==null?false:d;
this.q=new mj(this)
};
Ds.inherits(af);
Ds[_P].C=null;
Ds[_P].Or=null;
Ds[_P].EJ=null;
Ds[_P].qT=null;
Ds[_P].Uh=null;
Ds[_P].vl=null;
Ds[_P].Jj=null;
Ds[_P].Uj=null;
Ds[_P].ip=null;
Ds[_P].bG=null;
Ds[_P].Dn=[];
Ds[_P].Za=null;
Ds[_P].Vb=false;
Ds[_P].eb=function () {
return this.z
};
Ds[_P].V=function () {
return this.C
};
Ds[_P].re=function (a,b) {
if(!this.Vb) {
this.Vb=true;
var c=this.z;
this.C=b;
this.Uh=this.Jj=b.O;
this.vl=b.O+b.ma-1;
this.Uj=this.bG=b.Y;
this.ip=b.Y+b.Z-1;
var d=this.Jh,e=d.$d(a,b),f=d.Ie(b,e[0],e[1]);
if(this.ufa) {
	this.Dn[0]=f[0]-this.Uh;
	this.Dn[1]=f[1]-this.Uj
}else {
	this.Dn[0]=0;
	this.Dn[1]=0
}this.EJ=b.divDropSelection;
if(this.Uh!=this.vl||this.Uj!=this.ip) {
	var g=b.divSelection,h=this.Or=b.divFormulas;
	this.qT=gj(h);
	fj(h,"divSelectionDragDrop");
	Fi(h,Gi(g));
	Ki(h,Li(g));
	V(h,true);
	b.vc(1);
	var i;
	switch(this.$ea) {
		case 1:i=new Qf(0,undefined,0,undefined);
		break;
		case 2:i=new Qf(undefined,0,undefined,0);
		break;
		default:i=null
	}var j=
	new tj(h,undefined,i);
	this.Za=j;
	j.re(new gh(a))
}var k=c.W(),m=this.q;
m.listen(k,Ph,this.Qe);
m.listen(k,Oh,this.Ee);
c.P()
}
};
Ds[_P].Yw=function (a) {
var b=this.C,c=this.Za;
if(c) {
c.deltaX-=b.divMain[jd]+a[1];
c.deltaY-=b.divMain[Ub]+a[0]
}
};
Ds[_P].Qe=function (a) {
jb(a,this);
var b=this.Jh,c=this.C,d=b.$d(a,c);
if(d[1]<0)d[1]=0;
var e=b.Ie(c,d[0],d[1]),f=c.tq(e[0],e[1]);
if(f) {
this.Yw(f);
c.Vc(e[0],e[1])
}e[0]-=this.Dn[0];
e[1]-=this.Dn[1];
e[0]=Sf(e[0],1+c.Xb,c.Ha()-this.vl+this.Uh);
e[1]=Sf(e[1],1+c.Ra,c.Ba-this.ip+
this.Uj);
var g=this.Jj=c.lastTblHeight!=-1&&d[1]>c.lastTblHeight?-1:e[0],h=this.bG=e[1];
this.iw(g,h)
};
Ds[_P].iw=function (a,b) {
var c=this.V(),d=a+this.vl-this.Uh,e=b+this.ip-this.Uj;
c.Li(a,b,d,e,this.EJ)
};
Ds[_P].rF=function (a,b) {
return a!=this.Uh||b!=this.Uj
};
Ds[_P].Ee=function (a) {
jb(a,this);
this.Vb=false;
var b=this.C,c=this.z;
b.vc(0);
c.cellOverlayManager.Rf();
var d=this.z.W(),e=this.q;
e.unlisten(d,Ph,this.Qe);
e.unlisten(d,Oh,this.Ee);
var f=this.Za;
if(f)f.dispose();
this.Za=null;
var g=this.Or;
if(g)fj(g,
this.qT.join(" "));
var h=this.Uh,i=this.vl,j=this.Jj,k=this.Uj,m=this.ip,n=this.bG;
if(!this.rF(j,n)) {
b.dc(h,k,i,m);
b.zj(true,false)
}else {
var q=i-h+1,p=m-k+1;
this.Lq(h,k,q,p,j,n)
}this.JD();
a.preventDefault()
};
Ds[_P].Lq=function () {
};
Ds[_P].JD=function () {
};
Ds[_P].dispose=function () {
if(!this.N()) {
Ds.B.dispose.call(this);
if(this.Za)this.Za.dispose();
this.Za=null;
this.z=null;
this.Jh=null;
this.C=null;
this.Ega=null;
this.Or=null
}
};
var Es=function (a,b) {
Ds.call(this,a,b,0,true)
};
Es.inherits(Ds);
Es[_P].lp=false;
Es[_P].vp=null;
Es[_P].re=function (a,b) {
Es.B.re.call(this,a,b);
var c=b.trixApp.W(),d=this.vp=Zk(c,b.divMain,"divMouseShadow",0,0,"0px","0px"),e=this.Jh.$d(a,b);
Fi(d,new Of(e[0]+10,e[1]-10));
var f=new tj(d);
this.Uv=f;
f.re(new gh(a))
};
Es[_P].nN=function (a) {
return Zf?a[Zb]:a[oc]
};
Es[_P].Yw=function (a) {
Es.B.Yw.call(this,a);
var b=this.C,c=this.Uv;
c.deltaX-=b.divMain[jd]+a[1];
c.deltaY-=b.divMain[Ub]+a[0]
};
Es[_P].Qe=function (a) {
Es.B.Qe.call(this,
a);
var b=this.lp,c=this.lp=this.nN(a);
if(c!=b)this.Aaa(c)
};
Es[_P].Ee=function (a) {
this.lp=this.nN(a);
var b=this.V();
b.divMain.removeChild(this.vp);
this.vp=null;
this.Uv.dispose();
Es.B.Ee.call(this,a)
};
Es[_P].Aaa=function (a) {
this.lp=a;
y(this.vp,a?"+":"")
};
Es[_P].Lq=function (a,b,c,d,e,f) {
var g=this.eb(),h=this.V();
if(e==-1||e+c>h.Ha())e=h.Ha()-c+1;
if(f+d>h.Ba)f=h.Ba-d+1;
h.dc(a,b,a+c-1,b+d-1);
var i=this.lp?X.pasteAll:X.newPasteCut;
g.copyPaste.copy(i,null);
h.dc(e,f,e+c-1,f+d-1);
h.Ar(e,f);
h.kF(e);
g.paste(false)
};
Es[_P].dispose=function () {
if(!this.N()) {
Es.B.dispose.call(this);
if(this.Uv)this.Uv.dispose();
this.Uv=null;
this.vp=null
}
};
var Fs=function (a,b) {
Ds.call(this,a,b,1)
};
Fs.inherits(Ds);
Fs[_P].iw=function (a) {
Fs.B.iw.call(this,a,1);
var b=this.V();
if(a<this.Uh||a>this.vl)if(a==-1)this.eb().appOverlayManager.tT(b,b.Ha(),false);
else this.eb().appOverlayManager.tT(b,a,true);
Ga(b.divTop[J],"move")
};
Fs[_P].rF=function (a) {
return a<this.Uh||a>this.vl
};
Fs[_P].Lq=function (a,b,c,d,e,f) {
var g=this.V();
if(e==-1)this.eb().iP(a,a+c-1,g.Ha(),false);
else this.eb().iP(a,a+c-1,e,true);
if(e==-1)e=g.Ha()-c+1;
else if(e>=a)e-=c;
g.dc(e,b,e+c-1,b+
d-1);
g.Ar(e,f);
g.kF(e)
};
Ds[_P].JD=function () {
this.eb().appOverlayManager.Rf();
Ga(this.V().divTop[J],"")
};
var Gs=function (a,b) {
this.mq=a||"";
this.Tq=b||"";
this.SP=[];
this.vR=new Op(500);
this.Y8=R(this.U7,this);
this.ifa=new Dk(this.Tq);
this.dfa={
};
this.qaa(true);
this.qc=this.gB("enabled")=="1";
Td.setInterval(R(this.B$,this),7500)
};
Gs[_P].kV="LOGGING";
Gs[_P].Wa=null;
Gs[_P].No=false;
Gs[_P].lN=false;
Gs[_P].ZH=null;
Gs[_P].ZN=ne();
Gs[_P].Tba=function (a) {
this.kV=a
};
Gs[_P].init=function () {
if(this.qc)this.Mq()
};
Gs[_P].wc=function () {
return this.qc
};
Gs[_P].Ad=function (a) {
this.qc=a;
if(this.qc) {
this.Mq();
if(this.Wa)this.us()
}this.iS("enabled",
a?1:0)
};
Gs[_P].qaa=function (a) {
if(a==this.lN)return ;
this.lN=a;
var b=vk();
if(a)b.bW(this.Y8);
else b.L9(this.Y8)
};
Gs[_P].U7=function (a) {
if(this.dfa[a.qO])return ;
var b=this.ifa.Ip(a);
this.rea(b)
};
Gs[_P].rea=function (a) {
if(this.qc) {
this.Mq();
this.vR.add(a);
this.wy(a)
}else this.vR.add(a)
};
Gs[_P].wy=function (a) {
this.SP.push(a);
Td.clearTimeout(this.ZH);
if(ne()-this.ZN>750)this.mV();
else this.ZH=Td.setTimeout(R(this.mV,this),250)
};
Gs[_P].mV=function () {
this.ZN=ne();
if(this.Wa) {
var a=this.Wa[mc][Lc],b=a&&a[dd]-
(a[Ub]+a[hd])<=100;
this.Wa[mc].write(this.SP.join(""));
Da(this.SP,0);
if(b)this.Wa.scrollTo(0,1000000)
}
};
Gs[_P].oV=function () {
var a=this.vR.Fb();
for(var b=0;b<a[E];b++)this.wy(a[b])
};Gs[_P].Mq=function () {
if(this.Wa&&!this.Wa[yc]||this.No)return ;
var a=this.gB("dbg","0,0,800,500").split(","),b=ja(a[0]),c=ja(a[1]),d=ja(a[2]),e=ja(a[3]);
this.No=true;
this.Wa=l.open("","dbg"+this.mq,"width="+d+",height="+e+",toolbar=no,resizable=yes,scrollbars=yes,left="+b+",top="+c+",status=no,screenx="+b+",screeny="+c);
if(!this.Wa)if(!this.cU) {
ra("Logger popup was blocked");
this.cU=true
}this.No=false;
if(this.Wa)this.us()
};
Gs[_P].us=function () {
if(!this.Wa)return ;
this.Wa[mc].open();
var a='<style>*{font:normal 14px monospace;}.dbg-sev{color:#F00}.dbg-w{color:#E92}.dbg-sh{font-weight:bold;color:#000}.dbg-i{color:#666}.dbg-f{color:#999}.dbg-ev{color:#0A0}.dbg-m{color:#990}</style><hr><div class="dbg-ev" style="text-align:center">'+this.kV+"<br><small>Logger: "+this.mq+"</small></div><hr>";
this.wy(a);
this.oV()
};
Gs[_P].iS=
function (a,b) {
a+=this.mq;
oa.cookie=a+"="+fa(b)+";expires="+(new Date(ne()+2592000000)).toUTCString()
};
Gs[_P].gB=function (a,b) {
a+=this.mq;
var c=ha(oa.cookie),d=c.indexOf(a+"=");
if(d!=-1) {
var e=c.indexOf(";",d);
return pa(c.substring(d+a[E]+1,e==-1?c[E]:e))
}else return b||""
};
Gs[_P].B$=function () {
if(!this.Wa||this.Wa[yc])return ;
var a=this.Wa[Tc]||this.Wa.screenLeft||0,b=this.Wa[Uc]||this.Wa.screenTop||0,c=this.Wa.outerWidth||800,d=this.Wa.outerHeight||500;
this.iS("dbg",a+","+b+","+c+","+d)
};
var Js=function () {
this.Ht=[];
this.TP=new $g;
this.Tr=0;
this.Hda=0;
this.Gda=0;
this.Fda=0;
this.Sx=new $g;
this.Eda=0;
this.ZX=0;
this.Dfa=1;
this.XJ=new fh(0,4000);
this.XJ.pp=function () {
return new Hs
};
this.Xca=new fh(0,50);
this.Xca.pp=function () {
return new Is
};
var a=this;
this.LM=new fh(0,2000);
this.LM.pp=function () {
return ha(a.Dfa++)
};
this.LM.Oz=function () {
};
this.Uea=3
};
Js[_P].La=rk("goog.debug.Trace");
var Is=function () {
this.count=0;
this.time=0;
this.varAlloc=0
};
ya(Is[_P],function () {
var a=[];
a.push(this[N],
" ",this.count," (",o.round(this.time*10)/10," ms)");
if(this.varAlloc)a.push(" [VarAlloc = ",this.varAlloc,"]");
return a.join("")
});
var Hs=function () {
};
Hs[_P].vda=function (a,b,c) {
var d=[];
if(b==-1)d.push("    ");
else d.push(Ks(this.eventTime-b));
d.push(" ",Ls(this.eventTime-a));
if(this.eventType==0)d.push(" Start        ");
else if(this.eventType==1) {
d.push(" Done ");
var e=this.stopTime-this.startTime;
d.push(Ks(e)," ms ")
}else d.push(" Comment      ");
d.push(c,this);
if(this.totalVarAlloc>0)d.push("[VarAlloc ",
this.totalVarAlloc,"] ");
return d.join("")
};
ya(Hs[_P],function () {
return this[N]==null?this.comment:"["+this[N]+"] "+this.comment
});
Hb(Js[_P],function (a) {
this.Uea=a;
for(var b=0;b<this.Ht[E];b++) {
var c=this.XJ.id;
if(c)this.LM.Qg(c);
this.XJ.Qg(this.Ht[b])
}Da(this.Ht,0);
this.TP.clear();
this.Tr=Ms();
this.Hda=0;
this.Gda=0;
this.Fda=0;
this.Eda=0;
this.ZX=0;
var d=this.Sx.vd();
for(var b=0;b<d[E];b++) {
var e=d[b],f=this.Sx.get(e);
f.count=0;
f.time=0;
f.varAlloc=0;
this.Xca.Qg(f)
}this.Sx.clear()
});
Js[_P].X0=function () {
return this.toString ()
};
ya(Js[_P],function () {
var a=[],b=-1,c=[];
for(var d=0;d<this.Ht[E];d++) {
var e=this.Ht[d];
if(e.eventType==1)c.pop();
a.push(" ",e.vda(this.Tr,b,c.join("")));
b=e.eventTime;
a.push("\n");
if(e.eventType==0)c.push("|  ")
}if(this.TP.Kc()!=0) {
var f=Ms();
a.push(" Unstopped timers:\n");
Vg(this.TP,function (i) {
	a.push("  ",i," (",f-i.startTime," ms, started at ",Ls(i.startTime),")\n")
})
}var g=this.Sx.vd();
for(var d=0;d<g[E];d++) {
var h=this.Sx.get(g[d]);
if(h.count>1)a.push(" TOTAL ",h,"\n")
}a.push("Total tracers created ",
this.Eda,"\n","Total comments created ",this.ZX,"\n","Overhead start: ",this.Hda," ms\n","Overhead end: ",this.Gda," ms\n","Overhead comment: ",this.Fda," ms\n");
return a.join("")
});
var Ks=function (a) {
a=o.round(a);
var b="";
if(a<1000)b=" ";
if(a<100)b="  ";
if(a<10)b="   ";
return b+a
},Ls=function (a) {
a=o.round(a);
var b=a/1000%60,c=a%1000;
return ha(100+b).substring(1,3)+"."+ha(1000+c).substring(1,4)
},Ms=function () {
return ne()
},Ns=new Js;
var Os=null,Ps=null,Qs=function (a) {
Os=a
};
qe("trix.debug.setChangelist",Qs);
var Rs=function (a) {
Ps=a
};
qe("trix.debug.setBuildLabel",Rs);
var Ss=function (a,b) {
Gs.call(this,a,b);
this.Tba("Google Spreadsheets");
this.dU();
this.G=new mj(this);
this.WM=false
};
Ss.inherits(Gs);
Ss[_P].dU=function () {
rk("goog.net.BrowserChannel").sx(ik)
};
Ss[_P].Mq=function () {
if(this.Wa&&!this.Wa[yc]||this.No)return ;
var a=this.gB("dbg","0,0,800,500").split(","),b=ja(a[0]),c=ja(a[1]),d=ja(a[2]),e=ja(a[3]);
this.No=true;
this.Wa=l.open("","dbg"+this.mq,"width="+d+",height="+e+",toolbar=no,resizable=yes,scrollbars=yes,left="+b+",top="+c+",status=no,screenx="+b+",screeny="+
c);
if(!this.Wa)if(!this.cU) {
ra("Logger popup was blocked");
this.cU=true
}this.No=false;
if(this.Wa) {
this.us();
this.G.listen(this.Wa,"unload",this.H3)
}
};
Ss[_P].us=function () {
if(!this.Wa||this.WM)return ;
this.Wa[mc].open();
var a='<style>*{font:normal 14px monospace;}.dbg-sev{color:#F00}.dbg-w{color:#E92}.dbg-sh{font-weight:bold;color:#000}.dbg-i{color:#666}.dbg-f{color:#999}.dbg-ev{color:#0A0}.dbg-m{color:#990}</style><hr><div class="dbg-ev" style="text-align:center">'+this.Hga+"<br><small>Logger: "+this.mq+
"</small></div><hr>";
this.wy(a);
this.oV();
this.WM=true
};
Ss[_P].H3=function () {
this.Ad(false);
this.WM=false
};
Ss[_P].dispose=function () {
this.G.cc()
};
var Ts=function (a) {
Xi.call(this,a);
this.G=new mj(this);
this.ot=new Ss("GoogleSpreadsheets");
this.ot.dU()
};
Ts.inherits(Xi);
Ts[_P].RP=null;
Ts[_P].OP=null;
Ts[_P].wU=null;
Ts[_P].YJ=null;
Ts[_P].b5=function () {
Oi(".ss-db{border:1px solid #CCC;border-top-width:0;font:8pt Arial, sans-serif;top:0;left:20%;padding:0.4em 0.5em;position:absolute;z-index:20;}.ss-db-txt{color:#555}",this.A)
};
Ts[_P].b=function () {
var a=null,b=this.F,c=b.b("div",{
"class":"ss-db"
},a=b.b("span",{
"class":"ss-db-txt"
}),this.RP=b.b("a",
{
href:"#"
},"View XML"),b.createTextNode(" | "),this.OP=b.b("a",{
href:"#"
},"Debug window"),b.createTextNode(" | "),this.wU=b.b("a",{
href:"#"
},"Trace Dump"),b.createTextNode(" | "),this.YJ=b.b("a",{
href:"#"
},"Expire Info"),b.createTextNode(" | "),this.Mea=b.b("a",{
href:"#"
},"Close Info")),d=new Im;
d.append("build: ",Ps||"LOCAL");
var e=Os;
if(e!=-1)d.append(' | CL <a href="http://sourcerer/',e,'" target="_BLANK">',e,"</a>");
d.append("<br/>");
y(a,d.toString ());
this.A=c;
this.b5()
};
Ts[_P].Db=function () {
Ts.B.Db.call(this);
var a=this.G;
a.listen(this.RP,U,this.h3);
a.listen(this.OP,U,this.g3);
a.listen(this.wU,U,this.E3);
a.listen(this.YJ,U,this.I2);
a.listen(this.Mea,U,this.q2)
};
Ts[_P].h3=function (a) {
a.preventDefault();
var b=l.trixApp,c=b.nt,d=b.dj(),e=new Jm(c+"/fm");
e.ua("id",d);
e.ua("fmcmd",100);
Zm(e)
};
Ts[_P].g3=function (a) {
a.preventDefault();
this.ot.Ad(true)
};
Ts[_P].E3=function (a) {
a.preventDefault();
l.trixApp.log("Trace:\n"+Ns.X0(),true)
};
Ts[_P].I2=function (a) {
a.preventDefault();
var b=l.trixApp,c=b.nt,d=b.dj(),e=new Jm(c+
"/fm");
e.ua("id",d);
e.ua("fmcmd",300);
mi(e,null,"POST")
};
Ts[_P].q2=function (a) {
a.preventDefault();
var b=l.trixApp,c=b.nt,d=b.dj(),e=new Jm(c+"/fm");
e.ua("id",d);
e.ua("fmcmd",301);
mi(e,null,"POST")
};
Ts[_P].rc=function () {
this.G.cc();
Ts.B.rc.call(this)
};
Ts[_P].dispose=function () {
this.G.dispose();
this.G=null;
this.ot.dispose();
this.ot=null
};
var Vs=function () {
if(Us!=undefined)return Us;
var a=Xd("google.gears.factory");
if(a)return Us=a;
try{
var b=Xd("GearsFactory");
return Us=new b
}catch(c) {
}try{
return Us=new ActiveXObject("Gears.Factory")
}catch(c) {
}var d=Xd("window");
if(d&&d.navigator.mimeTypes["application/x-googlegears"])try{
var e=d.document,a=e.getElementById("gears-factory");
if(!a) {
	a=e.createElement("object");
	a.style.display="none";
	a.width="0";
	a.height="0";
	a.type="application/x-googlegears";
	a.id="gears-factory";
	e.documentElement.appendChild(a)
}return Us=
a
}catch(c) {
}return Us=null
},Us=undefined,Ws=function (a) {
if(!a)throwError("file name empty");
a=ha(a);
var b=a.replace(/[^a-zA-Z0-9\.\-@_]/g,"");
if(!b)throwError("file name invalid: "+a);
if(b[E]<=64)return b;
var c=b.substring(0,54);
return c+ha(Ze(a))
};
var Xs=function (a,b) {
Xh.call(this);
var c=Vs();
try{
this.Sb=c.create("beta.database","1.0")
}catch(d) {
throwError("Could not create the database. "+d[Dc]);
}if(this.Sb!=null) {
var e=a+"-"+b,f=Ws(e);
if(e!=f)this.La.info("database name "+e+"->"+f);
this.u$=f;
this.Sb.open(f)
}else throwError("Could not create the database");
};
te(Xs,Xh);
var bt=function (a) {
eh.call(this,a)
};
te(bt,eh);
Xs[_P].La=rk("goog.gears.Database");
Xs[_P].oG=true;
Xs[_P].Uf=0;
Xs[_P].Hq=false;
Xs[_P].uZ="IMMEDIATE";
var ct={
DEFERRED:0,IMMEDIATE:1,
EXCLUSIVE:2
};
Xs[_P].YI=ct.DEFERRED;
var dt=function (a) {
return a&&a.isValidRow()?a.field(0):null
},et=function (a) {
if(a&&a.isValidRow()) {
var b={
},c=a.fieldCount();
for(var d=0;d<c;d++)b[a.fieldName(d)]=a.field(d);return b
}else return null
};Xs[_P].execute=function (a) {
this.La.fine("Executing SQL: "+a);
a=ha(a);
var b;
try{
if(arguments[E]==1)return this.Sb.execute(a);
b=arguments[E]==2&&ce(arguments[1])?arguments[1]:tf(arguments,1);
this.La.fine("SQL arguments: "+b);
return this.Sb.execute(a,b)
}catch(c) {
if(b)a+=
": "+ki(b);
throwak(c,a);
}
};
Xs[_P].O_=function (a,b,c) {
if(b[E]==0||c>=b[E])return this.execute(a);
else {
if(ce(b[c]))return this.execute(a,b[c]);
var d=Array[_P][jc].call(b,c);
return this.execute(a,d)
}
};
Xs[_P].tQ=function (a,b,c,d) {
var e=this.O_(a,c,d);
try{
return b(e)
}finally{
if(e)e.close()
}
};
Xs[_P].a9=function (a) {
return this.tQ(a,dt,arguments,1)
};
Xs[_P].sQ=function (a) {
return this.tQ(a,et,arguments,1)
};
Xs[_P].tI=function (a) {
var b,c;
b=a?"ROLLBACK":"COMMIT";
c=a?"beforerollback":"beforecommit";
var d=new bt(c),
e=this.dispatchEvent(d);
if(e) {
this.Sb.execute(b);
this.Uf=0;
c=a?"rollback":"commit";
this.dispatchEvent(new bt(c))
}return e
};
Xs[_P].eX=function (a) {
if(this.oG)if(this.Uf==0) {
this.Hq=false;
this.dispatchEvent(new bt("beforebegin"));
this.Sb.execute("BEGIN "+a);
this.YI=ct[a];
this.Uf=1;
try{
	this.dispatchEvent(new bt("begin"))
}catch(b) {
	this.Sb.execute("ROLLBACK");
	this.Uf=0;
	throwb;
}return true
}else if(this.Hq)throwError("Cannot begin a transaction with a rollback pending");
else if(ct[a]>this.YI)throwError("Cannot elevate the level within a nested begin");
else this.Uf++;
return false
};
Xs[_P].begin=function () {
return this.eX(this.uZ)
};
Xs[_P].commit=function () {
if(this.oG) {
if(this.Uf<=0)throwError("Unbalanced transaction");
if(this.Uf==1) {
	var a=this.tI(this.Hq);
	return !this.Hq&&a
}else this.Uf--
}return false
};
Xs[_P].rollback=function (a) {
var b=true;
if(this.oG) {
if(this.Uf<=0)throwError("Unbalanced transaction");
if(this.Uf==1)b=this.tI(true);
else {
	this.Uf--;
	this.Hq=true;
	if(a)throwa;
	return false
}
}return b
};
Xs[_P].open=function () {
if(this.Sb&&this.u$)this.Sb.open(this.u$);
else throwError("Could not open the database");
};
Xs[_P].close=function () {
if(this.Sb)this.Sb.close()
};
Xs[_P].M=function () {
Xs.B.M.call(this);
this.Sb=null
};
var ft=function (a) {
af.call(this);
this.Sb=a
};
te(ft,af);
ft[_P].Ac="Base";
ft[_P].ri=1;
ft[_P].vE=[];
ft[_P].removeStore=function () {
this.Sb.begin();
try{
this.P9();
this.x_(this.vE);
this.Sb.commit()
}catch(a) {
this.Sb.rollback(a);
throwError("Could not remove the "+this.Ac+" schema: "+(a[Dc]||"unknown exception"));
}
};
ft[_P].Lc=function () {
return this.Ac
};
ft[_P].P9=function () {
try{
this.Sb.execute("DELETE FROM StoreVersionInfo WHERE StoreName=?",this.Ac)
}catch(a) {
}
};
ft[_P].Q0=function (a) {
switch(a[N]) {
case 1:case 2:return "DROP TABLE IF EXISTS "+
a[yd];
case 3:return "DROP INDEX IF EXISTS "+a[yd];
case 4:case 5:case 6:case 7:case 8:case 9:return "DROP TRIGGER IF EXISTS "+a[yd]
}return ""
};
ft[_P].x_=function (a) {
this.Sb.begin();
try{
for(var b=a[E]-1;b>=0;--b)this.Sb.execute(this.Q0(a[b]));this.Sb.commit()
}catch(c) {
this.Sb.rollback(c)
}
};
ft[_P].M=function () {
ft.B.M.call(this);
this.Sb=null
};
var gt=function (a) {
ft.call(this,a)
};
gt.inherits(ft);
gt[_P].La=rk("trix.gears.DocStore");
gt[_P].Ac="GoogleSpreadsheetsStore";
gt[_P].ri=2;
gt[_P].vE=[{
type:1,name:"DocumentData",columns:["docId TEXT NOT NULL","gridId INTEGER NOT NULL","startRow INTEGER NOT NULL","endRow INTEGER NOT NULL","content TEXT NOT NULL","PRIMARY KEY (docId, gridId, startRow) ON CONFLICT REPLACE"]
},{
type:1,name:"DocumentEmbeddedData",columns:["docId TEXT NOT NULL","gridId INTEGER NOT NULL","content TEXT NOT NULL","PRIMARY KEY (docId, gridId) ON CONFLICT REPLACE"]
},
{
type:1,name:"DocumentMetaData",columns:["docId TEXT NOT NULL PRIMARY KEY ON CONFLICT REPLACE","timestamp INTEGER","title TEXT","config TEXT NOT NULL","structure TEXT NOT NULL","firstGridId INTEGER NOT NULL"]
}];
gt[_P].O0=function (a) {
this.La.fine("getDocumentConfigAndStruct: "+a);
try{
var b=this.Sb.sQ("SELECT config, structure, firstGridId FROM DocumentMetaData WHERE docId=?",a);
return b
}catch(c) {
this.La.warning("getDocumentConfigAndStruct failed: "+c[Dc])
}return null
};
gt[_P].P0=function (a,b) {
this.La.fine("getDocumentEmbeddedData: "+
a+":"+b);
try{
return this.Sb.a9("SELECT content FROM DocumentEmbeddedData WHERE docId=? AND gridId=?",a,b)||null
}catch(c) {
this.La.warning("getDocumentEmbeddedData failed: "+c[Dc])
}return null
};
gt[_P].ZK=function (a,b,c,d) {
this.La.fine("getDocumentContent: "+a+":"+b+" "+c+"-"+d);
try{
var e=this.Sb.sQ("SELECT content, endRow FROM DocumentData WHERE docId=? AND gridId=? AND startRow=?",a,b,c);
return e&&(!d||e.endRow==d)?e.content:null
}catch(f) {
this.La.warning("getDocumentContents failed on "+a+": "+f[Dc])
}return null
};
var oi=function (a) {
if(a)this.parseFromString(a)
};
oi[_P].Bd=null;
Ca(oi[_P],null);
oi[_P].Rd=null;
Rb(oi[_P],null);
oi[_P].nf=null;
oi[_P].Qi=null;
ya(oi[_P],function () {
if(!this.Tk())return null;
this.normalize();
var a=this[$b],b=this.Rd,c=this[Ld],d=this.nf,e="";
if(b)e+=Cs(b);
if(a)e+=a;
if(!b||!a||d!=b||c!=a) {
e+=":";
if(d)e+=Cs(d);
if(c)e+=c
}if(this.Bd)e=ur(this.Bd,e);
return e
});
oi[_P].normalize=function () {
var a=this[$b],b=this.Rd,c=this[Ld],d=this.nf;
if(a>c) {
Ca(this,c);
Rb(this,a)
}if(b>d) {
this.Rd=d;
this.nf=
b
}
};
oi[_P].Tk=function () {
var a=this[$b],b=this.Rd,c=this[Ld],d=this.nf;
if(a>=0&&b>=0&&c>=0&&d>=0)if(!b==!d&&!a==!c&&(b||a)) {
this.Qi=null;
return true
}this.Qi=_M[331];
return false
};
oi[_P].i5=function () {
return !this.Rd&&!this.nf
};
oi[_P].h5=function () {
return !this[$b]&&!this[Ld]
};
oi[_P].Ha=function () {
var a=this[$b],b=this[Ld];
return a&&b?(b<a?a-b:b-a)+1:null
};
oi[_P].overlaps=function (a,b,c,d) {
return (!this.Rd||this.nf>=b&&this.Rd<b+d)&&(!this[$b]||this[Ld]>=a&&this[$b]<a+c)
};
oi[_P].covers=function (a,b,c,
d) {
return (!this.Rd||this.Rd<=b&&this.nf>=b+d-1)&&(!this[$b]||this[$b]<=a&&this[Ld]>=a+c-1)
};
Hb(oi[_P],function () {
Ca(this,this.Rd=Rb(this,this.nf=null));
this.Bd=this.Qi=null
});
oi[_P].parseFromString=function (a) {
this.reset();
var b=a.lastIndexOf("!");
if(b>=0) {
this.Bd=Ve(a.substring(0,b),"'")||null;
a=a.substring(b+1)
}if(a!="") {
var c=a.match(/^\s*([a-zA-Z]*)(\d*)(:([a-zA-Z]*)(\d*))?\s*$/);
if(c) {
	Ca(this,ht(c[2]));
	this.Rd=it(c[1]);
	if(c[3]) {
		Rb(this,ht(c[5]));
		this.nf=it(c[4])
	}else if(this[$b]&&this.Rd) {
		Rb(this,
		this[$b]);
		this.nf=this.Rd
	}
}
}return this.Tk()
};
var ht=function (a) {
var b=ga(a,10);
return b>0?b:null
},it=function (a) {
var b=a?a[E]:0;
if(b<1||b>2)return null;
a=a.toUpperCase();
var c=0,d;
for(var e=0;e<b;e++) {
if((d=jt.indexOf(a.charAt(e)))<0)return null;
c=c*26+(d+1)
}return c
},ur=function (a,b) {
return /^[a-zA-Z_][a-zA-Z0-9_]*$/.test(a)?a+"!"+b:"'"+a+"'!"+b
},vr=function (a) {
var b=a.lastIndexOf("!");
return b>=0?a.substring(b+1):a
},si=function (a,b) {
this.j=a;
if(b)this.parseFromString(b)
};
si.inherits(oi);
mb(si[_P],
null);
si[_P].normalize=function () {
si.B.normalize.call(this);
this.Bd=this.j.Aa.pb(this[Xc]).Lc()
};
si[_P].Tk=function () {
if(!si.B.Tk.call(this))return false;
if(this[Xc]!=null) {
var a=this.j.Aa.pb(this[Xc]);
if(a) {
	var b=a.Ha(),c=a.Ba;
	if(this[$b]<=b&&this[Ld]<=b&&this.Rd<=c&&this.nf<=c) {
		this.Qi=null;
		return true
	}this.Qi=_M[363];
	return false
}
}this.Qi=_M[332];
return false
};
Hb(si[_P],function () {
si.B.reset.call(this);
mb(this,null)
});
si[_P].parseFromString=function (a) {
si.B.parseFromString.call(this,a);
if(this.Bd) {
var b=
this.j.Aa.ou(this.Bd);
if(b)mb(this,b.id)
}else {
var b=this.j.activeGrid;
if(b) {
	mb(this,b.id);
	this.Bd=b.Lc()
}
}
};
var lt=function (a,b,c) {
Xh.call(this);
this.ZC=a;
this.ao=c;
this.Q=b;
Dh(b,["hilite","select",kt,"dismiss"],this);
this.qi=null;
this.Xc=[];
this.Sf=-1;
this.ph=0;
this.ni=null;
this.um=null
};
te(lt,Xh);
lt[_P].u6=10;
lt[_P].YW=true;
lt[_P].HW=false;
var kt="canceldismiss";
lt[_P].Nd=function (a) {
if(a[Sc]==this.Q)switch(a[N]) {
case "hilite":this.Eh(a.row);
break;
case "select":this.xr();
break;
case kt:this.Ty();
break;
case "dismiss":this.mJ();
break
}
};
lt[_P].Nba=function (a,b) {
if(this.qi==a)return ;
this.qi=a;
this.ZC.Mw(this.qi,
this.u6,R(this.Pv,this),b);
this.Ty()
};
lt[_P].Kba=function (a) {
this.ni=a
};
lt[_P].isOpen=function () {
return this.Q.Ka()
};
lt[_P].wM=function () {
if(this.Sf>=this.ph&&this.Sf<this.ph+this.Xc[E]-1) {
this.Eh(this.Sf+1);
return true
}else if(this.Sf==-1) {
this.Eh(this.ph);
return true
}return false
};
lt[_P].xM=function () {
if(this.Sf>this.ph) {
this.Eh(this.Sf-1);
return true
}else if(this.HW&&this.Sf==this.ph)this.Eh(-1);
return false
};
lt[_P].Eh=function (a) {
this.Sf=a;
this.Q.Eh(a);
return this.xB(a)!=-1
};
lt[_P].xr=function () {
var a=
this.xB(this.Sf);
if(a!=-1) {
var b=this.Xc[a];
this.ao.CE(b);
this.dismiss();
this.dispatchEvent({
	type:"update",row:b
});
return true
}else {
this.dismiss();
this.dispatchEvent({
	type:"update",row:null
});
return false
}
};
lt[_P].dismiss=function () {
this.Sf=-1;
this.qi=null;
this.ph+=this.Xc[E];
Da(this.Xc,0);
l.clearTimeout(this.um);
this.um=null;
this.Q.dismiss()
};
lt[_P].mJ=function () {
if(!this.um)this.um=l.setTimeout(R(this.dismiss,this),100)
};
lt[_P].Ty=function () {
l.setTimeout(R(function () {
if(this.um) {
	l.clearTimeout(this.um);
	this.um=null
}
},this),10)
};
lt[_P].M=function () {
lt.B.M.call(this);
this.Q.dispose();
this.ao.dispose();
this.ZC=null
};
lt[_P].Pv=function (a,b,c) {
if(this.qi!=a)return ;
var d=c?this.xB(this.Sf):null;
this.ph+=this.Xc[E];
this.Xc=b;
var e=[];
for(var f=0;f<b[E];++f)e.push({
id:this.fL(f),data:b[f]
});
this.Q.V9(e,this.qi,this.ni);
if(this.YW&&e[E]!=0) {
var g=d!=null?this.fL(d):this.ph;
this.Eh(g)
}else this.Sf=-1
};
lt[_P].xB=function (a) {
var b=a-this.ph;
if(b<0||b>=this.Xc[E])return -1;
return b
};
lt[_P].fL=function (a) {
return this.ph+
a
};
var mt=function (a,b,c,d) {
af.call(this);
this.jo=Vd(a)&&!(a===null)?a:",;";
this.b6=b||"";
this.Gq=c!=null?c:true;
this.Zb=new rj(d||150);
this.Tea=this.jo.substring(0,1);
this.kga=new RegExp("^[\\s"+this.jo+"]+|[\\s"+this.jo+"]+$","g");
this.Yfa=new RegExp("\\s*["+this.jo+"]$");
this.Ud=new mj(this);
this.ws=new mj(this);
this.sf=new Jn
};
te(mt,af);
mt[_P].nea=true;
mt[_P].s0=true;
mt[_P].bV=false;
mt[_P].U$=true;
mt[_P].mc=null;
mt[_P].Wk="";
mt[_P].Sl=false;
mt[_P].pE=false;
mt[_P].UW=function (a) {
this.fc=a
};
mt[_P].VW=
function (a) {
dj(a,"select");
ej(a,"haspopup",true);
this.Ud.listen(a,"focus",this.Hn);
this.Ud.listen(a,"blur",this.Gn);
if(!this.mc)this.ws.listen(a,Qh,this.zP)
};
mt[_P].QZ=function (a) {
if(a==this.mc)this.Gn();
this.Ud.unlisten(a,"focus",this.Hn);
this.Ud.unlisten(a,"blur",this.Gn);
if(!this.mc)this.ws.unlisten(a,Qh,this.zP)
};
mt[_P].CE=function (a,b) {
var c=this.fc.ni;
if(Vd(b)?b:this.Gq) {
var d=rq(c),e=this.KL(c[I],d),f=this.LF(c[I]),g=a.toString ();
if(!this.Yfa.test(g))g=De(g)+this.Tea;
if(this.nea) {
	if(e!=0&&
	!ze(f[e-1]))g=" "+g;
	if(e<f[E]&&!ze(f[e+1]))g=g+" "
}if(g!=f[e]) {
	f[e]=g;
	Ta(c,f.join(""));
	var h=0;
	for(var i=0;i<=e;i++)h+=f[i][E];c.focus();pq(c,h);tq(c,h)
}
}else Ta(c,a.toString ());this.pE=true
};mt[_P].M=function () {
mt.B.M.call(this);
this.Ud.dispose();
this.Ud=null;
this.ws.dispose();
this.ws=null
};
mt[_P].Of=function (a) {
switch(a[ed]) {
case 40:if(this.fc.isOpen()) {
	this.P6();
	a.preventDefault();
	return true
}else if(!this.Gq) {
	this.Jo(true);
	a.preventDefault();
	return true
}break;
case 38:if(this.fc.isOpen()) {
	this.S6();
	a.preventDefault();
	return true
}break;
case 9:this.Jo();
if(this.fc.xr()&&this.Gq) {
	a.preventDefault();
	return true
}break;
case 13:this.Jo();
if(this.fc.xr()) {
	a.preventDefault();
	return true
}break;
case 27:if(this.fc.isOpen()) {
	this.fc.dismiss();
	return true
}break;
case 229:if(!this.Sl) {
	this.Ud.listen(this.mc,"keyup",this.Ng);
	this.Sl=true;
	return true
}break
}if(this.U$&&this.Gq&&a[$c]&&this.jo.indexOf(ha.fromCharCode(a[$c]))!=-1) {
this.Jo();
if(this.fc.xr()) {
	a.preventDefault();
	return true
}
}return false
};
mt[_P].eH=
function () {
this.sf.attach(this.mc);
this.Ud.listen(this.sf,"key",this.AP);
if(S)this.Ud.listen(this.mc,kh,this.xP)
};
mt[_P].TQ=function () {
this.Ud.unlisten(this.sf,"key",this.AP);
this.sf.detach();
if(S)this.Ud.unlisten(this.mc,kh,this.xP);
if(this.Sl)this.Ud.unlisten(this.mc,"keyup",this.Ng)
};
mt[_P].Hn=function (a) {
this.ws.cc();
if(this.fc)this.fc.Ty();
if(a[Sc]!=this.mc) {
this.mc=a[Sc];
this.Zb.start();
this.Ud.listen(this.Zb,"tick",this.Kn);
this.Wk=this.mc[I];
this.eH()
}
};
mt[_P].Gn=function () {
if(this.mc) {
this.TQ();
this.mc=null;
this.Sl=false;
this.Zb.stop();
this.Ud.unlisten(this.Zb,"tick",this.Kn);
if(this.fc)this.fc.mJ()
}
};
mt[_P].Kn=function () {
if(!this.Sl)this.Jo()
};
mt[_P].zP=function (a) {
this.Hn(a)
};
mt[_P].AP=function (a) {
if(this.fc&&!this.Sl)this.Of(a)
};
mt[_P].Ng=function (a) {
if(a[ed]==13) {
this.Sl=false;
this.Ud.unlisten(this.mc,"keyup",this.Ng)
}
};
mt[_P].xP=function (a) {
if(this.Gq&&this.jo.indexOf(ha.fromCharCode(a[$c]))!=-1) {
this.Jo();
if(this.fc.xr())a.preventDefault()
}
};
mt[_P].Jo=function (a) {
if(a||this.mc&&this.mc[I]!=
this.Wk) {
if(!this.pE) {
	var b=this.z8();
	if(this.fc) {
		this.fc.Kba(this.mc);
		this.fc.Nba(b,this.mc[I])
	}
}this.Wk=this.mc[I]
}this.pE=false
};
mt[_P].S6=function () {
return this.bV?this.fc.wM():this.fc.xM()
};
mt[_P].P6=function () {
return this.bV?this.fc.xM():this.fc.wM()
};
mt[_P].z8=function () {
var a=rq(this.mc),b=this.mc[I];
return this.Nda(this.LF(b)[this.KL(b,a)])
};
mt[_P].Nda=function (a) {
return ha(a).replace(this.kga,"")
};
mt[_P].KL=function (a,b) {
var c=this.LF(a);
if(b==a[E])return c[E]-1;
var d=0;
for(var e=0,f=0;e<
c[E]&&f<b;e++) {
f+=c[e][E];
d=e
}return d
};
mt[_P].LF=function (a) {
if(!this.Gq)return [a];
var b=ha(a).split(""),c=[],d=[];
for(var e=0,f=false;e<b[E];e++)if(this.b6&&this.b6.indexOf(b[e])!=-1) {
if(this.s0&&!f) {
	c.push(d.join(""));
	Da(d,0)
}d.push(b[e]);
f=!f
}else if(!f&&this.jo.indexOf(b[e])!=-1) {
d.push(b[e]);
c.push(d.join(""));
Da(d,0)
}else d.push(b[e]);
c.push(d.join(""));
return c
};
var nt=function (a,b,c,d) {
this.gb=a||ig()[Lc];
this.F=T(this.gb);
this.Qfa=!a;
this.A=null;
this.qi="";
this.Xc=[];
this.bC=-1;
this.Uca=-1;
this.kb=false;
r(this,"ac-renderer");
this.rowClassName="ac-row";
this.activeClassName="active";
this.sp=b;
this.lga=d!=null?d:true;
this.Tfa=c!=null?c:false;
this.NN=null;
this.eG=false
};
te(nt,Xh);
var ot=0;
nt[_P].ap=null;
nt[_P].V9=function (a,b,c) {
this.qi=b;
this.Xc=a;
this.bC=0;
this.Uca=ne();
this.ni=c;
this.Sw=[];
this.redraw()
};
nt[_P].dismiss=function () {
if(this.kb) {
this.kb=false;
V(this.A,false)
}
};
nt[_P].show=function () {
if(!this.kb) {
this.kb=true;
V(this.A,true)
}
};
nt[_P].Ka=function () {
return this.kb
};
nt[_P].yM=function (a) {
this.p4();
this.bC=a;
if(a>=0&&a<this.A[rd][E]) {
var b=this.Sw[a];
hj(b,this.activeClassName);
ej(this.A,"activedescendant",b.id);
Ig(this.ap,Qg(b))
}
};
nt[_P].p4=function () {
if(this.bC>=0)ij(this.Sw[this.bC],this.activeClassName)
};
nt[_P].Eh=function (a) {
if(a==-1)this.yM(-1);
else for(var b=0;b<this.Xc[E];b++)if(this.Xc[b].id==a) {
this.yM(b);
return
}
};
nt[_P].Xaa=function (a) {
hj(a,
this[dc])
};
nt[_P].w6=function () {
if(!this.A) {
this.ap=this.F.b("div",{
	style:"display:none"
});
dj(this.ap,"region");
ej(this.ap,"live","rude");
this.F.appendChild(this.gb,this.ap);
this.A=this.F.b("div",{
	style:"display:none"
});
this.Xaa(this.A);
dj(this.A,"menu");
var a=this.A.id="goog-acr-"+ot++;
ej(this.ni,"controls",a);
this.F.appendChild(this.gb,this.A);
Dh(this.A,U,this.Wm,false,this);
Dh(this.A,Nh,this.Ch,false,this);
Dh(this.F.W(),U,this.ZL,false,this);
Dh(this.A,ih,this.fq,false,this)
}
};
nt[_P].redraw=function () {
this.w6();
if(this.eG)Sb(this.A[J],"hidden");
Da(this.Sw,0);
this.F.zf(this.A);
if(this.sp&&this.sp.render)this.sp.render(this,this.A,this.Xc,this.qi);
else {
var a=null;
Vg(this.Xc,function (f) {
	f=this.U9(f,this.qi);
	if(this.eG)this.A.insertBefore(f,a);
	else this.F.appendChild(this.A,f);
	a=f
},this)
}if(this.Xc[E]==0) {
this.dismiss();
return
}else this.show();
this.P8(this.A);
if(this.ni&&this.Qfa) {
var b=Ii(this.ni),c=Li(this.ni),d=Li(Hi(this.ni)),e=Li(this.A);
b.y=this.eG?b.y-e[P]:b.y+c[P];
if((this.Tfa||b.x+e[F]>d[F])&&this.NN!=
"LEFT") {
	b.x=b.x+c[F]-e[F];
	this.NN="RIGHT"
}else this.NN="LEFT";
Ji(this.A,b);
if(this.eG)Sb(this.A[J],"visible")
}Vi(this.A,true)
};
nt[_P].M=function () {
nt.B.M.call(this);
if(this.A) {
Gh(this.A,U,this.Wm,false,this);
Gh(this.A,Nh,this.Ch,false,this);
Gh(this.F.W(),U,this.ZL,false,this);
Gh(this.A,ih,this.fq,false,this);
this.F.removeNode(this.A);
this.A=null;
this.kb=false
}this.gb=null
};
nt[_P].P8=function (a) {
if(Uf&&Zf) {
x(a[J],"");
Mb(a[J],"visible");
x(a[J],a[tc]);
Mb(a[J],"auto")
}
};
nt[_P].T9=function (a,b,c) {
y(c,
Pe(a[nc].toString ()))
};
nt[_P].aC=function (a,b) {
if(a[lc]==3) {
var c,d=null;
if(ce(b)) {
	c=b[E]>0?b[0]:"";
	if(b[E]>1)d=tf(b,1)
}else c=b;
if(c[E]==0)return ;
var e=a[Jd];
c=ha(c).replace(/([-()\[\]{
}+?*.$\^|,:#<!\\])/g,"\\$1").replace(/\x08/g,"\\x08");
var f=new RegExp("(.*?)(^|\\W+)("+c+")","gi"),g=[],h=0,i=f.exec(e);
while(i) {
	g.push(i[1]);
	g.push(i[2]);
	g.push(i[3]);
	h=f.lastIndex;
	i=f.exec(e)
}g.push(e.substring(h));
if(g[E]>1) {
	Ob(a,g[0]+g[1]);
	var j=this.F.createElement("b");
	this.F.appendChild(j,this.F.createTextNode(g[2]));
	j=a[O].insertBefore(j,a[Dd]);
	for(var k=g[E]-1;k>=3;k--)a[O].insertBefore(this.F.createTextNode(g[k]),j[Dd])
}else if(d)this.aC(a,d)
}else {
var m=a[M];
while(m) {
	var n=m[Dd];
	this.aC(m,b);
	m=n
}
}
};
nt[_P].U9=function (a,b) {
var c=this.F.b("div",{
className:this.rowClassName
});
if(this.sp&&this.sp.$Q)this.sp.$Q(a,b,c);
else this.T9(a,b,c);
if(b&&this.lga)this.aC(c,b);
c.id="goog-acri-"+ot++;
hj(c,this.rowClassName);
dj(c,"menuitem");
this.Sw.push(c);
return c
};
nt[_P].wL=function (a) {
while(a&&a!=this.A&&!kj(a,this.rowClassName))a=
a[O];
return a?df(this.Sw,a):-1
};
nt[_P].Wm=function (a) {
var b=this.wL(a[Sc]);
if(b>=0)this.dispatchEvent({
type:"select",row:this.Xc[b].id
});
a.stopPropagation()
};
nt[_P].Ch=function (a) {
this.dispatchEvent(kt);
a.stopPropagation()
};
nt[_P].ZL=function () {
this.dispatchEvent("dismiss")
};
nt[_P].fq=function (a) {
var b=this.wL(a[Sc]);
if(b>=0) {
if(ne()-this.Uca<300)return ;
this.dispatchEvent({
	type:"hilite",row:this.Xc[b].id
})
}
};
;
;
var pt=function (a) {
this.z=a;
this.xA=null
};
pt[_P].Pp=function () {
if(!this.xA) {
this.xA=[];
var a=this.z.Pp();
for(var b=0;b<a[E];b++)this.xA.push(new qt(a[b]))
}return this.xA
};pt[_P].Mw=function (a,b,c) {
var d=this.z.cellSelection.Lt(a,true,"=-+*/%^&<>)"),e=Be(a.substring(a.lastIndexOf(d)+1)),f=this.j5(e),g=this.v0(e),h=[],i=f?1:b,j=this.Pp();
for(var k=0;k<j[E];k++) {
var m=j[k].matches(g,f);
if(m) {
	h.push(j[k]);
	if(h[E]>=i)break
}
}c(a,h,false,f&&h[E]==1)
};
pt[_P].l_=function (a) {
return a&&a[E]>0&&a.charAt(0)==
"="
};
pt[_P].j5=function (a) {
var b=a.indexOf(")"),c=a.indexOf("(");
return c>0&&b<0
};
pt[_P].v0=function (a) {
var b=a.indexOf(")");
if(b<0) {
var c=a.indexOf("(");
return c>0?a.substring(0,c):a
}else return ""
};
var qt=function (a) {
this.HA=a[0];
this.kfa=a[3];
this.xfa=this.HA+"(";
this.r6=this.HA+"("+this.kfa+")"
};
qt[_P].matches=function (a,b) {
if(a==null||a=="")return false;
if(b)return we(this.HA,a)==0;
return xe(this.HA,a)
};
qt[_P].sda=function () {
return this.r6
};
ya(qt[_P],function () {
return this.xfa
});
var ut=function (a) {
this.ZC=new rt(a);
var b=new st,c=new nt(null,b);
this.qq=new tt(a.cellSelection,null,null,false,null);
lt.call(this,this.ZC,c,this.qq);
this.qq.UW(this)
};
ut.inherits(lt);
ut[_P].sN=false;
ut[_P].KV=function (a) {
this.deactivate(a);
this.qq.VW(a)
};
ut[_P].deactivate=function (a) {
this.qq.QZ(a)
};
ut[_P].Na=function () {
return !this.sN&&this.isOpen()
};
ut[_P].Pv=function (a,b,c,d) {
this.sN=d;
if(d)this.qq.TQ();
else this.qq.eH();
ut.B.Pv.call(this,a,b,c)
};
var tt=function (a,b,c,d,e) {
mt.call(this,b,c,d,
e);
this.qX=a
};
tt.inherits(mt);
tt[_P].CE=function (a) {
var b=this.fc.ni,c=b[I],d=this.qX.Lt(c);
c=c.substring(0,c.lastIndexOf(d)+1);
Ta(b,c+a.toString ());
this.qX.Rh();
if(Wf||Uf) {
vq(b,b[I][E]);
b.focus()
}
};
tt[_P].Of=function (a) {
if(!this.fc.isOpen())return ;
if(!a[sd]||a[ed]!=40)tt.B.Of.call(this,a)
};
var st=function () {
};
st[_P].$Q=function (a,b,c) {
var d=a[nc].toString ();
y(c,a[nc].sda?a[nc].r6:d);
Ob(c,d)
};
var rt=function (a) {
this.yfa=[new pt(a)]
};
rt[_P].Mw=function (a,b,c) {
var d=this.yfa;
for(var e=0;e<d[E];e++)if(d[e].l_(a)) {
d[e].Mw(a,b,c);
return
}c(a,[])
};
l.IDICommon=l.IDICommon||(function () {
return {
getHash:function (a) {
	var b=a.indexOf("#")+1;
	return b?a.substr(b):""
},htmlEscape:function (a) {
	return /[&<>\"]/.test(a)?a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\"/g,"&quot;"):a
},makeIframeTag:function (a) {
	var b="<iframe";
	for(var c in a)b+=" "+c+'="'+IDICommon.htmlEscape(a[c])+'"';return b+"></iframe>"
},getIframe:function (a,b) {
	try{
		return a[Kd][b]
	}catch(c) {
		return null
	}
},makeIframeNode:function (a) {
	var b=oa.createElement("iframe");
	for(var c in a)b.setAttribute(c,a[c]);return b
},appendHiddenIframe:function (a,b) {
	setTimeout(function () {
		oa[Lc].appendChild(IDICommon.makeIframeNode({
			id:a,name:a,src:b,width:0,height:0,frameBorder:0
		}))
	},0)
},writeHiddenIframe:function (a,b) {
	oa.write(IDICommon.makeIframeTag({
		id:a,name:a,src:b,width:0,height:0,frameBorder:0
	}))
},splitURIComponent:function (a,b) {
	var c=[],d=a[E],e=0;
	while(e<d) {
		var f=a.substr(e,b),g=f[E];
		if(e+g<d)for(var h=1;h<3;++h)if(f.charAt(g-h)=="%")f=f.substr(0,g-=h);c.push(f);e+=g
	}return c
},
MAX_URL_LENGTH:4095,IDI_DEFAULT_POLLING_INTERVAL:1000
}
})();l.IDIHost=l.IDIHost||(function () {
var a=l[xc][od].replace(/([^:\/])\/.*$/,"$1/robots.txt"),b="",c={
},d={
},e={
},f={
},g={
};
function h(u,v) {
for(var t in v)u[t]=v[t]
}function i(u,v) {
var t=l[Kd][u];
if(t) {
	var w;
	while(w=IDICommon.getIframe(t,u+"_"+c[u])) {
		try{
			if(w[xc][od]=="about:blank")break
		}catch(B) {
			break
		}e[u]+=IDICommon.getHash(w[xc][od]);
		++c[u]
	}var A=e[u].split("$"),G=A[E]-1;
	if(G>0) {
		e[u]=A[G];
		for(var H=0;H<G;++H)v(pa(A[H]),u)
	}
}
}function j(u) {
return b||u.replace(/([^:\/]\/).*$/,"$1ig/idi_relay")
}function k(u) {
l.clearInterval(g[u]);
g[u]=0
}function m(u) {
a=u
}function n(u) {
b=u
}function q(u,v,t) {
k(u);
g[u]=l.setInterval(function () {
	i(u,v)
},typeoft=="object"&&t.pollingInterval||IDICommon.IDI_DEFAULT_POLLING_INTERVAL)
}function p(u,v,t) {
var w;
if(typeoft=="object")w=t.moduleRelayUrl;
var B=d[u];
if(qa(B))thrownew Error("Invalid module id");
else {
	var A=typeofw=="string"?w:j(f[u]),G=fa(v)+"$",H=IDICommon.MAX_URL_LENGTH-1-A[E],Q=IDICommon.splitURIComponent(G,H),K=Q[E];
	for(var sa=0;sa<K;++sa)IDICommon.appendHiddenIframe(u+"_"+(B+sa),A+"#"+
	Q[sa]);d[u]+=K
}
}function s(u,v,t,w,B) {
var A={
	frameBorder:0,scrolling:"no"
},G,H,Q,K,sa;
if(typeofB=="object") {
	G=B.iframeAttrs;
	H=B.callback;
	Q=B.userPrefs;
	K=B.pollingInterval;
	sa=B.parentDivId
}if(typeofG=="object")h(A,G);
h(A,{
	id:v,name:v,src:u,width:t,height:w
});
c[v]=0;
d[v]=0;
e[v]="";
f[v]=u;
var aa=[];
if(typeofQ=="object")for(var ia in Q)aa.push(fa(ia)+"="+fa(Q[ia]));if(typeofH=="function") {
	aa.push("idi_hr="+fa(a));
	l.IDIHost.registerListener(v,H,B)
}if(aa[E]) {
	var $=aa.join("&");
	if(A.src[E]+1+$[E]>IDICommon.MAX_URL_LENGTH) {
		$+=
		"$";
		var ba=j(u),db=IDICommon.MAX_URL_LENGTH-1-ba[E],Ya=IDICommon.splitURIComponent($,db),Ma=Ya[E];
		for(var ia=0;ia<Ma;++ia) {
			var eb=v+"_"+ia,Qa=ba+"#"+Ya[ia];
			if(sa) {
				var fb=oa.getElementById(sa);
				fb.innerHTML+=IDICommon.makeIframeTag({
					id:eb,name:eb,src:Qa,width:0,height:0,frameBorder:0
				})
			}else IDICommon.writeHiddenIframe(eb,Qa)
		}d[v]+=Ma;
		$=""
	}A.src+="#"+$
}if(sa) {
	var fb=oa.getElementById(sa);
	fb.innerHTML+=IDICommon.makeIframeTag(A)
}else oa.write(IDICommon.makeIframeTag(A))
}return {
setHostRelayUrl:m,setModuleRelayUrl:n,
getModuleRelayUrl:j,registerListener:q,unregisterListener:k,postMessageToModule:p,createModule:s
}
})();
var vt=(function () {
var a={
"\u0008":"\\b","\t":"\\t","\n":"\\n","\u000c":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"
},b={
"boolean":function (c) {
	return ha(c)
},number:function (c) {
	return isFinite(c)?ha(c):"null"
},string:function (c) {
	if(/["\\\x00-\x1f]/.test(c))c=c.replace(/([\x00-\x1f\\"])/g,function (d,e) {
		var f=a[e];
		if(f)return f;
		f=e.charCodeAt();
		return "\\u00"+o.floor(f/16).toString (16)+(f%16).toString (16)
	});
	return '"'+c+'"'
},object:function (c) {
	if(c) {
		var d=[],e,f,g,h,i;
		if(cinstanceofArray) {
			d[0]="[";
			h=c[E];
			for(g=0;g<h;g+=1) {
				i=c[g];
				f=b[typeofi];
				if(f) {
					i=f(i);
					if(typeofi=="string") {
						if(e)d[d[E]]=",";
						d[d[E]]=i;
						e=true
					}
				}
			}d[d[E]]="]"
		}else if(typeofc[Ec]==="function") {
			d[0]="{";
			for(g in c)if(c.hasOwnProperty (g)) {
				i=c[g];
				f=b[typeofi];
				if(f) {
					i=f(i);
					if(typeofi=="string") {
						if(e)d[d[E]]=",";
						d.push(b.string(g),":",i);
						e=true
					}
				}
			}d[d[E]]="}"
		}else return ;
		return d.join("")
	}return "null"
}
};
return {
copyright:"(c)2005 JSON.org",license:"http://www.JSON.org/license.html",stringify:function (c) {
	var d=b[typeofc];
	if(d) {
		c=d(c);
		if(typeofc==
		"string")return c
	}return null
},parse:function (c) {
	try{
		return !/[^,:{
		}\[\]0-9.\-+Eaeflnr-u\n\r\t]/.test(c.replace(/"(\\.|[^"\\])*"/g,""))&&eval("("+c+")")}catch(d) {return false}}}})();function wt(a) {var b=oa.createElement("DIV");y(b,"<iframeonload='this.pool_locked=false'></iframe>");var c=b.getElementsByTagName("IFRAME")[0];Sb(c[J],"hidden");x(c[J],D(c[J],"0px"));Gb(c[J],"0px");Fa(c[J],"absolute");c.pool_locked=a;this.Pg[this.Pg[E]]=c;b.removeChild(c);b=null;return c}function xt(a) {if(!a.match(/^http[s]?:\/\//))return;var b=this;l.setTimeout(function() {var c=null;for(var d=b.Pg[E]-1;d>=0;d--) {var e=b.Pg[d];if(e&&!e.pool_locked) {e[O].removeChild(e);if(l.ActiveXObject) {e=null;
		b.Pg[d]=null;
		b.Pg.splice(d,1)
	}else {
		e.pool_locked=true;
		c=e;
		break
	}
}
}c=c?c:b.Pea(true);
c.src=a;
oa[Lc].appendChild(c)
},0)
}function yt() {
for(var a=0;a<this.Pg[E];a++) {
ua(this.Pg[a],null);
this.Pg[a]=null
}Da(this.Pg,0);
this.Pg=[]
}function zt() {
this.Pg=[];
this.Pea=wt;
this.iframe=xt;
Db(this,yt)
}function At(a,b) {
_IFPC$services_[a]=b
}function Bt(a) {
delete _IFPC$services_[a]
}function Ct(a,b,c,d,e,f,g) {
c=c.slice(0);
c.unshift(_IFPC$registerCallback_(e));
c.unshift(f);
c.unshift(b);
c.unshift(a);
var h=4095-d[E];
h=
ga(h/3,10);
if(typeofg=="undefined")g=true;
var i=_IFPC$encodeArgs_(c),j=ga(i[E]/h,10);
if(i[E]%h>0)j+=1;
for(var k=0;k<j;k++) {
var m=i.substr(k*h,h),n=[a,_IFPC$callCounter_,j,k,m,g];
_IFPC$iframe_pool_.iframe(d+"#"+_IFPC$encodeArgs_(n))
}_IFPC$callCounter_++
}function Dt() {
_IFPC$services_={
};
_IFPC$callbacks_={
};
_IFPC$iframe_pool_.clear()
}function Et(a) {
var b=_IFPC$decodeArgs_(a)[0],c=null;
try{
c=l[Pc][Kd][b]
}catch(d) {
}try{
if(!c&&l[Pc][Pc][Kd][b]!=l[Pc]) {
l[Pc][Pc][Kd][b].setTimeout(function () {
},0);
c=l[Pc][Pc][Kd][b]
}
}catch(d) {
}if(!c)c=
l[Pc][Pc];
var e=function () {
c._IFPC.handleRequest(a)
};
if(l.ActiveXObject)e();
else c.setTimeout(e,0)
}function Ft(a) {
var a=_IFPC$decodeArgs_(a),b=a.shift(),c=a.shift(),d=a.shift(),e=a.shift(),f=a.shift(),g=a.shift(),h=b+"_"+c;
if(!_IFPC$packet_store_[h])_IFPC$packet_store_[h]=[];
_IFPC$packet_store_[h].push([e,f]);
if(_IFPC$packet_store_[h][E]==d) {
_IFPC$packet_store_[h].sort(function (s,u) {
return ga(s[0],10)-ga(u[0],10)
});
f="";
for(var i=0;i<d;i++)f+=_IFPC$packet_store_[h][i][1];_IFPC$packet_store_[h]=null;
var j=_IFPC$decodeArgs_(f),b=j.shift(),k=j.shift(),m=j.shift(),n=j.shift(),q=_IFPC$getServiceHandler_(k);if(q) {
var p=q.apply(null,j);
if(_IFPC$isCallbackIdWellFormed_(n)) {
	p.unshift(n);
	_IFPC$call(b,"ifpc_callback",p,m,null,"")
}
}else if(g)thrownew Error("Service "+k+" not registered.");
}
}function Gt(a) {
return _IFPC$services_.hasOwnProperty (a)?_IFPC$services_[a]:null
}function Ht(a) {
var b="";
if(a&&typeofa=="function") {
b=_IFPC$getNewCallbackId_();
_IFPC$callbacks_[b]=a
}return b
}function It(a) {
if(_IFPC$callbacks_.hasOwnProperty (a))_IFPC$callbacks_[a]=
null
}function Jt(a) {
if(a&&_IFPC$callbacks_.hasOwnProperty (a))return _IFPC$callbacks_[a];
return null
}function Kt() {
return "cbid"+_IFPC$callbackCounter_++
}function Lt(a) {
return (a+"").indexOf("cbid")==0
}function Mt(a) {
var b=a.split("&");
for(var c=0;c<b[E];c++) {
var d=pa(b[c]);
try{
d=vt.parse(d)
}catch(e) {
}b[c]=d
}return b
}function Nt(a) {
var b=[];
for(var c=0;c<a[E];c++) {
var d=vt.stringify(a[c]);
b.push(fa(d))
}return b.join("&")
}function Ot(a) {
var b=_IFPC$getCallback_(a);
if(b) {
var c=[];
for(var d=1;d<arguments[E];d++)c[c[E]]=
arguments[d];b.apply(null,c);_IFPC$unregisterCallback_(a)
}else thrownew Error("Invalid callbackId");
}var _IFPC$registerService=At,_IFPC$unregisterService=Bt,_IFPC$call=Ct,_IFPC$clear=Dt,_IFPC$relayRequest=Et,_IFPC$processRequest=Et,_IFPC$handleRequest=Ft,_IFPC$iframe_pool_=new zt,_IFPC$packet_store_={
},_IFPC$services_={
},_IFPC$callbacks_={
},_IFPC$callbackCounter_=0,_IFPC$callCounter_=0,_IFPC$getServiceHandler_=Gt,_IFPC$registerCallback_=Ht,_IFPC$unregisterCallback_=It,_IFPC$getCallback_=Jt,_IFPC$getNewCallbackId_=
Kt,_IFPC$isCallbackIdWellFormed_=Lt,_IFPC$decodeArgs_=Mt,_IFPC$encodeArgs_=Nt,_IFPC$callbackServiceHandler_=Ot;
_IFPC$registerService("ifpc_callback",_IFPC$callbackServiceHandler_);
var Pt=function () {
var a="u";
if($f)a="w";
else if(Zf)a="m";
else if(ag)a="l";
return a
},Rt=function (a) {
var b=[];
b.push(Pt());
for(var c=0;c<a[E];++c) {
var d=new Date(a[c]);
b.push(d.getTimezoneOffset()|0)
}return Qt(b)
},Qt=function (a) {
var b=a[E];
if(b<2)return "";
var c=[a[0]],d=a[1],e=d,f=1,g=2;
while(g<b) {
e=a[g++];
if(e!==d) {
c.push("g"+St(d)+"r"+St(f));
d=e;
f=1
}else f++
}c.push("g"+St(e)+"r"+St(f));
return c.join("")
},St=function (a) {
if(a>=0)return a.toString (16).toUpperCase();
else {
var b=-a;
return "-"+b.toString (16).toUpperCase()
}
};
var Tt=function (a) {
Xh.call(this);
this.A=a;
var b=Uf?"DOMMouseScroll":"mousewheel";
this.WC=Dh(this.A,b,this)
};
te(Tt,Xh);
Tt[_P].WC=null;
Tt[_P].Nd=function (a) {
var b=0,c=a.Vd;
if(c[N]=="mousewheel") {
b=-c.wheelDelta/40;
if(Wf)b/=3;
else if(Tf)b=-b
}else b=c.detail;
if(b>100)b=3;
else if(b<-100)b=-3;
var d=new Ut(b,c);
try{
this.dispatchEvent(d)
}finally{
d.dispose()
}
};
Tt[_P].M=function () {
Tt.B.M.call(this);
Ih(this.WC);
this.WC=null
};
var Ut=function (a,b) {
gh.call(this,b);
Bb(this,"mousewheel");
this.detail=a
};
te(Ut,gh);
var Vt,Wt={
LANGUAGE:{
aa:"Afar",ab:"Abkhazian",ace:"Achinese",ach:"Acoli",ada:"Adangme",ady:"Adyghe",ae:"Avestan",af:"Afrikaans",afa:"Afro-Asiatic Language",afh:"Afrihili",ain:"Ainu",ak:"Akan",akk:"Akkadian",ale:"Aleut",alg:"Algonquian Language",alt:"Southern Altai",am:"Amharic",an:"Aragonese",ang:"Old English",anp:"Angika",apa:"Apache Language",ar:"Arabic",arc:"Aramaic",arn:"Araucanian",arp:"Arapaho",art:"Artificial Language",arw:"Arawak",as:"Assamese",ast:"Asturian",ath:"Athapascan Language",aus:"Australian Language",
av:"Avaric",awa:"Awadhi",ay:"Aymara",az:"Azerbaijani",ba:"Bashkir",bad:"Banda",bai:"Bamileke Language",bal:"Baluchi",ban:"Balinese",bas:"Basa",bat:"Baltic Language",be:"Belarusian",bej:"Beja",bem:"Bemba",ber:"Berber",bg:"Bulgarian",bh:"Bihari",bho:"Bhojpuri",bi:"Bislama",bik:"Bikol",bin:"Bini",bla:"Siksika",bm:"Bambara",bn:"Bengali",bnt:"Bantu",bo:"Tibetan",br:"Breton",bra:"Braj",bs:"Bosnian",btk:"Batak",bua:"Buriat",bug:"Buginese",byn:"Blin",ca:"Catalan",cad:"Caddo",cai:"Central American Indian Language",
car:"Carib",cau:"Caucasian Language",cch:"Atsam",ce:"Chechen",ceb:"Cebuano",cel:"Celtic Language",ch:"Chamorro",chb:"Chibcha",chg:"Chagatai",chk:"Chuukese",chm:"Mari",chn:"Chinook Jargon",cho:"Choctaw",chp:"Chipewyan",chr:"Cherokee",chy:"Cheyenne",cmc:"Chamic Language",co:"Corsican",cop:"Coptic",cpe:"English-based Creole or Pidgin",cpf:"French-based Creole or Pidgin",cpp:"Portuguese-based Creole or Pidgin",cr:"Cree",crh:"Crimean Turkish",crp:"Creole or Pidgin",cs:"Czech",csb:"Kashubian",cu:"Church Slavic",
cus:"Cushitic Language",cv:"Chuvash",cy:"Welsh",da:"Danish",dak:"Dakota",dar:"Dargwa",day:"Dayak",de:"German",de_AT:"Austrian German",de_CH:"Swiss High German",del:"Delaware",den:"Slave",dgr:"Dogrib",din:"Dinka",doi:"Dogri",dra:"Dravidian Language",dsb:"Lower Sorbian",dua:"Duala",dum:"Middle Dutch",dv:"Divehi",dyu:"Dyula",dz:"Dzongkha",ee:"Ewe",efi:"Efik",egy:"Ancient Egyptian",eka:"Ekajuk",el:"Greek",elx:"Elamite",en:"English",en_AU:"Australian English",en_CA:"Canadian English",en_GB:"British English",
en_US:"U.S. English",enm:"Middle English",eo:"Esperanto",es:"Spanish",es_419:"Latin American Spanish",es_ES:"Iberian Spanish",et:"Estonian",eu:"Basque",ewo:"Ewondo",fa:"Persian",fan:"Fang",fat:"Fanti",ff:"Fulah",fi:"Finnish",fil:"Filipino",fiu:"Finno-Ugrian Language",fj:"Fijian",fo:"Faroese",fon:"Fon",fr:"French",fr_CA:"Canadian French",fr_CH:"Swiss French",frm:"Middle French",fro:"Old French",frr:"Northern Frisian",frs:"Eastern Frisian",fur:"Friulian",fy:"Western Frisian",ga:"Irish",gaa:"Ga",gay:"Gayo",
gba:"Gbaya",gd:"Scottish Gaelic",gem:"Germanic Language",gez:"Geez",gil:"Gilbertese",gl:"Galician",gmh:"Middle High German",gn:"Guarani",goh:"Old High German",gon:"Gondi",gor:"Gorontalo",got:"Gothic",grb:"Grebo",grc:"Ancient Greek",gsw:"Swiss German",gu:"Gujarati",gv:"Manx",gwi:"Gwich\u02bcin",ha:"Hausa",hai:"Haida",haw:"Hawaiian",he:"Hebrew",hi:"Hindi",hil:"Hiligaynon",him:"Himachali",hit:"Hittite",hmn:"Hmong",ho:"Hiri Motu",hr:"Croatian",hsb:"Upper Sorbian",ht:"Haitian",hu:"Hungarian",hup:"Hupa",
hy:"Armenian",hz:"Herero",ia:"Interlingua",iba:"Iban",id:"Indonesian",ie:"Interlingue",ig:"Igbo",ii:"Sichuan Yi",ijo:"Ijo",ik:"Inupiaq",ilo:"Iloko",inc:"Indic Language",ine:"Indo-European Language",inh:"Ingush",io:"Ido",ira:"Iranian Language",iro:"Iroquoian Language",is:"Icelandic",it:"Italian",iu:"Inuktitut",ja:"Japanese",jbo:"Lojban",jpr:"Judeo-Persian",jrb:"Judeo-Arabic",jv:"Javanese",ka:"Georgian",kaa:"Kara-Kalpak",kab:"Kabyle",kac:"Kachin",kaj:"Jju",kam:"Kamba",kar:"Karen",kaw:"Kawi",kbd:"Kabardian",
kcg:"Tyap",kfo:"Koro",kg:"Kongo",kha:"Khasi",khi:"Khoisan Language",kho:"Khotanese",ki:"Kikuyu",kj:"Kuanyama",kk:"Kazakh",kl:"Kalaallisut",km:"Khmer",kmb:"Kimbundu",kn:"Kannada",ko:"Korean",kok:"Konkani",kos:"Kosraean",kpe:"Kpelle",kr:"Kanuri",krc:"Karachay-Balkar",krl:"Karelian",kro:"Kru",kru:"Kurukh",ks:"Kashmiri",ku:"Kurdish",kum:"Kumyk",kut:"Kutenai",kv:"Komi",kw:"Cornish",ky:"Kirghiz",la:"Latin",lad:"Ladino",lah:"Lahnda",lam:"Lamba",lb:"Luxembourgish",lez:"Lezghian",lg:"Ganda",li:"Limburgish",
ln:"Lingala",lo:"Lao",lol:"Mongo",loz:"Lozi",lt:"Lithuanian",lu:"Luba-Katanga",lua:"Luba-Lulua",lui:"Luiseno",lun:"Lunda",luo:"Luo",lus:"Lushai",lv:"Latvian",mad:"Madurese",mag:"Magahi",mai:"Maithili",mak:"Makasar",man:"Mandingo",map:"Austronesian",mas:"Masai",mdf:"Moksha",mdr:"Mandar",men:"Mende",mg:"Malagasy",mga:"Middle Irish",mh:"Marshallese",mi:"Maori",mic:"Micmac",min:"Minangkabau",mis:"Miscellaneous Language",mk:"Macedonian",mkh:"Mon-Khmer Language",ml:"Malayalam",mn:"Mongolian",mnc:"Manchu",
mni:"Manipuri",mno:"Manobo Language",mo:"Moldavian",moh:"Mohawk",mos:"Mossi",mr:"Marathi",ms:"Malay",mt:"Maltese",mul:"Multiple Languages",mun:"Munda Language",mus:"Creek",mwl:"Mirandese",mwr:"Marwari",my:"Burmese",myn:"Mayan Language",myv:"Erzya",na:"Nauru",nah:"Nahuatl",nai:"North American Indian Language",nap:"Neapolitan",nb:"Norwegian Bokm\u00e5l",nd:"North Ndebele",nds:"Low German",ne:"Nepali","new":"Newari",ng:"Ndonga",nia:"Nias",nic:"Niger-Kordofanian Language",niu:"Niuean",nl:"Dutch",nl_BE:"Flemish",
nn:"Norwegian Nynorsk",no:"Norwegian",nog:"Nogai",non:"Old Norse",nqo:"N\u2019Ko",nr:"South Ndebele",nso:"Northern Sotho",nub:"Nubian Language",nv:"Navajo",nwc:"Classical Newari",ny:"Nyanja",nym:"Nyamwezi",nyn:"Nyankole",nyo:"Nyoro",nzi:"Nzima",oc:"Occitan",oj:"Ojibwa",om:"Oromo",or:"Oriya",os:"Ossetic",osa:"Osage",ota:"Ottoman Turkish",oto:"Otomian Language",pa:"Punjabi",paa:"Papuan Language",pag:"Pangasinan",pal:"Pahlavi",pam:"Pampanga",pap:"Papiamento",pau:"Palauan",peo:"Old Persian",phi:"Philippine Language",
phn:"Phoenician",pi:"Pali",pl:"Polish",pon:"Pohnpeian",pra:"Prakrit Language",pro:"Old Proven\u00e7al",ps:"Pashto",pt:"Portuguese",pt_BR:"Brazilian Portuguese",pt_PT:"Iberian Portuguese",qu:"Quechua",raj:"Rajasthani",rap:"Rapanui",rar:"Rarotongan",rm:"Rhaeto-Romance",rn:"Rundi",ro:"Romanian",roa:"Romance Language",rom:"Romany",root:"Root",ru:"Russian",rup:"Aromanian",rw:"Kinyarwanda",sa:"Sanskrit",sad:"Sandawe",sah:"Yakut",sai:"South American Indian Language",sal:"Salishan Language",sam:"Samaritan Aramaic",
sas:"Sasak",sat:"Santali",sc:"Sardinian",scn:"Sicilian",sco:"Scots",sd:"Sindhi",se:"Northern Sami",sel:"Selkup",sem:"Semitic Language",sg:"Sango",sga:"Old Irish",sgn:"Sign Language",sh:"Serbo-Croatian",shn:"Shan",si:"Sinhalese",sid:"Sidamo",sio:"Siouan Language",sit:"Sino-Tibetan Language",sk:"Slovak",sl:"Slovenian",sla:"Slavic Language",sm:"Samoan",sma:"Southern Sami",smi:"Sami Language",smj:"Lule Sami",smn:"Inari Sami",sms:"Skolt Sami",sn:"Shona",snk:"Soninke",so:"Somali",sog:"Sogdien",son:"Songhai",
sq:"Albanian",sr:"Serbian",srn:"Sranan Tongo",srr:"Serer",ss:"Swati",ssa:"Nilo-Saharan Language",st:"Southern Sotho",su:"Sundanese",suk:"Sukuma",sus:"Susu",sux:"Sumerian",sv:"Swedish",sw:"Swahili",syc:"Classical Syriac",syr:"Syriac",ta:"Tamil",tai:"Tai Language",te:"Telugu",tem:"Timne",ter:"Tereno",tet:"Tetum",tg:"Tajik",th:"Thai",ti:"Tigrinya",tig:"Tigre",tiv:"Tiv",tk:"Turkmen",tkl:"Tokelau",tl:"Tagalog",tlh:"Klingon",tli:"Tlingit",tmh:"Tamashek",tn:"Tswana",to:"Tonga",tog:"Nyasa Tonga",tpi:"Tok Pisin",
tr:"Turkish",ts:"Tsonga",tsi:"Tsimshian",tt:"Tatar",tum:"Tumbuka",tup:"Tupi Language",tut:"Altaic Language",tvl:"Tuvalu",tw:"Twi",ty:"Tahitian",tyv:"Tuvinian",udm:"Udmurt",ug:"Uighur",uga:"Ugaritic",uk:"Ukrainian",umb:"Umbundu",und:"Unknown or Invalid Language",ur:"Urdu",uz:"Uzbek",vai:"Vai",ve:"Venda",vi:"Vietnamese",vo:"Volap\u00fck",vot:"Votic",wa:"Walloon",wak:"Wakashan Language",wal:"Walamo",war:"Waray",was:"Washo",wen:"Sorbian Language",wo:"Wolof",xal:"Kalmyk",xh:"Xhosa",yao:"Yao",yap:"Yapese",
yi:"Yiddish",yo:"Yoruba",ypk:"Yupik Language",za:"Zhuang",zap:"Zapotec",zen:"Zenaga",zh:"Chinese",zh_Hans:"Simplified Chinese",zh_Hant:"Traditional Chinese",znd:"Zande",zu:"Zulu",zun:"Zuni",zxx:"No linguistic content",zza:"Zaza"
},COUNTRY:{
"001":"World","002":"Africa","003":"North America","005":"South America","009":"Oceania","011":"Western Africa","013":"Central America","014":"Eastern Africa","015":"Northern Africa","017":"Middle Africa","018":"Southern Africa","019":"Americas","021":"Northern America",
"029":"Caribbean","030":"Eastern Asia","034":"Southern Asia","035":"South-Eastern Asia","039":"Southern Europe","053":"Australia and New Zealand","054":"Melanesia","057":"Micronesian Region","061":"Polynesia","062":"South-Central Asia","142":"Asia","143":"Central Asia","145":"Western Asia","150":"Europe","151":"Eastern Europe","154":"Northern Europe","155":"Western Europe","172":"Commonwealth of Independent States","200":"Czechoslovakia","419":"Latin America and the Caribbean","830":"Channel Islands",
AD:"Andorra",AE:"United Arab Emirates",AF:"Afghanistan",AG:"Antigua and Barbuda",AI:"Anguilla",AL:"Albania",AM:"Armenia",AN:"Netherlands Antilles",AO:"Angola",AQ:"Antarctica",AR:"Argentina",AS:"American Samoa",AT:"Austria",AU:"Australia",AW:"Aruba",AX:"Aland Islands",AZ:"Azerbaijan",BA:"Bosnia and Herzegovina",BB:"Barbados",BD:"Bangladesh",BE:"Belgium",BF:"Burkina Faso",BG:"Bulgaria",BH:"Bahrain",BI:"Burundi",BJ:"Benin",BM:"Bermuda",BN:"Brunei",BO:"Bolivia",BQ:"British Antarctic Territory",BR:"Brazil",
BS:"Bahamas",BT:"Bhutan",BV:"Bouvet Island",BW:"Botswana",BY:"Belarus",BZ:"Belize",CA:"Canada",CC:"Cocos Islands",CD:"Congo - Kinshasa",CF:"Central African Republic",CG:"Congo - Brazzaville",CH:"Switzerland",CI:"Ivory Coast",CK:"Cook Islands",CL:"Chile",CM:"Cameroon",CN:"China",CO:"Colombia",CR:"Costa Rica",CS:"Serbia and Montenegro",CT:"Canton and Enderbury Islands",CU:"Cuba",CV:"Cape Verde",CX:"Christmas Island",CY:"Cyprus",CZ:"Czech Republic",DD:"East Germany",DE:"Germany",DJ:"Djibouti",DK:"Denmark",
DM:"Dominica",DO:"Dominican Republic",DZ:"Algeria",EC:"Ecuador",EE:"Estonia",EG:"Egypt",EH:"Western Sahara",ER:"Eritrea",ES:"Spain",ET:"Ethiopia",FI:"Finland",FJ:"Fiji",FK:"Falkland Islands",FM:"Micronesia",FO:"Faroe Islands",FQ:"French Southern and Antarctic Territories",FR:"France",FX:"Metropolitan France",GA:"Gabon",GB:"United Kingdom",GD:"Grenada",GE:"Georgia",GF:"French Guiana",GG:"Guernsey",GH:"Ghana",GI:"Gibraltar",GL:"Greenland",GM:"Gambia",GN:"Guinea",GP:"Guadeloupe",GQ:"Equatorial Guinea",
GR:"Greece",GS:"South Georgia and the South Sandwich Islands",GT:"Guatemala",GU:"Guam",GW:"Guinea-Bissau",GY:"Guyana",HK:"Hong Kong SAR China",HM:"Heard Island and McDonald Islands",HN:"Honduras",HR:"Croatia",HT:"Haiti",HU:"Hungary",ID:"Indonesia",IE:"Ireland",IL:"Israel",IM:"Isle of Man",IN:"India",IO:"British Indian Ocean Territory",IQ:"Iraq",IR:"Iran",IS:"Iceland",IT:"Italy",JE:"Jersey",JM:"Jamaica",JO:"Jordan",JP:"Japan",JT:"Johnston Island",KE:"Kenya",KG:"Kyrgyzstan",KH:"Cambodia",KI:"Kiribati",
KM:"Comoros",KN:"Saint Kitts and Nevis",KP:"North Korea",KR:"South Korea",KW:"Kuwait",KY:"Cayman Islands",KZ:"Kazakhstan",LA:"Laos",LB:"Lebanon",LC:"Saint Lucia",LI:"Liechtenstein",LK:"Sri Lanka",LR:"Liberia",LS:"Lesotho",LT:"Lithuania",LU:"Luxembourg",LV:"Latvia",LY:"Libya",MA:"Morocco",MC:"Monaco",MD:"Moldova",ME:"Montenegro",MG:"Madagascar",MH:"Marshall Islands",MI:"Midway Islands",MK:"Macedonia",ML:"Mali",MM:"Myanmar",MN:"Mongolia",MO:"Macao SAR China",MP:"Northern Mariana Islands",MQ:"Martinique",
MR:"Mauritania",MS:"Montserrat",MT:"Malta",MU:"Mauritius",MV:"Maldives",MW:"Malawi",MX:"Mexico",MY:"Malaysia",MZ:"Mozambique",NA:"Namibia",NC:"New Caledonia",NE:"Niger",NF:"Norfolk Island",NG:"Nigeria",NI:"Nicaragua",NL:"Netherlands",NO:"Norway",NP:"Nepal",NQ:"Dronning Maud Land",NR:"Nauru",NT:"Neutral Zone",NU:"Niue",NZ:"New Zealand",OM:"Oman",PA:"Panama",PC:"Pacific Islands Trust Territory",PE:"Peru",PF:"French Polynesia",PG:"Papua New Guinea",PH:"Philippines",PK:"Pakistan",PL:"Poland",PM:"Saint Pierre and Miquelon",
PN:"Pitcairn",PR:"Puerto Rico",PS:"Palestinian Territory",PT:"Portugal",PU:"U.S. Miscellaneous Pacific Islands",PW:"Palau",PY:"Paraguay",PZ:"Panama Canal Zone",QA:"Qatar",QO:"Outlying Oceania",QU:"European Union",RE:"Reunion",RO:"Romania",RS:"Serbia",RU:"Russia",RW:"Rwanda",SA:"Saudi Arabia",SB:"Solomon Islands",SC:"Seychelles",SD:"Sudan",SE:"Sweden",SG:"Singapore",SH:"Saint Helena",SI:"Slovenia",SJ:"Svalbard and Jan Mayen",SK:"Slovakia",SL:"Sierra Leone",SM:"San Marino",SN:"Senegal",SO:"Somalia",
SR:"Suriname",ST:"Sao Tome and Principe",SU:"Union of Soviet Socialist Republics",SV:"El Salvador",SY:"Syria",SZ:"Swaziland",TC:"Turks and Caicos Islands",TD:"Chad",TF:"French Southern Territories",TG:"Togo",TH:"Thailand",TJ:"Tajikistan",TK:"Tokelau",TL:"East Timor",TM:"Turkmenistan",TN:"Tunisia",TO:"Tonga",TR:"Turkey",TT:"Trinidad and Tobago",TV:"Tuvalu",TW:"Taiwan",TZ:"Tanzania",UA:"Ukraine",UG:"Uganda",UM:"United States Minor Outlying Islands",US:"United States",UY:"Uruguay",UZ:"Uzbekistan",VA:"Vatican",
VC:"Saint Vincent and the Grenadines",VD:"North Vietnam",VE:"Venezuela",VG:"British Virgin Islands",VI:"U.S. Virgin Islands",VN:"Vietnam",VU:"Vanuatu",WF:"Wallis and Futuna",WK:"Wake Island",WS:"Samoa",YD:"People's Democratic Republic of Yemen",YE:"Yemen",YT:"Mayotte",ZA:"South Africa",ZM:"Zambia",ZW:"Zimbabwe",ZZ:"Unknown or Invalid Region"
}
};
;
var Xt=function (a) {
a=a.replace(/-/g,"_");
Vt=a
},Zt=function (a,b,c) {
if(!Yt[b])Yt[b]={
};
Yt[b][c]=a;
if(Vt==null)Vt=c
},Yt={
},$t=function (a,b) {
Zt(a,"DateTimeConstants",b)
},au=function (a,b) {
Zt(a,"NumberFormatConstants",b)
},bu=function (a,b) {
Zt(a,"LocaleNameConstants",b)
},cu={
DECIMAL_SEP:".",GROUP_SEP:",",PERCENT:"%",ZERO_DIGIT:"0",PLUS_SIGN:"+",MINUS_SIGN:"-",EXP_SYMBOL:"E",PERMILL:"\u2030",INFINITY:"\u221e",NAN:"NaN",MONETARY_SEP:".",MONETARY_GROUP_SEP:",",DECIMAL_PATTERN:"#,##0.###",SCIENTIFIC_PATTERN:"0.###E0",
PERCENT_PATTERN:"#,##0%",CURRENCY_PATTERN:"\u00a4#,##0.00",DEF_CURRENCY_CODE:"USD"
},du={
ERAS:["BC","AD"],ERANAMES:["Before Christ","Anno Domini"],NARROWMONTHS:["J","F","M","A","M","J","J","A","S","O","N","D"],MONTHS:["January","February","March","April","May","June","July","August","September","October","November","December"],SHORTMONTHS:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],WEEKDAYS:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],SHORTWEEKDAYS:["Sun",
"Mon","Tue","Wed","Thu","Fri","Sat"],NARROWWEEKDAYS:["S","M","T","W","T","F","S"],SHORTQUARTERS:["Q1","Q2","Q3","Q4"],QUARTERS:["1st quarter","2nd quarter","3rd quarter","4th quarter"],AMPMS:["AM","PM"],DATEFORMATS:["EEEE, MMMM d, yyyy","MMMM d, yyyy","MMM d, yyyy","M/d/yy"],TIMEFORMATS:["h:mm:ss a v","h:mm:ss a z","h:mm:ss a","h:mm a"],ZONESTRINGS:null
};
;
;
;
;
;
;
var fu=function (a) {
this.j=a;
this.hD={
};
this.hD[0]=new eu(this.j.Kea);
this.hD[1]=new eu(this.j.ofa);
this.hD[2]=new eu(this.j.rfa)
},gu=[],hu=function (a) {
gu[a]=true
};
var iu=100,ju=100,ku=10,lu=100;
fu[_P].Am=function (a,b) {
var c=this.hD[a],d=c.Pe,e=c.Kt;
if(d==2)b();
else if(d==1)c.qQ(b);
else if(d==0) {
c.Gr(1);
c.qQ(b);
if(this.j.tfa) {
var f=T();
for(var g=0;g<e[E];g++) {
	var h=f.b("script",{
		type:"text/javascript",src:e[g]
	});
	f.appendChild(f.W()[Lc],h);
	this.iV(c,0)
}
}else for(var g=c.uD;g<e[E];g++)this.VR(c,g,0)
}
};
fu[_P].VR=function (a,b,c) {
var d=Vm(a.Kt[b]);
d.Bo(l[xc][cd]);
d.uo(l[xc][Hc]);
var e=new Mk;
Dh(e,Mj,R(this.r3,this,e,a,b,c));
e.send(d.toString ())
};
fu[_P].iV=function (a,b) {
if(a.u5())this.eM(a);
else if(b<iu)fi(R(this.iV,this,a,b+1),ju);
else this.aM(a)
};
fu[_P].r3=function (a,b,c,d) {
if(a.vv()) {
var e=a.Gg();
oe(e);
b.y4();
if(b.yW())this.eM(b)
}else if(d<ku)fi(R(this.VR,this,a,b,c,d+1),lu);
else this.aM(b)
};
fu[_P].aM=function (a) {
a.clear();
this.j.Bb(_M[7])
};
fu[_P].eM=function (a) {
a.Gr(2);
a.N_()
};
var eu=function (a) {
this.Kt=a;
this.vw=[]
};
Db(eu[_P],function () {
this.Pe=0;
this.vw=[]
});
eu[_P].Pe=0;
eu[_P].uD=0;
eu[_P].yW=function () {
return this.uD==this.Kt[E]
};
eu[_P].y4=function () {
this.uD++
};
eu[_P].Gr=function (a) {
this.Pe=a
};
eu[_P].u5=function () {
var a=this.Kt[this.Kt[E]-1],b=a.split("/");
a=b[b[E]-1];
return gu[a]
};
eu[_P].N_=function () {
for(var a=0;a<this.vw[E];a++)this.vw[a]();this.vw=[]
};eu[_P].qQ=function (a) {
this.vw.push(a)
};
var mu=function (a) {
this.wb=a;
this.By=new Np
};
mu.inherits(af);
mu[_P].GX=function () {
this.By.clear()
};
mu[_P].jl=function (a,b) {
a.type=b;
this.By.enqueue(a)
};
mu[_P].M_=function () {
var a=this.By,b,c=this.wb.H.V(),d=this.wb.Mc,e=c.info.idsTOcols;
while(b=a.dequeue())try{
var f=c.info.idsTOrows[b.r],g=b.type;
switch(g) {
case X[I]:c.DU(f,d,b);
break;
case X.format:var h=e[b.c],i=e[b.c2];
c.KU(f,d,h,i==null?1:i-h+1,b.css);
break;
case X.gridInfo:c.info.OU(b,true);
break;
case X.resizeCol:this.wb.lR(e[b.c],b.v);
break;
case X.resizeRow:c.mR(f,
d,b.v);
c.$P();
break;
case X.conditionalFormat:c.info.hS(f,e[b.c],b.cco,b.cfo);
break;
default:if(g==X.mergeCellsAcross||g==X.unmergeCells) {
	var j=e[b.c],k=e[b.c2],m=k-j+1;
	if(g==X.unmergeCells) {
		c.unmergeCells(f,j,m,d);
		c.oH()
	}else {
		c.dD(f,j,m,d);
		c.ZP(f,j)
	}
}break
}
}catch(n) {
this.wb.H.V().eb().hE(qm(n),X.error9)
}
};
mu[_P].dispose=function () {
if(!this.N()) {
mu.B.dispose.call(this);
this.wb=null;
this.By=null
}
};
var nu=function (a) {
return ee(a)||fe(a)
},ou=function (a) {
if(!ce(a))return false;
for(var b=0;b<a[E];b++) {
var c=a[b];
if(!ce(c))return false;
for(var d=0;d<c[E];d++) {
var e=c[d];
if(!nu(e))return false
}
}return true
};
var pu="[_a-zA-Z\u00a2-\u00a5\u00aa\u00b5\u00ba\u00c0-\u00d6\u00d8-\u00f6\u00f8-\u00ff]",qu="[^_.?0-9a-zA-Z\u007f-\u009f\u00a2-\u00a5\u00aa\u00b5\u00ba\u00c0-\u00d6\u00d8-\u00f6\u00f8-\u00ff]";
function ru(a) {
this.z=a;
var b=Yf;
this.Wb=S;
this.pv=this.Wb&&cg(b,"7.0")>=0;
this.e5=Uf&&cg(b,"1.8.1")>=0;
var c=this.z.W(),d=this.z.divGrids;
this.Xx=null;
this.Rx=null;
this.OL=true;
this.Jfa=false;
this.Tj=false;
this.gf=null;
this.ef=null;
this.xn=null;
this.wn=null;
this.efa=Rl(c,d,"","z-index:5;","absolute",-1000,
-1000,"0px","0px",1,"text");
this.Ge=null;
this.db=null;
this.nz(true);
this.qK=Rl(c,d,"","z-index:5;","absolute",-1000,-1000,"0px","0px",3,"text");
this.efa.onfocus=Qk(this,this.L);
this.qK.onfocus=Qk(this,this.L);
this.Rt=su(c,d,"formulaAddressLocator",0,0,"","","P");
Sb(this.Rt[J],"hidden");
this.Em=c.createElement("table");
var e=this.Em.insertRow(0);
this.Z_=e.insertCell(0);
d.appendChild(this.Em);
r(this.Em,"editBoxResizerTable");
var f=this.Em[J];
x(f,"");
ib(f,"-1000px");
f.top="-1000px";
this.I$=null;
this.H$=
null;
this.QR=null;
this.xO=null;
this.v6=null;
this.QN=null;
this.ON=null;
this.RN=null;
this.keyCodUp=null;
this.isEditBoxActive=false;
this.F2OrMouse=false;
this.RJ=1;
this.Wk=null;
this.UN=false;
this.IC=false;
this.eD=false;
this.I6=null;
this.kda=false;
this.VL=new RegExp(pu);
this.UL=new RegExp(qu)
}ru[_P].nz=function (a) {
var b=this.Wb,c=Wf;
if(a||Uf) {
var d=this.z.W(),e=this.z.divGrids;
if(b||c) {
this.db=Rl(d,e,"editBox","z-index:5","absolute",-1000,-1000,"0px","0px",2,"textarea");
if(Wf) {
	var f=this.db[J];
	x(f,D(f,
	"10px"))
}this.Ge=this.db
}else if(this.Ge==null) {
this.Ge=Zk(d,e,"editBoxWrapper",0,0,0,0,this.qK);
Lb(this.Ge[J],5);
this.db=Rl(d,this.Ge,"editBox","","absolute",0,0,"100%","97%",2,"textarea")
}else {
var g=e.removeChild(this.Ge);
e.insertBefore(g,this.qK)
}
}
};
ru[_P].laa=function () {
if(Uf) {
this.QN=Lj(this,this.A7);
Jj(this.db,"keypress",this.QN)
}this.ON=Lj(this,this.xf);
Jj(this.db,"keydown",this.ON);
this.RN=Lj(this,this.Ng);
Jj(this.db,"keyup",this.RN)
};
ru[_P].Ng=function (a) {
var b=this.z;
if(!b.on())return ;
var c=
a[ed];
if(c==224) {
clearTimeout(this.I6);
var d=this;
this.I6=setTimeout(function () {
d.eD=false
},300)
}var e=a[Bc]&&this.eD&&this.e5;
if(Zf&&!Wf&&(!this.UN||e)) {
if(c==88&&e)b.copyPaste.np(b.activeGrid);
this.fw(a,false,a[ed])
}this.UN=false;
if(this.Xx) {
ei(this.Xx);
this.Xx=null;
this.Rx=null;
this.OL=true
}if(this.Jfa&&this.Tj&&!this.ke()&&a[ed]!=16&&!a[Zb]&&!a[oc])this.Xx=fi(this.XL,10,this);
this.Rh();
if(!this.isEditBoxActive)if(this.keyCodUp==86) {
b.paste(false,null,this.IC);
this.keyCodUp=null
}else b.copyPaste.np(this.z.activeGrid)
};
ru[_P].A7=function (a) {
if(!this.z.on())return ;
if(a[oc]&&(a[wd]==98||a[wd]==66||a[wd]==105||a[wd]==73))Ij(a);
else this.fw(a,true,a[ed])
};
ru[_P].xf=function (a) {
if(!this.z.on())return ;
this.UN=true;
var b=a[ed]?a[ed]:(a[wd]?a[wd]:a[$c]);
if(b==224)this.eD=true;
if(b==16||b==17) {
}else if(Wf)this.fw(a,true,b);
else {
this.keyCodUp=null;
this.fw(a,false,b)
}
};
ru[_P].fw=function (a,b,c) {
var d=this.z;
if(d.activeFormuGrid!=null)d.activeFormuGrid.vc(3);
var e=this.Wb;
if(Uf&&c==27)Ij(a);
if(Wf&&c==3&&b)c=13;
var f=a[Zb]&&
a[oc];
if(d.modalDbox==null)if((a[Zb]||a[oc])&&!f&&this.isEditBoxActive&&(c==13||Zf&&Uf&&c==77)) {
if(!b) {
if(!this.ke())if(e) {
	var g=this.db[Nc][kc].createRange();
	Ja(g,"\n");
	g.select()
}else {
	var h=this.db,i=h[I],j=h[Oc],k=h.selectionEnd;
	Ta(h,i.substring(0,j)+"\n"+i.substring(k));
	h.setSelectionRange(j+1,j+1)
}Ij(a)
}
}else {
var m=a[oc]&&!f||a[Bc]&&Zf,n=Wf,q=d.activeGrid,p=Wf&&$f||dg("525"),s=false,u=a[wd];
if(b&&Uf)if(Zf&&m&&(u==31||u==61)) {
c=u;
b=false
}else if(ag&&!m&&c==0&&u>=1025&&u<=1105) {
s=true;
c=u;
b=false
}var v=
false;
if(b||e)switch(c) {
case 63234:if(!n)break;
if(m)Ij(a);
p=true;
case 37:if(n&&!p)break;
if(!this.F2OrMouse&&!this.ke()) {
	if(this.Id(true))this.HF(m,a[sd],false)
}else if(this.ke()&&!this.F2OrMouse)this.At(a,37);
break;
case 63232:if(!n)break;
p=true;
case 38:if(n&&!p)break;
if(!this.F2OrMouse&&!this.ke()) {
	if(this.Id(true))this.Kx(m,a[sd],false)
}else if(this.ke()&&!this.F2OrMouse)this.At(a,38);
break;
case 63235:if(!n)break;
if(m)Ij(a);
p=true;
case 39:if(n&&!p)break;
if(!this.F2OrMouse&&!this.ke()) {
	if(this.Id(true))this.IF(m,
	a[sd],false,true)
}else if(this.ke()&&!this.F2OrMouse)this.At(a,39);
break;
case 63233:if(!n)break;
p=true;
case 40:if(n&&!p)break;
if(!this.F2OrMouse&&!this.ke()) {
	if(this.Id(true))this.Hx(m,a[sd],false)
}else if(this.ke()&&!this.F2OrMouse)this.At(a,40);
break;
case 13:var t=true;
if(this.ke()&&d.Zt().Na()) {
	if(Uf)Ij(a);
	t=false
}if(!m&&!this.isEditBoxActive&&!q.HH()&&!q.oC()) {
	this.ui(true);
	this.F2OrMouse=true;
	t=false;
	Ij(a)
}if(t)if(this.Id(true)||Wf) {
	if(Wf)Ij(a);
	if(m)q.hyperlink();
	else {
		var w=q.Md();
		if(q.ma>1||
		q.Z>tu(w,q)) {
			if(this.RJ==1)this.Nca(a[sd]);
			this.RJ=1
		}else if(a[sd])this.Kx(m,false,false);
		else this.Hx(m,false,false)
	}
}break;
case 9:if(this.Id(true)) {
	var w=q.Md();
	if(q.ma>1||q.Z>tu(w,q))this.Oca(a[sd]);
	else if(a[sd])this.HF(m,false,false);
	else this.IF(m,false,false,false)
}break;
case 63276:if(!n)break;
p=true;
case 33:if(n&&!p)break;
if(this.Id(true))if(m) {
	if(!Uf)d.Nv(o.max(0,q[fc]-1))
}else this.Kx(m,a[sd],true);
break;
case 63277:if(!n)break;
p=true;
case 34:if(n&&!p)break;
if(this.Id(true))if(m) {
	if(!Uf)d.Nv(o.min(d.Aa.of()-
	1,q[fc]+1))
}else this.Hx(m,a[sd],true);
break;
default:v=true;
break
}if(!b||v&&(e||n))switch(c) {
case 27:this.Id(false);
d.P();
break;
case 35:if(m&&!this.F2OrMouse) {
	this.N6();
	if(n)Ij(a)
}break;
case 36:if(m&&!this.F2OrMouse) {
	this.O6();
	if(n)Ij(a)
}break;
case 113:if(!m&&!this.isEditBoxActive)if(a[sd])d.cellOverlayManager.wT(q,[q.Ga,q.Ea]);
else {
	this.ui(true);
	this.F2OrMouse=true
}break;
case 8:if(!this.isEditBoxActive&&!q.yq()) {
	q.Jz();
	Ij(a)
}else if(this.isEditBoxActive)this.Tj=false;
break;
case 46:if(!m&&!this.isEditBoxActive) {
	if(!q.yq())q.Jz()
}else if(this.isEditBoxActive)this.Tj=
false;
break;
case 32:if(!this.isEditBoxActive)if(a[sd]&&m)this.F$();
else if(a[sd])this.JR();
else if(m) {
	this.xR();
	Ij(a)
}else {
	this.ui(false);
	this.Tj=true
}else this.Tj=true;
break;
case 83:if(m) {
	if(d.gooffiLink!=null&&!d.Da())gm(d.gooffiLink,d.gooffiLink.save,0);
	Ij(a)
}case 80:if(m) {
	Ij(a);
	if(e)rb(a,0)
}default:if(!this.isEditBoxActive) {
	var B=Uf,A=Zf,G=a[oc]&&!f||a[Bc]&&A&&(!B||this.e5);
	this.IC=a[Bc];
	if(G)if(!q.yq())if(c==66) {
		d.Wl("bold");
		Ij(a)
	}else if(c==73) {
		d.Wl("italic");
		Ij(a)
	}else if(c==85) {
		d.Wl("underline");
		Ij(a)
	}else if(a[sd]&&c==82) {
		d.Wl("dirRtl");
		Ij(a)
	}else if(a[sd]&&c==76) {
		d.Wl("dirLtr");
		Ij(a)
	}else if(c==68) {
		var H=d.copyPaste;
		H.copy(X.pasteAll,1);
		H.paste(this.IC);
		Ij(a)
	}else if(c==82) {
		var H=d.copyPaste;
		H.copy(X.pasteAll,2);
		H.paste(this.IC);
		Ij(a)
	}if(m||this.eD) {
		if(!d.Da())if(c==67)d.copy(X.pasteAll,false,true);
		else if(c==88)d.copy(X.newPasteCut,false);
		else if(c==86)this.keyCodUp=c;
		else if(c==118&&n)gm(this,this.Ng,0,a);
		else if(c==90&&!a[sd])d.ex(X.undo);
		else if(c==89||c==90&&a[sd])d.ex(X.redo);
		else if(c==
		109&&!e&&!(B&&A))this.PB(a,q,d);
		else if(c==31&&B&&A)this.PB(a,q,d);
		else if(c==189&&e&&!this.pv)this.PB(a,q,d);
		else if(c==61&&!e&&!(B&&A))this.RB(a,q,d);
		else if(c==61&&B&&A&&!a[Bc])this.RB(a,q,d);
		else if(c==187&&e&&!this.pv)this.RB(a,q,d)
	}else if(this.JN(c,f,a[Zb],s)) {
		this.ui(false);
		this.Tj=true
	}
}else if(this.JN(c,f,a[Zb],s))this.Tj=true;
break
}
}
};
ru[_P].PB=function (a,b,c) {
if(b.BC(b.Ga)&&b.Ba>1) {
c.Fc(X.rowDelete,false);
if(!this.Wb)Ij(a)
}else if(b.EN(b.Ea)&&b.Ha()>1) {
c.Fc(X.colDelete,false);
if(!this.Wb)Ij(a)
}
};
ru[_P].RB=function (a,b,c) {
if(b.BC(b.Ga)) {
c.Fc(X.rowInsert,false);
if(!this.Wb)Ij(a)
}else if(b.EN(b.Ea)) {
c.Fc(X.colInsert,false);
if(!this.Wb)Ij(a)
}
};
ru[_P].Ep=function (a,b,c,d,e) {
while(c<=e)if(a.Mg(c)||a.iv(b,c,d))c++;
else return c;
return -1
};
ru[_P].Mt=function (a,b,c,d) {
while(c>0)if(a.Mg(c)||a.iv(b,c,d))c--;
else return c;
return -1
};
ru[_P].Fp=function (a,b,c,d,e) {
while(d<=e)if(a.iv(b,c,d))d++;
else return d;
return -1
};
ru[_P].oh=function (a,b,c,d) {
while(d>0)if(a.iv(b,c,d))d--;
else return d;
return -1
};
ru[_P].cK=
function (a,b,c,d,e) {
var f;
if(d) {
f=a.Y;
if(a.Ea==f)f+=a.Z-1
}else f=a.Ea;
var g=a.Ba,h=b.K(c),i=h[L],j=a.Ra,k=a.I.K(c,false,true),m=k[L],n=false;
while(f>=1&&f<=g) {
var q=f<j?m[f]:i[f];
if(!a.kd(q)) {
n=uu(q);
break
}f+=e
}var p=f;
for(var s=f+e;s>=1&&s<=g;s+=e) {
var q=s<j?m[s]:i[s];
if(!a.kd(q)) {
if(uu(q)) {
	if(!n) {
		if(p!=f)return p;
		n=true
	}
}else if(n)return s;
p=s
}
}return p
};
ru[_P].dK=function (a,b,c,d,e) {
var f;
if(d) {
f=a.O;
if(a.Ga==f)f+=a.ma-1
}else f=a.Ga;
var g=c<=a.Ra,h=a.I,i=g?h.K(f,false,true):b.K(f),j=i[L][c],k=
uu(j),m=a.Ha(),n=f;
for(var q=f+e;q>=1&&q<=m;q+=e) {
i=g?h.K(q,false,true):b.K(q);
j=i[L][c];
if(!a.Mg(q)&&!a.kd(j)) {
if(uu(j)) {
	if(!k) {
		if(n!=f)return n;
		k=true
	}
}else if(k)return q;
n=q
}
}return n
};
ru[_P].Hx=function (a,b,c) {
var d=this.z.activeGrid,e=d.H,f=d.Y,g=d.Ha();
if(a) {
var h=this.dK(d,e,f,b,1);
this.Jx(d,b,h,f)
}else {
var i=d.O,j=d.ma,h=i+1;
if(c) {
if(b&&j>1&&i==d.Ga)h=j+h-1;
var k=d.mainGridHei;
for(var m=h-1;m<g&&k>0;m++)k-=e.K(m)[Id];h=m
}else if(b)if(d.O<d.Ga)h=d.O+1;else h+=d.ma-1;if(h<=g) {
h=this.Ep(d,e,
h,f,g);
if(h>-1)this.Jx(d,b,h,f)
}
}
};
ru[_P].Kx=function (a,b,c) {
var d=this.z,e=d.activeGrid,f=e.H,g=e.Y;
if(a) {
var h=this.dK(e,f,g,b,-1);
this.Jx(e,b,h,g)
}else {
var i=e.O,j=e.ma,h=i-1;
if(c) {
if(b&&j>1&&i==e.Ga)h=j+h-1;
var k=e.mainGridHei;
for(var m=h+1;m>1&&k>0;m--)k-=f.K(m)[Id];h=m;if(h<=e.Xb)d.mouseSelection.D$(e)
}else if(b)if(e.O<e.Ga)h=e.O-1;else h+=e.ma-1;if(h>0) {
h=this.Mt(e,f,h,g);
if(h>-1)this.Jx(e,b,h,g)
}
}
};
ru[_P].Jx=function (a,b,c,d) {
if(b)a.dc(a.Ga,d,c,d+a.Z-1,true);
else a.Ua(c,a.Ea,true);
a.Vc(c,
d+a.Z-1)
};
ru[_P].IF=function (a,b,c,d) {
var e=this.z.activeGrid,f=e.H,g=e.O,h=e.Ba;
if(a&&d) {
var i=this.cK(e,f,g,b,1);
this.Ix(e,b,g,i)
}else {
var i=e.Ea+1;
if(b)if(e.Y<e.Ea)i=e.Y+1;
else i+=e.Z-1;
if(i<=h) {
i=this.Fp(e,f,g,i,h);
if(i>-1)this.Ix(e,b,g,i)
}
}
};
ru[_P].HF=function (a,b) {
var c=this.z.activeGrid,d=c.H,e=c.O;
if(a) {
var f=this.cK(c,d,e,b,-1);
this.Ix(c,b,e,f)
}else {
var f=c.Ea-1;
if(b)if(c.Y<c.Ea)f=c.Y-1;
else f+=c.Z-1;
if(f>0) {
f=this.oh(c,d,e,f);
if(f>-1)this.Ix(c,b,e,f)
}
}
};
ru[_P].Ix=function (a,b,c,d) {
if(b)a.dc(c,
a.Ea,c+a.ma-1,d,true);
else a.Ua(a.Ga,d,true);
a.Vc(c+a.ma-1,d)
};
ru[_P].Nca=function (a) {
var b=this.z.activeGrid;
this.Sr(a,b,b.H,b.Ga,b.Ea)
};
ru[_P].Sr=function (a,b,c,d,e) {
var f=b.O,g=b.Y,h=f+b.ma-1,i=g+b.Z-1;
if(a)if(f>=d)if(g>=e) {
var j=this.oh(b,c,h,i);
b.Ua(h,j,false)
}else {
var j=o.max(e-1,g),k=this.Mt(b,c,h,j);
if(k<f)return this.Sr(a,b,c,f,j);
else b.Ua(k,j,false)
}else {
var k=this.Mt(b,c,d-1,e);
if(k<f)return this.Sr(a,b,c,f,e);
else b.Ua(k,e,false)
}else if(h<=d)if(i<=e) {
var j=this.oh(b,c,f,g);
b.Ua(f,j,
false)
}else {
var j=o.min(e+1,i),k=this.Ep(b,c,f,j,h);
if(k==-1)return this.Sr(a,b,c,h,j);
else b.Ua(k,j,false)
}else {
var k=this.Ep(b,c,d+1,e,h);
if(k==-1)return this.Sr(a,b,c,h,j);
else b.Ua(k,e,false)
}b.Vc(b.Ga,b.Ea)
};
ru[_P].Oca=function (a) {
var b=this.z.activeGrid,c=b.H,d=b.O,e=b.Y,f=b.Ga,g=b.Ea,h=d+b.ma-1,i=e+b.Z-1,j=tu((g<=b.Ra?b.I.K(f,false,true):c.K(f))[L][g],b);
if(a)if(e>=g)if(d>=f) {
var k=this.oh(b,c,h,i);
b.Ua(h,k,false)
}else {
var m=o.max(f-1,d),k=this.oh(b,c,m,i);
b.Ua(m,k,false)
}else {
var k=this.oh(b,
c,f,g-1);
b.Ua(f,k,false)
}else if(i<=g||j>i-g)if(h<=f) {
var k=this.oh(b,c,d,e);
b.Ua(d,k,false)
}else {
var m=o.min(f+1,h),k=this.oh(b,c,m,e);
b.Ua(m,k,false)
}else {
var k=this.Fp(b,c,f,g+1,i);
b.Ua(f,k,false)
}b.Vc(b.Ga,b.Ea)
};
ru[_P].JR=function () {
var a=this.z.activeGrid,b=a.H,c=a.O,d=a.Ba;
a.dc(c,1,c+a.ma-1,d);
var e=this.Fp(a,b,c,1,d);
a.Ua(c,e,false);
a.kF(c);
a.Vc(c,e)
};
ru[_P].xR=function () {
var a=this.z.activeGrid,b=a.H,c=a.Y,d=a.Ha();
a.dc(1,c,d,c+a.Z-1);
var e=this.Ep(a,b,1,c,d);
a.Ua(e,c,false);
a.xaa(c);
a.Vc(e,
c)
};
ru[_P].F$=function () {
var a=this.z.activeGrid;
if(a.Md()==null)a.OR();
this.JR();
this.xR()
};
ru[_P].O6=function () {
var a=this.z.activeGrid;
a.OR();
a.Vc(a.Ga,a.Ea)
};
ru[_P].N6=function () {
var a=this.z.activeGrid;
a.G$();
a.Vc(a.Ga,a.Ea)
};
ru[_P].L=function (a,b) {
var c=this.db;
if(a==true)Xa(c,false);
if(!c.disabled) {
if(b!==true)this.z.P();
if(Uf&&$f)this.z.Bh().focus();
c.focus()
}
};
ru[_P].ke=function () {
if(this.isEditBoxActive) {
var a=this.db[I].charAt(0);
return a=="+"||a=="="
}return false
};
ru[_P].Eo=function (a) {
var b=
this.Rt[J],c=this.Ge[Ed]-18,d=this.Ge[Cc];
if(!this.Wb) {
c-=10;
d++
}b.top=c;
ib(b,d);
Sb(b,"visible");
var e=this.z.activeGrid,f=e.Ga,g=e.Ea;
if(a==true) {
f=e.info.idsTOrows[e.activeRowID];
g=e.info.idsTOcols[e.activeColID]
}var h=this.Rt;
y(h,f==null||g==null?_M[38]:Cs(g)+f)
};
ru[_P].hea=function (a) {
Ta(this.db,a=a.replace(/\n/mg,""));
var b=a.charAt(a[E]-1);
if(b.match(/[\+\-\/\*\^(=]/)!=null) {
Xa(this.db,true);
this.z.cb(_M[31]);
return false
}var c=false,d=0;
for(var e=0;e<a[E];e++) {
b=a.charAt(e);
if(b=='"')c=!c;
else if(!c)if(b=="(")d++;
else if(b==")")d--
}if(c) {
Xa(this.db,true);
this.z.cb(_M[32]);
return false
}else if(d<0) {
Xa(this.db,true);
this.z.cb(_M[31]);
return false
}else if(d>0)for(var e=0;e<d;e++)this.db.value+=")";return true
};ru[_P].Id=function (a) {
var b=this.z,c=b.activeGrid;
if(b.activeFormuGrid)b.activeFormuGrid.vc(3);
else if(c)c.vc(3);
var d=true,e=this.db,f=e[I],g=this.Wk!=f;
this.Wk=null;
if(this.isEditBoxActive&&a) {
if(f.indexOf("+")==0) {
f="="+f.substring(1);
Ta(e,f)
}if(f.indexOf("=")==0) {
d=this.hea(f);
f=e[I]
}
}if(d) {
if(b.activeFormuGrid!=null) {
b.activeFormuGrid=null;
b.activate(c[fc],true,true,false,null,true)
}if(this.isEditBoxActive) {
if(a&&g) {
	var h=c,i=h.I,j=h.info,k=h.activeRowID,m=h.activeColID,n=j.idsTOrows[k],q=j.idsTOcols[m],p=null,s=i.K(n,false,true),u=h.H.K(n);
	if(n==null||q==null)b.cb(_M[8]);
	else p=(q<=h.Ra?s:u)[L][q];
	if(p!=null) {
		vu(null,p,f);
		if(f.indexOf("=")!=0)j.bz(n,q);
		i.Fe(n,s,u,false,false);
		h.vj();
		h.cx(p,k,m)
	}h.activeRowID=null;
	h.activeColID=null
}var v=this.Ge[J];
ib(v,-100);
v.top=-100;
x(v,Wf?"10px":"0px");
D(v,Wf?"10px":"0px");
y(this.Rt,"");
Sb(this.Rt[J],"hidden");
if(b.activeGrid)b.activeGrid.nj()
}e.focus();
Ta(e,"");
wp(b.W(),this.Z_,"");
x(this.Em[J],"");
this.isEditBoxActive=false;
this.F2OrMouse=false;
if(mn)b.Zt().deactivate(e)
}this.xn=this.wn=this.gf=this.ef=null;
this.Tj=false;
return d
};
ru[_P].ui=function (a,b) {
var c=this.z;
c.P();
c.cellOverlayManager.Rf();
if(b!=null)this.RJ=b;
var d=c.activeGrid;
if(!d)return ;
if(!d.oC()) {
var e=d.Md();
if(e!=null) {
d.Vc(d.Ga,d.Ea);
var f=this.Ge[J],g=
d.Vi(e);
ib(f,g[0]);
f.top=g[1];
var h=this.db,i=d.info,j=d.Ga,k=d.Ea;
d.activeRowID=d.info.rowsTOids[j];
d.activeColID=d.info.colsTOids[k];
if(a) {
	var m=i.rB(j,k);
	if(m==null) {
		var n=i.OA(j,k);
		Ta(h,n==null?wu(e):n)
	}else Ta(h,"="+m);
	var q=h[I][E];
	pq(h,q);
	tq(h,q)
}else Ta(h,"");
this.Wk=h[I];
var p=xu(e,"fontSize","font-size");
f=this.db[J];
Va(f,p);
Na(f,xu(e,"fontFamily","font-family"));
Qb(f,xu(e,"fontWeight","font-weight"));
hb(f,xu(e,"fontStyle","font-style"));
var s=xu(e,"direction","direction");
f.direction=s;
var u=s=="rtl";
this.kda=u;
$a(f,u?"right":"left");
var v=this.Em[J];
Va(v,p);
Na(v,f.fontFamily);
Qb(v,f.fontWeight);
hb(v,f.fontStyle);
x(v,"");
var t=e[tc];
this.I$=t;
this.H$=e[Id];
this.QR=e[Cc]+t;
if(u) {
	this.xO=this.Ge[Cc]+t;
	this.QR+=38-d.divMain[jd]
}else this.xO=c.divGrids[tc]-this.Ge[Cc]-5;
this.v6=c.divGrids[Id]-this.Ge[Ed]-5;
this.isEditBoxActive=true;
this.Rh();
if(Wf)h.setSelectionRange(0,0);
d.nj();
if(mn)c.Zt().KV(h)
}
}else {
this.F2OrMouse=false;
this.L()
}
};
ru[_P].Rh=function () {
if(this.isEditBoxActive) {
var a=
this.db,b=this.Em,c=this.Ge,d=this.kda,e=a[I].match(/\n/gm),f=e?e[E]:0,g=Wf&&f>0?21:0;
vu(this.z.W(),this.Z_,a[I]+" ===");
var h=c[J],i=o.max(30,this.I$,b[tc]+g),j=this.xO;
if(i>j) {
i=j;
x(b[J],j)
}else i+=3;
x(h,i);
if(d)ib(h,this.QR-i);
var k=0;
if(f>0)k=f*0.6+3;
var m=5+(b[tc]>j?this.z.activeGrid.scrollDepth:0),n=o.min(o.max(this.H$+m,b[Id]+k),this.v6);
if(Zf)n=o.max(32,n);
D(h,n)
}
};
Ra(ru[_P],function () {
if(Uf)Kj(this.db,"keypress",this.QN);
Kj(this.db,"keydown",this.ON);
Kj(this.db,"keyup",this.RN)
});
ru[_P].At=
function (a,b) {
var c=this.z,d=c.activeFormuGrid;
if(!d)d=c.activeGrid;
var e="";
if(d!=c.activeGrid) {
var f=d[yd].replace(/'/g,"''"),g=d[yd].substring(0,1);e=this.VL.test(g)==true&&this.UL.test(f)==false?f+"!":"'"+f+"'!"}var h=this.db,i=rq(h),j=De(h[I].substring(0,i)),k=Ce(h[I].substring(i)),m=j.charAt(j[E]-1);if(c.Zt().Na())return;if(m==")") {this.Pca(a,b);return}var n;n=m==":"&&(k==""||this.wC(k.charAt(0)))?true:this.wC(m);if(n||!this.gf||!this.ef) {this.gf=d.Ga;this.ef=d.Ea}if(a[sd]) {if(!this.xn&&!this.wn) {this.xn=
this.gf;
this.wn=this.ef
}this.gP(b)
}else {
this.gP(b);
this.xn=this.gf;
this.wn=this.ef
}var q,p,s,u;
if(this.xn<this.gf) {
q=this.xn;
p=this.gf
}else {
q=this.gf;
p=this.xn
}if(this.wn<this.ef) {
s=this.wn;
u=this.ef
}else {
s=this.ef;
u=this.wn
}d.Li(q,s,p,u,d.divFormulas);
d.Vc(this.gf,this.ef);
var v=false,t=e+Cs(s)+q;
if(q!=p||s!=u) {
t+=":"+Cs(u)+p;
v=true
}t+=k;
if(n)Ta(h,j+t);
else {
var w=this.Lt(j,v),B=j.lastIndexOf(w);
Ta(h,j.substring(0,B+1)+t)
}vq(h,h[I][E]-k[E]);
this.Eo(true);
Ij(a)
};
ru[_P].Pca=function (a,b) {
if(b==37)this.HF(a[oc],
a[sd],false);
else if(b==38)this.Kx(a[oc],a[sd],false);
else if(b==39)this.IF(a[oc],a[sd],false,true);
else this.Hx(a[oc],a[sd],false)
};
ru[_P].gP=function (a) {
if(a==37) {
if(!(this.ef==1))this.ef-=1
}else if(a==38) {
if(!(this.gf==1))this.gf-=1
}else if(a==39) {
if(this.ef!=this.z.activeGrid.Ba)this.ef+=1
}else if(this.gf!=this.z.activeGrid.Bc)this.gf+=1
};
ru[_P].XL=function () {
var a=this.z.activeGrid,b=a.Ea,c=a.Ga,d=this.db,e=rq(d),f=d[I];
if(e!=0)f=f.substring(0,e);
var g="";
if(!this.Rx)this.Rx=c;
var h=this.Rx,
i;
if(this.OL) {
var j=o.max(1,h-20);
for(i=h;i>=j;i--) {
g=this.jN(a,i,b,c,f);
if(g!="")break
}if(i==0) {
this.OL=false;
h=c
}else h=j
}else {
var j=o.min(h+20,a.Bc);
for(i=h;i<=j;i++) {
g=this.jN(a,i,b,c,f);
if(g!="")break
}h=j
}this.Rx=h;
if(g==""&&i!=a.Bc+1) {
this.Xx=fi(this.XL,10,this);
return
}var k=f+g;
if(g!=""&&!(!/[^0-9]/.test(g))) {
Ta(d,k);
d.focus();
pq(d,f[E]);
tq(d,k[E])
}this.Rh()
};
ru[_P].jN=function (a,b,c,d,e) {
var f="",g=a.Ld(b,c);
if(g) {
var h=Qg(g);
if(d!=b&&!this.o5(e)&&xe(h,e))f=h.substring(e[E])
}return f
};
ru[_P].o5=
function (a) {
return !/[^0-9$.%(),]/.test(a)
};
ru[_P].JN=function (a,b,c,d) {
if(this.Wb) {
if(a>=48&&a<=57||a>=65&&a<=90||a>=96&&a<=111||a>=186&&a<=192||a>=219&&a<=222||a==229)return true
}else if((b||Zf)&&a==0||c&&a==0&&!(Uf&&ag)||a>=48&&a<=57||a>=65&&a<=90||a==59||a==61||a>=96&&a<=111||a>=186&&a<=192||a>=219&&a<=222||a==229||d)return true;
return false
};
ru[_P].wC=function (a) {
return Qe("=-+*/%^(,;&:<>",a)
};
ru[_P].Lt=function (a,b,c) {
var d=false,e=a,f;
while(!d) {
f=e.substring(e[E]-1);
if(f==":"&&b) {
e=e.substring(0,
e[E]-1);
continue
}d=c?Qe(c,f):this.wC(f);
e=e.substring(0,e[E]-1);
if(e==""&&!d) {
d=true;
f=""
}
}return f
};
function yu(a,b) {
this.C=a;
this.xg=Zk(a.trixApp.W(),b,"divColHead",36,0,a.mainGridWid,32);
this.divActiveCellInH=null;
this.divSelectionInH=null;
this.divFormulasInH=null;
this.tblMain=null;
this.ob=null;
this.qe=null;
this.JF=null;
this.FA=0;
this.Rb=new Bs(a,this,false)
}yu[_P].freezeRows=function (a,b,c,d) {
var e=this.C,f=this.tblMain[rd][0],g=this.ob,h=T(f),i=e.Ba+1,j,k,m,n=false;
if(a) {
n=this.FA>0;
this.FA=0;
if(!n) {
var q,p,s;
for(j=g[E]-1;j<=c;j++) {
p=h.b("tr",{
	isFrozenRow:true
});
for(q=0;q<i;q++) {
	s=h.b("td",
	q==0?{
		"class":"hd"
	}:{
	});
	h.appendChild(p,s)
}s=h.b("td",{
	"class":"headerEnd"
});
h.appendChild(p,s);
h.gN(p,g[g[E]-1])
}
}
}var u=e.eb().W(),v=e.H;
for(j=c;j>=b;j--) {
if(a) {
k=v.K(j,true);
m=g[j]
}else {
k=g[j];
m=v.K(j,true)
}if(n)y(m[L][0],k[L][0][rc]);
else if(!d)this.ft(u,k,m,i,true);
m.isFrozenRow=a;
pb(m[J],k[J][bd]);
if(a)v.kq(j,true);
else h.removeNode(g[j])
}if(!d&&!n)e.I.freezeRows(a,b,c,d);
if(this.qe)this.qe.Zc()
};
yu[_P].ft=function (a,b,c,d,e) {
var f=b[L],g=c[L],h,i,j;
for(var k=0;k<d;k++) {
h=f[k];
i=g[k];
if(k==
0)y(i,h[rc]);
else vu(null,i,wu(h));
tb(i,h[gd]);
if(e) {
j=h[dc];
r(i,j);
this.C.HI(h[Nc],a,j)
}pb(i[J],h[J][bd])
}
};
yu[_P].WV=function () {
var a=this.C,b=a.H,c=this.xg;
y(c,b.z0());
this.FA=b.lL();
this.tblMain=c[rd][0];
this.ob=this.tblMain[pd];
var d=this.ob;
if(this.qe)this.qe.dispose();
this.qe=new ds(d[d[E]-1],a,a.trixApp.mouseSelection);
this.JF=d[d[E]-1][Id];
var e=this.C.trixApp.W();
this.divActiveCellInH=Zk(e,c,"divActiveCell",-3,-3,"0px","0px");
this.divSelectionInH=Zk(e,c,"divSelection",-3,-3,"0px","0px");
this.divFormulasInH=Zk(e,c,"divFormuSelect",-3,-3,"0px","0px")
};
yu[_P].rW=function () {
var a=this.C,b=this.ob[0][L],c=this.JL()[L];
for(var d=1;d<b[E]-1;d++)if(a.Lk(d)) {
C(b[d][J],"none");
C(c[d][J],"none")
}
};
yu[_P].cn=function (a,b,c,d) {
zu(this.ob,a,b,c,d)
};
yu[_P].Do=function (a) {
x(this.xg[J],a)
};
yu[_P].Pd=function (a) {
D(this.xg[J],a)
};
yu[_P].Zh=function (a) {
vb(this.xg,a);
this.Rb.mH()
};
yu[_P].Vp=function () {
return this.xg[jd]
};
yu[_P].Wi=function (a,b) {
if(b&&a<=this.C.Ra) {
var c=this.C.I.sB();
return c[0][L][a]
}else return this.ob[0][L][a]
};
yu[_P].Np=function (a) {
return this.ob[a]
};
yu[_P].Xu=function (a,b,c,d) {
var e,f,g,h,i,j=this.ob;
for(e=0;e<j[E];e++) {
g=j[e];
h=g[L][a];
for(f=0;f<b;f++) {
i=Au(h,g,a+d);
if(e==0||e==j[E]-1) {
var k=i[J];
pb(k,h[J][bd]);
C(k,"");
x(k,c)
}
}
}
};
yu[_P].qt=function (a,b,c) {
var d,e,f;
for(d=0;d<this.ob[E];d++) {
f=this.ob[d];
for(e=0;e<b;e++)if(c)f.removeChild(f[L][a]);else f.deleteCell(a)
}
};yu[_P].JL=function () {
var a=this.ob;
if(!a)return null;
return a[a[E]-1]
};
yu[_P].V1=function () {
var a=this.JL();
if(!a)return [0,0];
var b=a[Ed]-
32,c=b+a[Id];
return [b,c]
};
var jt="ABCDEFGHIJKLMNOPQRSTUVWXYZ";
function Bu(a,b,c) {
b=ga(b,10);
c=ga(c,10);
var d=false,e=false,f="",g="",h=null,i=null,j=0,k=0,m=0,n=0,q=0,p=0,s="",u="",v="",t="",w,B=true;
for(var A=0;A<a[E];A++) {
h=a.charAt(A);
if(!d&&!e&&Cu(h))f=f+h;
if(A==a[E]-1||d||e||!Cu(h)) {
if(h=='"')d=!d;
if(!d&&h=="'")e=!e;
var G=A==a[E]-1||Du(h);
if(f[E]>0) {
i=Eu(f,/^(\$)?([a-zA-Z])?([a-zA-Z])?(\$)?(\d+)?(?:(:)(\$)?([a-zA-Z])?([a-zA-Z])?(\$)?(\d+)?)?$/);
if(B&&G&&i!=null) {
	var H="";
	for(j=1;j<=11;j++)if(i[j]==null)i[j]="";if(i[2][E]>
	0&&i[5][E]>0&&i[6][E]>0&&i[8][E]>0&&i[11][E]>0||i[2][E]>0&&i[5][E]>0||i[2][E]>0&&i[6][E]>0&&i[8][E]>0||i[5][E]>0&&i[6][E]>0&&i[11][E]>0) {
		if(i[5][E]>0) {
			m=ga(i[5],10);
			if(m<0)m=0;
			s=i[4][E]>0?"R"+m:"R["+(m-b)+"]"
		}else {
			m=-1;
			s=""
		}if(i[2][E]>0) {
			n=i[2].toUpperCase().charCodeAt(0)-64;
			if(i[3][E]>0) {
				k=i[3].toUpperCase().charCodeAt(0)-64;
				n=n*26+k
			}u=i[1][E]>0?"C"+n:"C["+(n-c)+"]"
		}else {
			n=-1;
			u=""
		}if(i[6][E]>0) {
			H+=i[6];
			if(i[11][E]>0) {
				q=ga(i[11],10);
				if(q<0)q=0;
				v=i[10][E]>0?"R"+q:"R["+(q-b)+"]"
			}else {
				q=-1;
				v=""
			}if(i[8][E]>
			0) {
				p=i[8].toUpperCase().charCodeAt(0)-64;
				if(i[9][E]>0) {
					k=i[9].toUpperCase().charCodeAt(0)-64;
					p=p*26+k
				}t=i[7][E]>0?"C"+p:"C["+(p-c)+"]"
			}else {
				p=-1;
				t=""
			}if(m>=0&&q>=0&&m>q) {
				w=s;
				s=v;
				v=w
			}if(n>=0&&p>=0&&n>p) {
				w=u;
				u=t;
				t=w
			}g+=s;
			g+=u;
			g+=i[6];
			g+=v;
			g+=t
		}else {
			g+=s;
			g+=u
		}
	}else g+=f
}else g+=f
}if(!(A==a[E]-1&&Cu(h)))g+=h;
f="";
B=Du(h)
}
}return g
}function Fu(a,b,c) {
b=ga(b,10);
c=ga(c,10);
var d=false,e=false,f="",g="",h=null,i=null,j=null,k=0,m=0,n=0,q=0,p=true;
a=""+a;
for(var s=0;s<a[E];s++) {
h=a.charAt(s);
if(s>0)i=a.charAt(s-
1);
if(!d&&!e&&Gu(h,i))f=f+h;
if(s==a[E]-1||d||e||!Gu(h,i)) {
if(h=='"')d=!d;
if(!d&&h=="'")e=!e;
var u=s==a[E]-1||Du(h);
if(f[E]>0) {
j=Eu(f,/^([R|r])?(\[)?(\-)?(\d+)?(\])?([C|c])?(\[)?(\-)?(\d+)?(\])?(?:(:)([R|r])?(\[)?(\-)?(\d+)?(\])?([C|c])?(\[)?(\-)?(\d+)?(\])?)?$/);
if(p&&u&&j!=null) {
	for(k=1;k<=21;k++)if(j[k]==null)j[k]="";var v="",t=false,w=false;if(j[1][E]>0&&j[6][E]>0||j[1][E]>0&&j[11][E]>0&&j[12][E]>0||j[6][E]>0&&j[11][E]>0&&j[17][E]>0) {
		if(j[6][E]>0)if(j[7][E]>0&&j[10][E]>0&&j[9][E]>0) {
			m=ga(j[9],
			10);
			if(j[8][E]>0)m=m*-1;
			q=c+m;
			v+=Cs(q);
			w=w||ga(q,10)>0
		}else if(j[9][E]>0) {
			v+="$";
			v+=Cs(j[9]);
			w=w||ga(j[9],10)>0
		}else {
			v+=Cs(c);
			w=w||ga(c,10)>0
		}else w=true;
		if(j[1][E]>0)if(j[2][E]>0&&j[5][E]>0&&j[4][E]>0) {
			m=ga(j[4],10);
			if(j[3][E]>0)m=m*-1;
			n=b+m;
			v+=Hu(n);
			t=t||ga(n,10)>0
		}else if(j[4][E]>0) {
			v+="$"+Hu(j[4]);
			t=t||ga(j[4],10)>0
		}else {
			v+=Hu(b);
			t=t||ga(b,10)>0
		}else t=true;
		if(j[11][E]>0) {
			v+=":";
			if(j[17][E]>0)if(j[18][E]>0&&j[21][E]>0&&j[20][E]>0) {
				m=ga(j[20],10);
				if(j[19][E]>0)m=m*-1;
				q=c+m;
				v+=Cs(q);
				w=w||ga(q,10)>
				0
			}else if(j[20][E]>0) {
				v+="$";
				v+=Cs(j[20]);
				w=w||ga(j[20],10)>0
			}else {
				v+=Cs(c);
				w=w||ga(c,10)>0
			}if(j[12][E]>0)if(j[13][E]>0&&j[16][E]>0&&j[15][E]>0) {
				m=ga(j[15],10);
				if(j[14][E]>0)m=m*-1;
				n=b+m;
				v+=Hu(n);
				t=t||ga(n,10)>0
			}else if(j[15][E]>0) {
				v+="$"+Hu(j[15]);
				t=t||ga(j[15],10)>0
			}else {
				v+=Hu(b);
				t=t||ga(b,10)>0
			}
		}g+=t&&w?v:"{}"
	}else g+=f
}else g+=f
}if(!(s==a[E]-1&&Gu(h,i)))g+=h;
f="";
p=Du(h)
}
}return g
}function Cu(a) {
var b=/\w/;
return b.test(a)||a=="$"||a==":"?true:false
}function Gu(a,b) {
var c=/\d/;
return c.test(a)||
a=="R"||a=="C"||a=="r"||a=="c"||a=="["||a=="]"||a=="-"&&b=="["||a==":"?true:false
}function Du(a) {
var b=/\w/;
return !b.test(a)?true:false
}function Eu(a,b) {
return b.test(a)?b.exec(a):null
}function Cs(a) {
a=ga(a,10);
if(a<=0)a=1;
var b="";
if(a<676&&a>0) {
var c=0;
if(a>26) {
c=(a-1)/26;
a=(a-1)%26+1
}b=c==0?ha.fromCharCode(a+64):ha.fromCharCode(c+64)+ha.fromCharCode(a+64)
}return b
}function Hu(a) {
a=ga(a,10);
if(a<=0)a=1;
return a
}function xr(a,b,c,d,e) {
var f=Cs(b)+a+":"+Cs(b+d-1)+(a+c-1);
if(e!=null)f=e[yd].indexOf(" ")>
-1?"'"+e[yd]+"'!"+f:e[yd]+"!"+f;
return f
}function ys(a) {
var b={
};
b.valid=false;
if(!/^(.*!)?[a-zA-Z]([a-zA-Z])?\d+(:[a-zA-Z]([a-zA-Z])?\d+)?$/.test(a))return b;
var c=a.indexOf("!");
if(c!=-1) {
var d=a.substring(0,c);
if(d[E]>2&&d.charAt(0)=="'"&&d.charAt(d[E]-1)=="'")d=d.substring(1,d[E]-1);
b.Bd=d;
a=a.substring(c+1)
}a=a.toUpperCase();
c=a.indexOf(":");
var e;
e=c==-1?Iu(a):Iu(a.substring(0,c));
b.fromRowPos=e.row;
b.fromColPos=e.col;
if(c==-1) {
b.toRowPos=e.row;
b.toColPos=e.col
}else {
a=a.substring(c+1);
e=Iu(a);
b.toRowPos=e.row;
b.toColPos=e.col
}if(b.fromRowPos&&b.fromColPos&&b.toRowPos&&b.toColPos)b.valid=true;
return b
}function Iu(a) {
var b={
},c=a.charAt(0),d=jt.indexOf(c);
a=a.substring(1);
var e=a.charAt(0),f=jt.indexOf(e);
if(f>=0)a=a.substring(1);
var g=d+1;
if(f>=0)g=27+d*26+f;
b.col=g;
var h="";
while(a!=""&&"0123456789".indexOf(a.charAt(0))!=-1) {
h+=a.charAt(0);
a=a.substring(1)
}var i=ga(h,10);
if(qa(i)||i==0)i=null;
b.row=i;
return b
};
function Ju(a) {
this.z=a;
this.Hi=null;
this.C=null;
this.qR=null;
this.SX=null;
this.Xc=null;
this.YX=null;
this.L5=null;
this.iY=true
}Ju[_P].jS=function (a) {
this.Hi=a
};
Ju[_P].copy=function (a,b,c) {
this.Hi=a;
var d=this.z,e=d.activeGrid;
this.C=e;
this.qR=e.info.rowsTOids[e.O];
this.SX=e.info.colsTOids[e.Y];
var f=e.ma,g=e.Z;
if(b==1)f=1;
else if(b==2)g=1;
this.Xc=f;
this.YX=g;
this.L5=d.cellSelection.db[I];
if(f*g>1000&&c&&this.iY) {
d.Hg().gi(_M[398](1000),"",5000,true);
this.iY=false
}
};
Ju[_P].paste=function (a,b) {
var c=
this.z;
if(!c.modalDbox) {
var d=this.Hi;
if(b) {
if(d!=null)this.OD()
}else if(d!=null&&Zf&&!a)this.OD();
else {
var e=c.cellSelection.db[I].replace(/\r\n/mg,"\n"),f=this.L5;
if(Wf)if(e==f+"\n")e=f;
if(f!=null)f=f.replace(/\r\n/mg,"\n");
if(d==null||f!=null&&e!=f) {
this.Hi=null;
this.A8()
}else this.OD()
}if(d==X.newPasteCut)this.Hi=null;
var g=this.IB(c.activeGrid);
c.iF(g)
}
};
Ju[_P].OD=function () {
if(this.z.modalDbox==null) {
var a=this.z.activeGrid;
if(this.Hi!=null&&this.qR!=null&&a!=null&&a.O!=null) {
var b=this.C,c=
b.info,d=c.idsTOrows[this.qR],e=c.idsTOcols[this.SX],f=this.Xc,g=this.YX,h=a.O,i=a.Y,j=a.ma,k=a.Z,m=oo+"=9";
m+="&atyp="+this.Hi;
var n=c.rowsTOids,q=c.colsTOids;
m+="&gid="+b.id;
m+="&srow="+n[d];
m+="&scol="+q[e];
m+="&erow="+n[d+f-1];
m+="&ecol="+q[e+g-1];
var p=a.info.rowsTOids,s=a.info.colsTOids;
m+="&pgi="+a.id;
m+="&pri="+p[h];
m+="&pci="+s[i];
m+="&peri="+p[h+j-1];
m+="&peci="+s[i+k-1];
this.z.Bb(_M[4]);
this.z.Ab(m,false);
if(f*g!=1)if(j*k==1||j==f&&k==g||j<f||k<g) {
var u=o.min(f,a.Ha()-h+1),v=o.min(g,a.Ba-
i+1);
a.dc(h,i,h+u-1,i+v-1,true)
}else if(j>f||k>g) {
var t=o.floor(j/f),w=o.floor(k/g);
a.dc(h,i,h+f*t-1,i+g*w-1,true)
}
}
}
};
Ju[_P].P1=function (a,b,c,d) {
return this.IB(a,b,c,d)[0]
};
Ju[_P].IB=function (a,b,c,d) {
var e=Vd(b)?b:"\n",f=Vd(c)?c:"\t",g=0,h=0,i=0,j=0,k="",m=new Im;
if(a!=null) {
var n=a.O;
if(n!=null) {
var q=1,p=true,s=true,u=a.Y,v=a.ma,t=a.Z,w,B,A=false;
if(v*t>1001) {
h=-1;
s=false
}for(w=0;w<v&&p;w++) {
for(B=0;B<t&&p;B++) {
	var G=wu(a.Ld(n+w,u+B));
	if(d&&(!G||G==""))A=true;
	else {
		if(s) {
			var H=a.info.B1(n+w,u+
			B);
			if(H!=null) {
				g+=H;
				h++;
				if(h==1) {
					j=H;
					i=H;
					k=G
				}else if(j<H)j=H;
				else if(i>H)i=H
			}
		}m.append(G);
		A=false
	}if(B<t-1)if(!d||!A)m.append(f);
	q++;
	if(q>1000)p=false
}if(!d||!A)m.append(e)
}
}
}var Q={
};
Q[0]=m.toString ();
Q[1]=h;
if(h>1) {
var K=Ku(g/h);
g=Ku(g);
if(k.charAt(k[E]-1)=="%") {
K=Lu(K);
g=Lu(g);
i=Lu(i);
j=Lu(j)
}Q[5]=K;
Q[2]=g;
Q[3]=i;
Q[4]=j
}return Q
};
Ju[_P].np=function (a) {
if(a&&a.O!=null) {
var b=this.z.cellSelection.db,c=this.IB(a);
Ta(b,c[0]);
this.z.iF(c);
b.focus();
b.select()
}
};
Ju[_P].A8=function () {
var a=this.z;
if(a.modalDbox==
null) {
var b=a.activeGrid;
if(this.Hi==null&&b!=null&&b.O!=null) {
var c=a.cellSelection.db[I],d=b.O,e=b.Y;
if(c[E]>50000)a.Hg().gi(_M[30],"",null,true);
else if(c.indexOf("\t")==-1&&c.indexOf("\n")==-1)b.cx(b.Md(),b.info.rowsTOids[d],b.info.colsTOids[e],c);
else if(c[E]>0) {
var f=oo+"=9";
f+="&atyp="+X.pasteFromClip;
f+="&pgi="+b.id;
f+="&pri="+b.info.rowsTOids[d];
f+="&pci="+b.info.colsTOids[e];
f+="&v="+fa(c);
var g=1,h=1,i=c.split("\n");
if(i!=null) {
	g=o.max(1,i[E]-1);
	i=i[0].split("\t");
	if(i!=null)h=o.max(1,
	i[E])
}g=o.min(g,b.Ha()-d+1);
h=o.min(h,b.Ba-e+1);
b.dc(d,e,d+g-1,e+h-1,true);
f+="&nrow="+g;
f+="&ncol="+h;
a.Bb(_M[4]);
a.Ab(f,true)
}
}
}
};
function Mu(a,b,c) {
this.VZ=[];
this.j=a;
this.oa=b;
this.yg=c;
this.qc=false;
var d=Tk(b,c,"","");
x(d[J],"100%");
Nb(d,"center");
this.R=d;
this.lJ=null
}Mu[_P].pS=function (a) {
var b=this.lJ;
if(b==null) {
b=Uk(this.R,20,"disclaimer");
C(b[J],"none");
this.lJ=b;
this.VZ.push(b)
}y(b,a)
};
Mu[_P].MJ=function (a) {
if(a!=this.qc) {
C(this.lJ[J],a?"":"none");
this.qc=a;
this.j.k$()
}
};
Mu[_P].mB=function () {
var a=0,b=this.VZ;
for(var c=0;c<b[E];c++)if(b[c][J][Cd]=="")a++;return a*20
};Mu[_P].wc=function () {
return this.qc
};
Mu[_P].$=
function () {
return this.R
};
var Nu=function (a,b,c,d,e,f,g,h,i) {
af.call(this);
this.qP=a;
this.Ed=b;
this.C=c;
this.ND=d;
this.bl=e.oid;
this.q=new mj(this);
var j=i?this.C.eb().divGrids:null;
this.zW(j);
this.XP(e);
if(f)this.hW();
if(g)this.A4();
if(h)this.ZY();
this.qo(e.rg,e.r1,e.c1,e.r2,e.c2)
};
Nu.inherits(Xh);
var Ou=l[xc][cd]+"//"+l[xc][Md]+"/obj/blank.html",Pu=function (a) {
var b={
},c=a.O,d=a.Y,e=a.info.rowsTOids,f=a.info.colsTOids;
b.rg=a.id;
b.r1=c;
b.c1=d;
b.r2=c+a.ma-1;
b.c2=d+a.Z-1;
var g=d+2,h=a.Ba-4;
if(g>h)g=o.max(1,h);
var i=c;
h=a.Ha()-
8;
if(i>h)i=o.max(1,h);
i=o.max(i,a.Xb+1);
if(i>a.Ha()) {
a.trixApp.cb(_M[364]);
return
}b.ar=e[i];
b.ac=f[g];
var j=16;
b.x=j;
b.y=j;
b.w=450;
b.h=320;
return b
};
Nu[_P].Cc=null;
Nu[_P].ct=null;
Nu[_P].iz=false;
Nu[_P].zA=null;
Nu[_P].Fs=null;
Nu[_P].Es=null;
Nu[_P].Tl=0;
Nu[_P].Ul=0;
Nu[_P].fs=0;
Nu[_P].Eq=0;
Nu[_P].mb=0;
Nu[_P].Tb=0;
Nu[_P].ol=null;
Nu[_P].Ph=null;
Nu[_P].ll=null;
Nu[_P].Un=null;
Nu[_P].Tn=null;
Nu[_P].iD=null;
Nu[_P].Pn=null;
Nu[_P].jd=function () {
return this.qP
};
Nu[_P].V=function () {
return this.C
};
Nu[_P].bb=function () {
return this.bl
};
Nu[_P].Fg=function () {
return new Of(this.Eq,this.fs)
};
Nu[_P].Mb=function () {
return this.mb
};
Nu[_P].Lb=function () {
return this.Tb
};
Nu[_P].Ke=function () {
return this.mb-2*this.ND
};
Nu[_P].Je=function () {
return this.Tb-2*this.ND
};
Nu[_P].fF=function (a) {
this.bl=a
};
Nu[_P].L=function (a) {
this.po(!a)
};
Nu[_P].po=function (a) {
var b=this.iD;
if(b)C(b[J],a?"block":"none")
};
Nu[_P].Eg=function () {
var a=new Im;
if(this.bl!=null)a.append("&oid=",this.bl);
a.append("&otyp=",this.qP);
a.append("&gid=",this.C.id);
a.append("&srow=",
this.Fs);
a.append("&scol=",this.Es);
a.append("&ox=",this.Tl);
a.append("&oy=",this.Ul);
a.append("&ow=",this.mb);
a.append("&oh=",this.Tb);
a.append("&rn0gid=",this.ol);
a.append("&rn0srow=",this.Ph);
a.append("&rn0scol=",this.ll);
a.append("&rn0erow=",this.Un);
a.append("&rn0ecol=",this.Tn);
return a.toString ()
};
Nu[_P].wd=function () {
var a={
};
a.oid=this.bl;
a.rg=this.ol;
a.r1=this.Ph;
a.c1=this.ll;
a.r2=this.Un;
a.c2=this.Tn;
a.ar=this.Fs;
a.ac=this.Es;
a.x=this.Tl;
a.y=this.Ul;
a.w=this.mb;
a.h=this.Tb;
return a
};
Nu[_P].A4=
function () {
var a=T(),b="obj_container_frame_"+this.bb(),c=this.ct=a.b("iframe",{
name:b,id:b,frameBorder:"no",scrolling:"no",height:this.Je(),width:this.Ke(),marginHeight:0,marginWidth:0,src:Ou
}),d=new Gm(c);
this.q.listen(d,"ifload",R(this.W_,this),false);
a.appendChild(this.Cc,c)
};
Nu[_P].W_=function () {
var a=this.ct;
if(a) {
var b=Hg(a),c=T(b),d=this.zA=c.b("div");
c.appendChild(b[Lc],d);
this.iz=true;
this.dispatchEvent("cfready")
}
};
Nu[_P].ZY=function () {
var a=this.V().Be;
this.Pn=vg("iframe",{
height:"1",
width:"1",style:"position:absolute;"
});
xg(a,this.Pn);
this.RD();
var b=this.Cc[uc];
this.q.listen(b,"scroll",R(this.RD,this))
};
Nu[_P].RD=function () {
this.V().Be;
var a=this.Cc;
if(a) {
var b=a[uc],c=b[Cc]+a[Cc]-b[jd]+this.Mb()/2,d=b[Ed]+a[Ed]-b[Ub]+this.Lb()/2,e=this.Pn[J];
e.top=d+"px";
ib(e,c+"px")
}
};
Nu[_P].zW=function (a) {
var b=T(),c=this.Cc=b.b("div",{
"class":"objWrap",style:"padding: "+this.ND+"px;"
});
a=a||this.C.divMain;
if(this.bl==null)Sb(c[J],"hidden");
b.appendChild(a,this.Cc)
};
Nu[_P].hW=function () {
var a=
T(),b=this.Cc,c=a.b("div",{
id:"gadget-transparent-"+this.bb(),className:"objGlasspane"
}),d=c[J];
d.top="0px";
ib(d,"0px");
D(d,"100%");
x(d,"100%");
C(d,"block");
if(S) {
d.background="#FFF";
xa(d,"alpha(opacity=0)")
}a.appendChild(b,c);
this.q.listen(c,Nh,R(this.Ch,this));
this.iD=c
};
Nu[_P].setPosition=function (a,b) {
if(a!=this.Eq||b!=this.fs) {
b=o.max(8,b);
this.Eq=a;
this.fs=b;
this.Bw()
}
};
Nu[_P].Pd=function (a,b) {
this.Tb=a;
if(b)this.Bw()
};
Nu[_P].Do=function (a,b) {
this.mb=a;
if(b)this.Bw()
};
Nu[_P].Va=function (a) {
this.Ed=
a
};
Nu[_P].Hb=function (a,b) {
if(a!=this.mb||b!=this[P]) {
this.mb=a;
this.Tb=b;
this.Bw()
}
};
Nu[_P].qo=function (a,b,c,d,e) {
this.ol=a;
this.Ph=b;
this.ll=c;
this.Un=d;
this.Tn=e
};
Nu[_P].lT=function (a) {
Lb(this.Cc[J],a)
};
Nu[_P].Me=function () {
};
Nu[_P].Kk=function () {
var a=this.C.trixApp;
if(a.Da())return ;
var b=new Im;
b.append(oo,"=",9);
b.append("&atyp=",X.deleteObject);
b.append("&oid=",this.bl);
b.append("&otyp=",this.qP);
a.Ab(b.toString (),false)
};
Nu[_P].updateObject=function (a) {
this.XP(a);
this.qo(a.rg,a.r1,a.c1,a.r2,
a.c2)
};
Nu[_P].deleteObject=function () {
this.dispose()
};
Nu[_P].t5=function (a,b) {
var c=this.fs,d=this.Eq,e=d+this.mb-1,f=c+this.Tb-1;
return a>=d&&a<=e&&b>=c&&b<=f
};
Nu[_P].XP=function (a) {
var b=a.ar,c=a.ac;
this.Fs=b;
this.Es=c;
var d=a.x,e=a.y;
this.Tl=d;
this.Ul=e;
var f=a.w,g=a.h;
this.mb=f;
this.Tb=g;
var h=this.C,i=h.H,j=h.info.idsTOrows[b],k=h.info.idsTOcols[c];
if(j!=null&&k!=null) {
var m=i.K(j),n=i.hd(m)+e,q=m[L][k][Cc]+d;
this.setPosition(q,n);
this.Hb(f,g)
}
};
Nu[_P].Bw=function () {
var a=this.Cc[J],b=S?0:2*
this.ND,c=S?1:0;
x(a,this.mb-b+2*c+"px");
D(a,this.Tb-b+2*c+"px");
a.top=this.fs-1+"px";
ib(a,this.Eq-1+"px");
if(this.ct) {
var d=this.ct[J];
D(d,this.Je());
x(d,this.Ke())
}if(this.Pn)this.RD()
};
Nu[_P].aea=function (a,b,c,d,e,f) {
this.Fs=a;
this.Es=b;
this.Tl=c;
this.Ul=d;
this.mb=e;
this.Tb=f;
this.yr()
};
Nu[_P].Zi=function () {
return null
};
Nu[_P].Rk=function () {
return false
};
Nu[_P].Ch=function () {
var a=this.C;
a.$a.El(this.bl)
};
Nu[_P].S_=function () {
var a=this.Cc[J];
x(a,"100%");
D(a,"100%");
a.top="0px";
ib(a,"0px");
x(this.wb,
"100%");
D(this.wb,"100%")
};
Nu[_P].yr=function (a) {
if(this.AC()||a) {
var b=new Im;
b.append(oo,"=",9);
b.append("&atyp=");
b.append(this.bb()!=null?X.updateObject:X.insertObject);
b.append(this.Eg());
this.C.trixApp.Ab(b.toString (),false)
}
};
Nu[_P].AC=function () {
return true
};
Nu[_P].dispose=function () {
if(!this.N()) {
Nu.B.dispose.call(this);
var a=this.Cc;
if(a) {
if(a[O])a[O].removeChild(a);
this.Cc=null
}if(this.Pn)this.Pn=null;
this.q.dispose()
}
};
var Qu=function (a,b) {
af.call(this);
this.Jq=a;
this.jr={
};
this.AJ={
};
this.eC=this.Jq.V().eb().pathImg;
this.Yo(b);
this.DW(b)
};
te(Qu,af);
Qu[_P].oi=22;
Qu[_P].Rj=4;
Qu[_P].nR=8;
Qu[_P].Bm=null;
Qu[_P].Yu=null;
Qu[_P].ec=null;
Qu[_P].Yo=function () {
throwError("Implement in subclass.");
};
Qu[_P].DW=function (a) {
var b=T(a),c=this.Jq;
for(var d in this.ec) {
var e=this.ec[d],f=e+"-resize";
if(this.jj(e))f=S?"hand":"pointer";
var g=b.b("div",{
className:"objResizer",style:"cursor: "+f
});
if(S) {
g[J].background="#FFF";
xa(g[J],
"alpha(opacity=0)")
}Dh(g,Sh,c.YL,true,c);
b.appendChild(a,g);
this.jr[e]=g
}
};
Qu[_P].Sa=function (a) {
C(this.Bm[J],a?"block":"none")
};
Qu[_P].Vca=function (a) {
this.Sa(false);
var b=this.jr;
for(var c in b)if(a!=c)C(b[c][J],"none")
};Qu[_P].o3=function (a,b,c) {
var d=a.Fg(),e=d.x,f=d.y,g=a.Mb(),h=a.Lb(),i=g/h,j=this.nR,k=this.Rj;
if(this.jj(b)) {
var m=this.aq(b,c);
f=m.y;
e=m.x
}else {
if(this.tv(b))g=c[Mc]+j-k-e;
if(this.yC(b)) {
e=c[Mc]+k;
g-=e-d.x
}if(this.xC(b))h=c.top+j-k-f;
if(c.browserEvent[sd])if(this.tv(b)||this.yC(b))h=
o.round(g/i);
else g=o.round(h*i)
}return new Qf(e,f,g,h)
};
Qu[_P].L=function (a,b) {
if(a) {
this.qJ();
this.H8(b)
}else {
this.Sa(false);
var c=this.jr;
for(var d in c)C(c[d][J],"none");this.qJ()
}
};Qu[_P].H8=function (a) {
var b=this.dQ(a);
this.Va(a);
this.Sa(true);
this.Mr(a);
this.I8(a,b)
};
Qu[_P].qJ=function () {
var a=this.AJ;
for(var b in a) {
var c=a[b];
Kh(c);
c.dispose()
}this.AJ={
}
};
Qu[_P].dQ=function (a) {
var b=a.Fg(),c=this.Bm[J],d=this.Rj,e=this.oi,f=b.y-e-1,g=b.x-d-1,h=e+a.Lb()+d+2,i=a.Mb()+2*d+2;
c.top=f+"px";
ib(c,
g+"px");
D(c,h+"px");
x(c,i+"px");
var j=this.Yu[J];
x(j,a.Mb()+"px");
D(j,a.Lb()+"px");
return new Qf(g,f,i,h)
};
Qu[_P].I8=function (a,b) {
var c=this.Jq,d=b[Mc],e=b.top,f=b[P],g=b[F],h=this.nR,i=this.oi,j=a.V().HL();
j[F]-a.Mb();
j[P]-a.Lb();
for(var k in this.ec) {
var m=this.ec[k],n=this.jr[m],q=n[J],p=new Qf(d,e,h,h);
if(this.jj(m))p=this.Rq(m,p,g);
else {
if(this.xC(m))p.top+=f-h;
else if(m!=this.ec.NORTH)p.top+=i;
if(this.tv(m))p.left+=g-h;
if(m==this.ec.SOUTH) {
x(p,o.max(g-2*h,2));
p.left+=h
}else if(this.yN(m))D(p,
o.max(f-h-i,2))
}q.top=p.top+"px";
ib(q,p[Mc]+"px");
x(q,p[F]+"px");
D(q,p[P]+"px");
C(q,"block");
var s=this.yB(),u=100,v=0,t=0,w=j[F]-h,B=j[P]-h;
if(this.jj(m)) {
var A=this.$p(m,g,f,j[F],j[P]);
v=A[Mc];
t=A.top;
w=A[Qd];
B=A[ld]
}else {
if(this.tv(m))v=d+s-h;
if(this.yC(m))w=d+g-s;
if(this.xC(m))t=this.JB(a,e,i,u,h);
if(m==this.ec.SOUTH)v=w=p[Mc];
else if(this.yN(m))t=B=p.top
}w=o.max(w,v);
B=o.max(B,t);
var G=new Qf(v,t,w-v,B-t),H=new tj(n,null,G);
this.AJ[k]=H;
Dh(H,"start",R(c.e3,c,m),true,this);
Dh(H,"drag",R(c.c3,
c,m),true,this);
Dh(H,"end",c.d3,true,c)
}
};
Qu[_P].yB=function () {
return 100
};
Qu[_P].tv=function (a) {
return a==this.ec.EAST||a==this.ec.SOUTHEAST
};
Qu[_P].yC=function (a) {
return a==this.ec.WEST||a==this.ec.SOUTHWEST
};
Qu[_P].xC=function (a) {
return a==this.ec.SOUTH||a==this.ec.SOUTHWEST||a==this.ec.SOUTHEAST
};
Qu[_P].yN=function (a) {
return a==this.ec.EAST||a==this.ec.WEST
};
Qu[_P].jj=function () {
throwError("Implement in subclass");
};
Qu[_P].Rq=function () {
throwError("Implement in subclass");
};
Qu[_P].$p=function () {
throwError("Implement in subclass");
};
Qu[_P].aq=function () {
throwError("Implement in subclass");
};
Qu[_P].JB=function (a,b,c,d,e) {
return b+c+d-e
};
Qu[_P].Va=function () {
throwError("Implement in subclass");
};
Qu[_P].Mr=function () {
throwError("Implement in subclass");
};
Qu[_P].dispose=function () {
if(!this.N()) {
Qu.B.dispose.call(this);
var a=this.Bm;
if(a) {
Kh(a);
Bg(a)
}a=this.lj;
if(a)Kh(a);
this.Bm=null;
this.Yu=null;
var b=this.jr;
for(var c in b) {
var d=b[c];
Kh(d);
Bg(d)
}this.jr=null
}
};
var Ru=function (a,b) {
Qu.call(this,a,b)
};
te(Ru,Qu);
Ru[_P].ec={
NORTH:"n",SOUTH:"s",EAST:"e",WEST:"w",SOUTHEAST:"se",SOUTHWEST:"sw"
};
Ru[_P].lj=null;
Ru[_P].Yo=function (a) {
var b=this.Jq,c="background-color:#efefef;",d="width:"+this.Rj+"px;"+c,e=T(a),f=e.b("td",null);
this.Yu=f;
var g=e.b("a",{
href:"#",className:"objMenuOpn"
}," ");
Dh(g,U,b.PP,false,b);
this.lj=g;
var h=e.b("table",{
cellPadding:"0",cellSpacing:"0",className:"objMover"
},e.b("tbody",null,e.b("tr",{
style:"height:"+this.oi+"px;"+c
},e.b("td",{
colSpan:"3"
},
g)),e.b("tr",null,e.b("td",{
style:d
}),f,e.b("td",{
style:d
})),e.b("tr",{
style:"height:"+this.Rj+"px;"+c
},e.b("td",{
colSpan:"3"
}))));
e.appendChild(a,h);
Dh(h,Sh,b.YL,true,b);
this.Bm=h
};
Ru[_P].Va=function (a) {
var b=this.lj,c=b[M];
Ob(c,a.Ed)
};
Ru[_P].Mr=function (a) {
var b=this.lj,c=b[M],d=b[tc];
if(d>=a.Mb()*0.6) {
Ob(c,"");
d=b[tc]
}this.OO=d
};
Ru[_P].jj=function (a) {
return a==this.ec.NORTH
};
Ru[_P].Rq=function (a,b,c) {
D(b,this.oi);
b.left+=this.lj[tc];
x(b,c-this.lj[tc]);
return b
};
Ru[_P].$p=function (a,b,c,d,e) {
var f=
this.OO-this.Rj,g=-o.round(this.oi/2),h=d-b+this.OO,i=e-c;
return new Jf(g,h,i,f)
};
Ru[_P].aq=function (a,b) {
var c=b.top+this.oi+1,d=b[Mc]+this.Rj+1-this.OO;
return new Of(d,c)
};
Ru[_P].dispose=function () {
if(!this.N()) {
Ru.B.dispose.call(this);
Bg(this.lj);
this.lj=null
}
};
var Su=function (a,b) {
es.call(this,a,a.divGrids);
this.pP=b;
this.Qd=1
};
Su.inherits(es);
Su[_P].Sa=function (a) {
V(this.pP.Cc,a)
};
Su[_P].$X=function () {
this.pP.eE(true);
this.pP.S_()
};
function Tu(a) {
Xh.call(this);
this.C=a;
this.fb={
};
this.Kd=-1;
this.xp=null
}te(Tu,Xh);
Tu[_P].V=function () {
return this.C
};
Tu[_P].p5=function (a) {
var b=this.fb[a];
return b?b.Rk():false
};
Tu[_P].ij=function (a,b) {
switch(b) {
case 1:a.eb().Qm().Am(0,R(this.O4,this,a));
break;
case 2:a.eb().Qm().Am(1,R(this.P4,this,a));
break;
case 3:a.eb().Qm().Am(2,R(this.Q4,this,a));
break
}
};
Tu[_P].O4=function (a) {
Uu(a)
};
Tu[_P].P4=function (a) {
var b=a.eb().Mf();
b.ij(a)
};
Tu[_P].Q4=function (a) {
Vu().ij(a)
};
Tu[_P].Me=function (a) {
var b=
this.fb[a];
if(b)b.Me()
};
Tu[_P].Kk=function (a) {
var b=this.fb[a];
if(b)b.Kk()
};
Tu[_P].dN=function (a,b) {
var c=this.C;
if(!this.fb[a.oid])switch(a.otyp) {
case 1:c.eb().Qm().Am(0,R(this.S4,this,c,a));
return ;
case 2:c.eb().Qm().Am(1,R(this.W4,this,c,a,b));
return ;
case 3:c.eb().Qm().Am(2,R(this.X4,this,c,a));
return
}
};
Tu[_P].S4=function (a,b) {
var c=new Wu(a,b);
this.lC(c,b)
};
Tu[_P].W4=function (a,b,c) {
var d=a.eb().Mf().V4(a,b,c);
this.lC(d,b)
};
Tu[_P].X4=function (a,b) {
var c=new Xu(a,b);
this.lC(c,b)
};
Tu[_P].lC=function (a,
b) {
var c=this.C.eb();
this.fb[b.oid]=a;
if(c.Da())a.po(false);
c.L(false,true)
};
Tu[_P].FU=function (a) {
var b=a.oid,c=this.fb[b];
if(c) {
c.updateObject(a);
if(b==this.Kd) {
this.cf();
this.C.trixApp.P();
this.El(b)
}
}
};
Tu[_P].gJ=function (a) {
var b=a.oid,c=this.fb[b];
if(c) {
var d=this.C.trixApp;
if(b==this.Kd) {
this.cf();
d.P()
}c.deleteObject();
this.fb[b]=null;
c.dispose();
delete this.fb[b];
d.L(false,true)
}
};
Tu[_P].c6=function () {
var a=this.C.trixApp;
if(a.wf&&a.uh) {
var b=a.q0.P0(a.Ze,this.C.id);
if(b)this.mO(b)
}else {
var c=
oo+"=11";
c+="&grid="+this.C.id;
hm(this.C.trixApp.url,c,true,this,this.i9)
}
};
Tu[_P].Lj=function (a) {
var b=this.fb[a];
if(b&&b.jd()==2)b.Lj()
};
Tu[_P].g$=function (a) {
var b=this.fb[a];
if(b&&b.jd()==3) {
b.gR();
b.yr();
this.cf()
}
};
Tu[_P].mO=function (a) {
var b=eval(a),c=this.fb,d=this.C.H;
for(var e=0;e<b[E];e++) {
var f=b[e];
if(f.ar!=null) {
var g=d.uc(d.Le(f.ar));
if(g.Na())if(c[f.oid])this.FU(f);
else this.dN(f)
}
}
};
Tu[_P].i9=function (a) {
if(a[Yc]==4) {
try{
if(a.status!=200)return
}catch(b) {
return
}this.mO(a[pc])
}
};
Tu[_P].E1=
function (a,b) {
var c=-1,d=this.fb;
for(var e in d) {
var f=d[e];
if(f&&f.t5(a,b))c=f.Rk()?e:o.max(c,e)
}return c
};
Tu[_P].OG=function () {
var a=this.C;
C(a.divTop[J],"none");
var b=a.divTop2[J],c=a.H;
x(b,c.Mb());
D(b,c.Lb())
};
Tu[_P].qZ=function () {
var a=this.C;
C(a.divTop[J],"");
a.trixApp.L(true);
this.cf()
};
Tu[_P].d7=function (a,b,c) {
var d=this.fb[a],e=d.Fg();
b+=e.x;
c+=e.y;
var f=this.C.divMain;
b-=f[jd];
c-=f[Ub];
b+=this.C.Dg();
c+=this.C.fd();
return {
x:b,y:c
}
};
Tu[_P].p1=function (a,b,c,d) {
var e=this.fb[a],f=this.d7(a,
b,c);
if(e.jd()==2)f.x+=e.Mb()-d;
return f
};
Tu[_P].D1=function (a) {
var b,c=this.fb[a];
if(c)b=c.jd();
return b
};
Tu[_P].C1=function (a) {
var b=this.fb[a];
if(b) {
var c;
switch(b.jd()) {
case 1:c=new Wu(this.C,b.wd(),true);
break;
case 2:c=new Yu(this.C,b.wd(),false,true);
break;
case 3:c=new Xu(this.C,b.wd(),true);
break
}return new Su(this.C.trixApp,c)
}return null
};
Tu[_P].El=function (a,b,c) {
var d=this.C;
if(d.trixApp.Da())return ;
d.trixApp.P();
var e=this.fb[a];
if(!e) {
this.cf();
return
}if(a==this.Kd&&!b)return ;
this.cf();
e.L(true,c);
this.Kd=a;
e.lT(98);
this.Yt(e).L(true,e)
};
Tu[_P].Yt=function (a) {
return a.jd()==2?this.$i():this.H0()
};
Tu[_P].$i=function () {
var a=this.mfa;
if(!a) {
a=new Zu(this,this.C.divMain);
this.mfa=a
}return a
};
Tu[_P].v9=function (a) {
if(this.N())return ;
var b=this.mu();
this.cf();
if(b)this.El(b.bb(),true,a)
};
Tu[_P].H0=function () {
var a=this.Sea;
if(!a) {
a=new Ru(this,this.C.divMain);
this.Sea=a
}return a
};
Tu[_P].Zi=function (a) {
var b=null,c=this.fb[a];
if(c)b=c.Zi();
return b
};
Tu[_P].mu=function () {
return this.fb[this.Kd]
};
Tu[_P].rC=function (a) {
return this.Kd==a.bb()
};
Tu[_P].cf=function () {
var a=this.fb[this.Kd];
if(a) {
a.lT(10);
a.L(false);
this.Yt(a).L(false,a)
}this.Kd=-1;
this.i4()
};
Tu[_P].Xg=function (a) {
this.kba(!a)
};
Tu[_P].kba=function (a) {
for(var b in this.fb) {
var c=this.fb[b];
if(c)c.po(a)
}
};
Tu[_P].jba=function (a,b,c) {
if(c)this.C.trixApp.P();
var d=this.fb[a];
if(d)d.po(b)
};
Tu[_P].e3=function (a) {
var b=this.C;
if(b.trixApp.Da()) {
this.cf();
return
}b.trixApp.P();
this.$V();
var c=this.fb[this.Kd];
this.Yt(c).Vca(a);
this.dispatchEvent("resizestart")
};
Tu[_P].c3=function (a,b) {
if(this.C.trixApp.Da())return ;
var c=this.fb[this.Kd],d=this.Yt(c).o3(c,a,b);
c.setPosition(d[Mc],d.top);
c.Hb(d[F],d[P]);
this.hP(c)
};
Tu[_P].d3=function () {
if(this.C.trixApp.Da()) {
this.cf();
return
}var a=this.fb[this.Kd],b=a.Fg(),c=b.y-1+(S?1:0),d=b.x,a=this.fb[this.Kd],e=this.C,f=e.trixApp.mouseSelection.Ie(this.C,d,c),g=e.info,h=g.rowsTOids[f[0]],i=g.colsTOids[f[1]],j=e.xa.Wi(f[1])[Cc],k=e.I,m=k.hd(k.K(f[0]));
a.aea(h,i,d-j,c-m,a.Mb(),a.Lb());
if(a.jd()==2&&a.Rk()) {
this.cf();
this.C.trixApp.P();
this.El(a.bb())
}this.dispatchEvent("resizeend")
};
Tu[_P].$V=function () {
var a=this.C.divMain,b=this.xp;
if(!b) {
var c=T(a);
b=c.b("div",{
className:"objGlasspane"
});
c.appendChild(a,b);
this.xp=b
}var d=this.fb[this.Kd],e=this.yJ;
if(!e&&S&&!dg("7")&&d.jd()==2) {
var c=T(a),f="obj_drag_frame_"+this.C.id;
e=c.b("iframe",{
name:f,id:f,frameBorder:"no",scrolling:"no",marginHeight:0,marginWidth:0,"class":"objGlasspaneFrame",ALLOWTRANSPARENCY:"true"
});
c.appendChild(a,e);
this.yJ=e;
var g=c.Y0(e);
g.open();
g.write("<html><head></head>");
g.write('<body style="background-color:transparent"></body></html>');
g.close()
}this.hP(d);
C(b[J],"block");
if(e)C(e[J],"block")
};
Tu[_P].hP=function (a) {
var b=a.Fg(),c=this.yJ,d;
if(c) {
d=c[J];
d.top=b.y+"px";
ib(d,b.x+"px");
D(d,a.Lb()+"px");
x(d,a.Mb()+"px");
C(d,"block")
}d=this.xp[J];
d.top=b.y+"px";
ib(d,b.x+"px");
D(d,a.Lb()+"px");
x(d,a.Mb()+"px");
C(d,"block");
cb(d,"transparent")
};
Tu[_P].i4=function () {
var a=this.xp;
if(a)C(a[J],"none");
var b=this.yJ;
if(b)C(b[J],"none")
};
Tu[_P].PP=function () {
var a=this.Kd,
b=this.fb[a];
if(b) {
var c=this.C;
c.yE(a);
c.trixApp.menuMain.yF(0,0);
var d=b.iD;
if(d) {
b.po(true);
Fh(d,U,R(this.jba,this,a,false,true))
}
}
};
Tu[_P].YL=function (a) {
a.stopPropagation();
a.preventDefault()
};
Tu[_P].y$=function () {
var a=this.Kd,b=this.fb[a];
if(b)b.w$()
};
Tu[_P].z9=function (a) {
this.fb[a.bb()]=a
};
Tu[_P].LZ=function (a,b) {
delete this.fb[a];
if(b)this.Kd=b
};
Tu[_P].dispose=function () {
if(!this.N()) {
Tu.B.dispose.call(this);
var a=this.xp;
if(a) {
Bg(a);
this.xp=null
}var b=this.fb;
for(var c in b) {
var d=b[c];
if(d)d.dispose()
}delete this.fb
}
};
function _getInstanceOfApp(a) {
if(xn()) {
init_M();
var b=bn(a);
return new Y(b)
}
}function _getInstanceOfFileManager(a) {
init_M();
return new zo(a)
};
function $u(a,b,c,d,e) {
this.z=a;
this.vf=b;
this.yg=c;
this.Wb=S;
this.b7=d;
this.UU=false;
this.f4=e;
this.vU=null;
this.Qv=null;
this.Wc=null;
this.C6=null;
this.z6=null;
this.LO=null;
this.D6=null;
this.PO=null;
this.Fh=5;
this.q4=null;
this.r4=null;
this.Rv=null;
this.WO=null;
this.XO=null;
this.XI=null;
this.R=null;
this.Nc(a.doc,c);
this.jp=null
}$u[_P].KO=null;
$u[_P].bB=function () {
var a=this.jp;
if(!a) {
a=new Ur(this.z);
this.jp=a
}return a
};
$u[_P].Nc=function (a,b) {
var c=this.z,d=c.pathImg,e=Zk(a,b,"menuDivs",0,0,"100%",
"34");
this.R=e;
Mb(e[J],"hidden");
var f=su(a,e,"menuMainTbl",this.Fh,3,"","100%","table"),g=f.insertRow(0),h=g[L],i,j,k=[23,24,25,26,27,0,1,2,31,3,4,5,6,22,13];
for(var m=0;m<k[E];m++) {
if(m==5)this.op(a,g,h,_M[56],10,65);
this.As(a,g,d,k[m])
}this.Cl(h[6][M],c,"bold",_M[57]);
this.Cl(h[7][M],c,"italic",_M[58]);
this.Cl(h[8][M],c,"underline",_M[59]);
this.Cl(h[9][M],c,"strikethrough",_M[419]);
this.Dl(h[10][M],1,_M[60]);
this.Dl(h[11][M],2,_M[61]);
this.Dl(h[12][M],-1,_M[62]);
this.Dl(h[13][M],0,_M[63]);
this.Dl(h[14][M],
5,_M[64]);
z(h[15][M],Qk(c,c.JX));
Ea(h[15][M],_M[65]);
z(h[0][M],el(c,c.ex,X.undo));
Ea(h[0][M],_M[52]);
z(h[1][M],el(c,c.ex,X.redo));
Ea(h[1][M],_M[53]);
z(h[2][M],Rk(c,c[nd],X.newPasteCut,true));
Ea(h[2][M],_M[49]);
z(h[3][M],Rk(c,c[nd],X.pasteAll,true));
Ea(h[3][M],_M[50]);
this.Dl(h[4][M],13,_M[51]);
this.op(a,g,h,_M[66],6,60);
this.op(a,g,h,_M[67],11,60);
this.op(a,g,h,_M[68],12,60);
i=g.insertCell(h[E]);
r(i,"menuCheckbox");
if(!this.Wb)x(i[J],"90px");
Rl(a,i,"","","relative",0,0,"","",1000,"checkbox");
i.appendChild(a.createTextNode(" "+
_M[73]));
this.Cl(i,c,"wrap",_M[73]);
j=this.As(a,g,d,28);
this.Dl(j,20,_M[555]);
if(c.fX) {
j=this.As(a,g,d,29);
this.Cl(j,c,"dirLtr",_M[361]);
this.q4=j;
j=this.As(a,g,d,30);
this.Cl(j,c,"dirRtl",_M[362]);
this.r4=j
}i=g.insertCell(h[E]);
r(i,"mergeButton");
var n="<table id=mergeTable class=inactive><tr class=top>";
n+="<td class=r height=4 width=3></td><td class=r></td>";
n+="<td class=r></td><td width=4></td></tr><tr><td class=r></td>";
n+="<td class=r2><div id=mergeWord1 class=word nowrap>";
n+=_M[69]+"</div></td>";
n+="<td class=r><div id=mergeWord2 class=word nowrap>";
n+=_M[70]+"</div></td>";
n+="<td></td></tr><tr class=bottom><td class=r height=3></td>";
n+="<td class=r></td><td class=r></td><td></td></tr></table>";
y(i,n);
this.Rv=a.getElementById("mergeTable");
this.WO=a.getElementById("mergeWord1");
this.XO=a.getElementById("mergeWord2");
z(i,Qk(this,this.G6));
if(pn)this.op(a,g,h,"Protect",14,60);
this.vU=h;
this.Qv=new vl(c,c.getDivApp(),0,d);
if(this.Wb) {
var q=f[pd][0][L],p=0;
for(var m=0;m<q[E];m++)p+=q[m][tc];
x(f[J],p*1.06)
}
};$u[_P].As=function (a,b,c,d) {
var e=b[L][E],f=b.insertCell(e);
r(f,"menuCell");
var g=this.Wb?"20px":"18px",h=Zk(a,f,"menuToolbarNoSel",0,0,g,g);
if(this.f4&&jf(this.f4,e))C(f[J],"none");
else {
y(h,'<img src="'+c+'toolbarAll9.gif" style="position:absolute">');
ib(h[M][J],-18*d);
qb(h,Rk(this,this.EM,h,true));
ab(h,Rk(this,this.EM,h,false))
}return h
};
$u[_P].EM=function (a,b) {
if(a[dc]!="menuToolbarSel")r(a,b?"menuToolbarHover":"menuToolbarNoSel")
};
$u[_P].op=function (a,b,c,d,e) {
var f=b.insertCell(c[E]);
Wa(f[J],"6px");
var g=new Sl(a,f,[[d]],true);
z(g.X[0],Rk(this,this.VT,e,f))
};
$u[_P].Cl=function (a,b,c,d) {
z(a,el(b,b.Wl,c));
Ea(a,d)
};
$u[_P].Dl=function (a,b,c) {
z(a,Rk(this,this.VT,b,a));
Ea(a,c)
};
$u[_P].Aca=function (a,b) {
var c=this.D6;
if(c==null) {
var d=[[_M[51]],[_M[54]],[_M[55]]];
c=new Ml(b.W(),b.getDivApp(),d,false);
var e=c.Gb;
z(e[0].J(),el(b,b.paste,true));
z(e[1].J(),Rk(b,b.paste,true,X.pasteValues));
z(e[2].J(),Rk(b,b.paste,true,X.pasteFormat));
this.D6=c
}var f=this.vf;
if(c.Ka) {
f.P();
return false
}b.P();
c.Sa("",a-4,this.z.divGrids[Ed]-1);
f.Wg(c)
};
$u[_P].gca=function (a,b) {
var c=this.KO;
if(c==null) {
var d=[[_M[16]],[_M[541]]];
c=new Ml(b.W(),b.getDivApp(),d,false);
var e=c.Gb;
z(e[0].J(),R(b.Xj,b,1));
z(e[1].J(),R(b.Xj,b,2));
this.KO=c
}var f=this.vf;
if(c.Ka) {
f.P();
return false
}b.P();
c.Sa("",a-4,b.divGrids[Ed]-1);
f.Wg(c)
};
$u[_P].We=function (a,b) {
if(a==null)this.Rc();
else {
var c=this.vU;
r(c[6][M],av(a)?"menuToolbarSel":"menuToolbarNoSel");
r(c[7][M],bv(a)?"menuToolbarSel":"menuToolbarNoSel");
r(c[8][M],cv(a)?
"menuToolbarSel":"menuToolbarNoSel");
r(c[9][M],dv(a)?"menuToolbarSel":"menuToolbarNoSel");
var d=xu(a,"whiteSpace","white-space"),e=c[19][M];
La(e,d==="normal"?true:false);
if(this.z.fX) {
r(this.q4,ev(a)?"menuToolbarNoSel":"menuToolbarSel");
r(this.r4,ev(a)?"menuToolbarSel":"menuToolbarNoSel")
}var f=this.Rv,g=tu(a,b),h=f[dc];
if(g>1&&g==b.Z) {
if(h!="apart") {
r(f,"apart");
Ea(f,_M[122]);
y(this.WO,_M[71]);
y(this.XO,_M[72])
}
}else {
tm(this.WO,_M[69]);
tm(this.XO,_M[70]);
if(b.Z>1) {
r(f,"active");
Ea(f,_M[120])
}else {
r(f,
"inactive");
Ea(f,_M[121])
}
}
}
};
$u[_P].Rc=function (a) {
var b=this.vU;
r(b[6][M],"menuToolbarNoSel");
r(b[7][M],"menuToolbarNoSel");
r(b[8][M],"menuToolbarNoSel");
r(b[9][M],"menuToolbarNoSel");
La(b[19],false);
if(a!=false) {
r(this.Rv,"inactive");
Ea(this.Rv,_M[121])
}
};
$u[_P].G6=function () {
var a=this.z,b=this.Rv[dc];
if(b==="active")a.merge(true);
else if(b==="apart")a.merge(false)
};
$u[_P].uca=function (a,b) {
var c=this.C6;
if(c==null) {
var d=null;
d=[["0"],["1"],["2"],["3"],,["4"],["5"],["6"],["7"],,["8"],["9"]];
var e=9;
if(cn) {
e++;
d.push([e.toString ()])
}e++;
d.push([e.toString ()]);
c=new Ml(b.W(),b.getDivApp(),d,false);
var f=c.Gb;
z(f[0].J(),Rk(b,b.Fc,X.rowInsert,true));
z(f[1].J(),Rk(b,b.Fc,X.rowInsertAfter,true));
z(f[2].J(),el(b,b.Fc,X.rowInsert));
z(f[3].J(),el(b,b.Fc,X.rowInsertAfter));
z(f[5].J(),Rk(b,b.Fc,X.colInsert,true));
z(f[6].J(),Rk(b,b.Fc,X.colInsertAfter,true));
z(f[7].J(),el(b,b.Fc,X.colInsert));
z(f[8].J(),el(b,b.Fc,X.colInsertAfter));
z(f[10].J(),el(b,b.Xj,1));
z(f[11].J(),Qk(b,b.up));
e=11;
if(cn)z(f[++e].J(),
el(b,b.Xj,2));
z(f[++e].J(),el(b,b.Xj,3));
this.C6=c
}var g=this.vf;
if(c.Ka) {
g.P();
return false
}var h=b.activeGrid,i=h.ma,j=h.Z,k=i!=h.Ha()&&j==h.Ba,m=i==h.Ha()&&j!=h.Ba;
c.ea(0,_M[102]);
c.ea(1,_M[103]);
c.ea(2,_M[104](i));
c.ea(3,_M[105](i));
c.ea(5,_M[106]);
c.ea(6,_M[107]);
c.ea(7,_M[108](j));
c.ea(8,_M[109](j));
c.ea(10,_M[16]);
c.ea(11,_M[17]);
e=11;
if(cn)c.ea(++e,_M[541]);
c.ea(++e,_M[479]);
if(k) {
c.ea(5,null);
c.ea(6,null);
c.ea(7,null);
c.ea(8,null)
}else if(m) {
c.ea(0,null);
c.ea(1,null);
c.ea(2,null);
c.ea(3,
null)
}if(i==1) {
c.ea(2,null);
c.ea(3,null)
}if(j==1) {
c.ea(7,null);
c.ea(8,null)
}b.P();
c.Sa("",a-4,b.divGrids[Ed]-1);
g.Wg(c)
};
$u[_P].kca=function (a,b) {
var c=b.activeGrid,d=this.z6;
if(d==null) {
var e=[["1"],["2"],[_M[110]],[_M[606]]];
d=new Ml(b.W(),b.getDivApp(),e,false);
var f=d.Gb;
z(f[0].J(),el(b,b.Fc,X.rowDelete));
z(f[1].J(),el(b,b.Fc,X.colDelete));
z(f[2].J(),Qk(b,b.pI));
z(f[3].J(),el(b,b.gp,X.clearUserComment));
this.z6=d
}var g=this.vf;
if(d.Ka) {
g.P();
return false
}var h=c.O,i=c.Y,j=c.ma,k=c.Z;
if(j>1)d.ea(0,
_M[95](h,h+j-1));
else d.ea(0,_M[94](h));
var m=Cs(i);
if(k>1)d.ea(1,_M[97](m,Cs(i+k-1)));
else d.ea(1,_M[96](m));
b.P();
d.Sa("",a-4,b.divGrids[Ed]-1);
g.Wg(d)
};
$u[_P].Cca=function (a,b) {
var c=this.PO;
if(c==null) {
var d=[];
for(var e=0;e<20;e++)d.push([""]);d.push(null,["Protect sheet..."],["Protect range..."],null,["Manage protection..."]);c=new Ml(b.W(),b.getDivApp(),d,false);this.PO=c;var f=c.Gb,g=21;z(f[g++].J(),R(b.sF,b,true,false));z(f[g++].J(),R(b.sF,b,true,true));g++;z(f[g++].J(),R(b.sF,b,false,false));
this.Bga=[]
}var h=this.vf;if(c.Ka) {
h.P();
return false
}var i=b.activeGrid,j=b.Ti().BL(i.id),k=0;
for(var e=0;e<j[E]&&k<20;e++) {
var m=j[e];
if(this.XS(b,m,k,true)) {
var n=c.Gb[k];
z(n.J(),R(this.T7,this,m));
k++
}
}for(;k<20;k++)c.ea(k,null);b.P();c.Sa("",a-4,b.divGrids[Ed]-1);h.Wg(c)
};$u[_P].XS=function (a,b,c,d) {
var e=this.PO,f=a.activeGrid;
if(!e.Ka&&!d||b[Xc]!=f.id)return false;
var g=e.Gb[c],h=f.Lc()+(b.range?"!"+b.range:"");
if(!b.ownPermissions[di.EDIT]) {
g.Cj("Locked "+h);
if(d)g.enable(false);
return true
}if(b.ownPermissions[di.ADVISORY_LOCK]) {
var i=
b.Wx;
if(!i)g.Cj("Unlock "+h);
else {
var j=o.ceil((i-ne())/1000);
g.Cj("Relock "+h+" (auto in "+j+"s)");
fi(R(this.XS,this,a,b,c),1000)
}if(d)g.enable(true);
return true
}return false
};
$u[_P].T7=function (a) {
var b=a.Wx;
if(!b)a.unlock();
else a.relock()
};
$u[_P].WU=function (a,b) {
if(a) {
this.b7=a;
this.UU=true
}if(b)this.Qv.Gaa(b)
};
$u[_P].XY=function (a,b) {
var c=new Ml(b.W(),b.getDivApp(),a,true,b.pathImg,b.divGrids);
this.OJ(c,b);
this.LO=c
};
$u[_P].OJ=function (a,b) {
var c=a.Gb;
for(var d=0;d<c[E];d++) {
var e=c[d];
if(e!=
null&&e.jd()!=3)if(!e.subMenu) {
var f=e.jd();
if(f==2)z(e.WA().X[0],el(this,this.DH,e));
else if(f==4)this.XI=e;
else z(e.J(),el(this,this.DH,e))
}else if(e&&e.subMenu)this.OJ(e.subMenu,b)
}
};
$u[_P].wca=function (a,b) {
var c=this.LO;
if(this.UU) {
if(c!=null) {
c.cleanup();
c=null
}this.UU=false
}if(c==null) {
this.XY(this.b7,b);
c=this.LO
}var d=this.vf;
if(c.Ka) {
d.P();
return false
}b.P();
c.Sa("",a-4,b.divGrids[Ed]-1);
d.Wg(c)
};
$u[_P].DH=function (a) {
var b=this.z,c=a.Cn,d="",e=a.jd();
if(e==2||e==1) {
var f=c[0],g="",h=0;
if(this.XI)h=this.XI.WG;
if(a.jd()==2) {
g=a.l1().replace(/\s+/,"");
g=h==0?"'"+g+" '":"' "+g+"'"
}else g=c[1];
d=h==0?g+f:f+g
}else d=c;
b.activeGrid.Zf(X.numberFormat,d,_M[4]);
b.L()
};
$u[_P].VT=function (a,b) {
var c=this.z;
if(c.Ya(true)) {
var d=b[Cc]+this.Fh;
if(a==10)this.wca(d,c);
else if(a==11)this.uca(d,c);
else if(a==12)this.kca(d,c);
else if(a==13)this.Aca(d,c);
else if(a==20)this.gca(d,c);
else if(a==14)this.Cca(d,c);
else {
var e=this.Qv,f=e.actualtype==a;
if(e.isOpen())c.P();
else if(this.Wc!=null) {
c.P();
f=false
}else {
c.P(this);
f=false
}if(!f) {
e.Yaa(o.max(0,a),a);
var g="color";
if(a==0)g="backgroundColor";
else if(a==1)g="fontFamily";
else if(a==2)g="fontSize";
else if(a==5)g="borders";
else if(a==6)g="align";
d-=4;
var h=c.divGrids[Ed]-1;
if(g=="color"||g=="backgroundColor")this.bB().D(true,g,d,h);
else e.open(d,h,g)
}
}c.L(false,true)
}else c.L()
};
$u[_P].Yk=function (a,b) {
var c=this.z;
if(b=="fontSize")c.activeGrid.Tc(b,a+"0%",true);
else if(b=="borders")c.activeGrid.Zf(X.borders,a,_M[4]);
else c.activeGrid.Tc(b,a,true);
c.L()
};
$u[_P].P=
function () {
var a=this.Qv;
if(a)a.close();
if(this.jp)this.bB().D(false)
};
$u[_P].$=function () {
return this.R
};
Ra($u[_P],function () {
if(this.R!=null)y(this.R,"");
this.Qv=null;
if(this.jp) {
this.jp.dispose();
this.jp=null
}
});
function fv(a,b,c) {
this.z=a;
this.vf=b;
this.yg=c;
this.Wb=S;
this.Fh=5;
this.f0=null;
this.g0=null;
this.h0=null;
this.R=null;
this.E6=null;
this.Nc(a.doc,c)
}fv[_P].Nc=function (a,b) {
var c=this.z,d=Zk(a,b,"menuDivs",0,0,"100%","34");
this.R=d;
var e=su(a,d,"menuMainTbl",this.Fh,3,"100%","100%","table");
e[J].tableLayout="fixed";
var f=e.insertRow(0),g=f.insertCell(0);
this.g0=Ql(a,g,"A1","");
this.h0=Ql(a,g,"","");
r(g,"menuMainFormu");
z(g,Qk(c,c.NV));
this.f0=g;
g=f.insertCell(1);
Nb(g,"right");
var h=g[J];
wb(h,"6px");
h.verticalAlign="bottom";
Wa(h,"6px");
x(h,"150px");
var i=new Sl(a,g,[[_M[311]]],true);
this.Dga=i;
var j=i.X[0];
z(j,el(this,this.Dca,g));
Ea(j,_M[312]);
g=f.insertCell(2);
Nb(g,"right");
h=g[J];
$a(h,"right");
Ua(h,"solid #ebf2fe 1px");
var k=["Sum","Count","Average","Min","Max","Product","<b>"+_M[117]+"&raquo;</b>"];
for(var m=1;m<=k[E];m++) {
var n=Ql(a,g,k[m-1],"menuMainLink");
z(n,m==k[E]?Qk(c,c.qca):el(c,c.eN,k[m-1]))
}wb(h,"6px");
x(h,380)
};
fv[_P].mx=function (a,b) {
var c=this.g0,d=this.h0;
if(b==null) {
y(c," ");
y(d," ")
}else {
y(c,a);
wp(this.z.W(),d,b)
}
};
fv[_P].oK=function (a) {
if(!this.Wb)x(this.f0[J],a?this.R[tc]-380:"")
};
fv[_P].Dca=function (a) {
var b=this.z,c=b.zd,d,e=this.E6;
if(e==null) {
var f=[[""],[""],[""],[""],[""],[""],[""],[""],[""],[""],[""],,[_M[313]],[_M[314]]];
e=new Ml(b.W(),b.getDivApp(),f,false);
d=e.Gb;
z(d[12].J(),Qk(b.zd,c.V6));
z(d[13].J(),Qk(c,c.xF));
this.E6=e
}d=e.Gb;
var g=c.GK();
for(var h=0;h<10;h++)if(h<g[E]) {
d[h].Cj(mm(g[h]));
z(d[h].J(),el(c,c.DR,g[h]))
}else d[h].Cj(null);
if(g[E]>10) {
d[10].Cj(_M[354]);
z(d[10].J(),Qk(c,c.xF))
}else d[10].Cj(null);
var i=this.vf;
if(e.Ka) {
i.P();
return false
}b.P();
e.Sa("",a[Cc]+6,b.divGrids[Ed]-1);
i.Wg(e)
};
fv[_P].We=function (a) {
if(a==null)this.Rc()
};
fv[_P].Rc=function () {
};
fv[_P].$=function () {
return this.R
};
Ra(fv[_P],function () {
if(this.R!=null)y(this.R,"")
});
function gv(a,b,c,d,e,f) {
var g=b.createElement("iframe");
r(g,"tiles");
g.frameBorder="0px";
g.marginWidth="0px";
g.marginHeight="0px";
var h=g[J];
x(h,e);
D(h,f);
g.scrolling="no";
c.appendChild(g);
this.wb=g;
this.qa=null;
this.C8=0;
this.Sh=0;
this.H=a;
this.gb=c;
this.Mc=d;
this.yw=false;
this.kb=false;
this.Xk=null;
this.uf=null;
this.ji=null;
this.ob=null;
this.If=null;
this.Vw=null;
this.Sg=null;
this.Pe=0;
this.fh=null;
this.Zfa=-1
}var hv=100,iv=200,jv="_gi";
gv[_P].xk=function () {
if(!this.fh)this.fh=new mu(this);
return this.fh
};
gv[_P].Gr=function (a) {
this.Pe=a
};
gv[_P].Il=function () {
return this.Pe==1||this.Pe==2
};
gv[_P].Na=function () {
return this.Pe==3
};
gv[_P].qx=function (a) {
this.uf=a
};
gv[_P].X3=function () {
var a=false;
try{
var b=this.wh(),c=b[ac];
if(c[E]>0&&c!="G")a=true
}catch(d) {
a=true
}if(a) {
this.B9();
return true
}else {
this.Sh=0;
return false
}
};
gv[_P].B9=function () {
if(this.C8<new Date) {
var a=o.min(30000,1000*this.Sh+500);
this.C8=a+ja(new Date);
this.Sh++;
this.XK(this.qa)
}
};
gv[_P].load=function () {
var a=this.H,b=a.V(),c=b.trixApp,
d=a.Zd(this.Mc),e=this.uf;
if(c.uh&&c.wf)this.G0(c.Ze,b,d,e);
else this.XK(kv(b,d,e))
};
gv[_P].XK=function (a) {
this.qa=a;
this.Pe=1;
if(this.fh)this.fh.GX();
var b=this.cq();
if(b==null) {
this.wb.src.replace(a);
this.xw()
}else if(!Wf&&this.Mc>0)this.T$(a);
else {
b[xc].replace(a);
if(Wf)this.xw()
}
};
gv[_P].T$=function (a) {
var b=this.H;
if(b.Iv)this.Pe=0;
else mi(a,R(this.J3,this),"POST")
};
gv[_P].J3=function (a) {
this.Pe=2;
var b=this.H;
if(b.Iv)this.Pe=0;
else this.nV(a[Sc].Gg())
};
gv[_P].G0=function (a,b,c,d) {
var e=b.trixApp.q0;
d=o.min(d,b.Ha());
var f=e.ZK(a,b.id,c,d);
this.nV(f)
};
gv[_P].nV=function (a) {
var b=this.wh();
b.write(a);
b.close();
this.xw()
};
gv[_P].xw=function () {
var a=this.Mc;
if(a>0) {
var b=this.H;
if(b.NW(a,a))b.mQ(a);
else fi(R(this.xw,this),hv)
}
};
gv[_P].IH=function (a) {
if(this.yw)return true;
else if(this.X3()) {
}else {
var b=this.wh(),c=this.cq();
b.window=c;
var d=this.Mc;
b.trixIndex=d;
var e=this.Xk=b.getElementById("tblMain");
if(e) {
var f=b.getElementsByTagName("meta");
if(!e.dirty&&f) {
var g=vm(f,"trixcnt"),h=vm(f,"trixlast");
if(g!=null&&h!=null) {
	var i=b.getElementById("tblMain_"+(g-1));
	if(i)if(i[pd][h])if(!S||b[Yc]=="complete") {
		e.dirty=true;
		this.yw=true;
		this.kb=true;
		this.Jba(g,a);
		var j=this.H.V();
		this.Aba(j,d);
		for(var k=0;k<g;k++)this.Xo(k);this.Pe=3;this.Zfa=vm(f,"lsq");j.info.I4(c[jv],d,d>0);c[jv]=null;if(this.fh)this.fh.M_();j.trixApp.mouseSelection.Iaa(this.wh());return true
	}
}
}
}
}return false
};gv[_P].freezeColumns=function (a) {
var b=a.I,c=this.Sg,d=this.ob,e=this.If,f,g,h,i=this.H.Zd(this.Mc);
for(var j=0;j<d[E];j++) {
f=
d[j];
g=c[j];
h=e[j]+i-1;
for(var k=1;k<g[E];k++)b.Fe(h+k,g[k],f[k],true,true)
}
};gv[_P].j0=function (a) {
fi(R(this.freezeColumns,this,a),iv)
};
gv[_P].Aba=function (a,b) {
var c,d=a.I;
if(this.Mc==0)d.Xba(this.cq().frozRowHTable);
var e=d.qL(true)[b][L][0];
y(e,this.cq().rowHTables);
Bi(e,"height","");
var f=[],g=[],h=e[rd],i=this.ob[E];
for(c=0;c<i;c++) {
f[c]=h[c];
g[c]=f[c][pd]
}this.Vw=f;
this.Sg=g
};
gv[_P].Jba=function (a,b) {
var c=[],d=[],e=[0],f=this.wh(),g=0;
for(var h=0;h<a;h++) {
var i=f.getElementById("tblMain_"+
h);
c[h]=i;
var j=i[pd];
d[h]=j;
g+=j[E]-1;
e[h+1]=g
}this.ji=c;
this.ob=d;
this.If=e;
this.qx(g+b)
};
gv[_P].K=function (a) {
var b=this.vu(a),c=this.ob[b];
return c?c[a-this.If[b]]:null
};
gv[_P].vu=function (a) {
var b=1;
while(a>this.If[b])b++;
return b-1
};
gv[_P].bu=function (a) {
var b=1;
while(a>this.If[b])b++;
return this.If[b-1]
};
gv[_P].insertRow=function (a,b) {
var c=this.vu(a),d=this.If;
for(var e=c+1;e<d[E];e++)d[e]++;var f=this.ji[c].insertRow(a-d[c]+b);this.Xo(c,10);return f
};gv[_P].deleteRow=function (a,b) {
var c=
this.vu(a),d=this.If,e=a-d[c];
om(this.ji[c],this.ob[c][e],e);
for(var f=c+1;f<d[E];f++)d[f]--;if(this.ob[c][E]==1&&c+b>0) {
var g=this.ji[c][O][O],h=g[O][O];
om(h,g,g.rowIndex);
this.ji[c]=null;
this.ob[c]=[]
}else this.Xo(c)
};
gv[_P].fR=function (a) {
if(this.Na()) {
var b=this.H,c=b.Zd(this.Mc),d=o.min(this.uf,b.V().Ha());
for(var e=d;e>c;e--) {
var f=xu(this.K(e-c),"display","display")=="none";
a.ox(e-1,e-1,f)
}
}
};
gv[_P].lR=function (a,b) {
var c=a<=this.H.V().Ra?this.Sg:this.ob;
for(var d=0;d<c[E];d++) {
var e=c[d];
if(e&&e[E]>0) {
var f=e[0][L][a];
x(f[J],b+"px")
}
}
};
gv[_P].kq=function (a,b) {
var c=this.vu(a),d=this.ob[c],e=this.Sg[c];
if(!d||!e)return ;
var f=a-this.If[c],g=d[f],h=e[f];
if(b) {
var i=this.ji[c][Id]-g[Id];
this.Xo(c,i);
C(g[J],"none");
C(h[J],"none")
}else {
C(g[J],"");
C(h[J],"");
this.Xo(c,10);
this.H.V().I.Fe(a,h,g,false,false,true)
}
};
gv[_P].Xo=function (a,b) {
var c=this.ji[a],d=this.Vw[a];
if(!c||!d||d[E]==0)return ;
if(!Vd(b))b=c[Id];
var e=b>1?"":"none";
if(a+this.Mc>0)C(c[O][O][J],e);
C(d[J],e)
};
gv[_P].zB=function () {
return this.Sg[0][0][L][E]-
1
};
gv[_P].eR=function () {
this.ji=null;
this.ob=null;
this.If=null;
this.yw=false;
this.kb=false
};
gv[_P].Ka=function () {
return this.kb
};
gv[_P].Lb=function () {
var a=this.Xk;
return a?a[Id]:this.gb[Id]
};
gv[_P].Mb=function () {
var a=this.Xk;
return a?a[tc]:this.gb[tc]
};
gv[_P].Pm=function () {
return this.Xk
};
gv[_P].cq=function () {
var a=this.wb;
return Wf?(a[ud]?a[ud][vd]:null):a[Fd]
};
gv[_P].wh=function () {
return this.cq()[mc]
};
gv[_P].D0=function () {
return S?this.wh()[Wc][1][Tb]:this.wh()[Wc][1].cssRules
};
gv[_P].dispose=
function () {
this.H=null;
this.wb=null;
this.Xk=null;
this.eR();
this.ji=null;
this.ob=null;
this.Vw=null;
this.Sg=null;
if(this.fh) {
this.fh.dispose();
this.fh=null
}
};
var lv=function (a) {
this.Qf=[];
this.reset(a)
};
Hb(lv[_P],function (a) {
if(!a)a=0;
Da(this.Qf,a+1);
for(var b=0;b<=a;b++)this.Qf[b]=0
});lv[_P].ox=function (a,b,c) {
var d=this.Qf;
if(c) {
var e=o.max(0,d[b+1]);
for(var f=b;f>=a||f>=0&&d[f]>0;f--) {
e++;
d[f]=e
}var g=b+d[b];
d[g]=-e
}else {
var h=this.Qf[b];
if(h>0) {
var i=b+h;
d[i]=-(h-1)
}for(var f=a;f<=b;f++)d[f]=0;this.Ot(a)
}
};Da(lv[_P],function () {
return this.Qf[E]-1
});
lv[_P].vN=function (a) {
return this.Qf[a]>0
};
lv[_P].Vx=function (a) {
var b=this.Qf[a];
return b>0?a+b:a
};
lv[_P].pU=function (a) {
var b=this.Qf[a];
if(b<=0)return a;
a+=b;
return a+this.Qf[a]-1
};
lv[_P].fN=function (a,b) {
if(b<=0)return ;
var c=new Array(2+b);
c[0]=a;
c[1]=0;
for(var d=2;d<c[E];d++)c[d]=0;var e=this.Vx(a);Array[_P][Hd].apply(this.Qf,c);this.Ot(e+b);this.Ot(a)
};lv[_P].hJ=function (a,b) {
var c=this.Vx(b+1),d=b-a+1;
this.Qf.splice(a,d);
this.Ot(c-d)
};
lv[_P].Ot=function (a) {
var b=0,c=this.Qf;
for(var d=a-1;d>=0&&c[d]>0;d--) {
b++;
c[d]=b
}c[a]=-b
};
var mv=function (a) {
this.j=a;
this.Cd=[];
this.wi=0;
this.Cu=[]
};
mv[_P].Ui=function () {
return this.Cd[this.wi]
};
mv[_P].Xp=function (a) {
return this.Cd[a]
};
mv[_P].haa=function (a) {
if(a<0||a>this.Cd[E]-1)throwError("Sheet index out of bounds.");
this.wi=a
};
mv[_P].qM=function (a) {
var b=this.Cd;
for(var c=0;c<b[E];c++)if(c!=a)b[c].Sa(false)
};mv[_P].hB=function (a) {
for(var b=0;b<b<this.Cd[E];b++)if(a==this.Cd[b])return b;return -1
};mv[_P].faa=function () {
var a=this.Cd,b=this.j.activeGrid;
for(var c=0;c<a[E];c++)if(b==
a[c]) {
this.wi=c;
break
}
};
mv[_P].of=function () {
return this.yh()[E]
};
mv[_P].ou=function (a) {
var b=this.Cd;
for(var c=0;c<b[E];c++) {
var d=b[c];
if(d.Qd==0&&d[yd]==a)return d
}return null
};
mv[_P].pb=function (a) {
return this.Cu[a]
};
mv[_P].vB=function (a) {
return this.yh()[a]
};
mv[_P].yh=function () {
var a=this.Cd,b=[];
for(var c=0;c<a[E];c++)if(a[c].Qd==0)b.push(a[c]);return b
};mv[_P].DS=function (a,b) {
qf(this.Cu,a.id);
this.Cu[b]=a
};
mv[_P].T1=function () {
var a=this.j,b=a.activeGrid.selectedEmbedObjectId;
if(b)return a.activeGrid.$a.C1(b);
return null
};
mv[_P].WL=function (a) {
switch(a) {
case 0:this.j.newGrid(null,null,null,null,null);
break;
case 1:var b=this.T1();
Kb(b,"Gadget");
this.Wo(b,"Gadget",this.wi+1);
break
}
};
mv[_P].gM=function (a) {
var b=this.Ui();
switch(b.Qd) {
case 0:var c=this.j,d=-1;
if(a>=0)d=c.V(a).id;
c.moveGrid(null,d);
break;
case 1:this.mD(b,a,true);
break
}
};
mv[_P].m3=function () {
var a=this.Ui();
switch(a.Qd) {
case 0:this.j.renameGrid(null,null,null,null);
break;
case 1:this.XQ(a,"Gadget Name");
break
}
};
mv[_P].C2=function () {
var a=this.Ui();
switch(a.Qd) {
case 0:this.j.duplicateGrid(null);
break;
case 1:this.Wo(a,this.wi+1,true);
break
}
};
mv[_P].l3=function () {
var a=this.Ui();
switch(a.Qd) {
case 0:this.j.removeGrid(null);
break;
case 1:this.VQ(a,true);
break
}
};
mv[_P].Wo=function (a,b,c) {
if(c)this.Cd.splice(c,0,a);
else this.Cd.push(a);
switch(a.Qd) {
case 0:this.Cu[a.id]=a;
Kb(a,b);
break;
case 1:a.$X();
break
}if(c)this.Wq(c,true)
};
mv[_P].mD=function (a,b,c) {
var d=this.wi;
switch(a.Qd) {
case 0:d=this.Q6(a,b,c);
break
}var e=this.Cd,f=this.hB(a);
if(f>=0) {
e.splice(f,
1);
e.splice(b,0,a)
}this.Wq(d,c)
};
mv[_P].XQ=function (a,b) {
var c;
switch(a.Qd) {
case 0:Kb(a,b);
c=this.j.activeGrid[fc];
break
}this.Wq(c,false)
};
mv[_P].VQ=function (a,b) {
var c;
switch(a.Qd) {
case 0:c=this.K9(a,b);
break
}var d=this.hB(a);
this.Cd.splice(d,1);
this.Wq(c,b,true)
};
mv[_P].Wq=function (a,b,c) {
if(Zf)fi(R(this.hR,this,a,b,c),0);
else this.hR(a,b)
};
mv[_P].hR=function (a,b,c) {
var d=this.Cd,e=this.j.Xe;
e.clear(true);
for(var f=0;f<d[E];f++)e.Bs(d[f][yd],"",false);this.j.QG(a,true,true,b,c)
};mv[_P].Q6=function (a,
b,c) {
if(c==null)c=true;
if(a[fc]!=b) {
var d=this.yh(),e=a[fc];
if(b>e)for(var f=e;f<b;f++)Ia(d[f+1],f);else if(b<e)for(var f=e;f>b;f--)Ia(d[f-1],f)
}Ia(a,b);var g=this.j;if(!c)b=g.activeGrid[fc];return b
};mv[_P].K9=function (a,b) {
if(b==null)b=true;
var c=this.j,d=a[fc]-1;
if(a[fc]==0)d=1;
if(!b&&a!=c.activeGrid)d=c.activeGrid[fc];
c.activate(d,false,false,false,b,true);
a.Sa(false);
this.Cu[a.id]=null;
var e=this.hB(a),f=this.yh();
for(var g=e+1;g<f[E];g++)f[g].index--;if(d>a[fc])d--;delete a;if(Zf&&Uf)if(a.Be)C(a.Be[J],
"none");return d
};function _createStaticConfigApp(a) {
return new nv(a)
};
var nv=function (a) {
af.call(this);
this.pga=a.userName;
this.yea=a.domain
};
nv.inherits(af);
nv[_P].je=null;
var ov="gears_static_config_app_iframe";
nv[_P].lookup=function () {
var a=new Jm(l[xc][od]);
if(a.Tp("new")!=null) {
this.aP(a);
zb(l[xc],a.toString ());
return {
error:true
}
}var b=a.Tp("key");
if(b) {
var c=$e(this.yea),d=new Xs(this.pga,c),e=new gt(d),f=e.O0(b);
if(f) {
var g=ni(f.config),h=ni(f.structure),i=f.firstGridId;
g.action0=h;
g.action1=e.ZK(b,i,0);
return g
}
}this.aP(a);
var j=oa[Lc];
ub(j[J],0);
j[J].margin=
0;
y(j,We('<iframe src="',a.toString (),'" frameborder=0 height="100%" width="100%" id="',ov,'"></iframe>'));
this.je=oa.getElementById(ov);
return {
error:true
}
};
nv[_P].aP=function (a) {
a.Wh(a.Yb.toString ()+"2");
a.Hc.set("cfg",true)
};
nv[_P].dispose=function () {
if(!this.N()) {
nv.B.dispose.call(this);
var a=this.je;
if(a) {
oa[Lc].removeChild(a);
this.je=null
}
}
};
re(nv[_P],"lookup",nv[_P].lookup);
re(nv[_P],"dispose",nv[_P].dispose);
function Z(a,b,c,d) {
es.call(this,a,a.divGrids);
var e=a.Aa;
Ia(this,e.of());
this.id=b;
e.DS(this,this.id);
this.Bc=ga(c?c:200,10);
this.Ba=ga(d,10);
this.H=new pv(this);
this.K3=false;
this.pN=false;
this.Yn=false;
this.rE=false;
this.info=null;
this.Ra=0;
this.Xb=0;
this.lM=null;
this.WB={
};
this.Gk=new lv;
this.$m=new lv;
this.e9=false;
this.Qd=0
}Z.inherits(es);
Z[_P].iM=false;
Z[_P].eb=function () {
return this.trixApp
};
Z[_P].zl=null;
Z[_P].qE=false;
Z[_P].vt=null;
Z[_P].fJ=120;
Z[_P].Hz=17;
Z[_P].Baa=function (a) {
this.fJ=
a
};
Z[_P].Caa=function (a) {
this.Hz=a
};
Z[_P].lB=function () {
return this.Hz+(S?0:1)
};
Z[_P].i1=function () {
return this.Hz-1
};
Z[_P].tC=function () {
return this.info!=null
};
Z[_P].Ha=function () {
return this.Bc
};
Z[_P].QS=function (a) {
this.Bc=a
};
Z[_P].OS=function (a) {
this.Ba=a
};
Z[_P].kF=function (a) {
this.Wfa=a
};
Z[_P].xaa=function (a) {
this.Nea=a
};
Z[_P].Lc=function () {
return this[yd]
};
Z[_P].cg=function (a) {
Kb(this,a)
};
Z[_P].Hv=function (a) {
this.Nc();
var b=this.H;
b.mF(0);
this.trixApp.Bb(_M[128],true);
b.XM();
if(a)b.uc(0).load();
b.mF(1);
b.lQ()
};
Z[_P].Nc=function () {
if(this.tC())return ;
this.info=new qv(this);
var a=this.trixApp.W(),b=Zk(a,this.Cc,"divGrid",0,0,"100%","100%");
this.Be=b;
this.mainGridWid=b[tc]-35;
this.mainGridHei=b[Id]-32;
this.divTop=Zk(a,b,"divTop",0,0,"100%","100%");
this.gr();
this.selectedEmbedObjectId=null;
this.activeRowID=null;
this.activeColID=null;
this.Wfa=null;
this.Nea=null;
var c=Zk(a,b,"divMainArea",35+(Uf?0:1),32,this.mainGridWid,this.mainGridHei);
this.divMain=c;
c.id="g"+this.id;
this.divTop2=Zk(a,c,"divTop",
0,0);
Lb(this.divTop2[J],7);
this.wp=Zk(a,c,"divSelObjs",0,0,"0px","0px");
this.Rz=Zk(a,this.wp,"divActiveCell",-3,-3,"0px","0px");
this.divSelection=Zk(a,this.wp,"divSelection",-3,-3,"0px","0px");
this.divFormulas=Zk(a,this.wp,"divFormuSelect",-3,-3,"0px","0px");
this.divDropSelection=Zk(a,this.wp,"divDropSelection",-3,-3,"0px","0px");
this.I=new rv(this,b);
this.xa=new yu(this,b);
this.$a=new Tu(this);
this.scrollDepth=c[tc]-c[hc]-1;
this.q=new mj(this);
this.f_=this.Yba(b);
this.rl();
this.eventSrc=null;
Ga(this.divTop[J],
"default");
this.lastTblHeight=-1;
this.KS=null;
this.qG=false;
this.Cm=true;
this.Si=0;
this.Ww=0;
this.l4=null;
this.m4=null;
this.n4=null;
this.o4=null;
this.trixApp.ze.K8(this)
};
Z[_P].dR=function () {
this.vt=null
};
Z[_P].M0=function () {
if(!this.vt)this.vt=Ii(this.divMain);
return this.vt
};
Z[_P].FL=function () {
var a={
gid:this.id
},b=this.info,c=b.colsTOids,d=b.rowsTOids,e=this.Y,f=this.O;
a.scol=c[e];
a.srow=d[f];
a.ecol=c[e+this.Z-1];
a.erow=d[f+this.ma-1];
return a
};
Z[_P].Yba=function (a) {
var b=null,c=T(a);
b=c.b("div",
{
"class":"addRowsPlusButton",style:" width: 35px;height: "+this.scrollDepth+"px;"+(this.trixApp.Da()?"display: none;":""),title:_M[460]
},c.createTextNode("+"));
if(S&&dg(7))Bi(b,"bottom","-1");
c.appendChild(a,b);
var d=this.q;
d.listen(b,ih,R(this.S2,this,b));
d.listen(b,jh,R(this.R2,this,b));
return b
};
Z[_P].cba=function (a,b) {
this.q=a;
this.fP=b
};
Z[_P].$Z=function () {
if(this.q) {
this.q.dispose();
this.q=null
}if(this.fP) {
this.fP.dispose();
this.fP=null
}
};
Z[_P].kE=function () {
var a=this.divMain;
vb(a,this.xa.Vp());
wa(a,this.I.Vp())
};
Z[_P].S2=function (a) {
cb(a[J],"#BBBFEF")
};
Z[_P].R2=function (a) {
cb(a[J],"#E8EEF7")
};
Z[_P].jaa=function (a) {
var b=this.f_;
if(b)V(b,a)
};
Z[_P].e$=function () {
var a=this.H;
if(a.Ec())if(!this.pN)this.Yn=true;
else {
this.Yn=false;
this.rE=false;
this.freezeRows(0,true,true);
this.freezeColumns(0,true,true);
a.h$();
return true
}return false
};
Z[_P].Fr=function (a) {
this.trixApp.Aa.DS(this,a);
this.divMain.id="g"+a;
this.trixApp.ze.Zda(this.id,a);
this.id=a
};
Z[_P].gr=function () {
this.Kr(1,1,1,1,1,1)
};
Z[_P].Ar=
function (a,b) {
this.Ga=a;
this.Ea=b;
this.nj()
};
Z[_P].Kr=function (a,b,c,d,e,f) {
this.O=a;
this.Y=b;
this.Ga=c;
this.Ea=d;
this.ma=e;
this.Z=f;
var g=this.H;
if(a&&g&&g.Ec())this.Su(b,b+f-1,a,a+e-1);
this.nj()
};
Z[_P].nj=function () {
if(kn) {
if(this.zl!=null)ei(this.zl);
var a=this.trixApp.cellSelection.isEditBoxActive?rn:qn,b=this.trixApp.gooffiLink;
if(b&&!this.trixApp.wf&&!b.ya.Fd.jc())this.zl=fi(this.R$,a,this)
}
};
Z[_P].R$=function () {
this.zl=null;
if(this.info.rowsTOids) {
var a=this.info.rowsTOids,b=this.info.colsTOids,
c=oo+"=13";
c+="&gid="+this.id;
var d=this.trixApp.cellSelection.isEditBoxActive;
if(d) {
c+="&arow="+this.activeRowID;
c+="&acol="+this.activeColID
}else {
c+="&arow="+a[this.Ga];
c+="&acol="+b[this.Ea]
}c+="&edit="+d;
this.trixApp.L$(c)
}
};
Z[_P].qS=function (a) {
if(a) {
var b=this.Y,c=this.Z,d=this.O,e=this.ma;
this.Su(b,b+c-1,d,d+e-1)
}else this.Su(1,0,1,0)
};
Z[_P].Su=function (a,b,c,d) {
if(this.Bc>300)return ;
if(!this.xa||!this.I||this.trixApp.mouseSelection.rN())return ;
var e=this.Ba,f=o.min(this.l4,e),g=o.min(this.m4,
e);
if(f!=a||g!=b) {
if(b-a+1<e) {
if(f) {
this.Ru(f,o.min(g,a-1),false);
this.Ru(o.max(b+1,f),g,false)
}this.Ru(a,b,true)
}else {
if(f)this.Ru(f,g,false);
a=null;
b=null
}this.l4=a;
this.m4=b
}var h=this.Bc,i=o.min(this.n4,h),j=o.min(this.o4,h);
if(i!=c||j!=d) {
if(d-c+1<h) {
if(i) {
this.Tu(i,o.min(j,c-1),false);
this.Tu(o.max(d+1,i),j,false)
}this.Tu(c,d,true)
}else {
if(i)this.Tu(i,j,false);
c=null;
d=null
}this.n4=c;
this.o4=d
}
};
Z[_P].Ru=function (a,b,c) {
for(var d=a;d<=b;d++) {
var e=this.xa.Wi(d,true);
cb(e[J],c?"#c8c8c8":"")
}
};
Z[_P].Tu=function (a,b,c) {
for(var d=a;d<=b;d++)lj(this.I.K(d,false,true),"on",c)
};Z[_P].S8=function () {
if(this.info.P3)this.$a.c6();
this.e9=true
};
Z[_P].IX=function () {
var a=this.$a;
if(a)a.dispose();
this.$a=new Tu(this)
};
Z[_P].freezeRows=function (a,b,c) {
a=o.max(o.min(10,a),0);
if(b) {
var d=this.xa,e=this.Xb;
if(a>e)d.freezeRows(true,e+1,a);
else if(a<e)d.freezeRows(false,a+1,e,c);
var f=d.Np(0)[L];
if(a==0)for(var g=0;g<f[E];g++)Fb(f[g][J],"none");else if(a>0&&e==0)for(var g=0;g<f[E];g++)Fb(f[g][J],"1px solid #9FC2FD");
var h=e;this.Xb=a;var i=this.I;i.tW(h,a);i.Rb.Re(true);this.nx();if(!c) {
wa(this.divMain,0);
if(S)gm(this,this.vj,0)
}if(Vf)this.rl()
}else {
while(a>0&&this.Mg(a))a--;
if(a>this.Xb&&a>=this.Ha()) {
this.trixApp.cb(_M[385]);
return
}var j=oo+"=9";
j+="&gid="+this.id;
j+="&atyp="+X.freezeRows;
j+="&srow="+a;
var k=this.trixApp;
k.Bb(_M[4],true);
k.Ab(j,false);
k.P()
}
};
Z[_P].nx=function () {
var a=this.xa,b=a.tblMain[Id];
if(this.Si!=b-32-a.JF) {
this.divMain[J].top=b;
this.I.Pba(b);
a.Pd(b);
this.mainGridHei=this.Be[Id]-b;
if(!S)this.mainGridHei-=
4;
D(this.divMain[J],this.mainGridHei);
this.I.Pd(this.mainGridHei);
this.Si=0;
if(this.Xb>0)this.Si=b-32;
else this.m9();
this.H.Nj();
this.dR();
return true
}return false
};
Z[_P].freezeColumns=function (a,b,c) {
a=o.max(o.min(5,a),0);
var d=this.Ra;
if(b) {
var e=this.I;
if(a>d)e.freezeColumns(true,d+1,a,c);
else if(a<d)e.freezeColumns(false,a+1,d,c);
var f=d;
this.Ra=a;
this.I.sW(f,a);
this.xa.Rb.Re(true);
this.Lx();
this.rl()
}else {
while(a>0&&this.Lk(a))a--;
var g=a>d,h=this.trixApp;
if(g&&a>=this.Ba) {
h.cb(_M[468]);
return
}if(a) {
var i=
g?d+1:1,j=g?a-d:a;
if(!h.FH(this,1,i,this.Bc,j)) {
h.cb(_M[473]);
return
}
}var k=new Im;
k.append(oo,"=",9);
k.append("&gid=",this.id);
k.append("&atyp=",X.freezeColumns);
k.append("&scol=",a);
h.Bb(_M[4],true);
h.Ab(k.toString (),false);
h.P()
}
};
Z[_P].Lx=function () {
var a=this.I,b=a.Mb();
if(this.Ra>0)b+=5;
if(this.Ww!=b) {
a.Do(b);
Bi(this.I.hf,"left",-1);
Bi(this.xa.xg,"left",b);
Bi(this.divMain,"left",b-(Uf?1:0)+"px");
this.Ww=b;
return true
}return false
};
Z[_P].rl=function () {
if(!this.tC())return ;
this.dR();
try{
var a=
this.I.jf;
this.mainGridWid=this.Be[tc]-(!a?35:a[tc]);
var b=this.xa.tblMain;
this.mainGridHei=this.Be[Id]-(!b?32:b[Id]);
var c=this.divTop[J];
x(c,this.Be[tc]-this.scrollDepth);
D(c,this.Be[Id]-this.scrollDepth);
if(!S) {
this.mainGridWid-=4;
this.mainGridHei-=4
}c=this.divMain[J];
x(c,this.mainGridWid);
D(c,this.mainGridHei);
this.I.Pd(this.mainGridHei);
this.xa.Do(this.mainGridWid-this.scrollDepth)
}catch(d) {
}
};
Z[_P].U8=function (a) {
var b=a==0,c=this.trixApp,d=this.xa,e=this.I,f=this.H;
this.lastTblHeight=-1;
if(b) {
d.WV();
e.oW();
var g=this.K3;
if(!g) {
this.Z=tu(f.K(1)[L][1],this);
c.mouseSelection.dba(this)
}
}e.Rb.Re(true);
this.vj();
this.lastTblHeight=this.H.Lb();
var h=d.FA,i=e.EA;
if(b) {
if(h>0)this.freezeRows(h,true,g);
if(i>0)this.freezeColumns(i,true,true);
else e.Ef(true,a);
if(Uf&&cg(Yf,"1.9b1")>=0)fi(R(e.Ef,e,true,a),100);
d.rW();
d.Rb.Re(true);
if(Zf&&Uf&&(h>0||i>0||g))this.vj();
this.rl();
c.ai(_M[39](this.Lc()))
}else if(i==0)e.Ef(true,a);
var j=f.Oa[E];
if(f.uc(j-1).Na()) {
if(j>1)c.UR();
this.S8()
}this.K3=true
};
Z[_P].h1=function () {
if(!this.lM) {
var a=
null,b=this.trixApp.W()[Wc],c=null;
for(var d=0;d<b[E];d++)try{
c=b[d];
a=sv(c);
this.lM=c;
break
}catch(e) {
}
}return this.lM
};
Z[_P].HH=function () {
var a=this.Md();
return this.ma>1||a&&this.Z>tu(a,this)
};
Z[_P].tq=function (a,b,c,d) {
c=c?o.max(c,0):0;
d=d?o.max(d,0):0;
var e=this.H,f=this.divMain,g=null,h=-f[Ub],i=-f[jd],j=e.K(a);
if(!j.isFrozenRow&&!j.getAttribute("isFrozenRow")) {
var k=j[L][0],m=e.hd(k[O]),n=m+k[Id],q=f[Ub],p=q+this.mainGridHei-this.scrollDepth+d;
if(q==m) {
}else if(m<q) {
h=o.min(h-(m-q),0);
g=[h,
i]
}else if(n>p) {
h=o.max(h-(n-p),-2000000);
g=[h,i]
}
}if(b>this.Ra) {
var k=e.K(0)[L][b];
m=k[Cc];
n=k[Cc]+k[tc];
q=f[jd];
p=f[jd]+this.mainGridWid-this.scrollDepth+c;
if(n>p) {
i=o.max(i-(n-p),-2000000);
g=[h,i]
}else if(m<q) {
i=o.min(i-(m-q),0);
g=[h,i]
}
}return g
};
Z[_P].Vc=function (a,b) {
var c=this.tq(a,b);
if(c!=null) {
var d=c[0],e=c[1],f=this.divMain;
vb(f,-e);
wa(f,-d);
this.xa.Zh(f[jd]);
this.I.Zh(f[Ub])
}
};
Z[_P].dc=function (a,b,c,d,e) {
this.selectedEmbedObjectId=null;
this.trixApp.cellSelection.Id(true);
this.Zv(a,b,
c,d);
var f=this.O,g=this.Y;
this.Li(f,g,f+this.ma-1,g+this.Z-1);
if(e==true)this.zj(true,false)
};
Z[_P].BC=function (a) {
return this.Z===this.Ba&&a>=this.O&&a<this.O+this.ma
};
Z[_P].EN=function (a) {
return this.ma===this.Bc&&a>=this.Y&&a<this.Y+this.Z
};
Z[_P].J$=function () {
return this.O+this.ma-1==this.Bc
};
Z[_P].Zv=function (a,b,c,d) {
var e=o.min(a,c),f=o.min(b,d),g=this.H,h=g.K(e)[L][f],i=o.max(b,d),j=g.K(o.max(a,c))[L][i],k=o.abs(c-a)+1,m=o.abs(d-b);
m+=o.max(tu(j,this,i),1);
m=o.max(tu(h,this,f),m);
this.Kr(e,
f,this.Ga,this.Ea,k,m)
};
Z[_P].OR=function () {
var a=this.b2(true);
this.Ua(a[0],a[1],true)
};
Z[_P].b2=function (a) {
var b=this.H,c=this.Ho(1),d,e,f,g=this.Ra,h=1;
if(g) {
d=this.I.K(c,false,true);
e=d[L];
f=e[h];
while(this.kd(f)&&h<=g) {
h++;
f=e[h]
}
}if(h==g+1) {
d=b.K(c);
e=d[L];
f=e[h];
while(this.kd(f)) {
h++;
f=e[h]
}
}return a?[c,h]:f
};
Z[_P].G$=function () {
this.selectedEmbedObjectId=null;
var a=this.H,b=this.Io(this.Bc),c=a.K(b),d=this.Ba,e=c[L],f=e[d];
while(this.kd(f)&&d>0) {
d--;
f=e[d]
}if(d>0)this.Ua(b,d,true)
};
Z[_P].Ua=
function (a,b,c) {
this.trixApp.cellSelection.Id(true);
this.selectedEmbedObjectId=null;
this.Ar(a,b);
if(c) {
var d=1,e=tu(this.Ld(a,b),this);
if(e>1)d=e;
this.Kr(a,b,a,b,1,d)
}this.zj(true,c)
};
Z[_P].yE=function (a) {
this.selectedEmbedObjectId=a
};
Z[_P].m9=function () {
var a=this.O,b=this.Y;
this.Li(a,b,a+this.ma-1,b+this.Z-1)
};
Z[_P].yt=function (a,b,c,d,e) {
if(!a)return ;
if(d>0&&e>0)this.Vz(a,b,c,d,e);
else C(a,"none")
};
Z[_P].Li=function (a,b,c,d,e) {
try{
var f=e||this.divSelection,g=f[J],h=this.xa,i=this.I,j,k,m,n=this.trixApp.ze,
q=n.e1(this.id),p=gr;
if(f==this.divFormulas) {
j=h.divFormulasInH[J];
k=i.divFormulasInH[J];
m=i.divFormulasInFFH[J]
}else if(f==this.divSelection) {
j=h.divSelectionInH[J];
k=i.divSelectionInH[J];
m=i.divSelectionInFFH[J]
}else if(f==q[p.SELECTION]) {
j=q[p.SELECTION_IN_HEADER][J];
k=q[p.SELECTION_IN_ROWHEADER][J];
m=q[p.SELECTION_IN_FROZEN_ROWHEADER][J]
}a=this.Ho(a);
c=this.Io(c);
b=this.Nl(b);
d=this.ZF(d);
if(a>c||b>d) {
this.vc(2);
return
}var s=this.FB(a,b),u=this.FB(c,d);
if(!s||!u) {
this.vc(2);
return
}var v=this.Xb,
t=this.Ra,w=b<=t,B=a<=v,A=d>t,G=c>v;
if(n)n.m$(w,B,A,G);
var H=this.vh(b,false),Q=this.vh(d,true),K=this.Km(a,false),sa=this.Km(c,true),aa=this.Si,ia=this.Ww,$=o.max(H-ia,0),ba=o.max(Q-ia,0)-$,db=o.max(K-aa,0),Ya=o.max(sa-aa,0)-db,Ma=o.min(H,ia),eb=o.min(Q,ia)-Ma,Qa=o.min(K,aa),fb=o.min(sa,aa)-Qa;
Qa+=32;
this.yt(m,Ma,Qa,eb,fb);
this.yt(k,Ma,db,eb,Ya);
this.yt(j,$,Qa,ba,fb);
this.yt(g,$,db,ba,Ya);
if(!e||e==this.divSelection)this.Su(b,d,a,c)
}catch(gb) {
}
};
Z[_P].Vz=function (a,b,c,d,e) {
if(S)e=o.max(0,o.min(e,
32768));
ib(a,b);
a.top=c;
x(a,d);
D(a,e);
C(a,"")
};
Z[_P].k6=function () {
var a=this.divSelection[J];
this.Vz(a,0,0,1,1);
C(a,"none");
a=this.divFormulas[J];
this.Vz(this.divFormulas[J],0,0,1,1);
C(a,"none")
};
Z[_P].vc=function (a) {
var b=this.xa,c=this.I;
if(a==0||a==1) {
pm(b.divActiveCellInH);
pm(c.divActiveCellInH);
pm(c.divActiveCellInFFH);
pm(this.Rz)
}if(a==0||a==2) {
pm(b.divSelectionInH);
pm(c.divSelectionInH);
pm(c.divSelectionInFFH);
var d=this.divSelection;
pm(d);
x(d[J],0)
}if(a==0||a==3) {
pm(b.divFormulasInH);
pm(c.divFormulasInH);
pm(c.divFormulasInFFH);
pm(this.divFormulas)
}if(a==0||a==4)pm(this.divDropSelection)
};
Z[_P].Cba=function (a) {
var b=this.divTop[J];
if(a) {
var c=this.O,d=this.Y,e=c+this.ma-1,f=d+this.Z-1;
this.Li(c,d,e,f,this.divDropSelection);
Ga(b,"pointer")
}else {
this.vc(4);
Ga(b,"default")
}
};
Z[_P].XH=function (a,b) {
var c=this.xa,d=this.I,e=a?"#ff9900":"";
this.Js(c.divSelectionInH[J],c.divActiveCellInH[J],e,a&&b);
this.Js(d.divSelectionInH[J],d.divActiveCellInH[J],e,a&&b);
this.Js(d.divSelectionInFFH[J],d.divActiveCellInFFH[J],
e,a&&b);
this.Js(this.divSelection[J],this.Rz[J],e,a&&b);
if(a==true)gm(this,this.XH,200)
};
Z[_P].Js=function (a,b,c,d) {
cb(a,c);
a.borderWidth=d?"3px":"";
a.borderStyle=d?"dotted":"";
b.borderColor=c;
b.borderStyle=d?"dotted":""
};
Z[_P].Vi=function (a) {
var b=[],c=this.I,d=a[O],e=d.isFrozenCol||d.getAttribute("isFrozenCol"),f=d.isFrozenRow==true||d.getAttribute("isFrozenRow"),g=e?c.hf:this.divMain;
b[0]=a[Cc]+g[Cc]-g[jd]+1;
b[1]=e?c.hd(a[O])+32+this.Si-(f?0:this.divMain[Ub]):this.H.hd(a[O])+(f?32:g[Ed]-g[Ub]);
return b
};
Z[_P].F0=function (a) {
var b=a[O],c=b.isFrozenCol||b.getAttribute("isFrozenCol"),d=b.isFrozenRow==true||b.getAttribute("isFrozenRow"),e=this.I,f=this.xa;
return c&&e?(d?e.hf:e.jf):(d&&f?f.xg:this.wp)
};
Z[_P].VK=function (a,b) {
var c=null;
if(b&&!this.Mg(a)&&!this.kd(b)) {
c={
};
var d=b[O],e=d.isFrozenCol||d.getAttribute("isFrozenCol"),f=d.isFrozenRow==true||d.getAttribute("isFrozenRow"),g=e?this.I.hf:this.divMain,h=e?this.I.hd(d)+(f?this.Si+32:-g[Ub]):this.H.hd(d)+(f?32:0),i=Wf,j=S||i?0:1;
c.top=h-
j;
ib(c,b[Cc]-j);
if(i) {
x(c,b[tc]-3);
D(c,b[Id]-3)
}else {
x(c,b[tc]+1);
D(c,b[Id]+1)
}
}return c
};
Z[_P].zj=function (a,b) {
var c=this.trixApp;
c.cellOverlayManager.Rf();
if(this.Cm) {
var d=c.menuMain;
if(d) {
d.Om().mx();
this.Cm=false
}
}if(b)this.vc(0);
else this.vc(1);
var e=this.Md();
if(!a||!e||this.Mg(this.Ga)||this.kd(e)) {
this.Cx(null,250,false);
return
}var f=this.divSelection[J],g=f[Cd]=="",h=this.xa.divSelectionInH;
if(!b&&!c.isPanningOn)if(this.ma>1||this.Z>1) {
if(g)C(f,"");
if(h&&h[J][Cd]=="")C(h[J],"")
}else this.vc(2);
var i=e[O],j=i.isFrozenCol||i.getAttribute("isFrozenCol"),k=i.isFrozenRow==true||i.getAttribute("isFrozenRow"),m=j?(k?this.I.divActiveCellInFFH[J]:this.I.divActiveCellInH[J]):(k?this.xa.divActiveCellInH[J]:this.Rz[J]),n=this.VK(this.Ga,e);
for(var q in n)m[q]=n[q];C(m,"");var p=c.ze;p.ge();l.setTimeout(R(p.Zc,p),0);this.Cx(e,250,false)
};Z[_P].Cx=function (a,b,c) {
this.qG=this.qG||!c;
ei(this.KS);
this.KS=fi(R(this.aV,this,a,!this.qG),b)
};
Z[_P].aV=function (a,b) {
this.qG=false;
var c=this.trixApp;
if(b!=true) {
var d,
e;
if(a!=null) {
var f=this.Ea,g=this.Ga;
e="<B>"+Cs(f)+g+"</B>&nbsp;=&nbsp;";
var h=this.info.rB(g,f),i=this.info.OA(g,f);
if(i==null)i=wu(a);
d=h!=null&&c.mode<2?h:i;
c.ai(d)
}var j=c.menuMain;
if(j)if(d==null) {
j.Om().mx();
j.Rc()
}else {
j.Om().mx(e,d);
j.We(a,this)
}
}if(a!=null)if(!c.cellSelection.isEditBoxActive&&!c.menuMain.w5())c.cellOverlayManager.zca(this);
this.KS=null
};
Z[_P].g1=function () {
return this.xa.divSelectionInH||null
};
Z[_P].M1=function () {
return this.I.divSelectionInH||null
};
Z[_P].a1=function () {
return this.I.divSelectionInFFH||
null
};
Z[_P].OW=function () {
var a=this.I;
return this.divSelection[J][Cd]===""||a.divActiveCellInFFH[J][Cd]===""||a.divSelectionInH[J][Cd]===""||this.xa.divSelectionInH[J][Cd]===""
};
Z[_P].vj=function (a) {
var b=this.H;
b.Nj();
this.zj(true,false);
if(kn)Fm();
if(this.OW()) {
var c=this.O,d=this.Y,e=this.ma,f=this.Z;
this.Li(c,d,c+e-1,d+f-1)
}else {
this.vc(2);
if(a)this.k6()
}this.vc(3);
this.xa.Rb.lH();
this.I.Rb.lH()
};
Z[_P].jM=function () {
var a=this.Ga,b=this.Ea;
if(a!=null&&b!=null) {
var c=this.info.j1(a,b);
if(c==null) {
c=
wu(this.Ld(a,b));
var d=c.toLowerCase();
if(/^((www\.)|((ftp|http|https|gopher|mailto|news|telnet|aim):\/\/))[%A-Za-z0-9$_.+!*(),;
\/?#:@&~=-]+$/.test(d)) {
if(d.indexOf("www.")==0)c="http://"+c;
return c
}
}else return tv(c)
}return null
};
Z[_P].hyperlink=function () {
var a=this.jM();
if(a!=null)jm(a)
};
Z[_P].Md=function () {
return this.Ld(this.Ga,this.Ea)
};
Z[_P].Ld=function (a,b) {
var c=this.FB(a,b);
return c?c[L][b]:null
};
Z[_P].FB=function (a,b) {
if(!this.H.Ec())return null;
return b<=this.Ra?this.I.K(a,false,true):
this.H.K(a)
};
Z[_P].xL=function (a) {
return o.max(this.H.K(a)[Id],this.I.K(a)[Id])
};
Z[_P].HL=function (a) {
var b=this.H,c=this.Bc,d=b.K(c),e=b.hd(d)+d[Id],f=d.isFrozenRow==true||d.getAttribute("isFrozenRow");
if(a&&!f)e+=this.Si;
var g=0,h=d[rd];
for(var i=h[E]-1;i>=0;i--) {
var j=h[i],k=j[tc];
if(k) {
g=j[Cc]+k;
break
}
}return new Rf(g,e)
};
Z[_P].Sa=function (a) {
if(this.tC()) {
var b=this.trixApp;
C(this.Be[J],a?"":"none");
this.pN=a;
if(!a)b.ze.ge();
this.zj(a,false);
if(a) {
var c=b.wf;
if(this.Yn||this.qE&&!c) {
b.reloadGrids([this.id]);
if(!c)this.qE=false
}else if(this.rE)this.H.Nj();
this.rE=false;
this.Yn=false;
this.qE|=c&&b.uh&&b.L3()&&!this.iM;
this.iM=true;
Fm()
}
}
};
Z[_P].vq=function (a) {
if(a&&S)return true;
return this.pN
};
Z[_P].Pt=function () {
this.Yn=true
};
Z[_P].a0=function () {
this.rE=true
};
Z[_P].c$=function () {
if(Uf)if(Zf) {
var a=this.Be[J];
C(a,"none");
gm(this,this.d$,0,a)
}else this.iE()
};
Z[_P].d$=function (a) {
C(a,"");
gm(this,this.iE,0)
};
Z[_P].iE=function () {
var a=this.trixApp;
a.cellSelection.nz(false);
a.activeGrid.zj(true,false);
a.L(true,
true)
};
Z[_P].pn=function () {
var a=this.trixApp;
return a.Da()||pn&&a.Ti().pn(this.id)
};
Z[_P].oC=function () {
var a=this.trixApp;
return a.Da()||pn&&a.Ti().DN(this.id,this.Ga,this.Ea,1,1)
};
Z[_P].yq=function () {
var a=this.trixApp;
return a.Da()||pn&&a.Ti().DN(this.id,this.O,this.Y,this.ma,this.Z)
};
Z[_P].kd=function (a) {
if(Wf)return a[J][Cd]=="none"||kj(a,"dn");
return xu(a,"display","display")=="none"
};
Z[_P].iv=function (a,b,c) {
return this.kd((c<=this.Ra?this.I.K(b,false,true):a.K(b))[L][c])
};
Z[_P].Mg=function (a) {
return this.Gk.vN(a-
1)
};
Z[_P].Lk=function (a) {
return this.$m.vN(a-1)
};
Z[_P].Ho=function (a) {
return this.Gk.Vx(a-1)+1
};
Z[_P].Io=function (a) {
return this.Gk.pU(a-1)+1
};
Z[_P].Nl=function (a) {
return this.$m.Vx(a-1)+1
};
Z[_P].ZF=function (a) {
return this.$m.pU(a-1)+1
};
Z[_P].RQ=function (a,b) {
var c=[],d=0,e;
for(var f=0;f<a[E];f++) {
e=a[f];
if(b[e]==null) {
c[d]=e;
d++
}
}return c
};
Z[_P].U4=function (a,b) {
var c=this.H,d=this.info,e=null,f=null,g,h,i=0;
if(a==X.rowInsertAfter) {
a=X.rowInsert;
i=1
}if(a==X.colInsertAfter) {
a=X.colInsert;
i=1
}this.qS(false);
if(a==X.rowInsert||a==X.rowDelete) {
var j=d.idsTOrows,k=b.r;
if(k==-1) {
i=1;
k=this.Bc
}else k=j[k];
if(k!=null) {
var m=c.Le(k),n=c.uc(m);
if(a==X.rowInsert) {
var q=this.RQ(b.nid,j),p=q[E];
if(n.Na()) {
	var s=c.K(k,false,m)[L],u=null,v=null,t=this.i1()+"px";
	for(h=0;h<p;h++) {
		u=c.insertRow(k,i);
		v=u.insertCell(0);
		for(g=1;g<s[E];g++) {
			e=S?u.appendChild(v.cloneNode(true)):u.insertCell(g);
			var w="";
			if(this.Lk(g)) {
				C(e[J],"none");
				w+=" hdn"
			}if(g<=this.Ra) {
				C(e[J],"none");
				w+=" frz"
			}r(e,"g"+w)
		}r(v,s[0][dc]);
		y(v,"<p>.</p>");
		D(v[rd][0][J],t)
	}this.I.a5(k,p,t,i);
	this.Bc+=p
}d.gH(q,null,k+i);
this.Gk.fN(k+i-1,p)
}else {
var B=j[b.r2];
if(B!=null) {
	var p=B-k+1;
	for(g=0;g<p;g++) {
		this.I.FZ(k);
		c.deleteRow(k);
		this.Bc--
	}d.SQ(k,null,p);
	this.Gk.hJ(k-1,B-1);
	if(this.O+this.ma-1>this.Bc||d.rowsTOids[this.O]==null)this.Ua(this.Bc,this.Y,true)
}
}this.I.aR(k,c);
this.I.Rb.Re(true)
}
}else {
var A=d.idsTOcols,G=b.c;
if(G==-1) {
i=1;
G=this.Ba
}else G=A[G];
if(G!=null) {
var H=this.xa.Np(0),Q=null;
if(a==X.colInsert) {
var q=this.RQ(b.nid,A),p=q[E],K=this.fJ;
c.Xu(G,
p,K,i);
this.xa.Xu(G,p,K,i);
for(g=1;g<=this.Bc;g++) {
	f=c.K(g)[L][G+p];
	Q=uv(f,this);
	if(Q!=null)if(Q!=f)Q.colSpan+=p
}this.Ba+=p;
var sa=this.O,aa=this.Y;
this.Zv(sa,aa,sa+this.ma-1,aa+this.Z-1);
d.gH(null,q,G+i);
this.$m.fN(G+i-1,p)
}else {
var ia=A[b.c2];
if(ia!=null) {
	var p=ia-G+1,$=0;
	for(g=0;g<p;g++)for(h=1;h<=this.Bc;h++) {
		f=c.K(h)[L][G+g];
		Q=uv(f,this);
		if(Q!=null)if(Q==f) {
			$=tu(f,this)-p+g;
			if($>0)this.dD(h,ia+1,$)
		}else Q.colSpan--
	}c.qt(G,p);
	this.xa.qt(G,p,S);
	this.Ba-=p;
	d.SQ(null,G,p);
	this.$m.hJ(G-1,ia-1);
	if(this.Y+
	this.Z-1>this.Ba||d.colsTOids[this.Y]==null)this.Ua(this.O,this.Ba,true);
	this.I.Ef(false)
}
}for(g=G;g<=this.Ba;g++)y(H[L][g],Cs(g));this.xa.Rb.Re(true)
}
}var ba=this.trixApp.cellSelection;if(ba.isEditBoxActive)ba.Eo(true)
};Z[_P].dD=function (a,b,c,d) {
var e=this.H,f=e.K(a,false,d),g=f[L],h=b<=this.Ra,i=this.I,j=i.K(a,false,true),k=h?j[L]:null,m=g[b];
m.mergP=m;
var n=h?k[b]:null,q=h?i.K(0,false,true)[L]:e.K(0)[L],p=c;
for(var s=0;s<c;s++)if(this.kd(q[b+s]))p--;tb(m,p);if(!h)C(m[J],"");if(h) {
tb(n,p);
C(n[J],
"")
}for(var s=1;s<c;s++) {
var u=g[b+s];
y(u,"");
C(u[J],"none");
tb(u,1);
this.info.bz(a,b+s);
u.mergP=m;
if(h) {
u=k[b+s];
y(u,"");
C(u[J],"none");
tb(u,1)
}
}this.I.Fe(a,j,f,false,false)
};
Z[_P].ZP=function (a,b) {
if(Uf&&a<this.Bc) {
var c=this.H.K(a+1)[L][b],d=c[dc];
r(c,"");
gm(this,this.vaa,0,c,d)
}
};
Z[_P].vaa=function (a,b) {
r(a,b)
};
Z[_P].unmergeCells=function (a,b,c,d) {
if(c>1) {
var e=this.H,f=e.K(0)[L],g=e.K(a,false,d),h=g[L],i=b<=this.Ra,j=this.I,k=i?j.K(0,false,true)[L]:null,m=j.K(a,false,true),n=i?m[L]:null;
for(var q=
b;q<b+c;q++) {
var p=h[q];
C(p[J],this.kd(f[q])?"none":"");
tb(p,1);
p.mergP=null;
if(q<=this.Ra) {
p=n[q];
C(p[J],this.kd(k[q])?"none":"");
tb(p,1)
}
}this.I.Fe(a,m,g,false,false)
}
};
Z[_P].oH=function () {
var a=this.Ga,b=this.trixApp.cellSelection.Fp(this,this.H,a,this.Ea,this.Ba);
if(b!=this.Ea&&b!=-1)this.Ua(a,b,true)
};
Z[_P].Pw=function (a,b,c,d,e) {
var f=this.H,g=false;
d=o.max(1,d);
if(c) {
var h,i;
for(var j=a;j<=b;j++) {
h=f.Le(j);
i=f.uc(h);
if(i.Na())this.mR(j,h,d);
else if(i.Il()&&e) {
var k={
};
k.r=this.info.rowsTOids[j];
k.v=d;
i.xk().jl(k,X.resizeRow)
}
}this.$P(a<=this.Xb)
}else {
var m=this.xa;
for(var j=a;j<=b;j++)Bi(m.Wi(j,true),"width",d+"px");g=this.Lx();for(var n=0;n<f.Oa[E];n++) {
var i=f.uc(n);
if(i.Na())for(var j=a;j<=b;j++)i.lR(j,d);else if(i.Il()&&e)for(var j=a;j<=b;j++) {
var k={
};
k.c=this.info.colsTOids[j];
k.v=d;
i.xk().jl(k,X.resizeCol)
}
}if(a<=this.Ra)this.I.gm.Zc();
m.Rb.Re(false)
}if(e)f.Nj();
if(g)this.rl()
};
Z[_P].mR=function (a,b,c) {
var d=this.I.K(a,false,true)[L][0];
if(S)D(d[J],c+"px");
var e=d[rd][0][J],f=c-1+
"px";
e.lineHeight=f;
D(e,f);
e=this.H.K(a,false,b)[L][0][rd][0][J];
D(e,f)
};
Z[_P].$P=function (a) {
if(a)this.nx();
this.xa.qe.Zc();
this.I.Rb.Re(false)
};
Z[_P].Q$=function (a,b,c,d) {
var e=false,f=oo+"=9";
f+="&gid="+this.id;
if(d) {
var g=this.info.rowsTOids,h=g[b],i=g[c];
if(h==null||i==null) {
e=true;
this.trixApp.Af(_M[7],X.errorGeneric,true)
}else {
f+="&atyp="+X.resizeRow;
f+="&srow="+h;
f+="&erow="+i;
f+="&v="+this.I.K(a)[Id]
}
}else {
var j=this.info.colsTOids,h=j[b],i=j[c];
if(h==null||i==null) {
e=true;
this.trixApp.Af(_M[7],
X.errorGeneric,true)
}else {
f+="&atyp="+X.resizeCol;
f+="&scol="+h;
f+="&ecol="+i;
f+="&v="+this.xa.Wi(a)[tc]
}
}if(!e) {
this.trixApp.Bb(_M[4]);
this.trixApp.Ab(f,false)
}
};
Z[_P].N$=function (a,b) {
var c=this.info.colsTOids[a],d=this.info.colsTOids[b];
if(c==null||d==null)this.trixApp.Af(_M[7],X.errorGeneric,true);
else {
var e=new Im;
e.append(oo,"=",9);
e.append("&gid=",this.id);
e.append("&atyp=",X.autoResizeCol);
e.append("&scol=",c);
e.append("&ecol=",d);
this.trixApp.Bb(_M[4]);
this.trixApp.Ab(e.toString (),false)
}
};
Z[_P].rM=function (a,b,c,d) {
var e=this.H,f=this.trixApp.cellSelection;
if(c) {
for(var g=a;g<=b;g++)e.kq(g,d);this.Gk.ox(a-1,b-1,d);this.I.Rb.Re(true);if(d) {
var h=this.Ea,i=f.Ep(this,e,this.Ga,h,this.Bc-1);
if(i==-1)i=f.Mt(this,e,this.Bc,h);
var j=this.Ho(this.O),k=this.Io(this.O+this.ma-1);
if(j<=k) {
this.Ua(i,h,false);
this.Zv(j,this.Y,k,this.Y+this.Z-1)
}else this.Ua(i,h,true)
}
}else {
var m=this.xa,n=e.K(0)[L],q=a;
for(var p=a;p<=b;p++) {
var s=this.kd(n[p]);
if(s&&d||!s&&!d) {
if(p>q) {
	e.cn(this,q,p-1,d);
	m.cn(this,
	q,p-1,d)
}q=p+1
}
}if(p>q) {
e.cn(this,q,p-1,d);
m.cn(this,q,p-1,d)
}this.$m.ox(a-1,b-1,d);
m.Rb.Re(true);
if(d) {
var u=this.Ga,v=f.Fp(this,e,u,this.Ea,this.Ba);
if(v==-1)v=f.oh(this,e,u,this.Ba);
var t=this.Nl(this.Y),w=this.ZF(this.Y+this.Z-1);
if(t<=w) {
this.Ua(u,v,false);
this.Zv(this.O,t,this.O+this.ma-1,w)
}else this.Ua(u,v,true)
}else if(Uf&&b==this.Ba)e.mK(true);
this.I.Ef(false)
}e.Nj()
};
Z[_P].Tc=function (a,b,c) {
if(this.O!=null) {
var d=this.H,e,f,g,h,i,j,k;
for(e=this.O;e<this.O+this.ma;e++) {
g=this.I.K(e,false,
true);
h=g[L];
i=d.K(e);
j=i[L];
for(f=0;f<this.Z;f++) {
k=this.Y+f<=this.Ra?h[this.Y+f][J]:j[this.Y+f][J];
if(a=="clearFmt") {
	k.fontSize="";
	k.fontFamily="";
	k.fontWeight="";
	k.whiteSpace=""
}else k[a]=b
}if(c)this.I.Fe(e,g,i,false,false)
}this.I.Ef(false);
this.xa.qe.Zc();
if(a=="clearFmt")this.Zf(X.clearFmt,"",_M[4]);
else this.Zf(X[a],b,_M[4])
}
};
Z[_P].Jz=function () {
if(this.O!=null) {
var a=this.H,b,c,d,e,f,g,h,i;
for(b=0;b<this.ma;b++) {
h=this.O+b;
d=a.K(h);
e=d[L];
f=this.I.K(h,false,true);
g=i<=this.Ffa?f[L]:null;
for(c=
0;c<this.Z;c++) {
i=this.Y+c;
if(i<=this.Ffa)y(g[i],"");
else y(e[i],"");
this.info.bz(h,i)
}this.I.Fe(h,f,d,false,false)
}this.Zf(X.clear,"",_M[5]);
this.I.Ef(false);
this.aV(this.Md())
}this.trixApp.L()
};
Z[_P].cx=function (a,b,c,d,e,f,g) {
if(b==null||c==null)this.trixApp.Af(_M[7],X.errorGeneric,true);
else {
this.trixApp.Bb(_M[5]);
var h=oo+"=9",i=d?d:wu(a);
if(i.indexOf("=")==0) {
i=g?Bu(i,this.info.idsTOrows[b],this.info.idsTOcols[c]):Bu(i,this.Ga,this.Ea);
h+="&atyp="+X.formula
}else h+="&atyp="+X[I];
h+="&gid="+
this.id;
h+="&srow="+b;
h+="&scol="+c;
if(typeofe=="number"&&typeoff=="number")h+="&erow="+e+"&ecol="+f;
h+="&v="+fa(i);
this.trixApp.Ab(h,true)
}
};
Z[_P].Zf=function (a,b,c) {
var d=this.info.rowsTOids,e=this.info.colsTOids,f=d[this.O],g=e[this.Y],h=d[this.O+this.ma-1],i=e[this.Y+this.Z-1];
if(f==null||g==null||h==null||i==null)this.trixApp.Af(_M[7],X.errorGeneric,true);
else {
this.trixApp.Bb(c);
var j=oo+"=9";
j+="&atyp="+a;
j+="&gid="+this.id;
j+="&srow="+f;
j+="&scol="+g;
j+="&erow="+h;
j+="&ecol="+i;
j+="&v="+
fa(b);
this.trixApp.Ab(j,true)
}
};
Z[_P].DU=function (a,b,c) {
var d=this.H,e=this.I,f=this.info.idsTOcols[c.c],g=e.K(a,false,true),h=d.K(a,false,b);
vu(null,(f<=this.Ra?g:h)[L][f],c.v);
e.Fe(a,g,h,false,false);
this.info.oba(a,f,c)
};
Z[_P].Xda=function (a) {
var b=this.info,c=b.idsTOrows,d=b.idsTOcols,e=c[a.r],f=d[a.c],g=c[a.r2],h=d[a.c2],i=1,j=1;
if(g!=null)i=g-e+1;
if(h!=null)j=h-f+1;
var k=a.css,m=this.H;
for(var n=0;n<i;n++) {
var q=m.Le(e+n),p=m.uc(q);
if(p.Na())this.KU(e+n,q,f,j,k);
else if(p.Il()) {
var s={
};
s.r=
b.rowsTOids[e+n];
s.c=a.c;
s.c2=a.c2;
s.css=a.css;
p.xk().jl(s,X.format)
}
}
};
Z[_P].JU=function (a,b,c,d) {
for(var e=b;e<=c;e++)a[e][J].cssText+=";"+d
};Z[_P].KU=function (a,b,c,d,e) {
var f=this.I,g=f.K(a,false,true),h=this.H,i=h.K(a,false,b),j=c+d-1;
if(c<=this.Ra) {
var k=o.min(j,this.Ra);
this.JU(g[L],c,k,e)
}if(j>this.Ra) {
var m=o.max(this.Ra+1,c);
this.JU(i[L],m,j,e)
}if(e.indexOf("font")!=-1||e.indexOf("whiteSpace")!=-1)f.Fe(a,g,i,false,false);
if(e.indexOf("border")!=-1)h.bordersChanged=true
};
Z[_P].Km=function (a,
b) {
var c=this.H,d=c.K(a);
if(!d)return null;
var e=c.hd(d);
if(a>this.Xb)e+=this.fd();
if(b)e+=d[Id];
return e
};
Z[_P].vh=function (a,b) {
var c=this.xa,d=c.Wi(a,true),e=d[Cc];
if(a>this.Ra)e+=this.Dg();
if(b)e+=d[tc];
return e
};
Z[_P].oea=function (a,b,c,d) {
var e=0,f=0,g="",h="",i="visible";
if(d!=null) {
if(d.r1!=null)f=-this.Km(d.r1);
h=this.Km(d.r2,true)+1;
if(d.c1!=null)e=-this.vh(d.c1);
g=this.vh(d.c2,true)+1
}var j="<div class='divGridPrint'";
j+=" style='overflow:";
j+=i;
j+=";left:";
j+=e;
j+="px; top:";
j+=f;
j+="px; width:";
j+=g;
j+="; height:";
j+=h;
j+="'>";
a.write(j);
a.write("<div class='divMainAreaPrint'>");
if(this.Xb>0) {
j="<div class='framesContainer'><table cellpadding='0'";
j+=" class='tblGenFixed' style='font-size:10pt;'>";
j+=this.xa.tblMain[rc];
j+="</table></div>";
y(c,j);
var k=c[M][M][pd];
for(var m=0;m<k[E];m++)k[m].removeChild(k[m][Vc]);var n=k[0][L],q;for(var m=0;m<n[E];m++) {
q=n[m][J];
D(q,"0");
Pa(q,"none 0");
Fb(q,"none 0");
y(n[m],"")
}D(k[0][J],"0");
a.write(c[rc])
}this.H.qea(a);
a.write("</div></div>")
};
Z[_P].fd=
function (a) {
if(!this.Si)return null;
return this.Si+(a?this.xa.JF:0)
};
Z[_P].Dg=function (a) {
if(!this.Ww)this.Lx();
return this.Ww+(a?5:0)
};
Ra(Z[_P],function () {
var a=this.$a;
if(a) {
a.dispose();
this.$a=null
}var a=this.H;
if(a) {
a.dispose();
this.H=null
}if(this.zl)ei(this.zl);
this.zl=null;
a=this.q;
if(a) {
a.dispose();
this.q=null
}
});
Z[_P].HI=function (a,b,c) {
if(!this.WB[c]) {
var d=this.h1(),e=null,f=0,g=c.split(" ");
for(var h=0;h<g[E];h++) {
e=g[h];
if(!this.WB[e]) {
var i=vv(a,e);
if(i) {
	wv(d,".colHead_"+this.id+" td."+
	e,i);
	wv(d,".rowHead_"+this.id+" td."+e,i);
	this.WB[e]=1;
	f++
}
}
}if(f==g[E])this.WB[c]=1
}
};
Z[_P].dt=function (a,b,c,d,e,f) {
var g=a[L],h=b[L],i,j,k;
while(d>h[E]-1)b.insertCell(-1);
for(var m=c;m<=d;m++) {
i=g[m];
j=h[m];
vu(null,j,wu(i));
if(e) {
k=i[dc];
r(j,k);
if(f)this.HI(i[Nc],j[Nc],k)
}pb(j[J],i[J][bd]);
tb(j,i[gd]);
C(i[J],"none");
if(this.Lk(m))C(j[J],"none")
}b.isFrozenRow=a.isFrozenRow==true||a.getAttribute("isFrozenRow")
};
Z[_P].selectCells=function (a,b,c,d) {
this.Kr(a,b,a,b,c-a+1,d-b+1);
this.dc(a,b,c,d,true)
};
Z[_P].getCellHtml=function (a,b) {
return this.Ld(a,b)
};
Z[_P].getCellFormula=function (a,b) {
return this.info.rB(a,b)
};
Z[_P].getCellValue=function (a,b) {
return this.info.OA(a,b)
};
Z[_P].getCellCoord=function () {
var a=[this.O,this.Y,this.ma,this.Z,this.Ga,this.Ea];
return a
};
Z[_P].getGridDimensions=function () {
var a=[this.Ha(),this.Ba];
return a
};
function qv(a) {
this.C=a;
this.uK=null;
this.Os=[];
this.rowsTOids=null;
this.colsTOids=null;
this.idsTOrows=null;
this.idsTOcols=null;
this.P3=false
}qv[_P].I4=function (a,b,c) {
var d=this.C,e=d.trixApp,f=false;
if(a) {
this.Os[b]=a.ci||[];
if(!c) {
this.uK=a.fx||[];
var g=a.rIds;
if(!g)f=true;
else {
this.rowsTOids=g;
d.QS(g[E]-1);
this.idsTOrows=this.wm(g)
}g=a.cIds;
if(!g)f=true;
else {
this.colsTOids=g;
d.OS(g[E]-1);
this.idsTOcols=this.wm(g)
}d.Fr(a.id);
if(a.eom)this.P3=true
}
}else f=true;
if(f)e.Af(_M[20](d[yd]),X.errorGeneric,
true)
};
qv[_P].gL=function (a) {
var b=this.Os,c=0;
for(var d=0;d<b[E];d++) {
var e=b[d],f=e[E];
if(e&&a<c+f)return d;
c+=f
}return null
};
qv[_P].xu=function (a,b) {
var c=this.Os,d=0;
for(var e=0;e<c[E];e++) {
var f=c[e],g=f[E];
if(f&&a<d+g) {
var h=f[a-d];
if(b&&!h) {
h=[];
f[a-d]=h
}return h
}d+=g
}return null
};
qv[_P].gH=function (a,b,c) {
var d=this.Os;
if(a) {
var e=a[E],f=this.rowsTOids;
for(var g=f[E]-1;g>=c;g--)f[g+e]=f[g];for(var g=0;g<e;g++)f[c+g]=a[g];this.idsTOrows=this.wm(f);c--;var h=this.gL(c);if(h==null)h=d[E]-1;var i=
d[h];c-=this.C.H.Zd(h);for(var g=i[E]-1;g>=c;g--)i[g+e]=i[g];for(var g=0;g<e;g++)i[c+g]=null
}else {
var e=b[E],f=this.colsTOids;
for(var g=f[E]-1;g>=c;g--)f[g+e]=f[g];for(var g=0;g<e;g++)f[c+g]=b[g];var j,k,g=0;for(var m=0;m<d[E];m++) {
k=d[m];
for(var n=0;n<k[E];n++) {
j=k[n];
if(j)for(g=f[E]-1;g>=c;g--) {
	j[g+e-1]=j[g-1];
	j[g-1]=null
}
}
}this.idsTOcols=this.wm(f)
}
};
qv[_P].SQ=function (a,b,c) {
var d=this.Os;
if(b==null) {
var e=this.rowsTOids,f=e[E];
for(var g=a;g<f-c;g++)e[g]=e[g+c];Da(e,f-c);this.idsTOrows=this.wm(e);
a--;var h=this.gL(a);a-=this.C.H.Zd(h);while(c>0&&h<d[E]) {
var i=d[h],j=o.min(c,i[E]-a);
if(a+j<=i[E]) {
var k=i[E]-a-j;
for(var g=0;g<k;g++)i[a+g]=i[a+g+j]
}c-=j;Da(i,i[E]-j);h++;a=0
}
}else {
var e=this.colsTOids,f=e[E];
for(var g=b;g<f-c;g++)e[g]=e[g+c];Da(e,f-c);var m,n,g=0;for(var q=0;q<d[E];q++) {
n=d[q];
for(var p=0;p<n[E];p++) {
m=n[p];
if(m) {
	for(g=b;g<f-c;g++)m[g-1]=m[g+c-1];Da(m,f-c-1)
}
}
}this.idsTOcols=this.wm(e)
}
};qv[_P].j1=function (a,b) {
var c=this.Cg(a,b);
if(c)return c.h;
return null
};
qv[_P].rB=function (a,
b) {
a--;
b--;
var c=this.xu(a);
if(c) {
var d=c[b];
if(d&&d.f!=null)return Fu(this.uK[d.f],a+1,b+1)
}
};
qv[_P].UK=function (a,b) {
var c=this.Cg(a,b);
if(c)return c.co;
return null
};
qv[_P].hS=function (a,b,c,d) {
var e=this.Cg(a,b,true);
e.cco=c;
e.cfo=d
};
qv[_P].dB=function (a,b,c) {
var d=this.Cg(a,b);
if(d)return c?d.cco:d.cfo;
return null
};
qv[_P].setUserComment=function (a,b,c) {
var d=this.Cg(a,b);
if(d) {
var e=d.co;
if(!e)e={
};
e.u=c;
d.co=e
}
};
qv[_P].bz=function (a,b) {
var c=this.Cg(a,b);
if(c) {
delete c.f;
delete c.v;
delete c.vn;
delete c.h;
if(c.co) {
delete c.co.a;
if(!c.co.u) {
delete c.co;
this.ix(a,b,false)
}
}
}
};
qv[_P].OA=function (a,b) {
var c=this.Cg(a,b);
if(c)return c.v;
return null
};
qv[_P].B1=function (a,b) {
var c=this.Cg(a,b);
if(c)return c.vn;
return null
};
qv[_P].Cg=function (a,b,c) {
var d=null;
a--;
b--;
var e=this.xu(a,c);
if(e) {
d=e[b];
if(!d&&c) {
d={
};
e[b]=d
}
}return d
};
qv[_P].oba=function (a,b,c) {
var d=c.va,e=c.vn,f=c.h,g=c.co,h=this.Cg(a,b),i=true;
if(d==null||d=="") {
if(h)h.v=null;
i=false
}if(i||e!=null||f!=null||g!=null) {
if(!h) {
a--;
b--;
var j=this.xu(a,true);
h=j[b];
if(!h)h={
};
j[b]=h
}if(i)h.v=d
}if(h) {
h.vn=e;
h.h=f;
h.co=g;
this.ix(a,b,g)
}
};
qv[_P].OU=function (a,b) {
var c=a.fI,d=false;
if(c==-1) {
c=null;
d=true
}else {
var e=a.fx;
if(e!=null||c!=null)this.uK[c]=e
}var f=this.idsTOrows,g=this.idsTOcols,h=f[a.r],i=g[a.c];
if(h!=null&&i!=null) {
var j=a.v,k=a.vn,m=a.h,n=a.co,q=f[a.r2],p=g[a.c2],s=1,u=1;
if(q!=null)s=q-h+1;
if(p!=null)u=p-i+1;
var v,t,w;
for(v=0;v<s;v++) {
var B=h+v,A=this.xu(B-1,true);
if(A)for(t=0;t<u;t++) {
var G=i+t,H=G-1;
w=A[H]||{
};
if(c!=
null) {
	w.f=c;
	delete w.v
}else if(j!=null) {
	delete w.f;
	if(j[E]>0)w.v=j;
	else delete w.v
}if(d)delete w.f;
w.vn=k;
if(m)w.h=m;
if(n)w.co=n;
this.ix(B,G,w.co);
A[H]=w
}else if(!b) {
var Q=this.C.H,K=Q.uc(Q.Le(B));
if(K.Il()) {
	var sa=Gf(a),aa=this.rowsTOids[B];
	sa.r=aa;
	sa.r2=aa;
	K.xk().jl(sa,X.gridInfo)
}
}
}
}
};
qv[_P].ix=function (a,b,c) {
var d=this.C.Ld(a,b);
if(c)em(d,this.C.trixApp.pathImg+"chip.gif","no-repeat","top right");
else em(d,null,"","")
};
qv[_P].wm=function (a) {
var b=[];
for(var c=1;c<a[E];c++)b[a[c]]=c;this.C.nj();
return b
};function xv(a,b,c,d,e,f) {
this.Ae=b;
this.z=a;
this.mI=e;
this.LD=f;
this.Wb=S;
var g=[];
g.wG=0;
g.EV=1;
g.sV=2;
g.zy=3;
g.FG=4;
this.yd=g;
this.divMain=null;
this.UO=null;
this.VO=null;
this.cD=null;
this.bD=[];
this.Fh=5;
this.h6=null;
this.Yea=d;
this.Nc(a.doc,b,d,c)
}var yv="new-features-link";
xv[_P].oD=null;
xv[_P].Nc=function (a,b,c,d) {
this.divMain=Zk(a,b,"menuMain",0,0,"100%","");
var e=this.divMain,f=this.z,g=f.gooffiLink;
this.oa=a;
var h=this.yd,i=null;
if(this.LD)i=[0,1,2,3,4,9,10,11];
h[h.wG]=new $u(f,this,e,d,i);
h[h.EV]=new zv(f,this,e);
h[h.sV]=new fv(f,this,e);
h[h.zy]=new Av(f,this,e);
if(g)h[h.FG]=g.ya.aZ(this,e);
var j=a.createElement("table");
c.insertBefore(j,c[M]);
x(j,"100%");
Gb(j,"0");
j.cellSpacing="0";
Ib(j,"0");
var k=j.insertRow(0);
Aa(k,"bottom");
var m=k.insertCell(0),n=Tk(a,m,"",""),q=n.insertRow(0);
Aa(q,"bottom");
var p=q.insertCell(0),s=p,u=s[J];
Eb(u,"6px");
wb(u,"4px");
Wa(u,"4px");
if(g)g.ya.xY(a,s);
p=q.insertCell(1);
var v=new Bv(f),t=new bl(a,p,f.pathImg,false),w=new Yk(this.Nm().$()),B=t.zi(_M[45],
w,{
handler:v
});
w=new Yk(this.U1().$());
t.zi(_M[46],w,{
handler:v
});
w=new Yk(this.Om().$());
t.zi(_M[47],w,{
handler:v
});
w=new Yk(this.f2().$());
var A=t.zi(_M[48],w,{
handler:v
});
A.display(false);
var G=this.K1();
if(G!=null) {
w=new Yk(G.$());
t.zi(_M[297],w,{
handler:v,metaData:"revisions"
})
}B.activate(true);
this.editTab=B;
this.h6=t;
m=k.insertCell(1);
Nb(m,"right");
n=Tk(a,m,"","");
q=n.insertRow(0);
var H=0;
if(g) {
this.jW(q,_M[539],[["Insert Plugin...",1],["Create a Map, Chart or Table...",2],["Insert Gadget...",
3]]);
H++
}if(this.mI&&!this.LD) {
p=q.insertCell(H++);
r(p,"iconimage");
var Q=T(p),K=Q.b("div",{
"class":"img-sprite icon-print"
});
Q.appendChild(p,K);
p=q.insertCell(H++);
r(p,"icontext");
var sa=Tl(a,p,"#",_M[132]);
Ea(sa,_M[130]);
var aa=g?el(g,g.wF,true):el(f,f.hQ,true);
z(K,aa);
z(sa,aa)
}p=q.insertCell(H++);
wb(p[J],"6px");
p=q.insertCell(H++);
Aa(p,"bottom");
wb(p[J],"4px");
if(g)g.ya.iZ(a,p)
};
xv[_P].jW=function (a,b,c) {
var d=this.t1(b,c),e=T(a),f=e.b("td",{
"class":"icontext new-features-holder"
},e.b("span",{
"class":"textlink_enabled",
id:yv
},d),e.b("sup",{
"class":"new-features-indicator"
},_M[213]));
e.appendChild(a,f);
this.cA(!this.z.Da());
var g=this.z.gooffiLink.Jt;
Dh(g,"fileMenuEnabled",R(this.cA,this,true));
Dh(g,"fileMenuDisabled",R(this.cA,this,false))
};
xv[_P].t1=function (a,b) {
if(this.z.Kl.l!="en"||!ce(b))return a;
var c=(new Date).getUTCHours()%b[E];
this.oD=b[c][1];
return b[c][0]
};
xv[_P].cA=function (a) {
var b=this.oa.getElementById(yv);
if(a) {
r(b,"textlink-enabled");
Dh(b,U,this.CP,false,this)
}else {
r(b,"textlink-disabled");
Gh(b,
U,this.CP,false,this)
}
};
xv[_P].CP=function () {
this.z.Xj(2);
if(this.oD!=null) {
var a=this.z.WJ;
if(a)a.log(10000,0,0,0,this.oD)
}
};
za(xv[_P],function (a) {
var b=this.yd;
for(var c=0;c<b[E];c++)if(b[c])x(b[c].$()[J],a)
});xv[_P].Xg=function (a) {
var b=this.h6,c=b.Gj,d=this.yd.zy;
for(var e=0;e<c[E];e++)if(e!=d)c[e].display(!a);c[d].display(a);c[d].activate(a);if(a)c[0].activate(false);else {
var f=b.Xt(),g=this.yd;
if(!f||f==g[g.zy]||f==g[g.FG])c[0].activate(true)
}
};
xv[_P].We=function (a,b) {
var c=this.yd;
for(var d=
0;d<c[E];d++)if(c[d])c[d].We(a,b)
};xv[_P].Rc=function (a) {
var b=this.yd;
for(var c=0;c<b[E];c++)if(b[c])if(c==b.wG)b[c].Rc(a);else b[c].Rc()
};xv[_P].P=function () {
this.Nm().P();
if(this.Wc!=null) {
this.Wc.Fi();
this.Wc.Sa("none");
this.Wc=null
}
};
xv[_P].Wg=function (a) {
this.Wc=a
};
xv[_P].wz=function (a,b) {
var c=null,d=this.Wb?"->":"&rarr;";
if(a==1)c=[[_M[49]],[_M[50]],[_M[51]],,[""],[""],,[""],[""],,[_M[457]],[""],[""],,[_M[84](d)],[_M[85](d)]];
else if(a==2)c=[[_M[49]],[_M[50]],[_M[51]],,["0"],["0"],,["0"],
["0"],,[_M[457]],[""],[""]];
else {
c=[[_M[49]],[_M[50]],[_M[51]],,[_M[110]],[_M[457]],,[_M[356]],[_M[606]],,[_M[357]]];
if(cn)c.splice(7,0,[_M[539]]);
if(ln)c.push(["Find and Replace..."])
}var e=new Ml(b.W(),b.getDivApp(),c,false),f=e.Gb;
z(f[0].J(),Rk(b,b[nd],X.newPasteCut,true));
z(f[1].J(),Rk(b,b[nd],X.pasteAll,true));
z(f[2].J(),el(b,b.paste,true));
var g=8;
if(a==1) {
z(f[4].J(),Rk(b,b.Fc,X.colInsert,false));
z(f[5].J(),Rk(b,b.Fc,X.colInsertAfter,false));
z(f[7].J(),el(b,b.Fc,X.colDelete));
z(f[10].J(),Qk(b,
b.Mz));
z(f[11].J(),Rk(b,b.lq,X.hideUnhideCols,1));
z(f[12].J(),Rk(b,b.lq,X.hideUnhideCols,0));
z(f[14].J(),el(b,b.Aj,1));
z(f[15].J(),el(b,b.Aj,0))
}else if(a==2) {
z(f[4].J(),Rk(b,b.Fc,X.rowInsert,false));
z(f[5].J(),Rk(b,b.Fc,X.rowInsertAfter,false));
z(f[7].J(),el(b,b.Fc,X.rowDelete));
z(f[10].J(),Qk(b,b.Mz));
z(f[11].J(),Rk(b,b.lq,X.hideUnhideRows,1));
z(f[12].J(),Rk(b,b.lq,X.hideUnhideRows,0))
}else {
g=4;
var h=4;
z(f[++h].J(),Qk(b,b.Mz));
h++;
if(cn)z(f[++h].J(),el(b,b.Xj,2));
z(f[++h].J(),Qk(b,b.up));
z(f[++h].J(),
Qk(b,b.gp));
h++;
z(f[++h].J(),Qk(b,b.E$));
if(ln) {
var i=b.V0();
z(f[++h].J(),Qk(i,i.Rca))
}
}z(f[g].J(),Qk(b,b.pI));
return e
};
xv[_P].bZ=function (a,b) {
var c=b.activeGrid.$a,d=c.D1(a),e=b.Aa,f=this.bD[d];
switch(d) {
case 1:if(!f) {
var g=[[_M[341]],[_M[342]],[_M[352]],[_M[402]]];
f=new Ml(b.W(),b.getDivApp(),g,false);
this.bD[d]=f
}var h=f.Gb;
z(h[0].J(),Qk(b,b.$O));
z(h[1].J(),Qk(b,b.Iz));
z(h[2].J(),Qk(c,c.y$));
z(h[3].J(),el(b,b.nQ,1));
break;
case 2:var i=b.Mf();
if(!f) {
var g=[[_M[544]],[_M[545]],[_M[543]],[_M[540]],
[_M[633]]];
if(gn)g.push([_M[546]]);
f=new Ml(b.W(),b.getDivApp(),g,false);
this.bD[d]=f
}var h=f.Gb;
z(h[0].J(),el(b,b.nQ,2));
z(h[1].J(),Qk(b,b.Lj));
z(h[2].J(),Qk(b,b.Iz));
z(h[3].J(),R(i.jca,i));
z(h[4].J(),R(i.h2,i));
if(gn)z(h[5].J(),R(e.WL,e,1));
break;
case 3:if(!f) {
var g=[[_M[476]],[_M[477]],[_M[478]]];
f=new Ml(b.W(),b.getDivApp(),g,false);
this.bD[d]=f
}var h=f.Gb;
z(h[0].J(),Qk(b,b.$O));
z(h[1].J(),Qk(b,b.Iz));
z(h[2].J(),el(c,c.g$,a));
break
}return f
};
xv[_P].yF=function (a,b) {
var c=this.z,d=c.activeGrid,
e=d.selectedEmbedObjectId,f=d.ma,g=d.Z,h=d.Ba==g,i=d.Ha()==f;
if(c.Da())return false;
if(h&&i) {
h=false;
i=false
}if(this.cD==null) {
this.cD=this.wz(0,c);
this.UO=this.wz(1,c);
this.VO=this.wz(2,c)
}var j=this.cD;
if(e) {
j=this.bZ(e,c);
var k=d.$a.p1(e,a,b,j.menuWidth);
a=k.x;
b=k.y
}else if(h) {
j=this.VO;
j.ea(12,null);
if(f>1) {
var m=d.O,n=m+f-1;
j.ea(7,_M[92](m,n));
j.ea(8,_M[93](m,n));
j.ea(11,_M[407](m,n));
if(this.Lca(m,n))j.ea(12,_M[409])
}else {
j.ea(7,_M[88]);
j.ea(8,_M[89]);
j.ea(11,_M[408])
}j.ea(4,_M[98](f));
j.ea(5,
_M[99](f))
}else if(i) {
j=this.UO;
j.ea(12,null);
if(g>1) {
var q=d.Y,p=Cs(q),s=Cs(q+g-1);
j.ea(7,_M[90](p,s));
j.ea(8,_M[91](p,s));
j.ea(11,_M[410](p,s));
if(this.Kca(q,q+g-1))j.ea(12,_M[412])
}else {
j.ea(7,_M[86]);
j.ea(8,_M[87]);
j.ea(11,_M[411])
}j.ea(4,_M[100](g));
j.ea(5,_M[101](g))
}if(j.Ka) {
this.P();
return false
}c.P();
var u=a+5;
if(a>d.mainGridWid-j.menuWidth)u=d.mainGridWid-j.menuWidth+5;
var v=b+c.divGrids[Ed]+32;
if(b>d.mainGridHei-j.menuHeight+d.fd())v-=j.menuHeight;
j.Sa("",u,v);
this.Wc=j;
if(c.gooffiLink!=
null) {
var t=c.gooffiLink.ya.Ei;
if(t)t.Nw()
}
};
xv[_P].Lb=function () {
return this.divMain[Id]+this.Yea[Id]
};
xv[_P].w5=function () {
var a=this.UO,b=this.VO,c=this.cD;
return a!=null&&a.Ka||b!=null&&b.Ka||c!=null&&c.Ka
};
xv[_P].Nm=function () {
return this.yd[this.yd.wG]
};
xv[_P].U1=function () {
return this.yd[this.yd.EV]
};
xv[_P].Om=function () {
return this.yd[this.yd.sV]
};
xv[_P].f2=function () {
return this.yd[this.yd.zy]
};
xv[_P].K1=function () {
return this.yd[this.yd.FG]
};
xv[_P].Lca=function (a,b) {
if(b-a>=100)return true;
var c=this.z.activeGrid;
for(var d=a;d<=b;d++)if(c.Mg(d))return true;return false
};xv[_P].Kca=function (a,b) {
if(b-a>=100)return true;
var c=this.z.activeGrid;
for(var d=a;d<b;d++)if(c.Lk(d))return true;return false
};Ra(xv[_P],function () {
var a=this.yd;
for(var b=0;b<a[E];b++)if(a[b])a[b].cleanup();if(this.divMain!=null)y(this.divMain,"");this.oa=null
});function Cv(a,b,c,d,e,f) {
this.vr=1;
this.Aa=a.Aa;
this.z=a;
var g=a.W();
this.Wc=null;
this.dd=b;
var h=Zk(g,b,"toolOuter",c,d,e,f);
this.tJ=h;
Ql(g,h,"&nbsp;&nbsp;","");
var i=new Sl(g,h,[[_M[40]]]);
this.YG=i;
var j=i.X[0],k=j[J];
Fa(k,"absolute");
k.top="3px";
ib(k,"10px");
this.YR();
var c=j[tc]+20;
this.T5=c;
this.Vea=Zk(g,h,"toolArrows",-1,0,"7px","100%");
y(this.Vea,"<b>&nbsp</b>");
var m=h[tc]-13-2;
this.divButtonContent=Zk(g,h,"toolContent",c,0,null,"80%");
var n=Tk(g,this.divButtonContent,"toolTable","");
this.dG=
n.insertRow(0);
this.ck=Zk(g,h,"toolArrows",m,0,"13px","50%");
y(this.ck,"<b>></b>");
this.bk=Zk(g,h,"toolArrows",m,h[Id]/2,"13px","50%");
y(this.bk,"<b><</b>");
this.L6=Lj(this,this.M7);
Jj(this.bk,"mouseover",this.L6);
this.M6=Lj(this,this.N7);
Jj(this.ck,"mouseover",this.M6);
this.H7=Lj(this,this.J7);
Jj(this.bk,"mouseout",this.H7);
this.I7=Lj(this,this.K7);
Jj(this.ck,"mouseout",this.I7);
this.ED=Lj(this,this.Mh);
Jj(this.bk,"mousedown",this.ED);
Jj(this.ck,"mousedown",this.ED);
this.wt=0;
this.mC=null
}Cv[_P].cS=
function (a) {
this.YG.display(a)
};
Cv[_P].YR=function () {
var a=this.Aa;
z(this.YG.X[0],R(a.WL,a,0))
};
Cv[_P].bS=function (a) {
this.YG.enable(a);
if(a)this.YR()
};
Db(Cv[_P],function (a) {
if(a==true) {
var b=this.dG[L][E];
for(var c=0;c<b;c++)this.dG.deleteCell(0)
}else {
y(this.tJ,"");
this.tJ=null
}
});
Cv[_P].TU=function (a,b) {
var c=this.z,d=this.Aa,e=this.dG,f,g=d.wi;
for(var h=0;h<d.Cd[E];h++) {
f=e[L][h];
if(h==a)if(!c.Da()) {
r(f,"sheetNotActive sheetActive");
z(f,Rk(this,this.ut,h,f))
}else {
r(f,"sheetNotActive sheetReadonly");
z(f,null)
}else {
r(f,h==g?"sheetNotActive sheetFormula":(b&&!c.V(h).H.Ec()&&!c.uh?"sheetDisabled":"sheetNotActive"));
z(f,el(c,c.Nv,h))
}
}
};
Cv[_P].ut=function (a,b) {
var c=this.z,d=this.Aa;
if(!c.Ya(false))return false;
var e=this.Wc;
if(e==null) {
var f=[[_M[41]],[_M[355]],[_M[42]],,[4],[5]];
e=new Ml(c.W(),c.getDivApp(),f,false);
var g=e.Gb;
z(g[0].J(),R(d.l3,d));
z(g[1].J(),R(d.C2,d));
z(g[2].J(),R(d.m3,d));
this.Wc=e
}if(e.Ka)this.P();
else {
c.P();
var h=e.menuHeight/5,i=h*3;
e.ea(4,null);
e.ea(5,null);
var j=d.Cd[E];
if(j>1) {
var k=d.wi,g=e.Gb;
if(k<j-1) {
e.ea(5,_M[44]+" &raquo;");
z(g[5].J(),R(d.gM,d,k+1));
i+=h
}if(k>0) {
e.ea(4,"&laquo; "+_M[43]);
z(g[4].J(),R(d.gM,d,k-2));
i+=h
}
}i=this.dd[Ed]-i;
if(Zf&&Uf) {
if(d.Ui().Qd==0)i-=this.z.activeGrid.scrollDepth;
i-=c.Ji.mB()
}e.Sa("",this.T5+o.max(0,b[Cc]-this.divButtonContent[jd]),i)
}c.L(false,true)
};
Cv[_P].P=function () {
if(this.Wc!=null) {
this.Wc.Fi();
this.Wc.Sa("none")
}
};
Cv[_P].Bs=function (a,b,c) {
var d=this.dG,e=d[L][E];
d.insertCell(e);
var f=d[L][e];
y(f,"");
bm(this.z.W(),f,
a);
var g=T(f);
g.appendChild(f,g.b("span",{
id:"tri"
},"\u25bc"));
r(f,b);
if(c&&e+1>1) {
d.insertCell(e);
y(d[L][e],"|");
f=d[L][e+1]
}else f=d[L][e];
return f
};
Cv[_P].i$=function () {
var a=this.tJ[tc],b=a-13-2;
x(this.divButtonContent[J],b-7-this.T5);
ib(this.ck[J],b);
ib(this.bk[J],b)
};
Cv[_P].wR=function () {
vb(this.divButtonContent,this.divButtonContent[jd]+1*this.vr*this.wt)
};
Cv[_P].M7=function () {
this.P();
this.vr=1;
this.wt=-1;
this.mC=Hj(this,this.wR,10)
};
Cv[_P].N7=function () {
this.P();
this.vr=1;
this.wt=1;
this.mC=
Hj(this,this.wR,10)
};
Cv[_P].J7=function () {
ea(this.mC);
this.wt=0
};
Cv[_P].K7=function () {
ea(this.mC);
this.wt=0
};
Cv[_P].Mh=function () {
if(this.vr<4)this.vr++;
else this.vr=1
};
Ra(Cv[_P],function () {
Kj(this.bk,"mouseover",this.L6);
Kj(this.ck,"mouseover",this.M6);
Kj(this.bk,"mouseout",this.H7);
Kj(this.ck,"mouseout",this.I7);
Kj(this.bk,"mousedown",this.ED);
Kj(this.ck,"mousedown",this.ED)
});
function Dv(a) {
Xh.call(this);
this.z=a;
var b=a.W();
this.Tv=false;
this.vJ=null;
this.Oe=false;
this.Qo=null;
this.HE=null;
this.tb=0;
this.kD=false;
this.cP=0;
this.eP=0;
this.dP=0;
this.Vf=0;
this.oe=0;
var c=a.divGrids;
this.mE=new js(c);
this.VL=new RegExp("[_a-zA-Z\u00a2-\u00a5\u00aa\u00b5\u00ba\u00c0-\u00d6\u00d8-\u00f6\u00f8-\u00ff]");
this.UL=new RegExp("[^_.?0-9a-zA-Z\u007f-\u009f\u00a2-\u00a5\u00aa\u00b5\u00ba\u00c0-\u00d6\u00d8-\u00f6\u00f8-\u00ff]");
this.Hea=true;
var d=new mj(this);
this.q=d;
d.listen(c,
Sh,this.p7);
d.listen(b,Ph,this.G7);
d.listen(b,Oh,this.hw);
d.listen(b,jh,this.m8);
this.Ev=0;
this.Yz=null;
this.lea=false;
this.tN=false;
this.YF=null;
this.XF=null;
this.ra=new Ev(this)
}te(Dv,Xh);
Dv[_P].sE=false;
Dv[_P].Tw=null;
Dv[_P].Ms=null;
Dv[_P].Iaa=function (a) {
if(Wf)this.q.listen(a[Lc],Sh,this.q7)
};
Dv[_P].dba=function (a) {
this.Hea=true;
var b=a.divTop,c=new mj(this);
c.listen(b,Mh,this.cw);
c.listen(a.divMain,"scroll",this.a8);
c.listen(b,Nh,this.Mh);
c.listen(a.divTop2,Nh,this.Mh);
c.listen(a.I.jf,Nh,this.Mh);
c.listen(a.xa.xg,Nh,this.Mh);
c.listen(a.f_,U,this.z.wda,false,this.z);
c.listen(a.divMain,Oh,this.P7);
var d=new Tt(b);
c.listen(d,"mousewheel",this.Q7);
a.cba(c,d)
};
Dv[_P].$e=function (a) {
a.stopPropagation();
a.preventDefault()
};
Dv[_P].cw=function (a) {
var b=this.z,c=this.aj(true),d=this.$d(a,c);
if(!b.cellSelection.ke()&&b.modalDbox==null&&!c.oC()&&!this.xq(c,d[1]+c.fd())) {
var e=this.z.cellSelection;
e.ui(true);
e.F2OrMouse=true
}else if(this.tb==41)this.$e(a)
};
Dv[_P].a8=function () {
this.z.cellOverlayManager.Rf();
var a=this.aj(true);
if(!a)return ;
this.z.ze.gy(a);
a.Cx(a.Md(),250,true);
if(this.tb==0||this.tb==9) {
var b=this.z.cellSelection;
if(b.isEditBoxActive)b.Eo();
if(this.tb==0) {
var c=a.divMain[jd],d=a.divMain[Ub];
a.xa.Zh(c);
a.I.Zh(d);
this.Vf=-c;
this.oe=-d;
return false
}
}
};
Dv[_P].m8=function (a) {
if(!a[ec]&&this.tb===1)this.hw(a)
};
Dv[_P].Bba=function (a) {
this.Vf=-a.divMain[jd];
this.oe=-a.divMain[Ub]
};
Dv[_P].P7=function () {
if(!this.Tv)this.z.cellSelection.L()
};
Dv[_P].p7=function (a) {
if(Wf) {
this.Mh(a,true);
this.hw(a)
}this.$e(a)
};
Dv[_P].q7=function (a) {
this.sE=true;
this.Mh(a,true);
this.hw(a);
this.sE=false;
this.$e(a)
};
Dv[_P].Q7=function (a) {
this.tb=9;
var b=this.aj(true);
if(!b)return ;
var c=this.z.cellSelection;
if(this.Oe)c.Eo();
else c.L();
var d=a.detail;
this.oe=Sf(this.oe-b.lB()*d,-2000000,0);
this.lD(b);
this.$e(a);
this.tb=0
};
Dv[_P].$d=function (a,b) {
var c=b.divMain,d=a[Nd],e=a[Od];
if(this.sE) {
var f=a[Sc][Nc],g=b.H;
for(var h=0;h<g.Oa[E];h++) {
var i=g.uc(h);
if(i.wh()!=f)e+=i.wb[Id];
else break
}
}else {
var j=b.M0();
e-=j.y;
if(e>=0)e+=
c[Ub];
d-=j.x;
if(d>=0)d+=c[jd]
}return [d,e]
};
Dv[_P].xq=function (a,b) {
var c=a.xa.V1();
return c[0]<=b&&b<=c[1]
};
Dv[_P].r5=function (a,b) {
var c=a.I.Mb();
return b>=c&&b<=c+5
};
Dv[_P].Ie=function (a,b,c,d) {
var e=d==1?1:this.EB(a,c),f=d==2?1:this.cB(a,b);
if(e==null||f==null)return null;
if(!d) {
var g=a.Ld(e,f);
if(g) {
var h=uv(g,a,false);
if(h)f=h
}
}return [e,f]
};
Dv[_P].EB=function (a,b) {
try{
var c=a.H,d,e,f,g=a.Xb;
if(b<0&&g>0) {
b+=a.fd();
if(this.xq(a,b))f=g+1;
else for(e=1;e<=g&&f==null;e++)if(!a.Mg(e)) {
d=c.K(e);
if(b<
c.hd(d)+d[Id])f=e
}
}else {
var h=c.Z0(b),i=g,j=h.Mc;
if(j>0)i=c.Zd(j);
var k=o.min(h.uf,a.Ha());
if(h.Ka())k=a.Io(k);
if(i>=k)f=k;
else if(h.Ka()) {
i=a.Ho(i+1);
d=c.K(i);
if(b<c.hd(d)+d[Id])f=i;
else {
	k=a.Io(k);
	d=c.K(k);
	if(b>c.hd(d))f=k;
	else {
		f=null;
		var m,n;
		while(f==null) {
			m=o.round((k+i)/2);
			if(k<i) {
				a.H.cm();
				f=i;
				break
			}n=a.Ho(m);
			d=c.K(n);
			var q=c.hd(d);
			if(b<q)k=a.Io(m-1);
			else if(b>q+d[Id])i=a.Ho(n+1);
			else f=n
		}
	}
}
}else {
var p=h.gb,s=(b-p[Ed])/p[Id];
f=o.ceil(s*(k-i))+i;
f=o.min(o.max(f,i+1),k)
}
}return f
}catch(u) {
return null
}
};
Dv[_P].cB=function (a,b) {
try{
var c,d,e=a.Ra;
if(b<0&&e>0) {
var f=a.I;
b+=a.Dg();
if(this.r5(a,b))c=a.Nl(e+1);
else {
var g=f.sB()[0][L];
d=e;
while(d>1&&b<g[d][Cc])d=a.ZF(d-1);
c=d
}
}else {
var g=a.H.K(0)[L],h=a.Ba;
c=a.Nl(e+1);
d=a.Nl(c+1);
while(d<=h&&b>g[d][Cc]) {
c=d;
d=a.Nl(d+1)
}
}return c
}catch(i) {
return null
}
};
Dv[_P].aj=function (a) {
var b=this.z.activeGrid;
if(a)this.Oe=this.z.cellSelection.ke();
if(this.Oe) {
if(this.z.activeFormuGrid==null)this.z.activeFormuGrid=this.z.activeGrid;
b=this.z.activeFormuGrid;
if(!b)return null;
this.vJ=b.divFormulas;
this.Qo=this.z.cellSelection.db
}else {
if(!b)return null;
this.vJ=b.divSelection;
this.Qo=null
}return b
};
Dv[_P].iy=function (a,b,c) {
if(this.Oe) {
this.a$(a,b,c);
if(!this.tN) {
this.tN=true;
this.z.cellSelection.Eo()
}
}else {
var d=this.z.modalDbox,e=this.DL(a);
if(d&&d.pd) {
if(e)d.pd(e)
}else if(e)this.dispatchEvent(new Fv(e))
}
};
Dv[_P].a$=function (a,b) {
var c=this.DL(a),d=this.Qo;
d.focus();
if(this.XF)this.pK();
if(b) {
var e=uq(d),f=d[I].substring(0,e),g=this.z.cellSelection.Lt(f,true);
pq(d,f.lastIndexOf(g)+
1);
tq(d,e)
}wq(d,c);
this.z.cellSelection.Rh();
if(this.tb==5)this.yR();
if(b&&S) {
this.XF=new Pf(rq(d),uq(d));
this.YF=fi(this.pK,0,this)
}
};
Dv[_P].pK=function () {
var a=this.Qo;
a.focus();
var b=this.XF;
if(b) {
pq(a,b[ad]);
tq(a,b.end);
this.XF=null
}if(this.YF) {
ei(this.YF);
this.YF=null
}
};
Dv[_P].yR=function () {
var a=this.Qo;
a.focus();
pq(a,uq(a))
};
Dv[_P].DL=function (a) {
var b=this.HE;
if(!b)return null;
var c=[];
if(this.z.activeFormuGrid!=this.z.activeGrid) {
var d=a[yd].replace(/'/g,"''"),e=a[yd].substring(0,1);if(this.VL.test(e)==
true&&this.UL.test(d)==false)c.push(d,"!");
else c.push("'",d,"'!")
}var f=b[Mc]+b[F]-1,g=b.top+b[P]-1;
if(b[F]&&b[P]) {
c.push(Cs(b[Mc]),b.top);
if(b[F]>1||b[P]>1)c.push(":",Cs(f),g)
}else if(b[F])c.push(Cs(b[Mc]),":",Cs(f));
else if(b[P])c.push(b.top,":",g);
else c.push("1:",a.Ha());
return c.join("")
};
Dv[_P].v5=function (a) {
if(!this.Oe&&!this.z.modalDbox)return a.kN(2);
return false
};
Dv[_P].vC=function (a,b,c,d) {
if(d==null)d=true;
if(!d||a.HH()) {
var e=a.ma,f=a.Z,g=a.Ba==f,h=a.Ha()==e;
if(g&&h)return !c;
var i=
b[1]+a.fd(),j=b[0]+a.Dg(),k=a.O,m=a.Km(k),n=a.Km(k+e-1,true);
if(m==null||n==null)return false;
var q=a.Y,p=a.vh(q),s=a.vh(q+f-1,true),u=p<j&&s>j,v=m<i&&n>i;
if(c) {
var t=p+5<j&&s-5>j,w=m+5<i&&n-5>i;
return v&&u&&!(w&&t)
}else return v&&u||g&&v||h&&u
}return false
};
Dv[_P].L1=function () {
if(!this.Tw)this.Tw=new Fs(this.z,this);
return this.Tw
};
Dv[_P].rN=function () {
var a=this.Tw;
return a&&a.Vb
};
Dv[_P].u0=function () {
if(!this.Ms)this.Ms=new Es(this.z,this);
return this.Ms
};
Dv[_P].d5=function () {
var a=this.Ms;
return a&&
a.Vb
};
Dv[_P].Mh=function (a,b) {
this.kD=false;
var c=this.aj(true);
if(!c)return ;
var d=this.z;
d.ze.ge();
var e=c.$a;
if(a[Sc]!==c.divTop&&e)e.qZ();
if(!d.on())return ;
ei(this.Yz);
this.Yz=null;
this.tN=false;
if(!this.Oe)d.cellSelection.Id(true);
var f=d.modalDbox;
if(!f||f&&f.vH()) {
d.cellOverlayManager.Rf();
var g=this.$d(a,c);
if(!this.Oe&&!d.modalDbox) {
var h=e.E1(g[0],g[1]);
if(h>=0||e.p5(h)) {
e.OG();
e.El(h);
return false
}
}if(b||this.v5(a)) {
this.kD=true;
if(this.vC(c,g)) {
d.copyPaste.np(c);
this.$e(a);
return
}
}this.Tv=
true;
if(!f&&this.xq(c,g[1]+c.fd())&&!c.pn()) {
var i=this.Ie(c,g[0],1),j=c.xa.qe.yk(i[1]),k=j[Cc],m=k+j[tc];
fj(j,"sortBarOn");
this.Ev=i[1];
this.tb=m-14<=g[0]&&g[0]<=m?40:41;
this.$e(a);
return
}var n=g[0]<=-(c.Dg()-35),q=g[1]<-c.fd(true);
d.isPanningOn=a[Zb]?true:false;
if(d.isPanningOn&&!this.Oe)if(n&&q) {
}else {
if(a[Ac]==0||a[Ac]==1) {
this.cP=a[Tc];
this.eP=a[Uc];
this.dP=(new Date).getTime();
this.tb=1
}var i=this.Ie(c,g[0],g[1]);
if(i!=null)c.Ua(i[0],i[1],true)
}else {
var p=n&&q;
if(p)this.tb=5;
else if(n) {
if(!this.Oe&&
!c.yq()&&!f&&!a[sd]) {
	var s=this.EB(c,g[1]);
	if(s!=null&&c.BC(s)) {
		this.L1().re(a,c);
		return
	}
}this.tb=3
}else if(q)this.tb=4;
else {
if(!c.yq()&&!f&&this.vC(c,g,true,false)&&!a[sd]) {
	var u=this.u0();
	u.re(a,c);
	return
}this.tb=2;
if(!this.Oe) {
	c.qS(false);
	c.vc(0)
}
}this.ra.gw(c,g,a[sd]);
if(this.Oe)this.Uu(c);
else if(this.tb!==2)this.Uu(c,true);
this.iy(c,true,a[sd])
}
}this.$e(a);
d.L();
if(S)fi(d.L,0,d)
};
Dv[_P].hw=function (a) {
if(Wf&&!this.Tv)return ;
this.Tv=false;
var b=this.aj(false);
if(!b)return ;
if(this.rN()||this.d5())return ;
var c=this.z;
c.P();
Ga(b.divTop[J],"default");
this.ra.stop();
var d=b.xa;
if(this.tb===1) {
this.RL(b,a);
c.copyPaste.np(b);
if(a[oc])b.hyperlink()
}else if(this.tb===40) {
var e=d.qe.yk(this.Ev);
d.qe.Jca(this.Ev,e[Ed],b.vh(this.Ev)-b.divMain[jd],e[tc])
}else if(this.tb===41) {
var f=this.$d(a,b),e=d.qe.yk(this.Ev);
if(this.xq(b,f[1]+b.fd()))fj(e,"sortBarOn");
else fj(e,"sortBar")
}else if(this.tb===2||this.tb===3||this.tb===4) {
var f=this.$d(a,b);
this.ra.O7(b,f);
this.iy(b);
if(this.Oe) {
b.vc(3);
this.yR();
c.cellSelection.F2OrMouse=
false
}else {
if(this.tb===2) {
var g=this.HE;
if(g) {
	var h=g[F]?g[Mc]+g[F]-1:b.Ba,i=g[P]?g.top+g[P]-1:b.Ha();
	b.Ar(g.top,g[Mc]);
	b.dc(g.top,g[Mc],i,h,true)
}if(a[oc])b.hyperlink()
}c.copyPaste.np(b)
}
}this.tb=0;
if(this.kD&&!c.modalDbox) {
this.kD=false;
var j=this.$d(a,b),k=b.divMain,m=o.max(0,j[0]-k[jd]+b.Dg()),n=o.max(0,j[1]-k[Ub]+b.fd());
c.menuMain.yF(m,n)
}c.isPanningOn=false;
if(this.Oe&&a[Sc]==this.Qo) {
b.vc(3);
c.cellSelection.F2OrMouse=true
}this.$e(a)
};
Dv[_P].G7=function (a) {
if(this.mE.Vb) {
this.$e(a);
return
}if(this.Tv) {
var b=
this.aj(false);
if(!b)return ;
if(this.tb===1) {
var c=(new Date).getTime();
if(c-this.dP>20) {
this.dP=c;
this.RL(b,a)
}this.$e(a);
return
}else if(this.tb===2||this.tb===3||this.tb===4) {
var d=this.$d(a,b);
this.ra.E7(b,d);
this.Uu(b);
this.iy(b);
this.$e(a);
return
}
}else {
var e=this.z;
if(!e.on())return ;
var b=this.aj(true);
if(!b)return ;
if(a[Sc]===b.divTop)if(!this.z.cellSelection.isEditBoxActive) {
if(b.I.gm.Vb||b.xa.qe.Vb) {
this.$e(a);
return
}var d=this.$d(a,b);
if(!this.mE.rca(b,d)) {
var f=this.Ie(b,d[0],d[1]);
this.lda(b,
f)
}if(!e.modalDbox) {
var g=this.xq(b,d[1]+b.fd()),h=this.K5,i=b.xa.qe;
if(!b.pn()) {
	if(g) {
		var j=this.Ie(b,d[0],1);
		if(j[1]!=h) {
			if(h) {
				yg(i.yk(h));
				fj(i.yk(h),"sortBar")
			}i.Ica(j[1]);
			this.K5=j[1]
		}
	}else if(h) {
		yg(i.yk(h));
		fj(i.yk(h),"sortBar");
		this.K5=null
	}var d=this.$d(a,b),k=this.vC(b,d,true,false);
	if(this.lea!=k) {
		b.Cba(k);
		this.lea=k
	}
}
}
}
}
};
Dv[_P].D$=function (a) {
this.oe=0;
wa(a.divMain,0);
a.I.Zh(0)
};
Dv[_P].Zw=function (a,b,c) {
if(!b||!c)return ;
var d,e,f=new Qf;
if(this.tb===2) {
var g=this.Ie(a,c.x,c.y);
if(g) {
d=
new Pf(g[1],b.x);
e=new Pf(g[0],b.y)
}
}else if(this.tb===3) {
var h=this.EB(a,c.y);
if(h!=null) {
d=new Pf(null,null);
e=new Pf(h,b.y)
}
}else if(this.tb===4) {
var i=this.cB(a,c.x);
if(i!=null) {
d=new Pf(i,b.x);
e=new Pf(null,null)
}
}else if(this.tb===5) {
d=new Pf(null,null);
e=new Pf(null,null)
}if(!d||!e)return ;
var f=new Qf;
ib(f,d[ad]||1);
f.top=e[ad]||1;
x(f,d[ad]?d.end-d[ad]+1:undefined);
D(f,e[ad]?e.end-e[ad]+1:undefined);
this.HE=f
};
Dv[_P].Uu=function (a,b) {
var c=this.HE;
if(c) {
if(b)a.Ua(c.top,c[Mc],false);
var d=c[F]?
c[Mc]+c[F]-1:a.Ba,e=c[P]?c.top+c[P]-1:a.Ha();
if(this.Oe)a.Li(c.top,c[Mc],e,d,this.vJ);
else a.dc(c.top,c[Mc],e,d,false)
}
};
Dv[_P].RL=function (a,b) {
this.Vf=this.Vf-(this.cP-b[Tc]);
this.cP=b[Tc];
this.oe=this.oe-(this.eP-b[Uc]);
this.eP=b[Uc];
this.lD(a)
};
Dv[_P].lD=function (a) {
var b=a.divMain;
vb(b,-this.Vf);
wa(b,-this.oe);
var c=b[jd],d=b[Ub];
a.xa.Zh(c);
a.I.Zh(d);
this.Vf=-c;
this.oe=-d
};
Dv[_P].lda=function (a,b) {
if(!Gv(b,this.wfa)) {
ei(this.Yz);
this.Yz=fi(R(this.lca,this,a,b),300)
}this.wfa=b
};
Dv[_P].lca=function (a,
b) {
var c=this.z.cellOverlayManager;
c.wT(a,b);
if(tn)c.fca(a,b)
};
Dv[_P].Hk=function (a) {
if(a!=this.mE.yj)this.mE.ge()
};
Dv[_P].I9=function (a) {
a.$Z()
};
Dv[_P].O9=function () {
this.q.cc()
};
var tr="selectaddress",Fv=function (a) {
eh.call(this,tr);
this.address=a
};
te(Fv,eh);
var Ev=function (a) {
this.Vv=a;
this.xea=new Of(0,0);
this.ql=new Of(0,0)
};
Ev[_P].Zb=null;
Ev[_P].Zo=null;
Ev[_P].Ih=null;
Ev[_P].wE=false;
Ev[_P].xE=false;
Ev[_P].$K=function (a,b,c,d,e) {
var f=a>c?a-c:(a<0&&d&&b>0?a:0);
if(f==0)return 0;
f/=e;
var g=f>
1?1:(f<-1?-1:f*o.abs(f));
return o.ceil(g*100)
};
Ev[_P].gw=function (a,b,c) {
var d=this.Vv,e;
this.stop();
if(c)e=new Of(b[0],b[1]);
else {
e=this.xea;
e.x=b[0];
e.y=b[1];
var f=d.Ie(a,e.x,e.y);
this.Zo=f?new Of(f[1],f[0]):null
}this.wE=e.x>0;
this.xE=e.y>0;
d.Zw(a,this.Zo,e)
};
Ev[_P].E7=function (a,b) {
var c=this.Vv,d=new Of(b[0],b[1]);
if(d.x>0)this.wE=true;
if(d.y>0)this.xE=true;
this.Ih=d.clone();
this.nH(this.Ih,c.Vf,c.oe);
var e=a.divMain;
this.ql.x=this.$K(this.Ih.x,-c.Vf,e[hc],this.wE,a.scrollDepth);
this.ql.y=this.$K(this.Ih.y,
-c.oe,e[hd],this.xE,a.scrollDepth);
this.stop();
if(this.ql.x==0&&this.ql.y==0)c.Zw(a,this.Zo,d);
else this.Kn()
};
Ev[_P].O7=function (a,b) {
var c=this.Vv,d=new Of(b[0],b[1]);
this.stop();
c.Zw(a,this.Zo,d)
};
Ev[_P].stop=function () {
if(this.Zb) {
ei(this.Zb);
this.Zb=null
}
};
Ev[_P].nH=function (a,b,c) {
if(a.x>=0)a.x+=b;
if(a.y>=0)a.y+=c
};
Ev[_P].Kn=function () {
var a=this.Vv.aj(false);
if(!a)return ;
var b=this.Vv,c=a.divMain,d=-b.Vf,e=-b.oe;
b.Vf=-(d+this.ql.x);
b.oe=-(e+this.ql.y);
b.lD(a);
var f;
if(b.Vf==-d&&b.oe==-e) {
f=
this.Ih.clone();
this.stop()
}else {
var g=20;
f=new Of(this.ql.x?Sf(this.Ih.x,g,c[hc]-g):this.Ih.x,this.ql.y?Sf(this.Ih.y,g,c[hd]-g):this.Ih.y);
this.Zb=fi(this.Kn,50,this)
}this.nH(f,-b.Vf,-b.oe);
b.Zw(a,this.Zo,f);
b.Uu(a);
b.iy(a)
};
function Hv(a) {
this.z=a;
this.pJ=false
}Hv[_P].lW=function (a) {
this.z.getDivApp().appendChild(a)
};
Hv[_P].YZ=function (a) {
this.pJ=a
};
Ra(Hv[_P],function () {
this.z=null
});
function Iv(a,b) {
this.z=a;
this.dd=b;
this.Bn=null;
this.vZ=2;
var c=["","","","",""],d=new Ml(a.W(),a.getDivApp(),c,false,null,null,!a.on()),e=d.Gb;
for(var f=0;f<c[E];f++)z(e[f].J(),R(this.Vda,this,e[f]));this.Wc=d
}Iv[_P].ut=function () {
var a=this.z,b=this.Wc;
if(!this.Bn||!b)return ;
if(b.Ka)this.P();
else {
var c=this.dd,d=c[Cc]+125,e=c[Ed]-b.menuHeight;
if(Zf&&Uf) {
e-=a.activeGrid.scrollDepth;
e-=a.Ji.mB()
}b.Sa("",d,e)
}a.L(false,true)
};
Iv[_P].P=function () {
var a=this.Wc;
if(a!=null) {
a.Fi();
a.Sa("none")
}
};
Iv[_P].Uda=
function (a) {
var b=this.Wc;
if(b==null)return 0;
if(b.Ka)this.P();
var c=0;
if(a!=null)c=a[1];
if(c<=1) {
this.Bn=null;
return c
}else this.Bn={
};
var d=a[2],e=a[5],f=a[3],g=a[4],h=this.Bn;
h[1]=_M[388](c);
h[2]=_M[391](d);
h[5]=_M[387](e);
h[3]=_M[390](f);
h[4]=_M[389](g);
b.ea(0,h[2]);
b.ea(1,h[5]);
b.ea(2,h[1]);
b.ea(3,h[3]);
b.ea(4,h[4]);
return c
};
Iv[_P].J0=function () {
return this.Bn[this.vZ]
};
Iv[_P].Vda=function (a) {
var b=a.a2();
this.z.cea(b);
var c=this.Bn;
for(var d in c)if(c[d]==b) {
this.vZ=d;
break
}this.P()
};
Ra(Iv[_P],
function () {
this.z=null;
this.dd=null;
this.Bn=null;
var a=this.Wc;
if(a) {
var b=a.Gb;
for(var c=0;c<b[E];c++)b[c].enable(false);a.cleanup()
}this.Wc=null
});function Jv(a) {
this.z=a;
this.yf=null;
this.hq=null;
this.wg=null
}Jv[_P].initialize=function (a) {
if(!this.yf) {
this.yf=a.ranges;
this.hq=a.help
}
};
Jv[_P].xF=function (a) {
if(this.z.Ya(true)) {
var b=this.wg;
if(!b) {
b=new Lr(this.z,this.hq);
this.wg=b
}b.PQ(a!=null);
if(a)b.fba(a);
b.D(true);
b.zk().focus()
}
};
Jv[_P].GK=function () {
this.IK();
var a=[];
for(var b in this.yf)a.push(this.yf[b].n);a.sort();return a
};Jv[_P].CB=function (a) {
this.IK();
return this.yf[a.toLowerCase()]
};
Jv[_P].IK=function () {
if(!this.yf) {
var a=oo+
"=7",b=hm(this.z.url,a,false),c=eval(b[pc]);
this.yf=c.ranges;
this.hq=c.help
}
};
Jv[_P].iW=function (a) {
if(this.yf!=null) {
this.yf[a.n.toLowerCase()]=a;
this.LQ()
}
};
Jv[_P].V6=function () {
var a=this.z,b=a.activeGrid;
if(b.O==null)return ;
var c=xr(b.O,b.Y,b.ma,b.Z);
this.xF(c)
};
Jv[_P].M$=function (a) {
var b=this.z;
if(b.Ya(true,true))b.activeGrid.Zf(X.addRange,a,_M[4])
};
Jv[_P].N9=function (a) {
a=a.toLowerCase();
if(this.yf&&this.yf[a]) {
delete this.yf[a];
this.LQ()
}
};
Jv[_P].P$=function (a) {
var b=this.z;
if(b.Ya(true,true))b.activeGrid.Zf(X.removeRange,
a,_M[4])
};
Jv[_P].iea=function (a) {
if(!a)return _M[308];
a=Wl(a);
if(a[E]==0)return _M[308];
if(a[E]>250)return _M[310];
var b=a,c=a.indexOf("!");
if(c>0&&c!=a[E]-1)b=a.substr(c+1);
if(!/^[^~!"#$%&'()*+,-.\/:;<=>?@\[\]\\^` ]*$/.test(b))return _M[309];if(/^[a-z]{1,2}\d+$/i.test(b)||/^(r\d*)?(c\d*)?$/i.test(b)||/^[0-9].*|true|false$/i.test(b))return _M[309];return null};Jv[_P].DR=function(a) {var b=this.z,c=b.cellSelection,d=b.activeGrid;if(b.modalDbox==null&&d!=null&&c.isEditBoxActive) {var e=c.db;e.value+=
a;
c.Rh()
}else {
var f=this.CB(a.toLowerCase());
if(f!=null) {
d=b.pb(f.g);
if(d.H.Ec()) {
if(d.id!=b.activeGrid.id)b.activate(d[fc],true,false,true);
fi(R(this.uM,this,f),100)
}else {
b.Dy(f.g,R(this.uM,this,f));
b.activate(d[fc],true,false,true)
}
}
}b.L()
};
Jv[_P].uM=function (a) {
var b=this.z.pb(a.g);
if(a.r1Pos<0||a.c1Pos<0||a.r2Pos>b.Ha()||a.c2Pos>b.Ba)return ;
b.dc(a.r1Pos,a.c1Pos,a.r2Pos,a.c2Pos);
b.Ua(a.r1Pos,a.c1Pos,false);
b.Vc(a.r1Pos,a.c1Pos)
};
Jv[_P].LQ=function () {
var a=this.wg;
if(a)a.u9()
};
Jv[_P].Pq=function (a,
b) {
var c=this.z,d=ys(a);
if(!d||!d.valid) {
if(b)ra(_M[331]);
return null
}var e=d.Bd,f;
if(!e) {
f=c.activeGrid;
d.gid=f.id;
d.Bd=f[yd]
}else {
f=c.Aa.ou(d.Bd);
if(f)d.gid=f.id;
else {
if(b)ra(_M[332]);
return null
}
}if(d.toRowPos<d.fromRowPos) {
var g=d.toRowPos;
d.toRowPos=d.fromRowPos;
d.fromRowPos=g
}if(d.toColPos<d.fromColPos) {
var g=d.toColPos;
d.toColPos=d.fromColPos;
d.fromColPos=g
}if(d.fromRowPos<0||d.fromColPos<0||d.toRowPos>f.Ha()||d.toColPos>f.Ba) {
ra(_M[363]);
return
}return d
};
Ra(Jv[_P],function () {
this.yf=null;
var a=this.wg;
if(a!=null)a.dispose();
this.z=null;
this.hq=null;
this.wg=null
});
function rv(a,b) {
this.C=a;
this.oa=a.trixApp.W();
var c=this.oa;
this.hf=Zk(c,b,"divFrozRowHead divRowHead divColHead",0,32,36,a.fd());
this.jf=Zk(c,b,"divRowHead",0,32,36,a.mainGridHei);
this.zK=null;
this.cl=su(c,this.jf,"framesContainer",0,0,"","","table");
this.Mfa=this.cl[pd];
this.oA=0;
this.d4=null;
this.DA=null;
this.AA=null;
this.Jp=null;
this.Z9=null;
this.$N=null;
this.EA=0;
this.Rb=new Bs(a,this,true);
this.gm=null;
this.Oea=null;
this.divActiveCellInH=null;
this.divActiveCellInFFH=null;
this.divSelectionInH=
null;
this.divSelectionInFFH=null;
this.divFormulasInH=null;
this.divFormulasInFFH=null;
this.Q5=-1;
this.ob=null
}rv[_P].j$=function () {
this.oA=0
};
rv[_P].sB=function () {
if(this.DA==null)this.DA=this.oa.getElementById("frozRowHead_"+this.C.id)[pd];
return this.DA
};
rv[_P].qL=function (a) {
return a?this.Mfa:this.cl
};
rv[_P].oW=function () {
var a=this.C,b=a.H,c=this.jf,d=this.hf;
this.EA=b.uc(0).zB();
if(this.gm)this.gm.dispose();
this.gm=new fs(this,a,a.trixApp.mouseSelection);
this.Oea=this.Mb();
var e=this.C.trixApp.W();
if(!this.divActiveCellInH) {
this.divActiveCellInH=Zk(e,c,"divActiveCell",-3,-3,"0px","0px");
this.divSelectionInH=Zk(e,c,"divSelection",-3,-3,"0px","0px");
this.divFormulasInH=Zk(e,c,"divFormuSelect",-3,-3,"0px","0px")
}this.divActiveCellInFFH=Zk(e,d,"divActiveCell",-3,-3,"0px","0px");
this.divSelectionInFFH=Zk(e,d,"divSelection",-3,-3,"0px","0px");
this.divFormulasInFFH=Zk(e,d,"divFormuSelect",-3,-3,"0px","0px");
if(!this.d4)this.d4=al(a.trixApp.W(),c,"","headerEnd","width:100%;height:"+(a.scrollDepth-
1));
this.DA=null
};
rv[_P].Xba=function (a) {
var b=T(this.hf);
this.C.H.lL();
this.hf[J].top=this.oA;
if(this.Jp)b.removeNode(this.AA[O]);
y(this.hf,a);
var c=this.hf[rd][0];
this.zK=c;
this.AA=c[rd][0];
this.Jp=c[pd];
this.C.Lx()
};
rv[_P].freezeRows=function (a,b,c,d) {
var e=this.C,f=this.AA,g=this.Jp,h=T(f),i=g[0][L][E],j,k,m;
if(a) {
var n,q,p;
for(j=g[E]-1;j<=c;j++) {
q=h.b("tr",{
isFrozenRow:true,isFrozenCol:true
});
for(n=0;n<i;n++) {
p=h.b("td",n==0?{
"class":"hd"
}:{
});
h.appendChild(q,p)
}h.gN(q,g[g[E]-1])
}
}var s=e.eb().W();
for(j=c;j>=b;j--) {
if(a) {
k=this.K(j,false,false);
m=g[j]
}else {
k=g[j];
m=this.K(j,false,false)
}if(!d)this.ft(s,k,m,i);
m.isFrozenRow=a;
pb(m[J],k[J][bd]);
if(a)V(k,false);
else h.removeNode(g[j])
}
};
rv[_P].ft=function (a,b,c,d) {
var e=b[L],f=c[L],g,h;
for(var i=0;i<d;i++) {
g=e[i];
h=f[i];
if(i==0)y(h,g[rc]);
else vu(null,h,wu(g));
tb(h,g[gd]);
r(h,g[dc]);
pb(h[J],g[J][bd])
}c.isFrozenCol=true
};
rv[_P].Ef=function (a,b) {
var c=this.C,d=c.H,e=c.xa;
d.cm();
var f,g,h,i=c.lastTblHeight!=d.Lb()||this.Q5!=this.Nf(),j=c.Ra>0,k=
c.nx();
if(k||i) {
var m=c.Xb+1;
for(f=1;f<m;f++)this.Fe(f,this.sB()[f],e.Np(f),a,j)
}var n=0,q=d.Oa[E]-1;if(b!=null)n=q=b;if(i) {
var p,s,u,v,t,w,B,A=d.Zd(n);
for(f=n;f<=q;f++) {
p=d.uc(f);
if(p.Na()) {
s=p.Sg;
u=p.ob;
v=p.If;
for(g=0;g<s[E];g++) {
t=s[g];
w=u[g];
B=A+v[g];
if(t!=null&&w!=null)for(h=1;h<t[E];h++)this.Fe(B+h,t[h],w[h],a,j)
}
}A=p.uf
}k=true
}if(k) {
c.vj();
this.Q5=c.lastTblHeight=d.Lb();
e.qe.Zc();
var G=c.trixApp.ze;
G.Zc();
G.gy(c)
}this.Rb.Re(false)
};
rv[_P].Fe=function (a,b,c,d,e,f) {
var g=this.C;
if(!f&&g.Mg(a))return ;
var h=c[L][0],i=b[L][0],j=h[rd][0];
if(!j)return ;
var k=j[Id],m=c[Id],n=true;
if(e||g.Ra) {
var q=b[Id];
if(!S&&q==m)return ;
Bi(i,"height","");
Bi(h,"height","");
if(S)hj(b,"equalize");
q=b[Id];
m=c[Id];
ij(b,"equalize");
if(q>m) {
Bi(h,"height",q+"px");
n=false
}else if(q==m)n=false
}if(n) {
var p=o.max(k,m);
if(!d||p!=g.lB())if(p!=i[Id])Bi(i,"height",p+"px")
}var s=g.xa;
if(a<=g.Xb&&s.tblMain) {
g.nx();
s.qe.Zc()
}else g.lastTblHeight=g.H.Lb();
g.H.cm();
this.Rb.Re(false)
};
rv[_P].K=function (a,b,c) {
if(c&&a<=this.C.Xb)return this.Jp[a];
var d=this.C.H,e,f,g,h,i,j,k,m=0;
for(h=0;h<d.Oa[E];h++) {
e=d.uc(h);
j=e.uf;
if(a<=j) {
a-=m;
f=e.Sg;
for(i=0;i<f[E];i++) {
g=f[i];
k=g[E];
if(k>0)k--;
if(a<=k)return b?e.Vw[i]:g[a];
a-=k
}return null
}m=j
}return null
};
rv[_P].hd=function (a) {
var b=a[O][O],c=b[O];
return c==this.hf?a[Ed]-this.C.fd()-32:c[Ed]+b[Ed]+a[Ed]
};
rv[_P].Mb=function () {
return this.zK?this.zK[tc]:this.cl[tc]
};
rv[_P].Nf=function () {
return this.cl[Id]
};
rv[_P].Do=function (a) {
Bi(this.hf,"width",a+(S?2:0)+"px");
Bi(this.jf,"width",a+(S?2:0)+"px")
};
rv[_P].Pd=
function (a) {
D(this.jf[J],a)
};
rv[_P].Pba=function (a) {
this.jf[J].top=a+this.oA
};
rv[_P].Zh=function (a) {
wa(this.jf,a);
this.Rb.mH()
};
rv[_P].Vp=function () {
return this.jf[Ub]
};
rv[_P].uL=function (a) {
var b=this.C.H;
for(var c=0;c<b.Oa[E];c++)if(a<=b.uc(c).uf)return c;return b.Oa[E]-1
};rv[_P].aR=function (a,b,c,d) {
if(a<=this.C.Ha()) {
if(c==null) {
c=this.uL(a);
var e=this.$N;
if(e!=null)c=o.min(c,e);
ei(this.Z9);
d=b.Zd(c)+1
}var f=b.uc(c).Sg;
for(var g=0;g<f[E];g++) {
var h=f[g];
if(h!=null)for(var i=1;i<h[E];i++) {
y(h[i][L][0][rd][0],
d);
d++
}
}c++;
if(c<b.Oa[E]) {
this.Z9=fi(R(this.aR,this,a,b,c,d),0);
this.$N=c
}else this.$N=null
}
};
rv[_P].a5=function (a,b,c,d) {
var e=this.C.H,f=this.K(a,true),g=this.C.Ra,h=a-e.bu(a)+d,i=f[pd][1][L][0],j,k,m;
for(var n=0;n<b;n++) {
j=f.insertRow(h);
j.isFrozenCol=true;
for(m=0;m<=g;m++) {
k=j.insertCell(-1);
if(m==0) {
y(k,"<p></p>");
r(k,i[dc]);
pb(k[J],i[J][bd]);
var q=k[rd][0],p=q[J];
D(p,c);
p.lineHeight=c;
Mb(p,"hidden")
}else r(k,"g")
}
}
};
rv[_P].FZ=function (a) {
var b=this.C.H,c=this.K(a),d=c[O][O];
om(d,c,c.rowIndex);
if(d[pd][E]<=1) {
var e=this.uL(a),f=-1,g=b.uc(e),h=g.Vw;
for(var i=0;i<h[E];i++)if(d==h[i]) {
f=i;
break
}d[O].removeChild(d);
if(f>-1) {
h[f]=[];
g.Sg[f]=[]
}if(a==1)this.oA=1
}
};
rv[_P].tW=function (a,b) {
if(b>a) {
var c=this.Jp,d=this.C.xa,e=this.AA;
T(e);
for(var f=a+1;f<=b;f++) {
var g=d.Np(f);
if(f<c[E]) {
var h=c[f];
Bi(h,"visibility","visible");
Bi(h,"display",g[J][Cd])
}
}
}
};
rv[_P].freezeColumns=function (a,b,c,d) {
var e=this.C,f=e.xa,g=e.Xb,h,i,j=false,k=a||b>1;
if(a) {
j=this.EA>0;
this.EA=0
}for(var m=0;m<=g+1;m++) {
i=this.Jp[m];
h=f.ob[m];
if(!j)if(a)e.dt(h,i,b,c,true,!j);
else e.dt(i,h,b,c,true,false);
if(m>0)this.Fe(m,i,h,false,k)
}Bi(f.ob[0][L][0],"border-right","none");
ij(f.ob[g+1][L][0],"sortBar");
if(!d) {
var n=e.H,q,p,s,u,v,t,w,B=0;
for(var m=0;m<n.Oa[E];m++) {
q=n.uc(m);
p=q.ob;
s=q.Sg;
u=q.If;
for(var A=0;A<p[E];A++) {
v=p[A];
t=s[A];
w=B+u[A];
for(var G=0;G<t[E];G++) {
h=v[G];
i=t[G];
if(a)e.dt(h,i,b,c,true,!j);
else e.dt(i,h,b,c,false,false);
if(G>0)this.Fe(w+G,i,h,false,k)
}
}B=q.uf
}
}if(b==1)if(a)hj(this.C.Be,"columnsFrozen");
else ij(this.C.Be,
"columnsFrozen")
};
rv[_P].sW=function () {
if(this.gm)this.gm.Zc()
};
function zv(a,b,c) {
this.z=a;
this.vf=b;
this.yg=c;
this.Wb=S;
this.B6=null;
this.A6=null;
this.Fh=5;
this.eU=null;
this.R=null;
this.Nc(a.doc,c)
}zv[_P].Nc=function (a,b) {
var c=this.z,d=Zk(a,b,"menuDivs",0,0,"100%","34");
this.R=d;
Mb(d[J],"hidden");
var e=su(a,d,"menuMainTbl",this.Fh,3,"","100%","table"),f=e.insertRow(0),g=0,h=f.insertCell(g);
this.eU=Ql(a,h,_M[81](),"menuMainLabel");
var i=h[J];
Qb(i,"normal");
x(i,"180px");
g++;
h=f.insertCell(g);
r(h,"menuMainLabel");
i=h[J];
Ka(i,"#fff solid 1px");
Qb(i,"normal");
Wa(i,
this.Wb?"2px":"6px");
x(i,"110px");
var j=this.Wb?"->":"&rarr;",k=new Sl(a,h,[[_M[82](j)],[_M[83](j)]]),m=k.X;
z(m[0],el(c,c.Aj,1));
z(m[1],el(c,c.Aj,0));
g++;
h=f.insertCell(g);
i=h[J];
i.verticalAlign="bottom";
Eb(i,"20px");
Wa(i,"6px");
var n=new Sl(a,h,[["<span>"+_M[74]+"</span>"]],true),q=n.X[0];
this.k0=n;
z(q,Rk(this,this.pca,h,c));
Ea(q,_M[77]);
g++;
h=f.insertCell(g);
i=h[J];
i.verticalAlign="bottom";
Eb(i,"10px");
Wa(i,"6px");
var p=new Sl(a,h,[["<span>"+_M[461]+"</span>"]],true),s=p.X[0];
this.i0=p;
z(s,Rk(this,
this.oca,h,c));
Ea(s,_M[464])
};
zv[_P].We=function (a,b) {
if(a==null)this.Rc();
else {
var c=b.Xb;
this.k0.cg(c>0?(c>1?_M[76](c):_M[75]):_M[74]);
var d=b.Ra;
this.i0.cg(d>0?(d>1?_M[463](d):_M[462]):_M[461]);
y(this.eU,_M[81]("<b>"+Cs(b.Ea)+" </b>"))
}
};
zv[_P].Rc=function () {
y(this.eU,_M[81]());
this.k0.cg(_M[74]);
this.i0.cg(_M[461])
};
zv[_P].wK=function (a) {
var b=this.z;
b.activeGrid.freezeRows(a);
b.L(true,true)
};
zv[_P].pca=function (a,b) {
var c=this.B6;
if(!c) {
var d=[[_M[80]],,[_M[78]],[_M[79](2)],[_M[79](3)],[_M[79](4)],
[_M[79](5)]];
c=new Ml(b.W(),b.getDivApp(),d,false);
var e=c.Gb;
z(e[0].J(),el(this,this.wK,0));
for(var f=2;f<d[E];f++)z(e[f].J(),el(this,this.wK,f-1));this.B6=c
}var g=this.vf;if(c.Ka) {
g.P();
return false
}b.P();
c.Sa("",a[Cc]+35-10,b.divGrids[Ed]-1);
g.Wg(c)
};
zv[_P].vK=function (a) {
var b=this.z;
b.activeGrid.freezeColumns(a);
b.L(true,true)
};
zv[_P].oca=function (a,b) {
var c=this.A6;
if(!c) {
var d=[[_M[467]],,[_M[465]],[_M[466](2)],[_M[466](3)],[_M[466](4)],[_M[466](5)]];
c=new Ml(b.W(),b.getDivApp(),d,false);
var e=
c.Gb;
z(e[0].J(),el(this,this.vK,0));
for(var f=2;f<d[E];f++)z(e[f].J(),el(this,this.vK,f-1));this.A6=c
}var g=this.vf;if(c.Ka) {
g.P();
return false
}b.P();
c.Sa("",a[Cc]+35-10,b.divGrids[Ed]-1);
g.Wg(c)
};
zv[_P].$=function () {
return this.R
};
Ra(zv[_P],function () {
if(this.R!=null)y(this.R,"")
});
function pv(a) {
this.Ur=0;
this.C=a;
this.cl=null;
this.Oa=null;
this.xK=null;
this.bordersChanged=false;
this.LE=null;
this.rR=new $g;
this.Iv=false
}pv[_P].kM=function () {
return this.uc(this.Oa[E]-1).Na()
};
pv[_P].g2=function () {
if(!this.kM())this.Iv=true
};
pv[_P].l$=function () {
if(this.Iv) {
this.Iv=false;
for(var a=0;a<this.Oa[E];a++) {
var b=this.uc(a);
if(!b.Na()) {
b.load();
return
}
}
}
};
pv[_P].NB=function (a,b) {
return kv(this.C,a,b)
};
var kv=function (a,b,c) {
var d=new Im(a.trixApp.url,"&",oo,"=",1),e=a.id;
if(e!=-1)d.append("&tile=",
e);
if(S&&a.Ha()<=200)d.append("&rpert=",100);
else d.append("&rpert=",20);
d.append("&tfe=",a.trixApp.eh);
if(b!=null)d.append("&srow=",b);
if(c!=null)d.append("&erow=",c);
return d.toString ()
};
pv[_P].XM=function () {
var a=this.C,b=a.divMain,c=a.trixApp.W(),d=this.cl,e=this.Oa;
if(!d) {
d=su(c,b,"framesContainer",0,0,"","","table");
e=[]
}this.cl=d;
this.Oa=e;
var f=o.ceil(a.Ha()/200),g=e[E],h=b[tc],i=a.lB()*200,j=a.I.qL();
for(var k=0;k<f;k++) {
if(k>=g) {
e[k]=this.EY(d,k,c,h,i);
var m=j.insertRow(k).insertCell(0);
r(m,"framesContainerCells");
Bi(m,"height",i)
}var n=k+1;
e[k].qx(n*200+(f!=1&&n==f?999:0))
}var q=d[pd],p=j[pd];
for(var k=g-1;k>=f;k--) {
var s=e.pop();
s.dispose();
om(d,q[k],k);
om(j,p[k],k)
}this.xK=q
};
pv[_P].EY=function (a,b,c,d,e) {
var f=a.insertRow(b).insertCell(0);
r(f,"framesContainerCells");
return new gv(this,c,f,b,d,e)
};
pv[_P].h$=function () {
var a=this.C,b=a.info.rowsTOids,c=a.info.colsTOids,d={
};
d.jga=b[a.O];
d.iga=c[a.Y];
d.wea=b[a.Ga];
d.vea=c[a.Ea];
d.Aea=b[a.O+a.ma-1];
d.zea=c[a.Y+a.Z-1];
this.LE=d;
var e=
this.Oa;
for(var f=0;f<e[E];f++)e[f].eR()
};pv[_P].Ada=function (a) {
if(this.Ec()) {
var b=a?"0px none":"1px solid",c=this.Oa;
for(var d=0;d<c[E];d++) {
var e=c[d];
if(e.Na()) {
var f=e.ob;
for(var g=0;g<f[E];g++) {
var h=f[g];
if(h&&h[E]>0)Ua(h[0][L][0][J],b)
}
}
}
}
};
pv[_P].mK=function (a) {
if(this.bordersChanged||a) {
this.aS(false);
gm(this,this.aS,0,true)
}
};
pv[_P].aS=function (a) {
var b=this.Oa,c=a?"collapse":"separate",d,e,f,g,h;
for(d=0;d<b[E];d++) {
f=b[d];
if(f.Na()) {
g=f.ji;
if(g)for(e=0;e<g[E];e++) {
h=g[e];
if(h)h[J].borderCollapse=
c
}
}
}if(a) {
this.bordersChanged=false;
this.Nj()
}
};
pv[_P].V=function () {
return this.C
};
pv[_P].bu=function (a) {
var b=this.Le(a),c=this.Zd(b);
return c+this.Oa[b].bu(a-c)
};
pv[_P].RK=function () {
return this.aL().getElementById("colHWrap")
};
pv[_P].z0=function () {
return this.RK()[rc]
};
pv[_P].lL=function () {
return this.RK()[rd][0][pd][E]-2
};
pv[_P].Ec=function () {
return this.Ur==2
};
pv[_P].mF=function (a) {
this.Ur=a;
if(a==0) {
var b=this.Oa;
if(b)for(var c=0;c<b[E];c++)b[c].Gr(0)
}
};pv[_P].Ck=function () {
return this.Ur
};
pv[_P].g5=function () {
var a=this.Oa[0],b=this.C;
if(a.yw) {
}else if(a.IH(0)) {
this.XM();
b.I.j$();
var c=b.Gk;
c.reset(b.Ha());
a.fR(c);
this.f$();
var d=a.zB();
if(d>0)a.freezeColumns(b,d)
}else return false;
return true
};
pv[_P].f$=function () {
var a=this.C,b=a.$m,c=a.Ba;
b.reset(c);
var d=this.K(0)[L];
for(var e=c;e>=1;e--) {
var f=d[e],g=kj(f,"hdn");
b.ox(e-1,e-1,g)
}
};
pv[_P].NW=function (a,b) {
var c=this.Oa,d=a;
for(var e=a;e<=b;e++) {
var f=c[e],g=this.C;
if(f.yw) {
}else if(f.IH(this.Zd(e))) {
f.fR(g.Gk);
var h=f.zB();
if(h>
0)f.j0(g)
}else return false;
d++
}return d==b+1
};
pv[_P].lQ=function () {
if(this.g5()) {
this.mQ(0);
this.mF(2);
var a=this.C.Pa();
a.Qu(true);
a.iK()
}else fi(R(this.lQ,this),hv)
};
pv[_P].mQ=function (a) {
var b=this.Oa,c=b[E]-1,d=a==0,e=this.C;
if(d&&e.trixApp.Ec()) {
var f=this.LE;
this.LE=null;
if(f==null)e.gr();
else {
var g=e.info.idsTOrows,h=e.info.idsTOcols,i=g[f.jga],j=h[f.iga],k=g[f.wea],m=h[f.vea],n=g[f.Aea],q=h[f.zea];
if(i==null||j==null||k==null||m==null||n==null||q==null)e.gr();
else {
var p=b[c].uf,s=e.Ba;
i=
o.min(i,p);
j=o.min(j,s);
e.Kr(i,j,o.min(k,p),o.min(m,s),o.min(n,p)-i+1,o.min(q,s)-j+1)
}
}
}this.Nj();
e.U8(a);
this.cm();
if(d&&e==e.trixApp.activeGrid)e.zj(true,false);
if(a<c)b[a+1].load();
else if(Wf) {
var u=e.I;
fi(R(u.Ef,u,false,null),100)
}
};
pv[_P].Nj=function () {
var a=this.C;
if(!a.vq()) {
a.a0();
return
}var b=this.Oa,c=this.Mb(),d=null;
for(var e=0;e<b[E];e++) {
d=b[e].wb[J];
x(d,c+"px");
D(d,b[e].Lb()+"px")
}this.cm()
};
pv[_P].Z0=function (a) {
var b=this.Oa,c=b[E]-1;
for(var d=0;d<c;d++)if(b[d+1].gb[Ed]>a)return b[d];
return b[c]
};pv[_P].uc=function (a) {
return this.Oa[a]
};
pv[_P].Le=function (a) {
var b=0,c=this.Oa,d=c[E];
while(b<d&&a>c[b].uf)b++;
return b
};
pv[_P].K=function (a,b,c) {
if(b==true||a==0||this.C.Xb<a) {
var d=c==null?this.Le(a):c,e=this.Oa[d];
if(e.Na())return e.K(a-this.Zd(d))
}else return this.C.xa.Np(a);
return null
};
pv[_P].Zd=function (a) {
return a>0?this.Oa[a-1].uf:0
};
pv[_P].insertRow=function (a,b) {
var c=this.Oa,d=this.Le(a),e=this.Zd(d);
for(var f=d;f<c[E];f++)c[f].qx(c[f].uf+1);return c[d].insertRow(a-e,b)
};
pv[_P].deleteRow=function (a) {
var b=this.Oa,c=this.Le(a),d=this.Zd(c);
b[c].deleteRow(a-d,c);
for(var e=c;e<b[E];e++)b[e].qx(b[e].uf-1)
};pv[_P].kq=function (a,b) {
var c=this.Le(a),d=this.Zd(c);
this.Oa[c].kq(a-d,b)
};
pv[_P].Xu=function (a,b,c,d) {
var e,f,g,h,i,j,k,m,n=a==this.C.Ba&&d,q=this.Oa;
for(h=0;h<q[E];h++) {
var p=q[h].ob;
for(i=0;i<p[E];i++)if(p[i])for(j=0;j<p[i][E];j++) {
e=p[i][j];
f=e[L][a];
for(k=0;k<b;k++) {
m=uv(f,this.C,false);
g=Au(f,e,a+d,n);
if(m!=null)if(m<a) {
g.mergP=f.mergP;
C(g[J],"none")
}if(j==0) {
D(g[J],
"0px");
x(g[J],c+"px")
}
}
}
}
};
pv[_P].qt=function (a,b) {
var c,d,e,f,g=null,h=this.Oa;
for(c=0;c<h[E];c++) {
var i=h[c].ob;
for(d=0;d<i[E];d++)if(i[d])for(e=0;e<i[d][E];e++) {
g=i[d][e];
for(f=0;f<b;f++)if(S)g.removeChild(g[L][a]);else g.deleteCell(a)
}
}
};pv[_P].cn=function (a,b,c,d) {
var e=this.Oa;
for(var f=0;f<e[E];f++) {
var g=e[f].ob;
for(var h=0;h<g[E];h++)zu(g[h],a,b,c,d)
}
};pv[_P].Mb=function () {
return this.Oa[0].Mb()
};
pv[_P].Lb=function () {
var a=this.Oa,b=0;
for(var c=0;c<a[E];c++)b+=a[c].Lb();return b
};pv[_P].hd=
function (a) {
var b=le(a),c=this.rR.get(b);
if(c!=null)return c;
c=a.isFrozenRow==true||a.getAttribute("isFrozenRow")?a[Ed]-32:this.xK[a[Nc].trixIndex][Ed]+a[O][O][O][Ed]+a[Ed];
this.rR.set(b,c);
return c
};
pv[_P].cm=function () {
this.rR.clear()
};
pv[_P].qea=function (a) {
var b=this.Oa;
for(var c=0;c<b[E];c++)a.write("<div class='framesContainer'>",b[c].Pm()[rc],"</div>")
};pv[_P].pea=function (a) {
var b=this.Oa,c=[],d,e,f;
for(var g=0;g<b[E];g++) {
d=b[g].D0();
for(var h=0;h<d[E];h++) {
e=d[h].selectorText;
if(c[e]==null) {
c[e]=
1;
f=e;
f+="{";
f+=d[h][J][bd];
f+="}";
a.write(f)
}
}
}
};
pv[_P].aL=function () {
return this.Oa[0].wh()
};
pv[_P].dispose=function () {
var a=this.Oa;
if(a) {
for(var b=0;b<a[E];b++)a[b].dispose();this.Oa=null
}this.C=null;this.cl=null;this.Oa=null;this.xK=null;this.LE=null
};$t(du,"en");au(cu,"en");bu(Wt,"en");var oo="action",X={
value:1,formula:2,clear:3,clearFmt:4,format:5,gridInfo:6,numberFormat:8,fontFamily:9,fontSize:10,fontWeight:11,fontStyle:12,textDecoration:13,whiteSpace:14,textAlign:15,verticalAlign:16,color:17,direction:18,backgroundColor:31,borders:32,conditionalFormat:35,freezeRows:40,resizeRow:41,resizeCol:42,mergeCellsAcross:43,unmergeCells:44,freezeColumns:45,autoResizeCol:46,newGrid:51,removeGrid:52,renameGrid:53,moveGrid:54,duplicateGrid:55,pasteValues:59,
pasteFormat:60,rowInsert:61,rowDelete:62,colInsert:63,colDelete:64,pasteAll:65,pasteFromClip:67,rowInsertAfter:68,colInsertAfter:69,undo:71,redo:72,addUser:73,deleteUser:74,newIM:75,selection:76,setUsers:77,mode:81,addRange:91,removeRange:92,localeChange:99,sort:151,moveRowsBefore:152,moveRowsAfter:153,newPasteCut:154,retractArray:161,hideUnhideRows:170,hideUnhideCols:171,errorGeneric:200,errorSuggReload:201,errorReload:202,errorLow:203,errorHigh:204,errorSeq:205,error9:206,disclaimer:210,cellExpansion:211,
reloadGrids:220,reloadAllGrids:221,renameDoc:301,lastSaved:302,autoSave:303,insertObject:401,updateObject:402,deleteObject:403,setUserComment:501,clearUserComment:502,aclRulesUpdate:520,autoFill:601,alternateAutoFill:602,updateScript:620,replaceAll:701,toast:9001,publish:9002
},po=1,Kv=2,Pr=3,Lv=null,Mv="toastCellExpansionUndo";
function Y(a) {
this.dga=new Date;
this.Ze=a.Ia("key");
try{
oa.execCommand("BackgroundImageCache",false,true)
}catch(b) {
}var c=new Date(a.Ia("loadTime"));
this.$fa=ka-c;
this.isIE=
S;
this.mode=a.Ia("mode");
if(this.mode==null)this.mode=0;
this.mI=a.Ia("chrome2");
this.LD=a.Ia("os");
this.tfa=a.Ia("jsCompileModeIsRaw");
this.Kea=a.Ia("chartsModuleFilenames");
this.ofa=a.Ia("gadgetsModuleFilenames");
this.rfa=a.Ia("imagesModuleFilenames");
this.lfa=dn;
this.qga=a.Ia("urlSearch");
this.pda=a.Ia("timePts");
this.zM=a.Ia("hlParameter");
this.fX=a.Ia("bidi");
this.userLocale=null;
this.Kl=null;
this.win=a.Ia("win");
this.doc=a.Ia("doc");
this.doc.window=this.win;
this.MIN_APP_WIDTH=450;
this.MIN_APP_HEIGHT=
250;
this.Ae=null;
this.dk=null;
this.activeGrid=null;
this.activeFormuGrid=null;
this.divGrids=null;
this.fG=null;
this.menuMain=null;
this.wJ=null;
this.Tz=null;
this.Xe=null;
this.Vq=null;
this.Rn=null;
this.Ur=null;
this.Jy=64;
this.pathImg="../images/";
this.c7="";
this.url=null;
this.cV=null;
this.sG=null;
this.isPanningOn=false;
this.cellOverlayManager=null;
this.appOverlayManager=null;
this.cellSelection=null;
this.mouseSelection=null;
this.Rea=null;
this.pZ=null;
this.dboxAlert=null;
this.screenFuncs=null;
this.Fz=null;
this.modalDbox=null;
this.cG=null;
this.copyPaste=null;
this.Ji=null;
this.gda=null;
this.R8=null;
this.Dh=null;
this.isDirty=null;
this.EX=false;
this.gooffiLink=null;
this.isReady=false;
this.Zm=false;
this.nX=false;
this.oR=[];
this.jP=0;
this.Cq=null;
this.gU=null;
this.eh=null;
this.Fj=[];
this.Qr=null;
this.zd=new Jv(this);
this.xW={
};
this.wf=false;
this.sP=null;
this.eaa=null;
this.ze=null;
this.La=rk("GoogleSpreadsheets");
var d=a.Ia("gears");
this.emailAddress=a.Ia("email");
this.uh=d;
this.gV=a.Ia("userDashDom");
this.gea=
a.Ia("userDashPrefix");
var e=$e(this.gV),f=d?new Xs(this.emailAddress,e):null;
this.p0=f;
this.q0=d?new gt(f):null;
this.G=new mj(this);
this.De=new fg(this.doc);
this.nt="";
this.qb=null;
this.bP=null;
this.Aa=new mv(this);
this.eK=null;
this.iI=null;
this.yU=null;
var g=a.Ia("evLog");
this.WJ=g?new Xk(g):null;
this.$k=null;
this.a4=false;
this.JV=null;
this.Nb=null
}Y[_P].$j=null;
Y[_P].Mf=function () {
if(!this.qb)this.JY();
return this.qb
};
Y[_P].JY=function () {
Nv(this.lfa);
this.qb=new Ov(this)
};
Y[_P].Qm=function () {
if(!this.bP)this.bP=
new fu(this);
return this.bP
};
Y[_P].Ti=function () {
if(pn)return this.Nb||(this.Nb=new ii(this.gooffiLink))
};
Y[_P].t0=function () {
if(pn)return this.JV||(this.JV=new wr(this))
};
Y[_P].V0=function () {
if(!this.eK)this.eK=new Pv(this);
return this.eK
};
Y[_P].Zt=function () {
if(!this.iI)this.iI=new ut(this);
return this.iI
};
Y[_P].Pp=function () {
if(!this.yU) {
var a=oo+"=5",b=hm(this.url,a,false);
this.yU=eval(b[pc])
}return this.yU
};
Y[_P].autoLoad=function (a,b,c,d,e,f) {
this.eh=f;
this.dk=a;
y(a,"");
a.trixNode=this;
this.Nr(b,
c);
this.Qaa(d);
if(Lv==null)Lv=Vl(d,["toolbarAll9.gif","bg-btn.gif","bg-btn.png","icon-dropdn.gif","icon-disabled-dropdn.gif","modalDlgBack.png"]);
this.lba(e);
this.B4();
var g=new Z(this,-1,200,20);
this.Aa.Wo(g,"temp");
g.Hv(false)
};
Y[_P].UR=function () {
if(this.a4)return ;
this.a4=true;
var a=oo+"=14";
a+="&tzo="+(new Date).getTimezoneOffset();
a+="&tzfp="+(this.pda?fa(Rt(this.pda)):"");
a+="&tfe="+this.eh;
hm(this.url,a,true)
};
Y[_P].kQ=function (a) {
var b=this.V(0).H.aL();
b.write(a);
b.close()
};
re(Y[_P],"processAction1",
Y[_P].kQ);
Y[_P].jQ=function (a) {
this.JS(a.lsq);
if(this.gooffiLink)this.gooffiLink.Uaa(a.lst);
this.eh=a.tfe;
var b=a.a,c=a.mf,d=a.ffm,e=a.ul,f=a.sl,g=a.p;
if(a.action==0&&b!=null&&c!=null&&e!=null&&f!=null&&d!=null) {
var h=this.Aa;
for(var i=0;i<b[E];i++) {
if(i==0) {
var j=h.Xp(0);
Kb(j,b[i].g);
j.Fr(b[i].i);
j.QS(b[i].r);
j.OS(b[i].c)
}else {
var j=new Z(this,b[i].i,b[i].r,b[i].c);
h.Wo(j,b[i].g)
}if(b[i].dw!=null)j.Baa(b[i].dw);
if(b[i].dh!=null)j.Caa(b[i].dh)
}this.userLocale=e;
this.Kl=f;
this.R8=g;
this.gX(c);
var k=
this.menuMain;
k.Nm().WU(null,d);
k.Om().oK(true);
this.setMode(this.mode);
if(a.d!=null) {
var m=this.Ji;
m.pS(a.d);
m.MJ(true)
}if(a.nr!=null)this.zd.initialize(a.nr)
}else this.ai(_M[0]);
this.Wn();
this.iK()
};
re(Y[_P],"processAction0",Y[_P].jQ);
Y[_P].iK=function () {
if(!this.nX) {
this.nX=true;
return
}var a=this.Zm;
if(!a&&this.Dh)this.Dh.connect();
var b=this.activeGrid;
if(!Zf||Wf) {
gm(b,b.vj,0);
gm(this,this.L,0)
}this.cellSelection.nz(false);
this.isReady=true;
this.Zm=true;
if(!a&&Zf)this.activate(0,true,false,true);
var c=this.xW;
for(var d in c) {
var e=this.Aa.pb(d);
if(e.H.Ec()) {
var f=c[d];
if(f) {
for(var g=0;g<f[E];g++)f[g]();c[d]=null;delete c[d]
}
}
}if(!a) {
this.O$();
if(this.activeGrid.H.kM())this.UR()
}this.ai(_M[126]);
this.KJ();
if(Uf&&Zf)gm(b,b.iE,0);
if(W.formStatus.formIsTurnedOn) {
this.uF();
this.Wn()
}
};
Y[_P].QT=function () {
if(this.gooffiLink)if(!this.gooffiLink.ya.hv()) {
ra(_M[675]);
return
}var a;
if(!this.$k) {
a=new Fj(this,false,2,false);
this.$k=new As(this,a);
this.$k.render(a.Ja())
}else a=this.$k.xb;
this.$k.hca();
a.D(true)
};
Y[_P].sF=function (a,b) {
if(pn&&this.Ya(false)) {
var c=this.t0();
if(a)c.aK(b);
else c.Bf();
c.zk().focus()
}
};
Y[_P].Z6=function (a) {
if(this.Nb)this.Nb.nO(true,a)
};
Y[_P].B4=function () {
var a=this.dk,b=this.doc,c=al(b,a,"","");
this.Ae=c;
var d=o.max(this.MIN_APP_HEIGHT,c[Id])-this.Jy-26,e=Tk(b,c,"","");
e[J].tableLayout="fixed";
x(e[J],"100%");
var f=e.insertRow(0),g=f.insertCell(0);
this.fG=g;
f=e.insertRow(1);
g=f.insertCell(0);
var h=Zk(b,g,"divAppArea"+(S?" IE":(Uf?" FF":"")),0,0,"100%",d);
this.divGrids=
h;
this.cellOverlayManager=new ir(this,b,h);
this.appOverlayManager=new br(this,b,h);
this.cellSelection=new ru(this);
this.mouseSelection=new Dv(this);
this.copyPaste=new Ju(this);
this.Nq=new Hv(this);
this.divMsg=Zk(b,h,"divMsg",-1000,2,"","");
f=e.insertRow(2);
g=f.insertCell(0);
this.Ji=new Mu(this,b,g);
C(g[J],"none");
this.gda=g;
f=e.insertRow(3);
g=f.insertCell(0);
e=Tk(b,g,"","");
f=e.insertRow(0);
g=f.insertCell(0);
D(g[J],26);
var i=o.max(g[tc],this.MIN_APP_WIDTH);
this.Tz=Zk(b,g,"panels",0,0,(S?i:i-1)-250,
"100%");
g=f.insertCell(1);
D(g[J],26);
var j=Zk(b,g,"panels panelStatus",0,0,250,"100%");
this.wJ=j;
y(j,"<table cellpadding='0' class='tblGeneric' style='table-layout:fixed'><tr><td class='secStatus'></td><td class='secVersion'></td></tr></table>");
var k=j[rd][0][pd][0][L];
this.Ur=k[0];
this.Vq=k[1];
this.Rn=new Iv(this,j);
z(this.Vq,Qk(this.Rn,this.Rn.ut));
this.maa();
if(Uf) {
var m=oa.getElementsByTagName("INPUT");
for(var n=0;n<m[E];n++)m[n].setAttribute("autocomplete","off")
}this.ze=new dr(this)
};Y[_P].bT=
function (a) {
this.eaa=a
};
re(Y[_P],"setSessionId",Y[_P].bT);
Y[_P].dj=function () {
return this.eaa
};
Y[_P].mS=function (a) {
this.nt=a
};
re(Y[_P],"setDasherPrefix",Y[_P].mS);
Y[_P].d2=function () {
return this.gea?this.gea:""
};
Y[_P].lS=function (a) {
this.Qea=a
};
re(Y[_P],"setDasherPrefixForPublish",Y[_P].lS);
Y[_P].yT=function () {
if(!this.$j)this.$j=new Ts(this.De);
var a=this.$j;
if(!a.rb)a.render(oa[Lc])
};
re(Y[_P],"sdw",Y[_P].yT);
Y[_P].uF=function () {
var a=W.getFormIndicator();
a.jT(this.Da());
var b=lg("div","menuMain")[0];
if(a.rb)a.D(true);
else a.render(b[O]);
this.G.listen(a,"edit_form",this.Xm)
};
Y[_P].Xm=function () {
W.openFormEditorWindow(this.Ze,this.zM)
};
Y[_P].YB=function () {
var a=W.getFormIndicator();
if(a.rb)a.D(false);
this.G.unlisten(a,jr,this.xga)
};
Y[_P].L=function (a,b) {
this.cellSelection.L(a,b)
};
Y[_P].iF=function (a) {
var b=this.Vq,c=this.Rn,d=c.Uda(a),e="";
if(d>1)e=c.J0();
else if(d<0)e=_M[391]("");
var f=T(b);
f.Co(b,e)
};
Y[_P].cea=function (a) {
var b=this.Vq,c=T(b);
c.Co(b,a)
};
Y[_P].cb=function (a,b) {
var c=this.dboxAlert;
if(!c) {
c=new Sr(this);
this.dboxAlert=c
}if(b==null)c.HS(_M[9],a);
else c.HS(b,a);
c.D(true)
};
Y[_P].Hg=function () {
var a=this.cG;
if(a==null) {
a=new Sk(this.doc,this.divGrids,this.pathImg);
var b=this;
a.onAfterHideHandler=function (c) {
b.Zx(c)
};
this.cG=a
}return a
};
Y[_P].Zx=function (a) {
var b=null;
try{
b=a[Sc][dc]
}catch(a) {
}switch(b) {
case Mv:if(this.Ya(false)) {
var c=oo+"=9";
c+="&atyp="+X.retractArray;
this.Bb(_M[4]);
this.Ab(c,false)
}break;
default:if(this.gooffiLink!=null)this.gooffiLink.Zx(b);
break
}this.L()
};
Y[_P].reloadGrids=
function (a,b) {
var c=null;
for(var d=0;d<a[E];d++) {
var e=this.pb(a[d]);
if(e.e$())c=e
}if(c) {
if(b)this.Hg().gi(b.tt,b.tc,null,true);
c.Hv(true)
}
};
Y[_P].C9=function (a) {
var b=this.activeGrid.id,c=null,d=this.Aa,e=a[E];
for(var f=0;f<e;f++) {
var g=a[f],h=g.g,i=g.i,j=d.pb(i);
if(j) {
this.renameGrid(j[fc],j,h,null);
var k=c?c.id:-1;
this.moveGrid(j,k,false);
j.Pt();
j.IX();
c=j
}else {
this.newGrid(c,h,i,1,1,false);
c=d.pb(i)
}
}var m=d.pb(b)[fc],n=m>=e?0:m;
this.activate(n,false,false,true,false);
for(var f=d.of()-1;f>=e;f--)this.removeGrid(d.Xp(f),
false);if(Wf)d.Wq(n,false)
};Y[_P].O$=function () {
var a=oo+"=12";
a+="&output="+(new Date-this.dga);
a+="&range="+(new Date-ka);
var b=this.activeGrid;
a+="&scol="+b.Ba;
a+="&srow="+b.Ha();
a+="&nrow="+b.Xb;
a+="&gid="+this.Aa.of();
a+="&tfe="+this.eh;
var c=bn().Ia("isBlank");
a+="&tile="+(c?0:1);
hm(this.url,a,true)
};
Y[_P].Dy=function (a,b) {
var c=this.pb(a);
if(c&&c.H.Ec())b();
else {
var d=this.xW,e=d[a];
if(!e)e=d[a]=[];
e.push(b)
}
};
Y[_P].nK=function (a) {
if(S)return ;
var b=this.Aa;
for(var c=0;c<b.of();c++)b.vB(c).H.Ada(a)
};
Y[_P].setConnectionParams=function (a,b,c) {
this.Dh=new iq(this,a,b,c)
};
Y[_P].OF=function () {
if(this.Dh!=null)this.Dh.disconnect(true)
};
Y[_P].maa=function () {
if(!S) {
this.sG=Lj(this,this.l8);
Jj(this.win,"resize",this.sG)
}this.cellSelection.laa()
};
Y[_P].l8=function () {
var a=this.menuMain.Om();
a.mx();
a.oK(false)
};
za(Y[_P],function (a,b,c,d) {
x(this.dk[J],c);
var e=o.max(a,this.MIN_APP_WIDTH);
x(this.Ae[J],e);
x(this.divGrids[J],e);
var f=this.menuMain;
if(f)f.resize(e);
x(this.Tz[J],(S?e:e-1)-250);
x(this.wJ[J],250);
this.Jy=!this.Da()?64:39;
C(this.fG[J],"");
var g=o.max(b,this.MIN_APP_HEIGHT),h=this.Ji.mB();
if(this.gooffiLink!=null)this.gooffiLink.ya.wu().resize(a,g-this.Jy,this.divGrids[Ed]);
D(this.Ae[J],g);
var i=g-this.Jy-26-h;
i-=W.getFormIndicator().Lb();
D(this.divGrids[J],i);
var j=this.Xe;
if(j)j.i$();
var k=this.Aa.yh();
if(d)for(var m=0;m<k[E];m++)k[m].rl();if(!S)if(this.activeGrid!=null)this.activeGrid.zj(true,false)
});Y[_P].k$=function () {
C(this.gda[J],this.Ji.wc()?"":"none");
this.Wn()
};
Y[_P].Wn=function () {
this.resize(this.Ae[tc],
this.Ae[Id],this.dk[tc],true)
};
Y[_P].setDisconnectedMode=function (a) {
this.wf=a;
this.sP=a?this.mode:this.sP;
this.setMode(a?2:this.sP);
var b=this.gooffiLink;
if(b!=null)b.mba(!a);
this.B8(a);
this.ze.jx(a);
if(a&&!this.uh)this.Bb(_M[348],true)
};
Y[_P].B8=function (a) {
var b=this.Fj;
for(var c=0;c<b[E];c++)b[c].executor.TS(a)
};Y[_P].JS=function (a) {
if(a==null) {
this.hE("Null LSQ encountered",X.errorSeq);
return false
}if(a<=this.Cq) {
this.log("LSQ out of order: "+this.Cq+" vs "+a,true);
return false
}this.Cq=a;
if(!this.gU)this.gU=
a;
return true
};
Y[_P].L3=function () {
return this.gU!=this.Cq
};
Y[_P].hE=function (a,b) {
this.Af(a,b,false);
this.log(a,true)
};
Y[_P].setMode=function (a) {
this.mode=a;
var b=this.Da();
if(this.gooffiLink!=null)this.gooffiLink.Xg(b);
if(this.isReady) {
this.$H();
this.ai("");
this.resize(this.Ae[tc],this.Ae[Id],this.dk[tc],true);
if(this.gooffiLink!=null)this.gooffiLink.ya.resize();
if(this.activeGrid!=null)this.activate(this.activeGrid[fc],true,false,true,true,true);
var c=this.Aa.yh();
for(var d=0;d<c[E];d++) {
var e=
c[d].$a;
if(e)e.Xg(b)
}this.ze.jx(b);
if(W.formIndicatorIsRendered())W.getFormIndicator().jT(b)
}
};
Y[_P].Da=function () {
return this.mode>0
};
Y[_P].Bh=function () {
return this.win
};
Y[_P].W=function () {
return this.doc
};
Y[_P].getDivApp=function () {
return this.Ae
};
Y[_P].getDivWholeApp=function () {
return this.dk
};
Y[_P].ai=function (a,b) {
var c=this.Ur;
wp(this.doc,c,a);
Ea(c,S?a:a.replace(/\n/mg," "));
var d="secStatus ";
if(b!=null)d+=b;
r(c,d)
};
Y[_P].V=function (a) {
return this.Aa.vB(a)
};
Y[_P].pb=function (a) {
var b=this.Aa.pb(a);
if(b)return b;
return null
};
Y[_P].Nv=function (a) {
var b=this.Aa.Xp(a);
if(b.Qd==0) {
if(this.fv()) {
var c=this.V(a),d=c.H.Ec();
if(!this.wf||d||this.uh) {
if(this.activeGrid!=null&&this.activeGrid!=c)this.activeGrid.H.g2();
this.activate(a,true,false,false);
this.activeGrid.H.l$();
if(Uf&&d) {
var e=c.I;
fi(R(e.Ef,e,false,null),0)
}
}
}
}else this.QG(a,true,false,false)
};
Y[_P].QG=function (a,b,c,d,e) {
var f=this.Aa,g=f.Xp(a);
if(g.Qd==0)this.activate(a,b,false,c,d,e);
else {
g.Sa(true);
f.qM(a);
f.haa(a);
this.Xe.TU(a,false)
}
};
Y[_P].activate=function (a,b,c,d,e,f) {
c=c==null?false:c;
var g=this.cellSelection.ke()&&!c,h=null;
if(!g&&!c&&e!=false)this.cellSelection.Id(true);
var i=this.modalDbox;
if(!i||d||i&&i.vH()) {
h=this.V(a);
if(!h.H.Ec()&&this.Zm)h.Hv(true);
this.Aa.qM(a);
if(g) {
this.cellSelection.Eo();
this.activeFormuGrid=h;
h.Sa(true);
h.vc(0)
}else {
this.activeGrid=h;
h.Sa(true);
if(this.Da())h.$a.cf();
h.nj()
}this.L();
this.Aa.faa();
if(b)this.Xe.TU(a,this.wf);
this.iF(null);
if(this.Zm) {
if(!f)h.c$();
h.Sa(true);
if(h.H.Ec()) {
h.I.Ef(false);
h.jaa(this.mode==0);
h.kE();
this.mouseSelection.Bba(h);
var j=h.$a;
fi(R(j.v9,j,true),0);
h.rl();
this.ze.kS(h)
}
}
}
};
Y[_P].gX=function (a) {
if(this.menuMain==null) {
this.Xe=new Cv(this,this.Tz,0,0,"100%","100%");
this.$H(a);
for(var b=0;b<this.Aa.of();b++)this.Xe.Bs(this.V(b)[yd],"",false)
}this.activate(0,true,false,true)
};Y[_P].$H=function (a) {
if(this.menuMain==null)this.menuMain=new xv(this,this.fG,a,this.dk,this.mI,this.LD);
var b=this.Xe;
if(!this.Da()) {
this.menuMain.Xg(false);
b.cS(true)
}else {
this.menuMain.Xg(true);
b.cS(false)
}
};
Y[_P].qca=function () {
if(this.screenFuncs==null)this.screenFuncs=new zr(this,this.Ae);
this.screenFuncs.D(true)
};
Y[_P].moveGrid=function (a,b,c) {
if(a==null) {
if(this.Ya(false)) {
var d=oo+"=9";
d+="&gid="+this.activeGrid.id;
d+="&atyp="+X.moveGrid;
d+="&v="+b;
this.Bb(_M[4]);
this.Ab(d,false)
}this.L()
}else {
var e=b==-1?0:this.pb(b)[fc];
if(b>-1&&e<a[fc])e++;
this.Aa.mD(a,e,c)
}
};
Y[_P].newGrid=function (a,b,c,d,e,f) {
var g=this.Aa;
if(c==null) {
if(this.Ya(false))if(g.of()>=40)this.cb(_M[12](40));
else {
var h=
oo+"=9";
h+="&gid="+this.activeGrid.id;
h+="&atyp="+X.newGrid;
this.Bb(_M[4]);
this.Ab(h,false)
}this.L()
}else if(!this.pb(c)) {
var i=new Z(this,c,d,e);
g.Wo(i,b);
if(f)i.Hv(true);
var j=a==null?0:a[fc]+1;
g.mD(i,j,f)
}else this.Af("",X.newGrid,false)
};
Y[_P].removeGrid=function (a,b) {
if(a==null) {
if(this.Aa.of()>1) {
if(this.Ya(false))if(la(_M[14])) {
var c=oo+"=9";
c+="&gid="+this.activeGrid.id;
c+="&atyp="+X.removeGrid;
this.Bb(_M[4]);
this.Ab(c,true)
}
}else this.cb(_M[13]);
this.L()
}else this.Aa.VQ(a,b)
};
Y[_P].duplicateGrid=
function () {
if(this.Ya(false))if(this.Aa.of()>=40)this.cb(_M[12](40));
else {
var a=oo+"=9";
a+="&gid="+this.activeGrid.id;
a+="&atyp="+X.duplicateGrid;
this.Bb(_M[4]);
this.Ab(a,false)
}this.L()
};
Y[_P].renameGrid=function (a,b,c,d) {
if(b==null) {
if(this.Ya(false)) {
if(a==null) {
b=this.activeGrid;
a=b[fc]
}else b=this.V(a);
c=c==null?b[yd]:c;
c=d==null?um(_M[18],c):um(d,c);
if(c!=null&&c!=b[yd]) {
var e=30;
d="";
c=Wl(c);
if(c[E]==0||c[E]>e)d=_M[15](" ");
else for(var f=0;f<this.Aa.of();f++)if(f!=a)if(this.V(f)[yd]==c)d=
_M[19](" ");if(d[E]!=0)this.renameGrid(a,null,c.substring(0,e),d);else {
d=oo+"=9";
d+="&gid="+b.id;
d+="&atyp="+X.renameGrid;
d+="&v="+fa(c);
this.Bb(_M[4]);
this.Ab(d,false)
}
}
}this.L()
}else this.Aa.XQ(b,c.toString ())
};
Y[_P].C$=function () {
if(this.Ya(false,true)) {
var a=oo+"=9";
a+="&atyp="+X.updateScript;
this.Bb(_M[4]);
this.Ab(a,false)
}
};
Y[_P].n$=function () {
var a=this.OE(Kv);
if(a)this.menuMain.Nm().WU(a.mf,a.ffm)
};
Y[_P].E$=function () {
var a=this.copyPaste.P1(this.activeGrid," "," ",true),b=this.qga+fa(a);
jm(b)
};
Y[_P].hQ=function (a) {
a=a==true;
var b=null;
if(this.Dh!=null) {
b=this.OE(po);
this.R8=b
}if(b==null)this.Q8(null,a);
else {
var c=this.activeGrid,d=c.id,e=new Im;
e.append(kv(c,0,b[d].r));
e.append("&fprt=",a);
e.append("&scol=0&ecol=");
e.append(b[d].c);
this.win.open(e.toString ())
}
};
Y[_P].Q8=function (a,b) {
var c=this.doc,d=this.activeGrid,e=this.win.open()[mc];
e.write("<html><head><title>",c[ac],"</title>");
e.write("<style type='text/css'>");
d.H.pea(e);
e.write("</style></head>");
e.write(b==true?"<body onload='window.print()'>":
"<body>");
var f=this.Ae,g=Zk(c,f,"",-3,-3,"0px","0px");
C(g[J],"none");
var h=null;
if(a!=null) {
h={
};
h.r1=1;
h.c1=1;
h.r2=a[d.id].r;
h.c2=a[d.id].c
}d.oea(e,c,g,h);
f.removeChild(g);
e.write("</body></html>");
e.close()
};
Y[_P].NV=function () {
var a=this.activeGrid;
if(this.modalDbox==null&&a!=null&&!this.Nq.pJ) {
var b=this.cellSelection;
if(!b.isEditBoxActive) {
b.ui(true);
b.F2OrMouse=true
}this.L()
}
};
Y[_P].eN=function (a,b) {
var c=this.cellSelection,d=this.activeGrid;
if(this.modalDbox==null&&d!=null) {
var e=c.db;
if(c.isEditBoxActive) {
if(e[I]==
"")Ta(e,"=");
e.value+=a+"(";
if(b!=null)e.value+=b+")";
if(Wf) {
var f=e[I][E];
e.setSelectionRange(f,f)
}c.Rh()
}else {
var g=d.ma,h=d.Z;
if(b!=null||g==1&&h<=tu(d.Md(),d)) {
c.ui(false);
Ta(e,"="+a+"(");
if(b!=null)e.value+=b+")";
c.Rh()
}else {
var i=d.O,j=d.Y,k="="+a+"("+xr(i,j,g,h)+")";
if(g>1) {
if(i+g<=d.Ha()) {
	d.dc(i,j,i+g,j+h-1);
	d.Ua(i+g,j,false)
}
}else if(j+h<=d.Ba) {
d.dc(i,j,i+g-1,j+h);
d.Ua(i,j+h,false)
}c.ui(false,0);
e.value+=k;
c.Rh()
}
}
}this.L()
};
Y[_P].Xj=function (a) {
if(this.Ya(true)) {
this.activeGrid.$a.ij(this.activeGrid,
a);
if(Wf)this.L()
}
};
Y[_P].$O=function () {
var a=this.activeGrid.selectedEmbedObjectId;
if(this.Ya(true)&&a)this.activeGrid.$a.Me(a)
};
Y[_P].Iz=function () {
var a=this.activeGrid.selectedEmbedObjectId;
if(this.Ya(true)&&a) {
if(a==this.activeGrid.selectedEmbedObjectId)this.activeGrid.yE(null);
this.activeGrid.$a.Kk(a)
}
};
Y[_P].Lj=function () {
var a=this.activeGrid.selectedEmbedObjectId;
if(a)this.activeGrid.$a.Lj(a)
};
Y[_P].nQ=function (a) {
var b=this.gooffiLink,c=b.ya.uj,d=this.activeGrid.selectedEmbedObjectId,e=
this.activeGrid.id,f;
if(!this.Ya(true)||!d)return ;
if(!b.save())return ;
c.show(true);
f=c.wc()?(c.J1()==e?e:-1):e;
if(c.publish({
enable:true,alertUser:true,sheet:f
})) {
c.tL(d);
var g=this.Rea||new is(this);
g.Daa(a,d);
g.D(true)
}
};
Y[_P].Mz=function () {
if(this.Ya(true))this.menuMain.Nm().bB().eB().show()
};
Y[_P].up=function () {
if(this.Ya(true)) {
var a="";
if(this.gooffiLink)a=this.gooffiLink.ya.z1();
this.cellOverlayManager.up(this.activeGrid,a)
}
};
Y[_P].gp=function () {
if(this.Ya(true))this.cellOverlayManager.gp(this.activeGrid,
X.clearUserComment)
};
Y[_P].ex=function (a) {
if(this.Ya(false)) {
var b=oo+"=9";
b+="&atyp="+a;
this.Bb(_M[4]);
this.Ab(b,true)
}this.L()
};
Y[_P].copy=function (a,b,c) {
var d=a==X.newPasteCut;
if(this.Ya(true)) {
this.copyPaste.copy(a,null,c);
this.activeGrid.XH(true,d)
}this.L();
if(b)if(S)this.cellSelection.db.createTextRange().execCommand("Copy");
else if(a==X.pasteAll)this.ai(_M[21],"secStatCopy");
else if(d)this.ai(_M[22],"secStatCopy")
};
Y[_P].paste=function (a,b,c) {
if(this.Ya(true)) {
var d=this.copyPaste,e=false;
if(a)if(S)this.cellSelection.db.createTextRange().execCommand("Paste");
else {
if(d.Hi==null) {
this.ai(_M[23],"secStatCopy");
this.L();
return
}e=true
}if(b!=null)d.jS(b);
d.paste(c,e)
}this.L()
};
Y[_P].pI=function () {
if(this.Ya(true))this.activeGrid.Jz()
};
Y[_P].JX=function () {
if(this.Ya(true)) {
this.activeGrid.Tc("clearFmt","",true);
this.menuMain.Rc(false)
}this.L()
};
Y[_P].iP=function (a,b,c,d) {
if(this.Ya(true)) {
var e=this.activeGrid,f=e.info.rowsTOids,g=f[a],h=f[b],i=c==-1?-1:f[c],j=oo+"=9";
j+="&gid="+e.id;
j+=
"&atyp="+(d?X.moveRowsBefore:X.moveRowsAfter);
j+="&srow="+g;
j+="&erow="+h;
j+="&pri="+i;
this.Bb(_M[4],true);
this.Ab(j,true)
}
};
Y[_P].Fc=function (a,b) {
if(this.Ya(true)) {
var c=this.activeGrid,d=c.ma==null?1:c.ma,e=c.Z==null?1:c.Z,f=c.O;
if(a==X.rowInsertAfter)f+=d-1;
var g=c.Y;
if(a==X.colInsertAfter)g+=e-1;
if(a==X.rowInsert||a==X.rowInsertAfter||a==X.rowDelete)this.cN(a,f,b?1:d);
else if(a==X.colInsert||a==X.colInsertAfter||a==X.colDelete)this.R4(a,g,b?1:e)
}this.L()
};
Y[_P].cN=function (a,b,c) {
if(this.Ya(true)) {
var d=
this.activeGrid,e=d.info.rowsTOids,f=e[b],g=d.Xb;
if(f==null)this.Af(_M[7],X.errorGeneric,true);
else {
var h=false,i=oo+"=9";
i+="&gid="+this.activeGrid.id;
i+="&atyp="+a;
var j=false;
if(a==X.rowInsert||a==X.rowInsertAfter)if(b<=g) {
h=true;
this.cb(_M[24])
}else {
i+="&srow="+f;
i+="&v="+c
}else if(a==X.rowDelete) {
j=true;
i+="&srow="+f;
if(c+g>=d.Ha()) {
h=true;
this.cb(_M[26])
}else if(b<=g) {
h=true;
this.cb(_M[25])
}else i+="&erow="+e[d.O+c-1]
}else {
h=true;
this.cb(_M[1])
}if(!h) {
this.Bb(_M[4],true);
this.Ab(i,j)
}
}this.L()
}
};
Y[_P].R4=function (a,b,c) {
if(this.Ya(true)) {
var d=this.activeGrid,e=d.info.colsTOids,f=e[b],g=d.Ra;
if(f==null)this.Af(_M[7],X.errorGeneric,true);
else {
var h=false,i=oo+"=9";
i+="&gid="+this.activeGrid.id;
i+="&atyp="+a;
var j=false;
if(a==X.colInsert||a==X.colInsertAfter)if(b<=g) {
h=true;
this.cb(_M[469])
}else {
i+="&scol="+f;
i+="&v="+c
}else if(a==X.colDelete) {
j=true;
i+="&scol="+f;
if(c+g>=d.Ba) {
h=true;
this.cb(_M[27])
}else if(b<=g) {
h=true;
this.cb(_M[470])
}else i+="&ecol="+e[d.Y+c-1]
}else {
h=true;
this.cb(_M[1])
}if(!h) {
this.Bb(_M[4],
true);
this.Ab(i,j)
}
}this.L()
}
};
Y[_P].lq=function (a,b,c,d) {
if(this.Ya(true)) {
var e=this.activeGrid,f=e.Xb,g=e.Ra,h=false,i=oo+"=9";
i+="&gid="+this.activeGrid.id;
i+="&atyp="+a;
i+="&v="+(b?"1":"0");
if(a==X.hideUnhideRows) {
var j=c!=null?c:e.O,k=d!=null?d-j+1:e.ma||1,m=e.info.rowsTOids,n=m[j],q=m[j+k-1];
if(n==null||q==null) {
h=true;
this.Af(_M[7],X.errorGeneric,true)
}else if(b&&k+f>=e.Ha()) {
h=true;
this.cb(_M[420])
}else if(j<=f) {
h=true;
this.cb(_M[422])
}else {
i+="&srow="+n;
i+="&erow="+q
}
}else if(a==X.hideUnhideCols) {
var p=
c!=null?c:e.Y,s=d!=null?d-p+1:e.Z||1,u=e.info.colsTOids,n=u[p],q=u[p+s-1];
if(n==null||q==null) {
h=true;
this.Af(_M[7],X.errorGeneric,true)
}else if(b&&s+g>=e.Ba) {
h=true;
this.cb(_M[421])
}else if(p<=g) {
h=true;
this.cb(_M[471])
}else {
i+="&scol="+n;
i+="&ecol="+q
}
}if(!h) {
this.Bb(_M[4]);
this.Ab(i,false)
}
}this.L()
};
Y[_P].Aj=function (a,b) {
if(this.Ya(true)) {
var c=this.activeGrid,d=b==null?c.Ea:b;
if(d!=null) {
var e=oo+"=9";
e+="&gid="+this.activeGrid.id;
e+="&atyp="+X.sort;
e+="&scol="+c.info.colsTOids[d];
e+="&v="+
a;
this.Bb(_M[4]);
this.Ab(e,true)
}
}this.L()
};
Y[_P].merge=function (a) {
if(this.Ya(true)) {
var b=this.activeGrid,c=b.O,d=b.Y;
if(c!=null&&d!=null) {
var e=b.ma==null?1:b.ma,f=b.Z==null?1:b.Z;
if(this.FH(b,c,d,e,f))if(a) {
var g=b.H,h=true,i,j,k;
for(i=0;i<e&&h;i++) {
k=d<=b.Ra?b.I.K(c+i,false,true)[L]:g.K(c+i)[L];
for(j=1;j<f&&h;j++)if(i+j>0)if(k[d+j][rc][E]>0)h=false
}if(!h)if(la(_M[28]("\n")))h=true;if(h) {
b.Ar(b.O,b.Y);
b.Zf(X.mergeCellsAcross,"",_M[4])
}
}else b.Zf(X.unmergeCells,"",_M[4]);
else this.cb(_M[29])
}
}this.L()
};
Y[_P].FH=function (a,b,c,d,e) {
var f=null,g=a.H,h=a.Ra,i=c<=h;
if(i&&c+e-1>h)return false;
var j=i?a.I:null;
for(var k=0;k<d;k++) {
f=uv((i?j.K(b+k,false,true)[L]:g.K(b+k)[L])[c],a);
if(f!=null) {
if(Qv(f)<c)return false;
if(tu(f,a)>e)return false
}
}if(e>1)for(var k=0;k<d;k++) {
f=uv((i?j.K(b+k,false,true)[L]:g.K(b+k)[L])[c+e-1],a);
if(f!=null)if(Qv(f)+tu(f,a)>c+e)return false
}return true
};
Y[_P].Wl=function (a) {
if(this.Ya(true)) {
var b=this.activeGrid,c=b.Md();
if(c!=null) {
if(a==="bold")b.Tc("fontWeight",av(c)?"normal":
"bold",av(c));
if(a==="italic")b.Tc("fontStyle",bv(c)?"normal":"italic");
if(a==="underline") {
var d="";
if(cv(c)) {
d="none";
if(dv(c))d="line-through"
}else {
d="underline";
if(dv(c))d+=" line-through"
}b.Tc("textDecoration",d)
}if(a==="strikethrough") {
var d="";
if(dv(c)) {
d="none";
if(cv(c))d="underline"
}else {
d="line-through";
if(cv(c))d+=" underline"
}b.Tc("textDecoration",d)
}if(a==="wrap") {
var e=xu(c,"whiteSpace","white-space");
if(e==="normal")b.Tc("whiteSpace","nowrap",true);
else b.Tc("whiteSpace","normal")
}if(a===
"alignLeft")b.Tc("textAlign","left");
if(a==="alignCenter")b.Tc("textAlign","center");
if(a==="alignRight")b.Tc("textAlign","right");
if(a==="alignTop")b.Tc("verticalAlign","top");
if(a==="alignMiddle")b.Tc("verticalAlign","middle");
if(a==="alignBottom")b.Tc("verticalAlign","bottom");
if(a==="dirLtr")b.Tc("direction","ltr");
if(a==="dirRtl")b.Tc("direction","rtl");
this.menuMain.We(c,b)
}
}this.L()
};
Y[_P].P=function (a) {
if(this.menuMain&&a!==this.menuMain)this.menuMain.P();
if(this.Xe)this.Xe.P();
if(this.Rn)this.Rn.P();
var b=this.gooffiLink;
if(b!=null)if(b.P)b.P()
};
Y[_P].Yk=function (a,b) {
this.menuMain.Nm().Yk(a,b)
};
Y[_P].Qaa=function (a) {
this.pathImg=a
};
Y[_P].lba=function (a) {
this.c7=a
};
Y[_P].Nr=function (a,b) {
this.url=a+(a.indexOf("?")==-1?"?":"");
this.cV=b==null?this.url:b+(b.indexOf("?")==-1?"?":"")
};
Y[_P].Bb=function (a,b) {
if(b==true) {
y(this.divMsg,a);
ib(this.divMsg[J],2)
}else if(this.Qr==null)this.Qr=fi(R(this.Bb,this,a,true),3000)
};
Y[_P].Qu=function (a) {
if(a||this.Fj[E]<1) {
ei(this.Qr);
this.Qr=null;
ib(this.divMsg[J],
-1000)
}else if(this.Zm)gm(this,this.Qu,1000,false)
};
Y[_P].Ya=function (a,b) {
if(this.modalDbox==null||b)if(this.cellSelection.isEditBoxActive&&!this.cellSelection.Id(true))this.cb(_M[2]);
else if(a)if(this.activeGrid.O==null)this.cb(_M[3]);
else return true;
else return true;
return false
};
Y[_P].Af=function (a,b,c) {
var d=oo+"=3";
d+="&emsg="+fa(a);
d+="&ecod="+b;
hm(this.url,d,true);
if(c&&a!=null)this.cb(a)
};
Y[_P].Ab=function (a,b,c) {
if(b==true)this.copyPaste.jS(null);
a+="&msq="+++this.jP;
a+="&lsq="+this.Cq;
if(this.eh)a+="&tfe="+this.eh;
this.log(a);
this.activeGrid.H.cm();
var d=new mq(this.cV,a,this),e=false;
if(this.Fj[E]>8) {
e=true;
for(var f=0;f<this.Fj[E]&&e;f++)if(!this.Fj[f].executor.Q3()) {
e=false;
break
}
}if(c!=true) {
var g={
};
g.executor=d;
g.msg=a;
g.date=new Date;
g.msq=this.jP;
this.Fj.push(g)
}if(e) {
this.Dh.disconnect();
this.setDisconnectedMode(true)
}else d.execute()
};
Y[_P].OE=function (a,b) {
try{
var c=oo+"=10&atyp="+a;
if(b)c=c+"&v="+b;
var d=im(this.url,c);
return eval("("+d+")")
}catch(e) {
return null
}
};
Y[_P].L$=function (a) {
if(this.eh)a+="&tfe="+this.eh;
this.log(a);
hm(this.cV,a,true)
};
Y[_P].zF=function (a,b) {
var c=this.Fz;
if(!c) {
c=new Mr(this);
this.Fz=c
}c.activate(a,b)
};
Y[_P].wda=function () {
var a=this.Nfa;
if(!a) {
a=new Qr(this,this.divGrids);
a.qba(3);
a.Waa(0,0,this.activeGrid.scrollDepth,0);
a.setPosition(new Yq(this.divGrids,3));
this.Nfa=a;
fi(R(a.D,a,true),0)
}else if(!a.q5())a.D(true)
};
Y[_P].aba=function (a) {
this.modalDbox=a;
if(!this.Da())this.ze.jx(true)
};
Y[_P].KX=function () {
this.modalDbox=null;
if(!this.Da())this.ze.jx(false)
};
Y[_P].M9=function (a,b,c) {
var d=this.Fj;
if(c==null) {
if(a!=null) {
this._me=true;
if(b!=null)for(var e=0;e<d[E];e++)if(d[e].executor==a) {
d.splice(e,1);
return a
}
}
}else for(var e=0;e<d[E];e++)if(d[e].msq==c) {
var f=d[e].executor;
d.splice(e,1);
return f
}
};
Y[_P].areTherePendingRequests=function () {
var a=this.Fj;
if(a!=null)return a[E]>0;
return false
};
Y[_P].fv=function () {
var a=this.activeGrid;
return a&&a.H.Ec()&&this.Zm
};
Y[_P].Ec=function () {
return this.Zm
};
Y[_P].on=function () {
var a=this.Nq;
return this.fv()&&(a==
null||!a.pJ)
};
Y[_P].KJ=function () {
var a=this.oR;
while(a[E]>0) {
if(!this.fv())return false;
this.ZD(a[0][0],a[0][1],true);
a.shift()
}
};
Y[_P].ZD=function (a,b,c) {
var d=false;
try{
d=this.h9(a,b,c)
}catch(e) {
this.hE(qm(e),X.error9)
}this.Qu(false);
return d
};
Y[_P].h9=function (a,b,c) {
if(c!=true) {
var d=this.oR;
if(this.fv()) {
if(d[E]>0) {
d.push([a,b]);
this.KJ();
return
}
}else {
d.push([a,b]);
return
}
}var e=null,f=null,g=null,h=null,i=null;
this._action=null;
this._sq=null;
this._lsq=null;
this._c=null;
this._a=null;
this._me=
null;
this._msq=null;
if(a!=null)if(a.indexOf("action")>-1)this.log(a);
var j=ne();
eval(a);
j=ne()-j;
var k=this.M9(b,this._action,this._msq),m=null,n=null;
if(k!=null) {
m=ne()-k.Tr;
n=k.A0();
k.dispose()
}var q=ne(),p=this._me==true;
if(this._action==9) {
var s=this._c,u=this._a;
if(this._lsq!=null)if(!this.JS(this._lsq))return false;
this.eh=this._tfe;
var v,t,w=true,B=Wf;
if(s!=null) {
var A=0;
for(var G=0;G<s[E];G++) {
t=s[G];
A=t.t;
if(t.g==null)switch(A) {
case X.reloadGrids:w=false;
this.reloadGrids(t.garr,t.tobj);
break;
case X.reloadAllGrids:var H=t.ttl,Q=t.msg;
if(H&&Q)this.Hg().gi(H,Q,10000,true);
this.C9(t.s);
var K=t.et;
if(K)this.menuMain.editTab.activate(K);
break;
case X.mode:this.setMode(t.v);
break;
case X.errorSuggReload:this.setDisconnectedMode(true);
this.Hg().gi(_M[6],_M[35],-1,true);
break;
case X.errorLow:this.cb(t.v);
break;
case X.errorHigh:ra(t.v);
break;
case X.toast:this.Hg().gi(t.tt,t.tc,t.to,t.tf);
break;
case X.disclaimer:this.Ji.pS(t.msg);
this.Ji.MJ(true);
break;
case X.localeChange:var sa=this.Kl,aa=t.sl;
this.Kl=
aa;
if(sa.l!=aa.l||sa.c!=aa.c||sa.v!=aa.v) {
	Xt(aa.l);
	this.n$()
}break;
default:break
}else {
v=true;
if(t.g>=0) {
	e=this.pb(t.g);
	f=e.H;
	if(f.Ec()) {
		h=e.info.idsTOrows;
		i=e.info.idsTOcols
	}else if((A==null||A<X.newGrid||A>X.moveGrid)&&A!=X.addRange&&A!=X.removeRange)v=false
}else e=null;
if(v) {
	v=false;
	switch(A) {
		case X.addRange:this.zd.iW(t);
		break;
		case X.removeRange:this.zd.N9(t.n);
		break;
		case X.newGrid:this.newGrid(e,t.nm,t.ng,t.rs,t.cs,p);
		break;
		case X.removeGrid:this.removeGrid(e,p);
		break;
		case X.renameGrid:this.renameGrid(null,
		e,t.nm,null);
		break;
		case X.moveGrid:this.moveGrid(e,t.pg,p);
		break;
		default:v=true;
		break
	}
}if(v&&!e.Yn) {
	var ia,$,ba,db;
	switch(A) {
		case X.resizeRow:ia=h[t.r];
		$=h[t.r2];
		e.Pw(ia,$,true,t.sz,true);
		this.mouseSelection.Hk(ia);
		break;
		case X.resizeCol:ba=i[t.c];
		db=i[t.c2];
		e.Pw(ba,db,false,t.sz,true);
		this.mouseSelection.Hk(ba);
		B=true;
		break;
		case X.hideUnhideRows:ia=h[t.r];
		$=h[t.r2];
		e.rM(ia,$,true,t.v);
		this.mouseSelection.Hk(ia);
		break;
		case X.hideUnhideCols:ba=i[t.c];
		db=i[t.c2];
		e.rM(ba,db,false,t.v);
		this.mouseSelection.Hk(ba);
		break;
		case X.freezeRows:e.freezeRows(t.r,true);
		break;
		case X.freezeColumns:e.freezeColumns(t.c,true);
		break;
		case X.conditionalFormat:var Ya=h[t.r],Ma=f.uc(f.Le(Ya));
		if(Ma.Na())e.info.hS(Ya,i[t.c],t.cco,t.cfo);
		else if(Ma.Il())Ma.xk().jl(t,A);
		break;
		case X.cellExpansion:if(p) {
			var eb=e.info,Qa=eb.idsTOrows,fb=eb.idsTOcols;
			e.dc(Qa[t.r1],fb[t.c1],Qa[t.r2],fb[t.c2]);
			e.Ua(Qa[t.r1],fb[t.c1],false);
			if(t.ow)this.Hg().gi("",_M[397]('<a class="'+Mv+'" hred="#">',"</a>"),10000,true,Mv)
		}break;
		default:if(A>=X.rowInsert&&
		A<=X.colDelete||A==X.rowInsertAfter||A==X.colInsertAfter)if(!e.vq())e.Pt();
		else {
			e.U4(A,t);
			if(A==X.rowInsert||A==X.rowInsertAfter||A==X.rowDelete) {
				e.lastTblHeight=-1;
				if(X.rowInsertAfter)w=false
			}
		}else if(A==X.mergeCellsAcross||A==X.unmergeCells)if(!e.vq(true))e.Pt();
		else {
			ia=h[t.r];
			$=h[t.r2];
			ba=i[t.c];
			db=i[t.c2];
			var gb=db-ba+1;
			for(var Jb=ia;Jb<=$;Jb++) {
				var Vb=f.Le(Jb),Ma=f.uc(Vb);
				if(Ma.Na())if(A==X.unmergeCells)e.unmergeCells(Jb,ba,gb,Vb);
				else e.dD(Jb,ba,gb,Vb);
				else if(Ma.Il()) {
					var Wb={
					};
					Wb.r=e.info.rowsTOids[Jb];
					Wb.c=t.c;
					Wb.c2=t.c2;
					Ma.xk().jl(Wb,A)
				}
			}if(A==X.unmergeCells)e.oH();
			else e.ZP($,ba)
		}else if(A>=X.insertObject&&A<=X.deleteObject)if(!e.vq(true))e.Pt();
		else if(e.e9) {
			var Qc=t,Gc=this.pb(Qc.g).$a;
			switch(A) {
				case X.insertObject:Gc.dN(Qc,p);
				break;
				case X.updateObject:Gc.FU(Qc);
				break;
				case X.deleteObject:Gc.gJ(Qc);
				break
			}
		}if(t.fI!=null||t.nI!=null||t.v!=null)e.info.OU(t);
		if(t.css!=null)e.Xda(t);
		break
	}
}
}
}if(Uf)for(var Yd=0;Yd<this.Aa.of();Yd++) {
f=this.V(Yd).H;
if(f.Ec())f.mK()
}
}if(u!=null) {
e=this.activeGrid;
f=
e.H;
g=e.I;
var ia,$,ba,Vb,Ma,id=u[E];
for(var G=0;G<id;G++) {
if(e.id!=u[G].g) {
e=this.Aa.pb(u[G].g);
f=e.H;
g=e.I
}if(f.Ec()&&!e.Yn) {
h=e.info.idsTOrows;
ia=h[u[G].r];
Vb=f.Le(ia);
Ma=f.uc(Vb);
if(Ma.Na()) {
	if(G>0&&ia!=$)e.lastTblHeight=-1;
	$=ia;
	e.DU(ia,Vb,u[G])
}else if(Ma.Il())Ma.xk().jl(u[G],X[I])
}
}if(id>1&&w) {
this.nK(false);
gm(this,this.nK,100,true)
}
}if(this.gooffiLink!=null)this.gooffiLink.e7(s,u,this.jP>0);
e=this.activeGrid;
if(B&&e.H.Ec()) {
e.I.Ef(false);
e.kE()
}else e.vj();
e.Cx(e.Md(),250,false)
}q=ne()-q;
if(m!=
null&&this.WJ!=null)this.WJ.log(n,m,j,q);
return true
};
Y[_P].E0=function () {
var a=new Date;
a.setTime(a.getTime()-this.$fa);
return a.toLocaleString ()
};
Y[_P].log=function (a,b) {
if(this.$j&&this.$j.ot.wc()||b)this.La.log(mk,a)
};
Ra(Y[_P],function () {
if(this.EX)return ;
this.EX=true;
this.gooffiLink=null;
this.Fj=null;
this.oR=null;
ei(this.Qr);
this.Qr=null;
this.OF();
if(this.Dh) {
this.Dh.dispose();
this.Dh=null
}if(this.Xe)this.Xe.cleanup();
this.cellOverlayManager.cleanup();
this.cellOverlayManager=null;
this.appOverlayManager.cleanup();
this.appOverlayManager=null;
this.cellSelection.cleanup();
this.mouseSelection.O9();
var a=null,b=this.Aa;
for(var c=0;c<b.of();c++) {
a=b.vB(c);
if(a.H.Ec())this.mouseSelection.I9(a);
a.cleanup()
}var d=this.screenFuncs;
if(d)d.cleanup();
d=this.pZ;
if(d) {
d.cleanup();
this.pZ=null
}d=this.Fz;
if(d)d.dispose();
d=this.dboxAlert;
if(d) {
d.dispose();
this.dboxAlert=null
}this.Fz=null;
if(this.cG)this.cG.cleanup();
this.Nq.cleanup();
this.zd.cleanup();
this.dk=null;
this.Ae=null;
var e=this.win;
if(e) {
if(!S)Kj(e,"resize",this.sG);
e.onfocus=null;
e=null
}this.doc=null;
this.activeGrid=null;
this.activeFormuGrid=null;
this.divGrids=null;
this.fG=null;
this.Tz=null;
this.wJ=null;
this.Xe=null;
z(this.Vq,null);
this.Vq=null;
this.Rn=null;
this.sG=null;
if(this.menuMain) {
this.menuMain.cleanup();
this.menuMain=null
}this.cellSelection=null;
this.mouseSelection=null;
if(this.screenFuncs)this.screenFuncs.dispose();
this.screenFuncs=null;
this.modalDbox=null;
this.copyPaste=null;
this.Nq=null;
this.Ji=null;
this.zd=null;
this.La=null;
var f=this.p0;
if(f) {
f.dispose();
this.p0=null
}var g=this.gearsDocStore;
if(g) {
g.dispose();
this.gearsDocStore=null
}this.G.cc();
this.G.dispose();
this.G=null;
if(this.$j)this.$j.dispose();
if(this.$k) {
this.$k.dispose();
this.$k=null
}bn().dispose()
});
re(Y[_P],"cleanup",Y[_P].cleanup);
Y[_P].getSheet=function (a) {
return this.V(a-1)
};
Y[_P].getMouseListener=function () {
return this.activeGrid.divTop
};
Y[_P].getKeyListener=function () {
return this.cellSelection.db
};
function Bv(a) {
this.z=a
}Bv[_P].Ks=function (a) {
var b=false,c=this.z,d=c.gooffiLink;
if(d!=null&&a.Cn=="revisions") {
if(!d.ya.hv()) {
ra(_M[675]);
b=false
}else if(d.Oc)b=d.save();
else if(d.isSaved()&&!c.Da())b=true
}else b=true;
return c.modalDbox==null&&b
};
Bv[_P].dp=function (a) {
this.z.P();
if(a.Cn=="revisions")this.z.Ya(false)
};
Bv[_P].Ds=function (a) {
var b=this.z;
if(b.gooffiLink!=null) {
var c=b.gooffiLink.ya;
c.wu().display(a.Cn=="revisions");
if(c.ue!=null)if(c.Yd().Na())c.Yd().close()
}b.L()
};
Bv[_P].fM=function () {
if(S)this.z.mouseSelection.Hk()
};
function tv(a) {
if(!/^((ftp|http|https|gopher|mailto|news|telnet|aim):\/\/)/.test(a))a="http://"+a;
return a
}function su(a,b,c,d,e,f,g,h) {
var i=a.createElement(h);
r(i,c);
var j=i[J];
ib(j,d+"px");
j.top=e+"px";
x(j,f);
D(j,g);
b.appendChild(i);
return i
}function xu(a,b,c) {
if(a[md])return a[md][b];
else {
var d=a[Nc].window;
if(d.getComputedStyle) {
var e=d.getComputedStyle(a,"");
try{
if(e==null||e==undefined)return c=="display"?"none":null;
else {
var f=e.getPropertyValue(c);
return Wf&&c=="display"&&f==""?"none":f
}
}catch(g) {
return null
}
}
}return null
}
function wu(a) {
var b=a[rd][E],c="";
for(var d=0;d<b;d++) {
var e=a[rd][d];
if(e[lc]==3) {
if(b==1)return e[Jd];
c+=e[Jd]
}else if(e[Jc].toLowerCase()=="br")c+="\n"
}return c
}function uu(a) {
return wu(a)[E]==0
}function Ku(a) {
a*=100;
a=o.round(a);
a/=100;
return a
}function Lu(a) {
a*=100;
a+="%";
return a
}function wp(a,b,c) {
var d=b[rd];
if(d[E]==1&&d[0][lc]==3)Ob(b[rd][0],c);
else {
y(b,"");
if(a==null)a=b[Nc];
bm(a,b,c)
}
}function vu(a,b,c) {
if(c.indexOf("\n")==-1)wp(null,b,c);
else {
y(b,"");
if(a==null)a=b[Nc];
var d=-1;
while((d=
c.indexOf("\n"))!=-1) {
var e=c.substring(0,d);
if(e[E]>0)bm(a,b,e);
var f=a.createElement("br");
b.appendChild(f);
c=d+1<c[E]?c.substring(d+1):""
}if(c!="")bm(a,b,c)
}
}function Au(a,b,c,d) {
var e;
if(S&&d!=true) {
e=b.insertCell(0);
b.insertBefore(e,b[L][c+1])
}else e=b.insertCell(c);
r(e,a[dc]);
ij(e,"dn");
em(e,null,"","");
return e
}function Qv(a) {
if(S) {
var b=a[O][L];
for(var c=1;c<b[E];c++)if(b[c]===a)return c;return null
}else return a.cellIndex
}function tu(a,b,c) {
var d=a[gd];
if(d<=1)return 1;
var e=c!=null?c:Qv(a),
f=b.Ba;
for(var g=0;g<d;g++)if(e+g<=f&&b.Lk(e+g))d++;return d
}function uv(a,b,c,d) {
if(a.mergP==null) {
var e=a[O][L],f=Qv(a);
while(b.kd(a)&&f>0) {
f--;
a=e[f]
}if(a[gd]>1||d)return c==false?f:a
}else return c==false?Qv(a.mergP):a.mergP;
return null
}function av(a) {
var b=xu(a,"fontWeight","font-weight");
return b===700||b==="bold"
}function bv(a) {
var b=xu(a,"fontStyle","font-style");
return b==="italic"
}function cv(a) {
if(S)return a[J].textDecorationUnderline;
var b=xu(a,"textDecoration","text-decoration");
return b.indexOf("underline")>=
0
}function dv(a) {
if(S)return a[J].textDecorationLineThrough;
var b=xu(a,"textDecoration","text-decoration");
return b.indexOf("line-through")>=0
}function ev(a) {
var b=xu(a,"direction","direction");
return b==="rtl"
}function wv(a,b,c) {
if(S)a.addRule(b,c);
else a.insertRule(b+" {"+c+"}",a.cssRules[E])
}function vv(a,b) {
var c=a[Wc],d,e,f;
b="."+b;
for(d=0;d<c[E];d++)try{
f=sv(c[d]);
for(e=0;e<f[E];e++)if(f[e].selectorText==b)return f[e][J][bd]
}catch(g) {
}return null
}function sv(a) {
var b;
b=S?a[Tb]:a.cssRules;
return b
}
function Gv(a,b) {
if(a==null||b==null)return false;
return a[0]==b[0]&&a[1]==b[1]
}function zu(a,b,c,d,e) {
if(e)for(var f=0;f<a[E];f++) {
var g=a[f][L];
for(var h=d;h>=c;h--) {
var i=g[h],j=b.kd(i),k=uv(i,b,true,j);
if(!k)C(i[J],"none");
else if(k[gd]>1)k.colSpan--;
else C(k[J],"none")
}
}else for(var f=0;f<a[E];f++) {
var g=a[f][L];
for(var h=c;h<=d;h++) {
var i=g[h];
if(b.kd(i)) {
tb(i,1);
i.mergP=null;
C(i[J],"");
ij(i,"dn")
}else i.colSpan++
}
}
}var hr=function (a,b,c,d,e,f,g) {
var h=c+" "+d,i=Zk(a,b,h,0,0,f,g);
C(i[J],"none");
i.onmouseup=dm(i,h);
i.onmousedown=dm(i,c+" "+e);
return i
},cr=function (a) {
V(a,false);
Fi(a,0,0)
};
var Rv=function () {
wj.call(this,"dialog",true);
this.$aa(false);
this.Va("Find & Replace...");
var a=this.Ja(),b=T(a);
this.gK=b.b("input",{
style:"width: 20em;"
});
this.bR=b.b("input",{
style:"width: 20em;"
});
this.tH=b.b("input",{
type:"checkbox"
});
La(this.tH,true);
this.q6=b.b("input",{
type:"checkbox"
});
this.s6=b.b("input",{
type:"checkbox"
});
var c=b.b("table",{
},b.b("tbody",{
},b.b("tr",{
},b.b("td",{
},"Find: "),b.b("td",{
},this.gK)),b.b("tr",{
},b.b("td",{
},"Replace: "),b.b("td",{
},this.bR)),b.b("tr",{
},b.b("td",
{
colspan:"2"
},this.tH,"Search all sheets",this.q6,"Match case",this.s6,"Match entire cell contents"))));
b.appendChild(a,c);
var d=new xj;
d.set("findNext","Find");
d.set("finalAll","Find all");
d.set("replace","Replace",true);
d.set("replaceAll","Replace all",true);
d.set("cancel","Cancel",false,true);
this.od(d);
this.q=new mj(this);
this.q.listen(this,zj,this.ic)
};
Rv.inherits(wj);
Rv[_P].ic=function (a) {
var b="canceled";
if(a.key=="findNext")b="findnext";
else if(a.key=="finalAll")b="findall";
else if(a.key==
"replace")b="replace";
else if(a.key=="replaceAll")b="replaceall";
this.dispatchEvent(new Sv(b,this.gK[I],this.bR[I],this.tH[ic],this.q6[ic],this.s6[ic]))
};
Rv[_P].dispose=function () {
if(!this.N()) {
Tv.B.dispose.call(this);
this.gK=null;
this.bR=null
}
};
var Sv=function (a,b,c,d,e,f) {
eh.call(this,a);
this.findValue=b;
this.replaceValue=c;
this.searchAllSheets=d;
this.matchCase=e;
this.matchEntireCell=f
};
Sv.inherits(eh);
var Pv=function (a) {
this.z=a;
this.Nt=null
};
Pv.inherits(af);
Pv[_P].Rca=function () {
var a=this.Nt;
if(!a) {
this.Nt=a=new Rv(this.z);
Dh(a,"replaceall",this.n3,false,this)
}a.D(true)
};
Pv[_P].n3=function (a) {
var b=this.z,c=new Im;
c.append(oo,"=",9);
c.append("&gid=",b.activeGrid.id);
c.append("&atyp=",X.replaceAll);
c.append("&v=",fa(a.findValue),"<>",fa(a.replaceValue),"<>",a.searchAllSheets?"1":"0","<>",a.matchCase?"1":"0","<>",a.matchEntireCell?"1":"0");
b.Bb(_M[4]);
b.Ab(c.toString (),false)
};
Pv[_P].dispose=function () {
if(!this.N()) {
Ip.util.Config.B.dispose.call(this);
if(this.Nt) {
this.Nt.dispose();
this.Nt=null
}
}
};
function Av(a,b,c) {
this.z=a;
this.vf=b;
this.yg=c;
this.Wb=S;
this.Fh=5;
this.R=null;
this.Nc(a.doc,c)
}Av[_P].Nc=function (a,b) {
this.R=Zk(a,b,"menuDivs",0,0,"100%","9")
};
Av[_P].We=function (a) {
if(a==null)this.Rc()
};
Av[_P].Rc=function () {
};
Av[_P].$=function () {
return this.R
};
Ra(Av[_P],function () {
if(this.R!=null)y(this.R,"")
});
