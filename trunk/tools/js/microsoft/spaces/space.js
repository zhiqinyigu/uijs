/* Copyright (C) 2009 Microsoft Corporation */registerNamespace("Spaces");Spaces.PartFrame=function(g,a){Spaces.PartFrame.initializeBase(this,arguments);a=this.getParameters();var f=this,c,i,j=[],b,h=null,d=null,e;this.canSpanWidth=a.exp=="1";this.canChangeTitle=a.cht=="1";this.hideBorder=a.hb=="1";this.hideTitle=a.ht;this.spanWidth=false;this.initialize=function(){Spaces.PartFrame.callBaseMethod(this,"initialize",arguments);f.registerFor("Spaces.LayoutManager",l);f.registerFor("Spaces.Customize.ModuleTab",n);i=$Dom.Css.getElementsByCssSelector("a.sppfMenu",g)[0];if(a.edit){if(!a.n)this.addMenuItem(GetString("live.sndefaultstrings.strings.partPrefs.framePrefs"),m);if(!a.req)this.addMenuItem(GetString("live.sndefaultstrings.strings.global.tooltip.Hide"),k)}else{if(a.api){var c=a.addtospaceurl.format(a.api);this.addMenuItem(GetString("live.sndefaultstrings.strings.partPrefs.addTo."+g_siteType),function(){document.location=c})}if(a.f)this.addMenuItem(GetString("live.sndefaultstrings.strings.sitetools.subscribetorss"),function(){window.open(a.f)})}b=g;while(b.tagName!="widget"&&b.className.indexOf("Widget")==-1)b=b.parentNode;e=b.id;if(b.className.indexOf("FullRegionWidth")>=0)this.spanWidth=true};this.dispose=function(){Spaces.PartFrame.callBaseMethod(this,"dispose",arguments)};this.addMenuItem=function(c,b){var a=new Web.UI.Menu.TextItem(c);if(b)a.attachEvent("onclick",function(){o(b)});j.push(a);return a};this.showMenu=function(){if(!c){c=new Web.UI.Menu;c.addItems(j)}c.setRelocateStyle({top:0,right:0,bottom:0,left:0,enableX:true,enableY:false});c.dockTo(i,null,true);c.setAnchor(Web.UI.Popup.VAnchor.Top,Spaces.IsRTL()?Web.UI.Popup.HAnchor.Right:Web.UI.Popup.HAnchor.Left);c.setDock(Web.UI.Popup.VDock.Bottom,Spaces.IsRTL()?Web.UI.Popup.HDock.Right:Web.UI.Popup.HDock.Left);c.setPadding(0,0);c.show()};this.getFramePrefs=function(){var c=g.getElementsByTagName("H2")[0].innerText,a=b.className.indexOf("FullRegionWidth")>=0?true:false;return {name:c,hideTitle:this.hideTitle=="1",hideBorder:this.hideBorder,fullWidth:a}};this.applyFramePrefs=function(a){if(a.name){var c=g.getElementsByTagName("H2")[0];if(c.firstChild.tagName=="A")c=c.firstChild;c.innerText=a.name}if(typeof a.fullWidth!="undefined")if(a.fullWidth)b.className+=" FullRegionWidth";else b.className=b.className.removeSpaceDelimitedString("FullRegionWidth");if(typeof a.hideTitle!="undefined")this.hideTitle=a.hideTitle;if(typeof a.hideBorder!="undefined")this.hideBorder=a.hideBorder};this.getPartId=function(){return e};var m=function(){var a=new Spaces.PartPrefs.PartPrefPopOver(f,"Spaces.PartPrefs.FramePrefUI",i)},o=function(a){a();c.hide()};function l(b,a){if(a)h=b;else h=null}function n(b,a){if(a)d=b;else d=null}function k(){event.returnValue=false;h.removePart(b,e);if(null!=d)d.refresh();f.fire("onhidemodule",e);return false}this.hide=function(){return k()}};Spaces.PartFrame.registerClass("Spaces.PartFrame","$Binding");Spaces.PartFrame.skipClass=true;Spaces.PartFrame.Events=new $Enum("onhidemodule");Spaces.PartFrame.Params=new $Enum("id","edit","req","exp","cht","hb","ht","api","f","addtospaceurl","n");Spaces.PartFrame.showMenu=function(c,a){elPart=c;while(elPart.className.indexOf("spDefaultFrame")==-1)elPart=elPart.parentNode;var b=elPart;$Spaces.bindIfNotBound(b,"Spaces.PartFrame",{addtospaceurl:a},"pf").showMenu()};Spaces.PartFrame.hidePart=function(b){elPart=b;while(elPart.className.indexOf("spDefaultFrame")==-1)elPart=elPart.parentNode;var a=elPart;Spaces.PartFrame.bindIfNotBound(a,"Spaces.PartFrame").hide()};Function.Identity=function(a){return a};Function.NoOp=function(){};Array.Empty=[];String.prototype.compare=function(a,b){if(b)return this.toLowerCase()==a.toLowerCase();else return this==a};String.prototype.replaceAll=function(d,c){var b,a=this;do{b=a;a=a.replace(d,c)}while(a!=b);return a};registerNamespace("System.Util");System.Util.CookieJar=new function(){var a=this;function e(){var a=new Date;a.setFullYear(a.getFullYear()+1);return a.toUTCString()}a.asString=function(){var a="";for(var c in b)a+=c+":"+b[c]+"&";if(a.length>0)a=a.slice(0,-1);return a};a.setCookie=function(a,c){if(!!a)b[a]=c};a.getCookie=function(a){if(!!a&&!!b[a])return b[a];return null};a.flush=function(){var b=c+a.asString()+"; expires="+e();document.cookie=b};function d(e){var d=e.split("&");for(var c=0;c<d.length;c++){var a=d[c].split(":");if(!!a[0])b[a[0]]=a[1]}}a.Init=function(){var f=document.cookie,e=f.split(";");for(var b=0;b<e.length;b++){var a=e[b].trim();if(a.indexOf(c)!=-1){d(a.substring(c.length,a.length));break}}};var b={},c="photoSettings="};System.Util.GetImage=function(a){return PathUtility.MapPath(PathUtility.MapPathType.Image,PathUtility.MapPathServerType.SpacesWeb,"Parts/PhotoAlbum",a)};System.Util.GetSwf=function(a){return PathUtility.MapPath(PathUtility.MapPathType.Script,PathUtility.MapPathServerType.SpacesWeb,"Parts/PhotoAlbum",a)};System.Util.HasValue=function(a){return a!=undefined&&a!=null};System.Util.Copy=function(a,c){for(var b in a)c[b]=a[b]};System.Util.SetProps=function(b,a){System.Util.Copy(a,b)};System.Util.IsValidIndex=function(a,b){return a>=0&&a<b.length};System.Util.Trace=function(a){if(!$Browser.isIE())if($Browser.isMozilla()&&!!window["console"])console.log("FlashTrace: "+a)};System.Pool=function(d,b){if(!b)b=0;var c=this,a=[];c.CheckOut=function(){return a.length?a.shift():new d};c.CheckIn=function(c){if(a.length<b){if(c.Clean)c.Clean();a.unshift(c)}}};registerNamespace("System.Browser");System.Browser.Goto=function(a){try{document.location.href=a}catch(b){}};registerNamespace("System.Drawing");System.Drawing.Point=function(a,b){return {x:a,y:b}};System.Drawing.Point.Pool=new System.Pool(System.Drawing.Point);System.Drawing.Size=function(b,a){if(!b)b=0;if(!a)a=0;return {width:b,height:a}};System.Drawing.Size.Pool=new System.Pool(System.Drawing.Size);System.Drawing.Size.Copy=System.Util.Copy;System.Drawing.Rectangle=function(c,d,b,a){return {x:c,y:d,width:b,height:a}};System.Drawing.Rectangle.Scale=function(a,d,c,b){if(!b)b=Function.Identity;a.x=b(d*a.x);a.y=b(c*a.y);a.width=b(d*a.width);a.height=b(c*a.height)};System.Drawing.GetBoundedRegion=function(c,b,d){var a=Math.min(b.width/c.width,b.height/c.height);if(!d&&a>1)a=1;return a};System.Drawing.IsPointInRect=function(b,a){return a.x<=b.x&&b.x<=a.x+a.width-1&&(a.y<=b.y&&b.y<=a.y+a.height-1)};System.Drawing.ClipToSquare=function(b,a){b.x=0;b.y=0;b.height=b.width=Math.min(a.width,a.height);if(a.width>a.height)b.x=Math.floor((a.width-a.height)/2);else b.y=Math.floor((a.height-a.width)/2)};registerNamespace("System.Styles");System.Styles.Clipping=new function(){this.RectToStyle=function(a,b){if(!b)b="px";var c=null;if(a)c="rect("+a.y+b+" "+(a.width+a.x)+b+" "+(a.height+a.y)+b+" "+a.x+b+")";return c}};System.Styles.VerticallyAlign=function(c,b,a){c.style.pixelTop=Math.floor((a-b)/2)};System.Styles.HorizontallyAlign=function(c,b,a){c.style.pixelLeft=Math.floor((a-b)/2)};System.Styles.Center=function(c,b,a){System.Styles.VerticallyAlign(c,b.height,a.height);System.Styles.HorizontallyAlign(c,b.width,a.width)};System.Styles.SetSize=function(b,a){System.Util.SetProps(b.style,{width:a.width+"px",height:a.height+"px"})};System.Styles.SetLocation=function(b,a){System.Util.SetProps(b.style,{pixelLeft:a.x,pixelTop:a.y})};System.Styles.SetSizeAndLocation=function(a,b){System.Styles.SetSize(a,b);System.Styles.SetLocation(a,b)};registerNamespace("System.Dom");System.Dom.GetText=function(b){var a=document.createElement("div");a.innerHTML=b;return a.innerText};System.Dom.EventHookup=function(e,b,d,a){var c=a?"attachEvent":"detachEvent";e[c](b,d)};System.Dom.BuildTree=function(b){var a=System.Dom.BuildTree.div;if(typeof b=="string")a.innerHTML=b;else return b;var d=null;if(a.childNodes.length==0)return null;else if(a.childNodes.length==1)return a.removeChild(a.childNodes[0]);else{var c=[];while(a.childNodes.length>0)c.push(a.removeChild(a.childNodes[0]));return c}};System.Dom.BuildTree.div=document.createElement("div");System.Dom.Traverse=function(a){function d(c){b.push(c);while(b.length>0){c=b.pop();for(var a=1;a<e.length;a++)e[a](c);for(var a=c.childNodes.length-1;a>=0;a--)if(c.childNodes[a].nodeType==1)b.push(c.childNodes[a])}}var b=System.Dom.Traverse.aEls,e=arguments;if(a)if(a.constructor==Array){for(var c=0;c<a.length;c++)if(a[c])d(a[c])}else d(a)};System.Dom.Traverse.aEls=[];System.Dom.Traverse.FindIds=function(a){function b(b){t=b.getAttribute("id");if(t&&t.length>0&&!a[t])a[t]=b}return b};System.Dom.Traverse.FindGroups=function(a){function b(b){t=b.getAttribute("group");if(t&&t.length>0){if(!a[t])a[t]=[];a[t].push(b)}}return b};System.Dom.Traverse.FindClasses=function(b){function a(a){t=a.className;if(t&&t.length>0)b.push(a)}return a};System.Dom.NotifyWhenLayoutComplete=function(a,c){if(!a.onLayoutComplete)a.onLayoutComplete=new $Event(true);function b(){if(a.clientWidth==0)window.setTimeout(b,100);else try{a.onLayoutComplete.fire(a)}catch(c){}}if(c)a.onLayoutComplete.attach(c);b()};System.Dom.UnNotifyWhenLayoutComplete=function(a){if(a)a.onLayoutComplete=null};System.Dom.RemoveChildren=function(a){while(a.childNodes.length>0)a.removeChild(a.childNodes[0])};System.Dom.Format=function(d,a){var c=0,b=a.indexOf("{",c);while(b!=-1){d.appendChild(document.createTextNode(a.substring(c,b)));var f=a.indexOf("}",b+1),e=parseInt(a.substring(b+1,f));if(!isNaN(e))if(arguments.length>e+2)d.appendChild(arguments[e+2]);c=f+1;b=a.indexOf("{",c)}d.appendChild(document.createTextNode(a.substring(c)))};System.Dom.FindOffsetInParentElement=function(e,a,d,f){var c=0,b=0;while(a!=d&&d.contains(a)){c+=a.offsetTop;b+=a.offsetLeft;if(f){c-=a.scrollTop;b-=a.scrollLeft}a=a.offsetParent}e.x=b;e.y=c};System.Dom.CreateHierarchy=function(){var a={};function b(h,d){var f=h,e;for(var c=0;c<d.length;c++)if(d[c].constructor==Array)b(f,d[c]);else{if(typeof d[c]=="string"){var g=d[c].split(" ");e=document.createElement(g[0]);if(g.length>1)a[g[1]]=e}else e=d[c];f?f.appendChild(e):(a["root"]=e);f=e}}b(null,arguments);return a};registerNamespace("Msn.Spaces.UI");Msn.Spaces.UI.FlashObject=function(c,a){this.GetFlashObject=function(){var b=a["name"];return $Browser.isIE()?window[b]:document[b]};function b(){var b;if($Browser.isIE()){b="<object classid='clsid:d27cdb6e-ae6d-11cf-96b8-444553540000' width='"+a.width+"' height='"+a.height+"' codebase='http://fpdownload.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=9,0,28,0'"+" id='"+a["name"]+"' name='"+a["name"]+"'>";var e={Movie:"src",FlashVars:"",Src:"src",Menu:"menu",WMode:"wmode",Quality:"quality",AllowScriptAccess:"allowScriptAccess",BGColor:"bgcolor",AllowFullScreen:"allowFullScreen"};for(var d in e){var f=d;if(!!e[d])f=e[d];b+="<param name='"+d+"' value='"+a[f]+"' />"}b+="<param name='Play' value='0' /></object>"}else{b="<embed ";for(var d in a)b+=d+"='"+a[d]+"'";b+="></embed>"}c.innerHTML=b}b()};Msn.Spaces.UI.FlashObject.GetDefaultParams=function(a){return {width:"100%",height:"100%",name:a,id:a,onerror:"Msn.Spaces.Photos.SlideshowApi.doTrace",bgcolor:"#000000",allowScriptAccess:"always",menu:"true",quality:"high",type:"application/x-shockwave",src:"",FlashVars:"startIndex=0",wmode:"transparent",pluginspage:"http://macromedia.com/go/getflashplayer",allowFullScreen:"true"}};Msn.Spaces.UI.NoBreakText=function(c){var b=this;b.SetText=function(b){if(b)a.nodeValue=b};var d=b.element=document.createElement("nobr"),a=document.createTextNode(c);d.appendChild(a)};Msn.Spaces.UI.Link=function(c){var b=this,a=b.element=document.createElement("a");a.href="javascript:Function.NoOp()";a.appendChild(c)};Msn.Spaces.UI.RolloverImageSet=function(d,b,c,a){this.imgParamsNormal=d;this.imgParamsHover=b?b:this.imgParamsNormal;this.imgParamsDown=c?c:this.imgParamsHover;this.imgParamsDisabled=a?a:this.imgParamsNormal};Msn.Spaces.UI.RolloverImage=function(s,r){var d=System.Dom,a=this;a.dispose=function(){k(false)};a.SetImages=function(a){i=a;c(j)};a.Resize=function(a){return b.Resize(a)};a.SetEnabled=function(b){e=b;var a="imgParamsNormal";if(f)a="imgParamsDown";else if(g)a="imgParamsHover";c(b?a:"imgParamsDisabled")};function c(a){j=a;i[a].Load(b)}function m(){if(!e)return;c(f?"imgParamsDown":"imgParamsHover");b.element.style.cursor="pointer";g=true;a.onMouseEnter.fire()}function o(){if(!e)return;c("imgParamsNormal");b.element.style.cursor="default";g=false;a.onMouseLeave.fire()}function q(){if(!e)return;if(i.imgParamsDown)c("imgParamsDown");f=true}function t(){if(!e)return;if(g){c("imgParamsHover");f=false;a.onClick.fire()}else c("imgParamsNormal");f=false}function n(){h=true;a.onMouseEnter.fire()}function p(){h=false;a.onMouseLeave.fire()}function l(){if(e&&h)switch(event.keyCode){case 13:a.onClick.fire()}}function k(a){d.EventHookup(b.element,"onmouseenter",m,a);d.EventHookup(b.element,"onmouseleave",o,a);d.EventHookup(b.element,"onmousedown",q,a);d.EventHookup(b.element,"onmouseup",t,a);d.EventHookup(b.element,"onfocus",n,a);d.EventHookup(b.element,"onblur",p,a);d.EventHookup(b.element,"onkeypress",l,a)}function u(){a.img=b;a.element=b.element;a.size=b.size;a.onClick=new $Event;a.onMouseEnter=new $Event;a.onMouseLeave=new $Event;k(true);b.element.tabIndex=0;c(!!r?"imgParamsDisabled":"imgParamsNormal")}var b=new d.Image,i=s,h=false,f=false,g=false,j=null,e=true;u()};Msn.Spaces.UI.Layout=function(c){var a=this;a.SetLocation=function(a){var c=a%3;b.cell.align=c==0?"right":c==2?"center":"left";b.cell.vAlign=a>=7?"top":a>=4?"middle":"bottom"};a.Resize=function(c){System.Drawing.Size.Copy(c,a.size);System.Styles.SetSize(b.root,c);return a.size};function d(){b.cell.appendChild(c)}var b=System.Dom.CreateHierarchy("table","tbody","tr","td cell");a.element=b["root"];a.size=System.Drawing.Size();d()};Msn.Spaces.UI.ButtonPanel=function(m,k,f,g,j){var a=this;a.SetAdjustSizeCallback=function(a){e=a};a.GetButtonElement=function(a){return b[a].element};a.SetButtonInfo=function(c,e,d){f[c]=e;g[c]=d;if(b[c]){a.size.width-=b[c].size.width;b[c].SetImages(e);b[c].element.title=b[c].img.img.alt=GetString("live.sndefaultstrings.strings."+d);h()}};a.SetEnabled=function(c,d){i=!c;if(System.Util.HasValue(d))b[d].SetEnabled(c);else for(var a=0;a<b.length;a++)if(b[a])b[a].SetEnabled(c)};function h(){a.size.width=0;a.size.height=0;var f=0;for(var c=0;c<b.length;c++)if(b[c]){var d=a.size.width==0?0:k;b[c].element.style.pixelLeft=a.size.width+d;a.size.width+=d+b[c].size.width;a.size.height=Math.max(a.size.height,b[c].size.height)}for(var c=0;c<b.length;c++)if(b[c])b[c].element.style.pixelTop=Math.floor((a.size.height-b[c].size.height)/2);a.element.style.pixelWidth=a.size.width;a.element.style.pixelHeight=a.size.height;if(!!e)e.call(a,a.element)}a.dispose=function(){for(var e=0;e<b.length;e++)if(b[e]){b[e].onMouseEnter.detach(c);b[e].onMouseLeave.detach(d);b[e].dispose();b[e]=null}System.Dom.EventHookup(a.element,"onmouseenter",c,false);System.Dom.EventHookup(a.element,"onmouseleave",d,false)};function c(){a.onMouseEnter.fire()}function d(){a.onMouseLeave.fire()}function l(){var j=a.element=document.createElement("div");j.style.position="relative";function k(h,f,e){function g(){a.onClick.fire(h)}var b=null;if(f){b=new Msn.Spaces.UI.RolloverImage(f,i);b.element.title=b.img.img.alt=GetString("live.sndefaultstrings.strings."+e);b.element.id=e;b.element.style.position="absolute";j.appendChild(b.element);b.onClick.attach(g);b.onMouseEnter.attach(c);b.onMouseLeave.attach(d)}return b}for(var e=0;e<f.length;e++)b[e]=k(e,f[e],g[e]);a.size=System.Drawing.Size();System.Dom.EventHookup(a.element,"onmouseenter",c,true);System.Dom.EventHookup(a.element,"onmouseleave",d,true);h()}var b=[],e=null,i=j;a.onClick=new $Event;a.onMouseEnter=new $Event;a.onMouseLeave=new $Event;l()};Msn.Spaces.BuildNodes=function(b){var a=System.Dom.BuildTree(b);if(a){a.htIds={};a.htGroups={};a.aClasses=[];System.Dom.Traverse(a,System.Dom.Traverse.FindIds(a.htIds),System.Dom.Traverse.FindGroups(a.htGroups),System.Dom.Traverse.FindClasses(a.aClasses))}return a};Msn.Spaces.CleanBuiltNodes=function(a){if(a){a.htIds=null;a.htGroups=null;a.aClasses=null}};Msn.Spaces.ProcessStrings=function(a){if(a)for(var b=0;b<a.length;b++)a[b].parentNode.replaceChild(document.createTextNode(GetString("live.sndefaultstrings.strings."+a[b].getAttribute("sid"))),a[b])};Msn.Spaces.ProcessClasses=function(a,c){if(a)for(var b=0;b<a.length;b++){var d=a[b].className;if(c[d])a[b].className=c[d]}};Msn.Spaces.ProcessImages=function(a,d){if(a){var c=System.Dom;for(var b=0;b<a.length;b++){var e=c.Image.CreateFromResource(d[a[b].getAttribute("iid")]);a[b].parentNode.replaceChild(e.element,a[b])}}};Msn.Spaces.AssignClass=function(c,b,a){c.className=b[a]?b[a]:a};Msn.Spaces.ProcessNodes=function(e,c,d,b){var a=Msn.Spaces.BuildNodes(e);if(c)Msn.Spaces.ProcessStrings(a.htGroups["string"],c);if(d)Msn.Spaces.ProcessImages(a.htGroups["image"],d);if(b)Msn.Spaces.ProcessClasses(a.aClasses,b);return a};Msn.Spaces.CreateNodes=function(b,a){return Msn.Spaces.ProcessNodes(b,false,a.images,a.classes)};registerNamespace("Msn.Spaces.Resources");Msn.Spaces.Resources.Create=function(b){function a(a){var c={};if(a)for(var b=0;b<a.length;b+=2)c[a[b]]=a[b+1];return c}function d(b){return a(b)}function c(b){return a(b)}function e(e){var h=parseInt,i=a(e[0]),g={},f=e[1],b;for(var d=0;d<f.length;d++){b=f[d];var c;if(b[1]=="PhotosPath")c=PathUtility.MapPath(PathUtility.MapPathType.Image,PathUtility.MapPathServerType.SpacesWeb,"Parts/PhotoAlbum",b[2]);else if(b[1]=="SitePath")c=PathUtility.MapPath(PathUtility.MapPathType.Image,PathUtility.MapPathServerType.SpacesWeb,null,b[2]);else c=i[b[1]]+b[2];g[b[0]]={src:c,size:System.Drawing.Size(h(b[3]),h(b[4])),clip:!!b[5]?b[5]:null}}return g}var f={images:e(b[0]),classes:d(b[1]),properties:c(b[2])};return f};registerNamespace("System.Dom");System.Dom.Image=function(n,t,r,p,q,s){var f=System.Util,c=System.Drawing,a=this;a.Reconstruct=function(m,c,d,n,o,i){a.Clean();j=n;k=o;g=false;if(i){g=true;f.Copy(i,h)}a.src=m;f.Copy(c,a.srcSize);f.Copy(c,a.size);a.isReady=false;a.onReady.isInvoked=false;f.Copy(d?d:c,e);a.Resize(e);b.onload=u;b.onerror=w;l=1;b.src=m;b.style.visibility="visible"};a.Clean=function(){a.onReady.dispose();b.onload=b.onerror=null;b.style.visibility="hidden"};a.Resize=function(b){return a.Relayout(b,j,k)};a.FrameImage=function(a){o=a;if($Browser.isIE())b.style.msInterpolationMode="bicubic"};a.Relayout=function(t,q,r,p){j=q;k=r;if(p){g=true;f.Copy(p,h)}c.Size.Copy(t,e);var m=v;c.Size.Copy(a.srcSize,m);if(g)c.Size.Copy(h,m);var n,l;if(j)n=l=c.GetBoundedRegion(m,e,true);else{n=e.width/m.width;l=e.height/m.height}if(k){n=Math.min(n,1);l=Math.min(l,1)}if(g){f.Copy(h,i);c.Rectangle.Scale(i,n,l,Math.round);b.style.clip=System.Styles.Clipping.RectToStyle(i);b.style.pixelLeft=0-i.x;b.style.pixelTop=0-i.y}b.style.pixelWidth=Math.round(n*a.srcSize.width);b.style.pixelHeight=Math.round(l*a.srcSize.height);if(!!o){d.style.borderStyle="solid";d.style.borderWidth="2px";if(!System.Dom.Image.borderColor)System.Dom.Image.FindBorderColor();d.style.borderColor=System.Dom.Image.borderColor||""}d.style.pixelWidth=a.size.width=Math.floor(n*m.width);d.style.pixelHeight=a.size.height=Math.floor(l*m.height);if(!g){var s=new System.Drawing.Size(b.style.pixelWidth,b.style.pixelHeight);System.Styles.Center(b,s,a.size)}return a.size};function m(c){b.onload=null;b.onerror=null;a.isReady=c;a.onReady.fire({img:a,success:c})}function u(){m(true)}function w(){if(l>=3)m(false);else{l++;b.src=b.src}}function x(){d=document.createElement("a");b=document.createElement("img");a.img=b;a.element=d;a.srcSize=c.Size();a.size=c.Size();a.rectClip=h;a.sizeDisplay=e;a.onReady=new $Event(true);d.style.position="relative";d.style.display="block";d.style.overflow="hidden";b.style.position="absolute";b.alt="";d.appendChild(b);if(n)a.Reconstruct(n,t,r,p,q,s)}var d,b,l=0,e=c.Size(),j,k,h=c.Rectangle(0,0,0,0),g=false,o=false,v=c.Size(),i=c.Rectangle(0,0,0,0);x()};System.Dom.Image.Pool=new System.Pool(System.Dom.Image,0);System.Dom.Image.borderColor="";System.Dom.Image.FindBorderColor=function(){if(!!System.Dom.Image.borderColor&&System.Dom.Image.borderColor.length>0)return System.Dom.Image.borderColor;var a=document.getElementById("FullViewNav"),d="on";if(!a){a=document.getElementById("tblAlbums");d="selectionbg"}if(!!a){function c(e,d,f){var a=e.children;if(!!a&&a.length>0){var b=0;for(;b<a.length;b++){c(a[b],d,f);if(!!d(a[b]))f.push(a[b])}}else if(d(e))f.push(e)}var b=[];c(a,function(a){return a.className.toLowerCase()==d},b);if(b.length>0){if($Browser.isIE())System.Dom.Image.borderColor=b[0].currentStyle.backgroundColor;else System.Dom.Image.borderColor=document.defaultView.getComputedStyle(b[0],null).getPropertyValue("background-color");return System.Dom.Image.borderColor}}return ""};System.Dom.Image.Params=function(f,e,c,a,b,d){var g=this;g.Load=function(g){g.Reconstruct(f,e,c,a,b,d)}};System.Dom.Image.CreateFromResource=function(a){return new System.Dom.Image(a.src,a.size,a.size,true,true,a.clip)};registerNamespace("Msn.Spaces.Photos.OM");Msn.Spaces.Photos.OM.Init=function(a){if(Msn.Spaces.Photos.OM["PhotosFppUrl"]!=a){var b=new PhotosService.FppProxySettings;b.Version=PhotosService.FppVersion.TWO;b.CanaryToken=C_CANARY_COOKIE_NAME;Msn.Spaces.Photos.OM.photosFpp=PhotosService.initializeEx("http://"+window.location.hostname+a,b);Msn.Spaces.Photos.OM["PhotosFppUrl"]=a}};Msn.Spaces.Photos.OM.AvailableViews=new $Flags("Thumb",1,"Mobile",2,"Web",4,"Hires",8);Msn.Spaces.Photos.OM.ImageComment=function(i,d,c,h,f,e,b,g,a){return {strID:i,strAuthor:d,strAuthorPuid:c,strUrl:h,strEmail:f,dtPosted:e,strFormattedDate:b,strText:g,showContactControl:a}};Msn.Spaces.Photos.OM.AlbumInfo=function(h,f,d,e,g,c,b,a){return {strID:h,strName:f,iImageCount:d,dtCreated:e,strUrl:g,sizeDimension:c,blnIsEditable:b,blnIsDeletable:a}};Msn.Spaces.Photos.OM.ImageView=function(b,a,c){return {strUrl:b,sizeDimension:a,iSize:c}};Msn.Spaces.Photos.OM.ImageInfo=function(g,b,a,d,c,f,e){return {strID:g,strCaption:b,astrKeywords:a,dtCreated:d,aComments:c,htoViews:f,aoAlbums:e}};Msn.Spaces.Photos.OM.AlbumImageCollection=function(d,j,g,i,h,f){var a=this;a.GetAt=function(f,d){function e(){d(b[f])}if(a.IsReadyAt(f))e();else if(d)c.push(e);else return null};a.GetIndexOf=function(d,e){if(!d||d.length<1)return -1;function f(){var c=-1;for(var a=0;a<b.length;a++)if(b[a].strID==d){c=a;break}e(c)}if(a.IsReadyAt(0))f();else if(e)c.push(f);else return photoIndex};a.IsReadyAt=function(){return !!b};function e(d){b=d;for(var a=0;a<c.length;a++){c[a]();c[a]=null}c=null}a.GetImageInfoArrayAsync=function(c,d){var e=(new Date).valueOf();function a(){if(!b)if((new Date).valueOf()-e<d)window.setTimeout(a,250);else c(null);else c(b)}a()};var c=[],b;a.strName="";a.iCount=d.iImageCount;Msn.Spaces.Photos.OM.GetImageInfoArray(d.strID,e,f)};Msn.Spaces.Photos.OM.GetAlbumInfo=function(e,a,b){function d(){a(c)}var c=Msn.Spaces.Photos.OM.MockCreateAlbumInfoArray(b);window.setTimeout(d,1)};Msn.Spaces.Photos.OM.GetImageInfoArray=function(a,d,c){function e(c){for(var e=0;e<c.length;e++)c[e].htoViews={1:c[e].thumb,4:c[e].web,8:c[e].hires};b[a]=c;d(b[a])}var b=Msn.Spaces.Photos.OM.GetImageInfoArray.htInfo[c];if(!!Msn.Spaces.Photos.OM.GetImageInfoArray["blnLoadedCurrentAlbum"]&&!Msn.Spaces.Photos.OM.GetImageInfoArray.blnLoadedCurrentAlbum[c])LoadCurrentAlbum(b,c);if(b[a])d(b[a]);else Msn.Spaces.Photos.OM.photosFpp.getimageinfo1(a,0,1e3,spa_lastModified,c,e)};function InitGetImageInfoArray(a){if(!Msn.Spaces.Photos.OM.GetImageInfoArray["htInfo"])Msn.Spaces.Photos.OM.GetImageInfoArray.htInfo={};Msn.Spaces.Photos.OM.GetImageInfoArray.htInfo[a]={};if(!Msn.Spaces.Photos.OM.GetImageInfoArray["iCount"])Msn.Spaces.Photos.OM.GetImageInfoArray.iCount={};Msn.Spaces.Photos.OM.GetImageInfoArray.iCount[a]=0;if(!Msn.Spaces.Photos.OM.GetImageInfoArray["blnLoadedCurrentAlbum"])Msn.Spaces.Photos.OM.GetImageInfoArray.blnLoadedCurrentAlbum={};Msn.Spaces.Photos.OM.GetImageInfoArray.blnLoadedCurrentAlbum[a]=false}function LoadCurrentAlbum(h,c){function d(a){if(!!a&&a.length>=3)return new PhotosService.ImageView(a[0],new PhotosService.PhotosSize(parseInt(a[1][0]),parseInt(a[1][1])),parseInt(a[2]));else return null}function g(c){function d(a){if(a.length>=10)return new PhotosService.ImageComment(a[0],a[1],a[2],a[3],a[4],a[5],a[6],a[7],a[8],a[9]);else return null}var b=[];for(var a=0;a<c.length;a++)b.push(d(c[a]));return b}if(!!spa_strCurrentAlbumId[c]){var f=[];for(var e=spa_aaCurrentAlbumData[c].length-1;e>=0;e--){var a=spa_aaCurrentAlbumData[c][e],b=new PhotosService.ImageInfo(a[0],a[1],a[2],g(a[3]),d(a[4]),d(a[5]),d(a[6]));b.htoViews={1:b.thumb,4:b.web,8:b.hires};f.unshift(b)}h[spa_strCurrentAlbumId[c]]=f}if(!Msn.Spaces.Photos.OM.GetImageInfoArray["blnLoadedCurrentAlbum"])Msn.Spaces.Photos.OM.GetImageInfoArray.blnLoadedCurrentAlbum={};Msn.Spaces.Photos.OM.GetImageInfoArray.blnLoadedCurrentAlbum[c]=true}Msn.Spaces.Photos.OM.MockCreateAlbumInfoArray=function(c){var d=new Array(spa_aaImageData[c].length);for(var b=0;b<spa_aaImageData[c].length;b++){var a=spa_aaImageData[c][b];d[b]=Msn.Spaces.Photos.OM.AlbumInfo(a[0],a[4],a[5],a[6],a[1],System.Drawing.Size(a[2],a[3]),a[7],a[8])}return d};Msn.Spaces.Photos.SlideshowParams={};Msn.Spaces.Photos.SlideshowParams.Speeds=new $Enum("Slow","Medium","Fast");Msn.Spaces.Photos.SlideshowParams.Themes=new $Enum("PanAndZoomTheme","CrossFadeTheme","MirrorTheme");Msn.Spaces.Photos.SlideshowSettings=new function(){function i(a){if(!!a){if(typeof a=="boolean")return !!a;if(a.toLowerCase()=="false")return false;else return true}return false}var c=Msn.Spaces.Photos.SlideshowParams,b=System.Util.CookieJar,a=this;a.setSpeed=function(b){g=c.Speeds.parse(b);a.save()};a.setRepeat=function(b){f=i(b);a.save()};a.setIsPlaying=function(b){d=i(b);a.save()};a.setTheme=function(b){h=c.Themes.parse(b);a.save()};a.getSpeed=function(){if(!e)return c.Speeds.Medium;else return g};a.getRepeat=function(){if(!e)return true;else return f};a.getIsPlaying=function(){return d};a.getTheme=function(){if(!e)return c.Themes.CrossFadeTheme;else return h};a.setFullMode=function(a){e=a};a.debugShowState=function(a){alert("Cookie jar ("+a+") : \n"+"speed: "+g+"\n"+"theme: "+h+"\n"+"repeat: "+f+"\n"+"playing: "+d+"\n")};a.save=function(){if(!!e){b.setCookie("speed",g);b.setCookie("theme",h);b.setCookie("repeat",f)}b.setCookie("isPlaying",d);b.flush()};a.Init=function(){b.Init();var e=b.getCookie("repeat");if(!!e)f=i(e);var a=b.getCookie("isPlaying");if(!!a)d=i(a);var k=b.getCookie("theme");if(!!k)h=c.Themes.parse(k);var j=b.getCookie("speed");if(!!j)g=c.Speeds.parse(j)};var f=true,g=c.Speeds.Medium,d=true,h=c.Themes.CrossFadeTheme,e=false;this.Init()};registerNamespace("Msn.Spaces.Photos");Msn.Spaces.DisplayBox=function(g,h){var b=this;b.ChangeTransition=function(b){if(b)a.animation=Msn.Spaces.UI.FadeAnimation.Build(a,b)};b.Display=function(e,f,h,m){function l(f){try{var e=0;while(e<a.children.length){var c=a.children[e];if((!c.id.toLowerCase().startsWith("keyfocusanchor")||c.id.toLowerCase().startsWith("idfirstimage"))&&(!f||!!f&&!!d&&c!=d.element)){a.removeChild(c);b.onItemRemoved.fire(c)}else e++}}catch(g){}}if(!e){l();return}i(m);function k(){l(true);if(h)h(true)}var c=null;if(!!a)if(!a.animation){c=Msn.Spaces.UI.FadeAnimation.Build(a,g);a.animation=c}else c=a.animation;f&=!!c;if(!!c)c.SetCallback(k);b.Stop();var j;if(!!c){if(!f){j=c.Duration;c.SetDuration(0)}c.Apply()}var o=d;if(e){var n=e.Resize(b.size);if(b.size.width)System.Styles.Center(e.element,n,b.size);if(!!e.element.children[0]){if(e.element.nodeName.toLowerCase()!="table")e.element.style.display="inline";e.element.style.position="absolute";if(f)if($Browser.isIE())e.element.style.filter="progid:DXImageTransform.Microsoft.Alpha(opacity=0)";else e.element.style.opacity=0}if(!!a)a.appendChild(e.element);d=e}if(!!c){c.Play();if(!f)c.SetDuration(j)}else k()};b.Stop=function(){if(!!a.animation&&b.IsTransitioning())a.animation.Stop()};b.IsTransitioning=function(){try{return a.animation.IsTransitioning()}catch(b){return false}};b.Resize=function(c){if(!!c){System.Drawing.Size.Copy(c,b.size);System.Styles.SetSize(a,c);if(d){var e=d.Resize(c);System.Styles.Center(d.element,e,c)}}return b.size};function j(){b.onItemClicked.fire(b)}function k(){a.style.position="relative";e.create(null).Events.register(b.element,{onclick:j});function c(){b.ChangeTransition(g)}System.Dom.NotifyWhenLayoutComplete(a,c)}b.dispose=function(){System.Dom.UnNotifyWhenLayoutComplete(a);a.onfilterchange=null;if(e){e.dispose();e=null}if(a.animation){a.animation.dispose();a.animation=null}a=null};function i(a){if(!!a&&a!=f)f=a}var f,c=document.createElement("a");c.style.display="inline";c.style.position="absolute";c.style.left="0px";c.style.height="0px";c.style.width="100%";c.style.height="100%";c.tabIndex=0;c.id="keyfocusAnchor"+h.properties.uniqueId;var a=document.getElementById("divDisplayBox"+h.properties.uniqueId);if(!!a)b.element=a;else a=b.element=document.createElement("div");a.appendChild(c);var d=null,l=null,e=new $Memory.Groups;b.size=System.Drawing.Size();b.onItemRemoved=new $Event;b.onItemClicked=new $Event;k()};Msn.Spaces.Photos.ImageDisplay=function(k,j){var b=this;function c(){this.image=new System.Dom.Image;this.image.parent=this;this.Clean=this.image.Clean}c.Pool=new System.Pool(c,0);b.dispose=function(){a.dispose()};b.ShowImage=function(p,l,n,j,k,e){function h(a){if(m())return;if(k)k(!a,l)}function o(d){if(m())c.Pool.CheckIn(g);else if(d.success){if(!!e&&e.isInitialized==false){e.navbar.style.display="inline";e.isInitialized=true}if(j)j();g.image.FrameImage(true);a.Display(g.image,n,r,e);a.element.style.cursor="pointer"}else h(true);if(!f&&Spaces.LoadMonitor){function b(){f=true;Spaces.LoadMonitor.CompleteComponent("sp_mft_photoalbum"+p)}window.setTimeout(b,1e3)}}function r(){h(false)}function m(){return q!=d}var i=l.htoViews[Msn.Spaces.Photos.OM.AvailableViews.Web];if(i){var q=++d,g=c.Pool.CheckOut();g.image.Reconstruct(i.strUrl,i.sizeDimension,b.size,true,true);g.image.onReady.attach(o)}else h(true)};b.ShowText=function(b){e.nodeValue=b;a.Display(g)};b.Stop=function(){d++;a.Stop()};b.Clear=function(){d++;a.Display()};b.RelayoutNavbar=function(){if(!!a)a.Resize()};function h(){var b=document.createElement("span");e=document.createTextNode("");b.appendChild(e);var a=new Msn.Spaces.UI.Layout(b);a.SetLocation(5);return a}function i(a){if(a&&a!=g)c.Pool.CheckIn(a.parent)}var d=0,a=new Msn.Spaces.DisplayBox(j,k);b.element=a.element;b.size=a.size;b.Resize=a.Resize;b.onItemClicked=a.onItemClicked;a.onItemRemoved.attach(i);var g=h(),e,f=false};Msn.Spaces.Photos.SlideShowIndexCalculator=function(k,j){var a=this;function f(b){if(b!=f.iIndex){f.iIndex=b;a.onIndexChange.fire(b)}}f.iIndex=-2;a.IndexChangeEnd=function(a){d=false;c=-1;b=a;f(b)};a.IndexChangeBegin=function(a){d=true;c=b;b=a;f(b)};a.IndexChangeCancel=function(){if(d){d=false;b=c;c=-1}};a.GetShiftedIndex=function(e){if(e==0)return b;else if(d)if(c==-1&&e<0)return -1;else if(b==-1&&e>0)return -1;var f=a.NormalizeIndex(i(e));return f};function i(a){var e=b;if(e==-1&&a<=0)e=0;if(d)if(a<=0)return c+a+1;else return e+a-1;else return e+a}a.NormalizeIndex=function(b){var c=b;if(h)if(b>=e)a.pickNextAlbum.fire(false);else if(b<0)a.pickNextAlbum.fire(true);if(g){c=b%e;if(c<0)c+=e}else if(b<0||b>=e)c=-1;return c};a.IsFirstIndex=function(a){if(g)return false;return a==0};a.IsLastIndex=function(a){if(g)return false;return a==e-1};a.Reset=function(i,f,a){b=-1;c=-1;d=false;e=i;g=f;h=a};a.SetCurrentIndex=function(a){c=b=a};a.SetLoop=function(a){g=a};a.onIndexChange=new $Event;a.pickNextAlbum=new $Event;var b,c,d,e,g,h;a.Reset(k,!!j)};Msn.Spaces.Photos.SlideshowLogic=function(d,i,a){var b=this;function w(){var c=this;function v(){if(!b)return false;var c="";if(a.IsVisible()&&!a.IsMenuShowing()&&!a.IsAnimationRunning()&&!a.IsMouseOver())a.FadeOut();j()}function l(){if(!b)return false;f=window.setInterval(v,w)}function j(){if(!b)return false;window.clearInterval(f);f=0}function u(){j();l()}function e(){if(!b)return false;u();if(!a.IsVisible()&&!a.IsAnimationRunning())a.FadeIn();return true}function o(){e()}function n(){if(!b)return false;if(!a.IsMouseOver())h=true;return e()}function g(){if(!b)return false;h=false;if(!a.IsMouseOver()){if(f!=0)j();l()}return true}function t(){if(!b)return false;if(!!a)a.RepaintStop();return g()}function s(){return e()}function p(){return e()}c.dispose=function(){System.Dom.EventHookup(window,"onscroll",m,false);k.dispose();if(f)j()};function q(){if(!b)return false;h=false;return e()}function r(){if(!b)return false;if(!h)return g()}function m(){return e()}c.SetHandleEvents=function(a){b=a};c.AddKeyEvents=function(){var b=document.getElementById("keyfocusAnchor"+d.properties.uniqueId),a=k.create(null).Events;a.register(b,{onfocus:s});a.register(b,{onblur:t});a.register(b,{onkeypress:p});System.Dom.EventHookup(window,"onscroll",m,true)};c.Init=function(){var c=i.element,b=k.create(null).Events;b.register(c,{onmouseenter:n});b.register(c,{onmouseleave:g});b.register(c,{onmousemove:o});a.onMouseEnter.attach(q);a.onMouseLeave.attach(r)};c.DelayHide=function(){g()};c.Show=function(){if(a.IsAnimationRunning())a.CancelFade();if(!a.IsVisible()&&!a.IsAnimationRunning())a.FadeIn()};var w=2e3,f=0,k=new $Memory.Groups,h=false,b=true}function s(b){if(!!d.properties.iterateAlbums){var e=d.properties.uniqueId,c=0,a;if(b.iCount==1){for(a=0;a<spa_aaImageData[e].length;a++)c+=spa_aaImageData[e][a][5];return c>1}else if(b.iCount>1)return true;else return false}else return b.iCount>1}b.SetData=function(g,f){c=g;z=f;e.Reset(c.iCount,m,d.properties.iterateAlbums);if(g_htIsFirstPhotoAvailable[d.properties.uniqueId]&&b.SetData.IsFirstRun)b.SetData.IsFirstRun=false;else i.Clear();a.SetEnabled(s(c));j.SetHandleEvents(c.iCount>0)};b.SetData.IsFirstRun=true;b.RelayoutNavbar=function(){if(!!i)i.RelayoutNavbar()};function f(k,z,l,p,n,r){function w(){if(!l)e.IndexChangeEnd(g);r()}function y(a,b){a?w():u(b)}function x(){h.iCount++;if(!l)e.IndexChangeBegin(g)}function u(b){var a="DisplayComplete";if(!!b){var c=b.htoViews[Msn.Spaces.Photos.OM.AvailableViews.Web];if(!!c)a=a+"~"+c.strUrl}$Tracing.Error.Submit("Failed to load image",document.location.href,0,a,Spaces.Watson.Error.ImageNotLoaded,null);if(!l)e.IndexChangeCancel();g=e.NormalizeIndex(g+q);if(g==k){if(l)h(GetString("live.sndefaultstrings.strings.Photos.ErrorLoading"));r(true)}else window.setTimeout(m,1)}function h(b){function c(){if(A()||a!=h.iCount)return;i.ShowText(b)}h.iCount++;var a=h.iCount;window.setTimeout(c,1e3)}h.iCount=0;function t(b){if(b){i.ShowImage(d.properties.uniqueId,b,n,x,y,a);if(!v){j.AddKeyEvents();v=true}}else u()}function m(){if(l){e.IndexChangeEnd(g);h(GetString("live.sndefaultstrings.strings.Photos.Loading"))}if(c){c.GetAt(g,t);a.SetEnabled(s(c));j.DelayHide()}else a.SetEnabled(false)}function A(){return B!=f.iCount[d.properties.uniqueId]}if(!c||c.iCount<=0){i.ShowText(GetString("live.sndefaultstrings.strings.Photos.NoPhotosVisitorMode"));return}f.iCount[d.properties.uniqueId]++;var B=f.iCount[d.properties.uniqueId],g=k,q=p?1:0;if(z){g=e.GetShiftedIndex(k);q=p?k<0?-1:1:0}if(!!c&&c.iCount==1){c.GetAt(0,t);if(!s(c)){a.Pause();j.Show()}else if(k==1)b.pickNextAlbum.fire(false);return}if(g!=-1){m();o=e.IsLastIndex(g)}else{if(n){a.Pause();j.Show()}else{if(k==-1)g=c.iCount-1;else g=0;m()}o=true}}if(!f["iCount"])f.iCount={};f.iCount[d.properties.uniqueId]=0;function t(a){if(a)k();else{b.onAdvanceDone.fire();g()}}b.GotoIndex=function(g){var a=g_htIsFirstPhotoAvailable[d.properties.uniqueId]&&g_htFirstPhotoTimedOut[d.properties.uniqueId]&&b.GotoIndex.isFirstRun;if(a){b.GotoIndex.isFirstRun=false;if(!!c&&c.iCount<=1)g=0;else e.SetCurrentIndex(g+1)}f(g,false,!a,false,a,t)};b.GotoIndex.isFirstRun=true;b.AdvanceBy=function(a){f(a,true,true,true,false,t)};b.IsPlaying=function(){return h};b.PlayFromCurrent=function(){r=true;a.Play();r=false};function g(b){function a(){f(1,true,false,true,true,t);g.iCount[d.properties.uniqueId]++}if(h){k();if(b)a();else l=window.setTimeout(a,p)}}if(!g["iCount"])g.iCount={};g.iCount[d.properties.uniqueId]=0;function k(){window.clearTimeout(l);l=null}function H(){h=true;n.setIsPlaying(h);if(o){o=false;b.GotoIndex(0);g(false)}else g(!r)}function E(){k();h=false;n.setIsPlaying(h)}function I(){k();h=false;n.setIsPlaying(h);b.GotoIndex(0)}function C(){k();b.AdvanceBy(-1)}function G(){k();b.AdvanceBy(1)}function D(){a.ToggleSettingsMenu()}var q={Fast:3e3,Medium:5e3,Slow:8e3};function A(a){System.Util.Trace("Speed changed to "+a);p=q[a];n.setSpeed(a);g()}function y(){var a=d.properties.SlideshowSpeed.toLowerCase();if(a=="fast")return q.Fast;else if(a=="slow")return q.Slow;else return q.Medium}function B(){u(!m)}function u(b){m=b;e.SetLoop(m);a.SetRepeat(m);n.setRepeat(m)}function x(a){p=a}function F(){a.onPlay.attach(H);a.onPause.attach(E);a.onStop.attach(I);a.onPrevious.attach(C);a.onNext.attach(G);a.onSettings.attach(D);a.onRepeat.attach(B);x(p);a.onSpeedChanged.attach(A);u(true);a.SetEnabled(false);j.Init()}b.SetLoop=u;b.dispose=function(){j.dispose();if(l){window.clearTimeout(l);l=null}};var n=Msn.Spaces.Photos.SlideshowSettings,v=false,m=false,o=false,j=new w,r=false,p=y(),h=false,l=null,c,z=-1,e=new Msn.Spaces.Photos.SlideShowIndexCalculator;b.onIndexChange=e.onIndexChange;b.onAdvanceDone=new $Event;b.pickNextAlbum=e.pickNextAlbum;F()};Msn.Spaces.Photos.SlideshowView=function(f){var a=this;a.Dispose=function(){b.dispose()};a.Unload=function(){a.onIndexChange.clear();c.Stop()};a.Resize=function(b){b.width=Math.min(600,b.width);var f=.75;b.height=Math.min(b.height,Math.round(b.width*f));var c=d.Resize(b);a.size.width=c.width;a.size.height=c.height;System.Styles.SetSize(e,a.size);return a.size};a.SetState=function(a){var c=!g;g=a;b.SetData(g.images,g.iCurrentIndex);b.GotoIndex(g.iCurrentIndex)};a.IsPlaying=function(){return b.IsPlaying()};function i(){c=Msn.Spaces.UI.PlayerControls.Build(f,true,false,true,true,false);a.ctrlControls=c}a.dispose=function(){c.dispose();d.dispose();b.dispose()};function j(){Msn.Spaces.Photos.SlideshowSettings.setFullMode(false);e.style.position="relative";d=new Msn.Spaces.Photos.ImageDisplay(f,"transition:crossfade,duration:1");a.onItemClicked=d.onItemClicked;if(!g_htIsFirstPhotoAvailable[f.properties.uniqueId])e.appendChild(d.element);i();b=new Msn.Spaces.Photos.SlideshowLogic(f,d,c);a.onIndexChange=b.onIndexChange;a.Play=c.Play;a.Pause=c.Pause;a.PlayFromCurrent=b.PlayFromCurrent;a.GotoIndex=b.GotoIndex;a.RelayoutNavbar=b.RelayoutNavbar;a.pickNextAlbum=b.pickNextAlbum}var e=document.getElementById("divSlideshowView"+f.properties.uniqueId);if(!!e)a.element=e;else e=a.element=document.createElement("div");var g,d,c,b;a.size=System.Drawing.Size();var l=System.Drawing.Size(),h=false;j()};Msn.Spaces.UI.PlayerControls=function(x,E,o,C,g,A,D,i){var a=this,F=System.Util.GetImage;a.onPlay=new $Event;a.onPause=new $Event;a.onStop=new $Event;a.onPrevious=new $Event;a.onNext=new $Event;a.onSettings=new $Event;a.onRepeat=new $Event;a.onMouseEnter=new $Event;a.onMouseLeave=new $Event;a.onSpeedChanged=new $Event;a.GetMinimumWidth=function(){return v};a.GetNavigationBar=function(){return b};a.Play=function(){p(true)};a.Pause=function(){p(false)};a.PlayPause=function(){p(!j)};a.Stop=function(){j=false;c.SetButtonInfo(h["playPause"].index,o,"Photos.Play");a.onStop.fire()};a.Previous=function(){a.onPrevious.fire()};a.Next=function(){a.onNext.fire()};a.Settings=function(){a.onSettings.fire()};a.Resize=function(){return a.size};a.SetEnabled=function(a,b){if(b)c.SetEnabled(a,b);else c.SetEnabled(a)};a.SetRepeat=function(a){if(!!d)d.SetRepeat(a)};a.SetSpeed=function(a){if(!!d)d.SetSpeed(a)};a.IsVisible=function(){l();if(!b)return false;if(!!d&&d.IsShowing())return true;var a=b.style.display!="none"&&b.style.visibility!="hidden";return a};a.IsAnimationRunning=function(){if(!!f&&f.IsTransitioning()||!!e&&e.IsTransitioning())return true;return false};a.IsMenuShowing=function(){return !!d&&d.IsShowing()};a.IsMouseOver=function(){return k};a.SetMouseOver=function(a){k=a};a.ToggleSettingsMenu=function(){if(!!d)d.Toggle()};a.dispose=function(){c.onClick.detach(w);c.onMouseEnter.detach(m);c.onMouseLeave.detach(n);c.dispose();if(!!f)f.dispose();if(!!e)e.dispose();if(!!d)d.dispose();d=null;c=null;System.Dom.EventHookup(b,"onmouseenter",m,false);System.Dom.EventHookup(b,"onmouseleave",n,false)};a.CancelFade=function(){if(!!f&&f.IsTransitioning()){f.Cancel();b.style.display="inline";Msn.Spaces.UI.SetOpacity(b,100)}if(!!e&&e.IsTransitioning())e.Cancel()};a.FadeIn=function(){b.style.display="inline";y(function(){return f})};a.FadeOut=function(){u();e.SetCallback(B);y(function(){return e})};function B(){b.style.display="none"}function l(){if(!b){var a=document.getElementById("idControlsContainer"+x.properties.uniqueId);b=a}}function u(){if(!f)f=Msn.Spaces.UI.FadeAnimation.Build(b,"transition:fadeIn,duration:1");if(!e)e=Msn.Spaces.UI.FadeAnimation.Build(b,"transition:fadeOut,duration:1")}function y(c){l();if(!b)return;u();var a=c();if(!a)return;if(a.IsTransitioning())a.Stop();a.Apply();a.Play()}a.RepaintStop=function(){if(!!c&&!!g)c.SetButtonInfo(h["stop"].index,g,"Photos.Stop")};function p(b){j=b;c.SetButtonInfo(h["playPause"].index,j?C:o,j?"Photos.Pause":"Photos.Play");a[j?"onPlay":"onPause"].fire()}function z(h){function f(d,g,f){var a=document.createElement("div"),e=F(d),c=new System.Drawing.Size(g,f),b=a.style;b.position="absolute";b.visibility="visible";b.background="url("+e+") repeat-x";b.zIndex=0;System.Styles.SetSize(a,c);a.size=c;return a}var c=[10,!!g?53:25,24,!!i?53:25,10],d=["rt_end","side_1px","center","side_1px","lt_end"],b=new System.Drawing.Point(0,0);for(var a=d.length-1;a>=0;a--){var e=f(d[a]+".gif",c[a],26);System.Styles.SetLocation(e,b);h.appendChild(e);b.x+=c[a]}r=b.x;v=r}function t(d){var c={},f=d.childNodes;for(var e=0;e<f.length;e++){var j=f[e];c[j.id]=j}var b=new System.Drawing.Point(!!g?20:10,5);if(Spaces.IsRTL()){b=new System.Drawing.Point(!!g?11:10,5);if(!!i){System.Styles.SetLocation(c["Photos.Settings"],b);c["Photos.Settings"].style.zIndex=1;b.x=38}System.Styles.SetLocation(c["Photos.Next"],b);c["Photos.Next"].style.zIndex=1;b.x+=25;b.y=1;System.Styles.SetLocation(c["Photos.Play"],b);c["Photos.Play"].style.zIndex=1;b.x+=24;b.y=5;System.Styles.SetLocation(c["Photos.Previous"],b);c["Photos.Previous"].style.zIndex=1;if(!!g){b.x+=28;System.Styles.SetLocation(c["Photos.Stop"],b);c["Photos.Stop"].style.zIndex=1}}else{if(!!g){System.Styles.SetLocation(c["Photos.Stop"],b);c["Photos.Stop"].style.zIndex=1;b.x=38}System.Styles.SetLocation(c["Photos.Previous"],b);c["Photos.Previous"].style.zIndex=1;b.x+=25;b.y=1;System.Styles.SetLocation(c["Photos.Play"],b);c["Photos.Play"].style.zIndex=1;b.x+=24;b.y=5;System.Styles.SetLocation(c["Photos.Next"],b);c["Photos.Next"].style.zIndex=1;if(!!i){b.x+=28;System.Styles.SetLocation(c["Photos.Settings"],b);c["Photos.Settings"].style.zIndex=1}}if(q==0)q=!!d.style.pixelHeight?c["Photos.Play"].style.pixelHeight:d.style.pixelHeight;var h=new System.Drawing.Size(r,q);System.Styles.SetSize(d,h);a.size=h}var s;function m(){k=true;a.onMouseEnter.fire();return true}function n(){k=false;a.onMouseLeave.fire();return true}function w(b){if(a.IsAnimationRunning())a.CancelFade();if(a.IsVisible())s[b]();k=true;return true}function G(){function f(b,e){var c=[];for(var a=0;a<b.buttons.length;a++){var d=b[b.buttons[a]];if(d.index!=-1)c.push(d[e])}return c}function j(){l();if(!b)return;System.Dom.EventHookup(b,"onmouseenter",m,true);System.Dom.EventHookup(b,"onmouseleave",n,true)}var e=!!g?0:1;h={buttons:["stop","previous","playPause","next","settings"],stop:{index:0-e,image:g,strId:"Photos.Stop",eventCallback:a.Stop},previous:{index:1-e,image:A,strId:"Photos.Previous",eventCallback:a.Previous},playPause:{index:2-e,image:o,strId:"Photos.Play",eventCallback:a.PlayPause},next:{index:3-e,image:D,strId:"Photos.Next",eventCallback:a.Next},settings:{index:!!i?3:-1,image:i,strId:"Photos.Settings",eventCallback:a.Settings}};var k=f(h,"strId");c=new Msn.Spaces.UI.ButtonPanel(x,E,f(h,"image"),k,true);s=f(h,"eventCallback");c.onClick.attach(w);c.onMouseEnter.attach(m);c.onMouseLeave.attach(n);a.element=c.element;a.element.display="none";a.size=c.size;l();a.navbar=b;a.isInitialized=false;j();z(a.element);t(a.element);if(!!i)d=new Msn.Spaces.Photos.SlideshowSettingsMenu(a,c.GetButtonElement(h["settings"].index));c.SetAdjustSizeCallback(t)}var k=false,f,e,b,h,c,j=false,r=0,q=0,v=0,d;G()};Msn.Spaces.UI.PlayerControls.Build=function(c,b,g,e,f,d){function a(b){function a(f){var a=c.images["player_"+b+"_"+f],d;if(!!a.clip){var e=new System.Drawing.Size(a.clip.width,a.clip.height);d=new System.Dom.Image.Params(a.src,a.size,e,true,true,a.clip)}else d=new System.Dom.Image.Params(a.src,a.size);return d}var d=new Msn.Spaces.UI.RolloverImageSet(a("normal"),a("hover"),a("down"),a("disabled"));return d}return new Msn.Spaces.UI.PlayerControls(c,3,b?a("play"):null,b?a("pause"):null,g?a("stop"):null,e?a(Spaces.IsRTL()?"next":"back"):null,f?a(Spaces.IsRTL()?"back":"next"):null,d?a("settings"):null)};registerNamespace("Msn.Spaces.Photos");Msn.Spaces.Photos.ViewerBinding=function(b,a){var c=Msn.Spaces.Photos,f=this;Msn.Spaces.Photos.ViewerBinding.initializeBase(this,arguments);var g=false;a=this.getParameters();var e,d=new $Memory.Groups,h,i;function k(){var i=["mainbody","bold","bold","ListBox","ListBox","ListBoxSelected","ListBoxSelected","DetailSection","DetailSection","DetailSectionHeader","DetailSectionHeader","DetailSectionBody","DetailSectionBody","DetailSectionFormElements","DetailSectionFormElements","imageBorder","imageBorder","imageShadow","imageShadow"],e=["PhotosPath",null,"EfpPath",$Config.Themes.url+"hig/img/","ThemedSpacesPath",$Config.Themes.url+"Spaces/img/","SitePath",null],b="Transports.png";if(Spaces.IsRTL())b="Transports_flipped.png";var g=[["player_play_normal","PhotosPath",b,100,114,System.Drawing.Rectangle(72,56,24,24)],["player_play_hover","PhotosPath",b,100,114,System.Drawing.Rectangle(48,56,24,24)],["player_play_down","PhotosPath",b,100,114,System.Drawing.Rectangle(24,56,24,24)],["player_play_disabled","PhotosPath",b,100,114,System.Drawing.Rectangle(0,56,24,24)],["player_pause_normal","PhotosPath",b,100,114,System.Drawing.Rectangle(72,32,24,24)],["player_pause_hover","PhotosPath",b,100,114,System.Drawing.Rectangle(48,32,24,24)],["player_pause_down","PhotosPath",b,100,114,System.Drawing.Rectangle(24,32,24,24)],["player_pause_disabled","PhotosPath",b,100,114,System.Drawing.Rectangle(0,32,24,24)],["player_stop_normal","PhotosPath",b,100,114,System.Drawing.Rectangle(45,96,15,16)],["player_stop_hover","PhotosPath",b,100,114,System.Drawing.Rectangle(30,96,15,16)],["player_stop_down","PhotosPath",b,100,114,System.Drawing.Rectangle(15,96,15,16)],["player_stop_disabled","PhotosPath",b,100,114,System.Drawing.Rectangle(0,96,15,16)],["player_back_normal","PhotosPath",b,100,114,System.Drawing.Rectangle(75,80,25,16)],["player_back_hover","PhotosPath",b,100,114,System.Drawing.Rectangle(50,80,25,16)],["player_back_down","PhotosPath",b,100,114,System.Drawing.Rectangle(25,80,25,16)],["player_back_disabled","PhotosPath",b,100,114,System.Drawing.Rectangle(0,80,25,16)],["player_next_normal","PhotosPath",b,100,114,System.Drawing.Rectangle(75,16,25,16)],["player_next_hover","PhotosPath",b,100,114,System.Drawing.Rectangle(50,16,25,16)],["player_next_down","PhotosPath",b,100,114,System.Drawing.Rectangle(25,16,25,16)],["player_next_disabled","PhotosPath",b,100,114,System.Drawing.Rectangle(0,16,25,16)],["player_settings_normal","PhotosPath",b,100,114,System.Drawing.Rectangle(72,0,24,16)],["player_settings_hover","PhotosPath",b,100,114,System.Drawing.Rectangle(48,0,24,16)],["player_settings_down","PhotosPath",b,100,114,System.Drawing.Rectangle(24,0,24,16)],["player_settings_disabled","PhotosPath",b,100,114,System.Drawing.Rectangle(0,0,24,16)],["dropDownArrow","PhotosPath","dropArrow_grayStroke_10x6.gif",10,6],["detailsCollapsed","EfpPath","glyph/collapse_~Right~_rest_~BodyTextLuminance~.gif",10,10],["detailsCollapsed_hover","EfpPath","glyph/collapse_~Right~_hover_~BodyTextLuminance~.gif",10,10],["detailsExpanded","EfpPath","glyph/expand_~Left~_rest_~BodyTextLuminance~.gif",10,10],["detailsExpanded_hover","EfpPath","glyph/expand_~Left~_hover_~BodyTextLuminance~.gif",10,10],["pager_first_enabled","PhotosPath","first_color.GIF",10,12],["pager_first_disabled","PhotosPath","first_dim.GIF",10,12],["pager_previous_enabled","PhotosPath","prev_color.GIF",7,12],["pager_previous_disabled","PhotosPath","prev_dim.GIF",7,12],["pager_next_enabled","PhotosPath","next_color.GIF",7,12],["pager_next_disabled","PhotosPath","next_dim.GIF",7,12],["pager_last_enabled","PhotosPath","last_color.GIF",10,12],["pager_last_disabled","PhotosPath","last_dim.GIF",10,12],["clearIcon","ThemedSpacesPath","clearicon_~ContainerHeaderTextLuminance~.gif",16,16],["errorIcon","EfpPath","notification/annotation_warning.gif.gif",16,16],["filmstrip_left_rest","EfpPath","glyph/backnext_~Left~_rest_~ContainerHeaderTextLuminance~.gif",10,10],["filmstrip_left_hover","EfpPath","glyph/backnext_~Left~_hover_~ContainerHeaderTextLuminance~.gif",10,10],["filmstrip_right_rest","EfpPath","glyph/backnext_~Right~_rest_~ContainerHeaderTextLuminance~.gif",10,10],["filmstrip_right_hover","EfpPath","glyph/backnext_~Right~_hover_~ContainerHeaderTextLuminance~.gif",10,10],["expand_right_rest","EfpPath","glyph/expand_~Right~_rest_~ContainerHeaderTextLuminance~.gif",10,10],["collapse_right_hover","EfpPath","glyph/collapse_~Right~_rest_~ContainerHeaderTextLuminance~.gif",10,10],["detailsPaneCloseRest","EfpPath","glyph/close_rest_~ContainerHeaderTextLuminance~.gif",10,10],["detailsPaneCloseHover","EfpPath","glyph/close_hover_~ContainerHeaderTextLuminance~.gif",10,10],["moveAlbumUp","PhotosPath","move_album_up.gif",9,10],["moveAlbumDown","PhotosPath","move_album_down.gif",9,10]],j=[e,g],f=["args",a,"strVisitorCid",a["strvisitorcid"],"initialAlbumIndex",parseInt(a["istartingalbumindex"]),"isOwner",a["isowner"]=="1","strDefaultView",a["strdefaultview"],"strPhotoID",a["strphotoid"],"iStartingImageIndex",parseInt(a["istartingimageindex"]),"uniqueId",a["uniqueid"],"iterateAlbums",a["iteratealbums"]=="1","SlideshowSpeed",a["slideshowspeed"]],h=[j,i,f],c=Msn.Spaces.Resources.Create(h);InitGetImageInfoArray(c.properties.uniqueId);var d=c.properties.strDefaultView;if(!d)d="Photos.Slideshow";c.properties["initialView"]=GetString("live.sndefaultstrings.strings."+d);return c}function j(){e.SetWidth(b[$Browser.isIE()?"offsetWidth":"clientWidth"]-10)}function l(){var h=k(),g={},f={};g[GetString("live.sndefaultstrings.strings.Photos.Slideshow")]=c.SlideshowView;f[GetString("live.sndefaultstrings.strings.Photos.Slideshow")]="Photos.Slideshow";e=new c.Viewer(b,h,g,f,a,a["stralbumidreplacementtoken"],a["streditalbumtemplateurl"],a["strcommenttemplateurl"],a["strfullviewtemplateurl"]);d.create(null).Events.register(b,{onresize:j});j()}f.dispose=function(a){Msn.Spaces.Photos.ViewerBinding.callBaseMethod(this,"dispose",arguments);System.Dom.UnNotifyWhenLayoutComplete(b);if(d){d.dispose(a);d=null}if(e)e.dispose();if(h)h=null;if(i)i=null;f=null;b=null};f.initialize=function(){c.ViewerBinding.callBaseMethod(this,"initialize",arguments);c.OM.Init(a["strphotosfppurl"]);if(!g){System.Dom.NotifyWhenLayoutComplete(b,l);g=true}}};Msn.Spaces.Photos.ViewerBinding.registerClass("Msn.Spaces.Photos.ViewerBinding","$Binding");Msn.Spaces.Photos.ViewerBinding.skipClass=true;Msn.Spaces.Photos.ViewerBinding.Params=new $Enum("isOwner","strVisitorCid","strPhotosFppUrl","iStartingAlbumIndex","strAlbumIdReplacementToken","strNewAlbumUrl","strEditAlbumTemplateUrl","strCommentTemplateUrl","strFullViewTemplateUrl","strDefaultView","strPhotoID","iStartingImageIndex");Msn.Spaces.Photos.Viewer=function(T,b,z,U,X,n,y,J,K){var m=Msn.Spaces.Photos,A=Msn.Spaces.UI,N=System.Dom,g=this;g.SetWidth=function(b){if(!!e("divViewer")){C=b;x.width=b;x.height=2e3;r(b);if(!I){if(a)a.Resize(x);c.htIds.idCommentLinks.style.width=x.width+"px"}P();if(a)System.Styles.SetSize(e("divViewer"),a.size)}};g.CreateCommentLink=function(j,i,l){var g=this;function k(){if(h)h.dispose();a=null}function e(){var a=J.replace(n,f.strID.replace("cns!","")+"/"+d.strCurrentPhotoId);u(a);if($Browser.isIE())event.returnValue=false}g.SetCount=function(a){b.SetText(GetString("live.sndefaultstrings.strings.Photos.CommentsHeader").format(a))};var b=new A.NoBreakText(j);b.element.title=i;var a=new A.Link(b.element);a.element.id=l;h.create("commentLink").Events.register(a.element,{onclick:e});c.htIds.idCommentLinks.appendChild(a.element);t.push(k)};g.NextAlbum=function(a){function c(c){var d=0;while(!!c[d]&&c[d].strID!=f.strID)d++;if(!!a)if(d-1<0)j=c.length-1;else j=d-1;else j=d+1;if(!!c[j]){while(!!c[j]&&c[j].iImageCount<=0)if(!!a){j--;if(j<0)j=c.length-1}else j++;if(!!c[j])if(!a)k(c[j],0);else k(c[j],c[j].iImageCount-1);else if(!a)k(c[b.properties["initialAlbumIndex"]],0);else k(c[b.properties["initialAlbumIndex"]],c[b.properties["initialAlbumIndex"]].iImageCount-1)}else k(c[b.properties["initialAlbumIndex"]],0)}m.OM.GetAlbumInfo("",c,b.properties.uniqueId)};function F(a){var b=!!a?a.strCaption||"":"";if(v.parentNode)v.parentNode.style.visibility=!!b?"visible":"hidden";v.nodeValue=b||"-"}function G(a){if(a&&a.commentsCount==null)a.commentsCount=a.aComments.length;var b=0;if(!!a)b=a.commentsCount;if(s)if(a)s.SetCount(a.commentsCount);else s.SetCount(0)}function E(){delete l[GetString("live.sndefaultstrings.strings.Photos.Slideshow")];z[GetString("live.sndefaultstrings.strings.Photos.Slideshow")]=Msn.Spaces.Photos.SlideshowView;e("divViewer").appendChild(e("idControlsContainer"));o(b.properties["initialView"])}function p(a){Msn.Spaces.Photos.iCurrentSlideShowIndex=a;function b(b){q=b;F(q);G(q);c.htIds.idProgressText.style.visibility=d.images.iCount>0?"visible":"hidden";var e=a;if(a<d.images.iCount)e+=1;c.htIds.idProgressText.innerHTML=GetString("live.sndefaultstrings.strings.Photos.PageIndicator").format(e,d.images.iCount);if(!!b)d.strCurrentPhotoId=b.strID.replace("cns!","")}q=null;d.iCurrentIndex=a;if(d.iCurrentIndex!=-1)d.images.GetAt(d.iCurrentIndex,b);p.iCount++}p.iCount=0;function P(){if(a){var b=e("divViewer");c.htIds.idProgressText.style.paddingTop="5px";c.htIds.idProgressText.style.pixelWidth=a.size.width;c.htIds.idProgressText.style.pixelLeft=b.style.pixelLeft;c.htIds.idCommentLinks.style.pixelLeft=b.style.pixelLeft;c.htIds.idCommentLinks.style.pixelWidth=a.size.width;L()}}function r(e,a){if(!a&&r.blnRun)r(e,true);r.blnRun=true;var b=a?"none":"block",d=a?"removeChild":"appendChild";if(!a)I=false;c.htIds.idDescriptionBottom[d](v);c.htIds.idCommentLinks.style.display=b}r.blnRun=false;function H(){w();if($Browser.isIE())event.returnValue=false}function k(e,k){function j(b){d.iCurrentIndex=!!b&&b>=0?b:0;p(d.iCurrentIndex);a.SetState(d)}f=null;var g=null;if(arguments.length>2)g=arguments[2];if(!c||!c["htIds"])return;q=null;G(null);F(null);if(e){if(!B[e.strID])B[e.strID]=new m.OM.AlbumImageCollection(e,m.OM.AvailableViews.Thumb|m.OM.AvailableViews.Web,true,1e6,true,b.properties.uniqueId);f=e;if(i)i.SetSelectedAlbum(f);Q(c.htIds.idAlbumTitle,e.strName,M,true,true,GetString("live.sndefaultstrings.strings.Photos.FullView"));d.images=B[e.strID];if(g&&g.length>0)d.images.GetIndexOf(g,j);else j(k)}var o=f.blnIsEditable,l=f.blnIsDeletable,h=document.getElementById("phEditAlbum"+b.properties.uniqueId);if(!!h&&h.firstChild)if(!!f)h.firstChild.href=y.replace(n,f.strID.replace("cns!",""))}function L(){if(a.ctrlControls){e("idControlsContainer").style.top=a.size.height-30+"px";if(Spaces.IsRTL())a.ctrlControls.element.style.right=Math.floor((a.size.width-a.ctrlControls.size.width)/2)+"px";else System.Styles.HorizontallyAlign(a.ctrlControls.element,a.ctrlControls.size.width,a.size.width);if(!!a)if(!!a.RelayoutNavbar)a.RelayoutNavbar()}}function o(c){var f=!o.blnHasRun;o.blnHasRun=true;if(a){if(!!a.pause&&!!Msn.Spaces.Photos.Viewer.PauseCurrentView)delete Msn.Spaces.Photos.Viewer.PauseCurrentView;if(a.onFullView)a.onFullView.detach(w);f=a.IsPlaying();e("divViewer").removeChild(a.element);a.onIndexChange.detach(p);a.pickNextAlbum.detach(g.NextAlbum);if(!!a.onFatalError)a.onFatalError.detach(E);if(a.onItemClicked)a.onItemClicked.detach(H);if(a.ctrlControls)e("idControlsContainer").removeChild(a.ctrlControls.element);a.Unload()}if(!z[c]){w();return}if(!l[c])l[c]=new z[c](b);a=l[c];if(!!a.Pause)Msn.Spaces.Photos.Viewer.PauseCurrentView=a.Pause;if(a.onFullView)a.onFullView.attach(w);if(a.onItemClicked)a.onItemClicked.attach(H);if(a.ctrlControls)e("idControlsContainer").appendChild(a.ctrlControls.element);a.onIndexChange.attach(p);a.pickNextAlbum.attach(g.NextAlbum);if(!!a.onFatalError)a.onFatalError.attach(E);if(!g_htIsFirstPhotoAvailable[b.properties.uniqueId]){System.Dom.RemoveChildren(e("divViewer"));e("divViewer").appendChild(a.element)}if(a.ctrlControls)e("divViewer").appendChild(e("idControlsContainer"));if(C)g.SetWidth(C);if(d.images)a.SetState(d);if(f&&Msn.Spaces.Photos.SlideshowSettings.getIsPlaying()==true)a.PlayFromCurrent()}o.blnHasRun=false;function S(){function d(a){O=a;if(a.length>0)if(i){i.BindTo(a);i.onAlbumSelected.attach(k)}var d=parseInt(b.properties["iStartingImageIndex"]),c=a[b.properties["initialAlbumIndex"]];if(!!c)if(g_htIsFirstPhotoAvailable[b.properties.uniqueId]&&c.iImageCount>1)d++;k(c,d,b.properties["strPhotoID"])}s=new g.CreateCommentLink(GetString("live.sndefaultstrings.strings.Photos.CommentsHeader").format(0),GetString("live.sndefaultstrings.strings.Photos.CommentsTooltip"),"TotalComments");var a=c.htIds.tblAlbums;if(a)i=new Spaces.Photos.AlbumPicker(a);o(b.properties["initialView"]);m.OM.GetAlbumInfo("",d,b.properties.uniqueId)}function Q(c,b,f,g,e,d){function i(){if(h)h.disposeGroup("links")}if(e)N.RemoveChildren(c);var a=new A.Link(document.createTextNode(g?b:GetString("live.sndefaultstrings.strings."+b)));if(!!d)a.element.title=d;c.appendChild(a.element);t.push(i);h.create("links").Events.register(a.element,{onclick:f})}function u(a){function b(){System.Browser.Goto(a)}window.setTimeout(b,1)}function M(){var a=y.replace(n,f.strID.replace("cns!",""));u(a)}function w(){var a="";if(d.strCurrentPhotoId)a=d.strCurrentPhotoId;var b=K.replace(n,f.strID.replace("cns!","")+"/"+a);u(b)}g.pause=function(){if(!!a&&!!a.Pause)a.Pause()};g.dispose=function(){if(!!Msn.Spaces.Photos.Viewer["PauseCurrentView"])delete Msn.Spaces.Photos.Viewer.PauseCurrentView;for(strViewName in l){l[strViewName].dispose();delete l[strViewName]}for(var a=0;a<t.length;a++)t[a]();function b(a){if(a)a.dispose()}if(i)b(i);Msn.Spaces.CleanBuiltNodes(c);if(h){h.dispose();h=null}};var R=b.properties.uniqueId;function e(a){return c.htIds[a+R]}var t=[],c=g.element=Msn.Spaces.CreateNodes(T,b),D=_ge("phEditAlbum"+b.properties.uniqueId);if(D){c.htIds["phEditAlbum"+b.properties.uniqueId]=D.parentNode;c.htIds["phEditAlbum"+b.properties.uniqueId].id=D.id}var d=new m.ImageViewerState,l={},O=null,f=null,a,s,i,B={},v=document.createTextNode(""),I=false,x=System.Drawing.Size(),C=0,q=null,h=new $Memory.Groups;if(!!e("divViewer"))S()};Msn.Spaces.Photos.ImageViewerState=function(){var a=this;a.images=null;a.iCurrentIndex=-1};registerNamespace("Spaces.Photos");Spaces.Photos.AlbumPicker=function(a){var f=this;f.dispose=function(){if(c){c.dispose();c=null}};function l(){var d=window.event.srcElement.tagName,c=window.event.srcElement,a=j(c,b);f.onAlbumSelected.fire(n(a.attributes[b].value))}function k(d){function c(b,c){var a=d&&c;b.style.cursor=a?"pointer":"default";b.style.display=a?"inline":"none"}function f(d){if(d.id=="spanUp")c(d,!o(a.attributes[b]));else if(d.id=="spanDown")c(d,!q(a.attributes[b]))}var a=j(window.event.srcElement,b);if(a){try{if(d&&a.attributes[b].value!=e.strID)a.className+=" HoverBG";else a.className=a.className.removeSpaceDelimitedString("HoverBG")}catch(g){}System.Dom.Traverse(a,f);event.returnValue=false}}function m(){k(true)}function p(){k(false)}function j(a,b){while(a&&!a.attributes[b]){if(a.id=="albumPicker2")return null;a=a.parentElement}return a}function i(b){for(var a=0;a<d.length;a++)if(d[a].strID==b)return a;return -1}function o(c){return g==1||a.rows[0].attributes[b]==c}function q(c){return g==1||a.rows[a.rows.length-1].attributes[b]==c}function n(b){for(var a=0;a<d.length;a++)if(d[a].strID==b)return d[a];return null}function h(b,c){a.rows[b].className=c?"SelectionBG":"PartBG"}f.BindTo=function(a){d=a};f.SetSelectedAlbum=function(b){if(e){var a=i(e.strID);if(a!=-1)h(a,false)}e=b;a=i(e.strID);if(a!=-1)h(a,true)};function r(){f.onAlbumSelected=new $Event(false);g=a.rows.length;c.create(null).Events.register(a,{onmouseover:m});c.create(null).Events.register(a,{onmouseout:p});c.create(null).Events.register(a,{onclick:l})}var e=null,g=0,d=null,b="pa:albumID",c=new $Memory.Groups;r()};Msn.Spaces.UI.SetOpacity=function(a,b){if($Browser.isIE())if(a.filters.length>0&&!!a.filters["DXImageTransform.Microsoft.Alpha"])a.filters.item("DXImageTransform.Microsoft.Alpha").opacity=b;else a.style.filter="progid:DXImageTransform.Microsoft.Alpha(opacity="+b+")";else a.style.opacity=b/100};Msn.Spaces.UI.FadeAnimation=function(m,q,i){var a=this,f=Msn.Spaces.UI.SetOpacity;function r(){if(!!j)j.call()}function p(){if(i==Msn.Spaces.UI.FadeAnimation.AnimationTypes.CrossFade)return o("a",2);else{var a=[];a.push(m);return a}}function o(d,e){var c=[],a=m.childNodes;if(!a)return null;for(var b=0;b<a.length&&c.length<=e;b++)if(a[b].nodeName.toLowerCase()==d&&!a[b].id.toLowerCase().startsWith("keyfocusanchor"))c.push(a[b]);return c}function g(b){var a=d;if(!a)return;if(i==Msn.Spaces.UI.FadeAnimation.AnimationTypes.CrossFade){if(a.length<2)if(a.length==1)f(a[0],100);else System.Util.Trace("Crossfading with no image");else if(a.length>=2){f(a[0],b);f(a[1],c-b)}}else if(i==Msn.Spaces.UI.FadeAnimation.AnimationTypes.FadeOut)f(a[0],b);else f(a[0],c-b)}function k(){return 60}function n(){return 1e3/k()}function t(){return c/(k()*a.Duration)}function s(){e=(new Date).valueOf()}function v(){if(e==0)s();l=(new Date).valueOf()}function u(){return l-e}a.Duration=q;a.SetDuration=function(b){a.Duration=b};a.SetCallback=function(a){j=a};a.Cancel=function(){if(a.Duration==0)return;if(!!b){window.clearInterval(b);b=null}g(c);d=null;e=0};a.dispose=function(){if(!!b){window.clearInterval(b);b=null}d=null;e=0};a.Apply=function(){if(a.Duration==0)return;g(c);e=0};a.IsTransitioning=function(){return b!=null};a.Play=function(){if(a.Duration==0){a.Stop();return}if(!d)d=p();var f=t(),i=k();function e(b){var a=f*(b/(1e3/i));return c-a}b=window.setInterval(function(){v();var b=u();if(b>a.Duration*1e3){h=0;g(h);a.Stop();return}else h=e(b);g(h)},n())};a.Stop=function(){d=null;if(!!b){window.clearInterval(b);b=null}r()};var c=100,j=null,e=0,l=0,b=null,h=c,d=null};Msn.Spaces.UI.FadeAnimation.AnimationTypes={};Msn.Spaces.UI.FadeAnimation.AnimationTypes.CrossFade="crossfade";Msn.Spaces.UI.FadeAnimation.AnimationTypes.FadeIn="fadeIn";Msn.Spaces.UI.FadeAnimation.AnimationTypes.FadeOut="fadeOut";Msn.Spaces.UI.FadeAnimation.Build=function(f,b){var e=b.split(","),d=1,b=Msn.Spaces.UI.FadeAnimation.AnimationTypes.CrossFade,h=[Msn.Spaces.UI.FadeAnimation.AnimationTypes.CrossFade,Msn.Spaces.UI.FadeAnimation.AnimationTypes.FadeIn,Msn.Spaces.UI.FadeAnimation.AnimationTypes.FadeOut];for(var c=0;c<e.length;c++){var a=e[c].split(":");if(a[0]=="transition")b=a[1];else if(a[0]=="duration")d=parseFloat(a[1])}var g=new Msn.Spaces.UI.FadeAnimation(f,d,b);return g};function Spa(){}Spa.IsUndefined=function(a){return a===void 0};Spa.IsDefined=function(a){return a!==void 0};Spa.HasValue=function(a){return a!==void 0&&a!=null};Spa.Point=function(a,b){this.x=this.left=a;this.y=this.top=b};Function.prototype.ArgsArray=function(c){var b=Spa.IsUndefined(c)?0:c,a=this.arguments,d=Math.max(0,a.length-b);if(a.length>=b+1)if(a[b]){if(a[b].blnIsArgsArray)return a[b];if(a[b].constructor==Array){a=a[b];b=0;d=a.length}}a.iStart=b;a.iEnd=b+d;a.blnIsArgsArray=true;return a};Spa.Pool=function(a,b){this.fncCreate=a;this.fncClean=b;this.aobjPool=[]};Spa.Pool.prototype.CheckOut=function(){if(this.aobjPool.length==0)return this.fncCreate();else return this.aobjPool.shift()};Spa.Pool.prototype.CheckIn=function(a){Spa.Invoker(this.fncClean,a);this.aobjPool.unshift(a)};Spa.Properties=function(){};Spa.Properties.Set=function(c){var a=Spa.Properties.Set.ArgsArray(1);for(var b=a.iStart;b<a.iEnd;b+=2)c[a[b]]=a[b+1]};Spa.String=function(){};Spa.String.Format=function(c){var b=c;for(var a=1;a<arguments.length;a++)b=b.replace("{"+(a-1)+"}",arguments[a]);return b};Spa.Dom=function(){};Spa.Dom.CreateElement=function(b,c){var a=window.document.createElement(c);Spa.Properties.Set(a.style,Spa.Dom.CreateElement.ArgsArray(2));if(b)b.appendChild(a);return a};Spa.Dom.FindOffsetInParentElement=function(a,d,e){var c=0,b=0;while(a!=d&&d.contains(a)){c+=a.offsetTop;b+=a.offsetLeft;if(e){c-=a.scrollTop;b-=a.scrollLeft}a=a.offsetParent}return new Spa.Point(b,c)};Spa.Dom.ExecuteWhenLayoutComplete=function(b,c){if(b.clientWidth==0){var a=b.__objEventOnLayoutComplete;if(!a){function d(){if(b.clientWidth==0)window.setTimeout(d,100);else{a.Fire();b.__objEventOnLayoutComplete=null}}a=new Spa.Event;b.__objEventOnLayoutComplete=a;a.Attach(c);d()}else a.Attach(c)}else c()};Spa.Navigation=function(){};Spa.Navigation.Goto=function(a){try{document.location.href=a}catch(b){}};Spa.Dom.Styles=function(){};Spa.Dom.Styles.TrblValue=function(d,b,a,c){if(arguments.length==1)b=a=c=d;return d+" "+b+" "+a+" "+c};Spa.Dom.Image=function(){};Spa.Dom.Image.Create=function(){function b(){a.src="";c.Delete();if(window.detachEvent)window.detachEvent("onunload",b)}var a=document.createElement("img"),c=new Spa.Memory.Wrapper(a);window.attachEvent("onunload",b);return a};Spa.Dom.Image.Scale=function(d,b,a,f,e){var c=Math.min(1,Math.min(f/b,e/a));d.width=Math.round(b*c);d.height=Math.round(a*c)};Spa.Dom.Image.Cache=function(i,e,h){var d=false;function b(b){if(!d){d=true;a.onload=null;a.onerror=null;Spa.Invoker(e,!b);Spa.Dom.Image.Cache.imgPool.CheckIn(a)}}function j(){e=null;b(true)}function g(){if(c<h)f();else b(true)}function f(){c++;a.src=i}var c=0,a=Spa.Dom.Image.Cache.imgPool.CheckOut();Spa.Dom.Event.Set(a,"onload",b);Spa.Dom.Event.Set(a,"onerror",g);f();return j};Spa.Dom.Image.Cache.imgPool=new Spa.Pool(function(){return document.createElement("img")},null);function Spa_InsertNodeAt(d,c,a){var b=c.childNodes.length;if(a<0||a>b)return;if(a<b){var e=c.childNodes[a];e.insertAdjacentElement("beforeBegin",d)}else if(a==b)if(b==0)c.appendChild(d);else{var e=c.childNodes[b-1];e.insertAdjacentElement("afterEnd",d)}}function Spa_IndexOfNode(c,b){for(var a=0;a<b.childNodes.length;a++)if(b.childNodes[a]==c)return a;return -1}function Spa_ElementButton(a,j,e,i){var u="progid:DXImageTransform.Microsoft.BasicImage(grayScale=1)",t="progid:DXImageTransform.Microsoft.Alpha(Opacity=50)",r="progid:DXImageTransform.Microsoft.Light(enabled=false)",s="progid:DXImageTransform.Microsoft.Light(enabled=false)";a.tabIndex=0;var b=i;this.element=a;var c=false;function g(){if(b)a.style.textDecoration="none";c=false}function f(){if(e&&b);}function h(){if(e&&b);}function q(){g()}function d(){if(b)if(j)j()}function n(){function a(){h();d()}f();window.setTimeout(a,1)}function k(){if(b)n()}function l(){if(b){a.style.textDecoration="underline";if(e);}c=true}function o(){c=true}function p(){c=false}function m(){if(b&&c)switch(event.keyCode){case 13:d()}}this.SetEnabled=function(c){b=c;a.disabled=!c;a.style.cursor=c?"hand":"default";if(!c)a.style.textDecoration="none"};Spa.Dom.Event.Set(a,"onclick",d);Spa.Dom.Event.Set(a,"ondblclick",k);Spa.Dom.Event.Set(a,"onmouseover",l);Spa.Dom.Event.Set(a,"onmouseout",g);Spa.Dom.Event.Set(a,"onmousedown",f);Spa.Dom.Event.Set(a,"onmouseup",h);Spa.Dom.Event.Set(a,"ondrag",q);Spa.Dom.Event.Set(a,"onfocus",o);Spa.Dom.Event.Set(a,"onblur",p);Spa.Dom.Event.Set(a,"onkeypress",m);this.SetEnabled(!!i)}Spa.Invoker=function(b){if(b){var a=arguments;b(a[1],a[2],a[3],a[4],a[5],a[6],a[7],a[8],a[9],a[10])}};Spa.SetTimeout=function(a,b){if(a)if(b<=0){a();return null}else return window.setTimeout(a,b)};Spa.Memory=function(){};Spa.Memory.Wrapper=function(a){this.obj=a};Spa.Memory.Wrapper.prototype.Delete=function(){delete this.obj};Spa.Memory.Dispose=function(a){if(a){if(a.constructor==Array)for(var b=a.length-1;b>=0;b--)delete a[b];else if(a.Dispose)a.Dispose();var c;for(c in a){a[c].Dispose();delete a[c]}}};Spa.Memory.CircularReference=function(){};Spa.Memory.CircularReference.iNextID=0;Spa.Memory.CircularReference.htPropertiesToUnload=[];Spa.Memory.CircularReference.Create=function(a,b,d){if(!a.__strRefUnloadID)a.__strRefUnloadID=Spa.Memory.CircularReference.iNextID++;var c=Spa.Memory.CircularReference.htPropertiesToUnload;if(!c[b])c[b]=[];c[b][a.__strRefUnloadID]=a;a[b]=d};Spa.Memory.CircularReference.ClearAll=function(){var a,d,c=Spa.Memory.CircularReference.htPropertiesToUnload,b;for(a in c){b=c[a];for(d in b)b[d][a]=null}if(window.detachEvent)window.detachEvent("onunload",Spa.Memory.CircularReference.ClearAll)};if(window.attachEvent)window.attachEvent("onunload",Spa.Memory.CircularReference.ClearAll);Spa.Dom.Event=function(){};Spa.Dom.Event.Set=Spa.Memory.CircularReference.Create;Spa.Event=function(a){this.obj=a;this.callbacks=[];this.iCount=0};Spa.Event.prototype.Attach=function(b){var a=this.iCount;this.iCount++;this.callbacks[a]=b;return a};Spa.Event.prototype.Detach=function(b){if(b!=null&&b!=void 0&&this.iCount>0){for(var a=b;a<this.iCount-1;a++)this.callbacks[a]=this.callbacks[a+1];this.callbacks[this.iCount-1]=null;delete this.callbacks[this.iCount-1];this.iCount--}};Spa.Event.prototype.Fire=function(b){for(var a=0;a<this.callbacks.length;a++)if(this.callbacks[a])this.callbacks[a](Spa.IsDefined(b)?b:this.obj)};Spa.Xml=function(){};Spa.Xml.LoadUrl=function(f,d){function c(){function e(b){Spa.Invoker(d,b);a.onreadystatechange=function(){};a.src="";var c=document.getElementById("bodyProxy");c.removeChild(a);Spa.Xml.LoadUrl.xmlNodePool.CheckIn(a)}function g(){if(a.XMLDocument.readyState==4)if(a.documentElement)e(a);else if(b<3){b++;window.setTimeout(c,1e3)}else e(null)}a.onreadystatechange=g;a.src=f}var b=1,a=Spa.Xml.LoadUrl.xmlNodePool.CheckOut(),e=document.getElementById("bodyProxy");e.appendChild(a);c()};Spa.Xml.LoadUrl.xmlNodePool=new Spa.Pool(function(){return document.createElement("xml")},null);Spa.Xml.SendRequest=function(e,b,d){function c(){if(a.readyState==4){a.onreadystatechange=function(){};Spa.Invoker(d,a);Spa.Xml.SendRequest.xmlhttpNodePool.CheckIn(a)}}var a=Spa.Xml.SendRequest.xmlhttpNodePool.CheckOut();a.open(b?"POST":"GET",e,true);a.onreadystatechange=c;a.send(b?b:null)};try{Spa.Xml.SendRequest.xmlhttpNodePool=new Spa.Pool(function(){return new ActiveXObject("Msxml2.XMLHTTP")},null)}catch(a){}Spa.Xml.GetNodeText=function(a){return a?a.text:""};Spa.Xml.IntAttribute=function(c,b){var a=c.getAttribute(b);return Spa.HasValue(a)?parseInt(a):null};Spa.Spaces=function(){};$Network.registerFpp("PhotosService",function(){var d=$Network.FppProxy,a=d.__string,c=d.__primitive,h=d.__array,e=d.__custom,f=d.__enum,g=d.__date,i=d.__object,j=d.__oArray,b=new $Network.FppProxy("PhotosService");b.rfc("PhotosSize",[c("width"),c("height")]);b.AvailableViews=new $Flags("Thumb",1,"Mobile",2,"Web",4,"Hires",8);b.rfc("ImageComment",[a("strID"),a("strAuthor"),a("strAuthorPuid"),a("strUrl"),a("strEmail"),g("dtPosted"),a("strFormattedDate"),a("strText"),c("showContactControl"),c("IsRestrictedByFss"),a("FssRestrictedAddCommentMessage")]);b.rfc("CommentsInfo",[a("PrevCommentHandle"),a("NextCommentHandle"),h("Comments"),c("CommentsCount")]);b.rfc("AlbumInfo",[a("strID"),a("strName"),c("iImageCount"),g("dtCreated"),a("strUrl"),e(b.PhotosSize,"sizeDimension")]);b.rfc("ImageView",[a("strUrl"),e(b.PhotosSize,"sizeDimension"),c("iSize")]);b.rfc("ImageInfo",[a("strID"),a("strCaption"),g("dtCreated"),h("aComments"),e(b.ImageView,"thumb"),e(b.ImageView,"web"),e(b.ImageView,"hires")]);b.rfc("OwnerInfo",[a("cid"),a("title"),a("alias")]);b.rfc("PhotoAlbum",[a("rescourceId"),a("title"),c("size")]);b.InviteReturnCodes=new $Flags("Success",0,"GenericError",1,"InputValidationError",2,"QuotaExceeded",3,"QuotaEmpty",4,"ABCHError_CanRetry",5,"ABCHError_NoRetry",6);b.rfc("InviteReturnData",[f("Code"),a("Detail"),a("DisplayMessage")]);b.rfc("ServerEventData",[a("Category"),a("Message")]);b.rfc("ServerTracingObject",[h("m_serverTraceCollection")]);b.FppStatus=new $Flags("SUCCESS",0,"ERR_HTTP_MISCONFIGURATION",-7,"ERR_HTTP_PARSE_FAILURE",-6,"ERR_HTTP_CONNECT_FAILURE",-5,"ERR_HTTP_TIMEOUT",-4,"ERR_SERVER_UNCAUGHT",-3,"ERR_APP_SPECIFIC",-2,"ERR_FPP_PROTOCOL",-1);b.rfc("FppError",[a("ErrorCode"),a("Message"),i("ErrorObj"),a("StackTrace")]);b.rfc("FppReturnPackage",[f("Status"),i("Value"),j("OutRefParams"),e(b.FppError,"Error"),i("ProfilingInfo")]);b.FppCommandType=new $Flags("FPP",0,"FPP_JSON",1,"FPP_RP",2,"FPP_RP_JSON",3);b.FppVersion=new $Flags("BASE",0,"ONE",1,"TWO",2,"CURRENT",2);b.rfc("FppProxySettings",[f("Version"),f("CommandType"),a("PartnerId"),a("SessionId"),a("AuthUser"),a("ServerTunnelingUrl"),c("UseClientXmlProxy"),a("CanaryToken"),c("DefaultRetry"),c("Notify"),f("DateType")]);b.FppDateType=new $Flags("Local",0,"UTC",1);b.rfm("getspaceinfo",[a("alias")],"getspaceinfo",$Network.Type.XMLPost,null,"Microsoft.Spaces.Web.Parts.PhotoAlbum.PhotosFpp");b.rfm("getalbums",[a("cid_string")],"getalbums",$Network.Type.XMLPost,null,"Microsoft.Spaces.Web.Parts.PhotoAlbum.PhotosFpp");b.rfm("getimageinfo0",[a("albumID"),c("startIndex"),c("endIndex"),a("dateLastModified")],"getimageinfo0",$Network.Type.XMLPost,null,"Microsoft.Spaces.Web.Parts.PhotoAlbum.PhotosFpp");b.rfm("getimageinfo1",[a("albumID"),c("startIndex"),c("endIndex"),a("dateLastModified"),a("strId")],"getimageinfo1",$Network.Type.XMLGet,null,"Microsoft.Spaces.Web.Parts.PhotoAlbum.PhotosFpp");b.rfm("getimageinfo",[a("albumID"),c("startIndex"),c("endIndex"),a("dateLastModified")],"getimageinfo",$Network.Type.XMLGet,null,"Microsoft.Spaces.Web.Parts.PhotoAlbum.PhotosFpp");b.seal();return b});registerNamespace("Spaces.RSSPart");Spaces.RSSPart.GetRssService=function(f,b){Spaces.RSSPart.GetRssService.initializeBase(this,arguments);var a=0;this.dispose=function(){Spaces.RSSPart.GetRssService.callBaseMethod(this,"dispose",arguments)};this.initialize=function(){Spaces.RSSPart.GetRssService.callBaseMethod(this,"initialize",arguments);var d={},f=$Network.getCookie(C_CANARY_COOKIE_NAME);if(f&&f!="")d[C_CANARY_COOKIE_NAME]=f;d["LiveProxy"]="true";d["Accept-Language"]=b.mkt;function h(a){e(a[0].resource,null)}var c=new $Request(b.proxyurl,$Network.Type.XML,null,null);c.setHeaders(d);c.setPostString(null);c.setGroup(null);c.setTimeout(15000);c.setObject(null);var g=new $Network(null,null,[c]);a=b.numitems;g.load(h)};function e(b){var a=f.rows[0].cells[0];if(b==null||b.responseXML==null)if(!a.firstChild.innerText)a.innerText=GetString("live.sndefaultstrings.strings.rsssettings.feedinvalid");else a.firstChild.innerText=GetString("live.sndefaultstrings.strings.rsssettings.feedinvalid");else{var c=Web.Rss.parse(b);d(c,a)}}function d(d,a){if(!d||d.channels.length<1)if(!a.firstChild.innerText)a.innerText=GetString("live.sndefaultstrings.strings.rsssettings.feedinvalid");else a.firstChild.innerText=GetString("live.sndefaultstrings.strings.rsssettings.feedinvalid");else{var f=d.channels[0],b=document.createElement("table");b.className="fixedTable rssViewTable";b.width="100%";var e=b.insertRow(b.rows.length);e.className="rssContentDelimeter";e.insertCell(0);c(b,f);a.replaceChild(b,a.firstChild);if(a.childNodes.length>1)a.removeChild(a.childNodes[1])}}function c(c,o){var f=o.items.length;if(f<1){var m=c.insertRow(c.rows.length),j=m.insertCell(0),e=document.createElement("div");e.innerText=GetString("live.sndefaultstrings.strings.rss.feed.noentry");j.appendChild(e);return}if(f>a)f=a;for(var i=0;i<f;i++){var d=o.items[i],r=c.insertRow(c.rows.length),q=r.insertCell(0),h=document.createElement("a");h.href=d.link;h.target="_blank";h.innerHTML=d.title;q.appendChild(h);var b,n,l,g;try{n=new Date-new Date(d.pubDate);l=8.64e7;g=Math.floor(n/l);if(!isFinite(g))d.pubDate=null}catch(s){d.pubDate=null}if(d.pubDate==null)b="{0}{2}{1}";else{b=GetString("live.sndefaultstrings.strings.rss.footer.titledaysago");if(g==0)b=GetString("live.sndefaultstrings.strings.rss.footer.today");else if(g==1)b=GetString("live.sndefaultstrings.strings.rss.footer.yesterday");else b=b.replace("{3}",g)}if(d.source!=undefined&&d.source.title!=undefined&&d.source.title.trim()!="")b=b.format("","",d.source.title);else b="";var m=c.insertRow(c.rows.length),j=m.insertCell(0);j.className="ellipse";if(b!=""){var e=document.createElement("div");e.className="ellipse graytitle";e.innerText=b;j.appendChild(e)}if(i<f-1){var k=c.insertRow(c.rows.length);k.className="rssContentDelimeter";k.insertCell(0);var p=c.insertRow(c.rows.length);p.className="line";p.insertCell(0)}}}return this};Spaces.RSSPart.GetRssService.registerClass("Spaces.RSSPart.GetRssService","$Binding");Spaces.RSSPart.GetRssService.Params=new $Enum("proxyurl");Spaces.RSSPart.GetRssService.Params=new $Enum("mkt");Spaces.RSSPart.GetRssService.Params=new $Enum("numitems");Spaces.RSSPart.GetRssService.skipClass=true;function OpenPendingRequest(a){window.open(a,null,"menubar=no,height=572,width=766,status=no,toolbar=no,titlebar=no,resizeable=no,location=no,scrollbars=no")}registerNamespace("Spaces");Spaces.FriendsPartBinding=function(f){Spaces.FriendsPartBinding.initializeBase(this,arguments);var a=new $Memory.Groups,b=false;this.initialize=function(){Spaces.FriendsPartBinding.callBaseMethod(this,"initialize",arguments);this.registerFor("Spaces.LayoutManager",d)};this.dispose=function(b){if(a){a.dispose(b);a=null}Spaces.FriendsPartBinding.callBaseMethod(this,"dispose",arguments)};function d(b,d){if(!!b)if(d){a.create(null).Events.register(b,{onlayoutchange:e});a.create(null).Events.register(b,{onpartdragdrop:c})}}function e(){b=true;c()}function c(){if(!b)return;var a=f.getElementsByTagName("view");if(a[1].className.indexOf("viewActive")==-1){a[0].className=a[0].className.removeSpaceDelimitedString("viewActive");a[1].className+=" viewActive"}}};Spaces.FriendsPartBinding.registerClass("Spaces.FriendsPartBinding","$Binding");Spaces.FriendsPartBinding.skipClass=true;registerNamespace("Spaces.Photos");Spaces.Photos.Strings=Spaces.Strings;__Spaces_Photos_Strings=Spaces.Strings