/* Copyright (C) 2009 Microsoft Corporation */$Network.registerFpp("GadgetsFpp",function(){var c=$Network.FppProxy,a=c.__string,e=c.__primitive,h=c.__array,i=c.__custom,d=c.__enum,j=c.__date,f=c.__object,g=c.__oArray,b=new $Network.FppProxy("GadgetsFpp");b.InviteReturnCodes=new $Flags("Success",0,"GenericError",1,"InputValidationError",2,"QuotaExceeded",3,"QuotaEmpty",4,"ABCHError_CanRetry",5,"ABCHError_NoRetry",6);b.rfc("InviteReturnData",[d("Code"),a("Detail"),a("DisplayMessage")]);b.rfc("ServerEventData",[a("Category"),a("Message")]);b.rfc("ServerTracingObject",[h("m_serverTraceCollection")]);b.FppStatus=new $Flags("SUCCESS",0,"ERR_HTTP_MISCONFIGURATION",-7,"ERR_HTTP_PARSE_FAILURE",-6,"ERR_HTTP_CONNECT_FAILURE",-5,"ERR_HTTP_TIMEOUT",-4,"ERR_SERVER_UNCAUGHT",-3,"ERR_APP_SPECIFIC",-2,"ERR_FPP_PROTOCOL",-1);b.rfc("FppError",[a("ErrorCode"),a("Message"),f("ErrorObj"),a("StackTrace")]);b.rfc("FppReturnPackage",[d("Status"),f("Value"),g("OutRefParams"),i(b.FppError,"Error"),f("ProfilingInfo")]);b.FppCommandType=new $Flags("FPP",0,"FPP_JSON",1,"FPP_RP",2,"FPP_RP_JSON",3);b.FppVersion=new $Flags("BASE",0,"ONE",1,"TWO",2,"CURRENT",2);b.rfc("FppProxySettings",[d("Version"),d("CommandType"),a("PartnerId"),a("SessionId"),a("AuthUser"),a("ServerTunnelingUrl"),e("UseClientXmlProxy"),a("CanaryToken"),e("DefaultRetry"),e("Notify"),d("DateType")]);b.FppDateType=new $Flags("Local",0,"UTC",1);b.rfm("SetPreference",[a("id"),a("serializedData")],"SetPreference",$Network.Type.XMLPost,null,"Microsoft.Spaces.Web.Part.GadgetsFpp");b.rfm("SetVisitorHeight",[a("id"),e("height")],"SetVisitorHeight",$Network.Type.XMLPost,null,"Microsoft.Spaces.Web.Part.GadgetsFpp");b.rfm("SetPreferenceWithAuthToken",[a("id"),a("authToken"),a("spaceCid"),a("userCid"),a("serializedData")],"SetPreferenceWithAuthToken",$Network.Type.XMLPost,null,"Microsoft.Spaces.Web.Part.GadgetsFpp");b.rfm("SetGadgetApproved",[a("id")],"SetGadgetApproved",$Network.Type.XMLPost,null,"Microsoft.Spaces.Web.Part.GadgetsFpp");b.seal();return b});var GadgetVersion="0.030706.1";registerNamespace("Web.Settings.GadgetHost");Web.Settings.GadgetHost.rememberPreference=Web.Settings.GadgetHost.rememberPreference||false;Web.Settings.GadgetHost.supportThirdParty=Web.Settings.GadgetHost.supportThirdParty||true;Web.Settings.GadgetHost.isolateThirdParty=Web.Settings.GadgetHost.isolateThirdParty||true;Web.Gadget=new function(){this.version="1.0";var k=this,c={},n=null,a=new $Enum("Standard","Custom","Insecure","Security"),d=0,h=[];this.onhostgadget=new $Event;this.onrequestmanifest=new $Event;this.onbindmanifest=new $Event;this.onisolategadget=new $Event;this.ondefaultrss=new $Event;this.ReadyState=new $Enum("manifestloading","manifestcomplete","securing","isolating","gadgetloading","gadgetcomplete","error","gadgetcancel");this.ErrorState=new $Enum("none","filemissing","parseerror","rssfeed","noplatform","noclassname","badparameters","thirdpartydisabled");this.Mode=new $Enum("author","view");this.Type={External:0,Internal:1};this.ManifestType={Gadget:0,RSSGadget:1,RSSFeed:2,Module:3};function o(){var a={},b=document.location.search.substring(1);function c(c){var b=c.split("=");if(b[0])a[b[0].toLowerCase()]=unescape(b[1])}if(b)var d=b.split("&").forEach(c);return a}var f=o(),j=n==document.location.protocol+"//"+document.location.host+document.location.pathname&&f["m"],g=function(d,n){g.initializeBase(this,arguments);var s=n.gadgethosturl,h=n.manifest,y=h.url,B=n.params,P=n.view,r=n.callback,C=n.secure,u=null,v=n.noisolation,o={returnValue:false,manifest:h,params:B,url:h.url,error:Web.Gadget.ErrorState.none},F=[],G=[],D=[],t=h.rssFeed||{};for(var H in B)t[H]=B[H];var x="",w=null,l=null,i=null;function L(a){return a==""||a=="optional"||a=="shared"}function E(e,a){v=v&&L(a.isolation);for(var c in a.defaults)if(!t.defaults[c])t.defaults[c]=new String(a.defaults[c]||"");else t.defaults[c][x]=a.defaults[c];for(var b in a.references)switch(a.references[b].type){case "text/css":F.queue(b);break;case "text/xml":var d=(new $Request(b,$Network.Type.XML)).setName(a.references[b].name);G.queue(d);break;case "text/script":D.push(b)}}function K(a){if(a)for(var b=0;b<a.length;b++){var c=Web.Gadget.Manifest.getType(a[b],"live");if(c)E(a[b],c)}}function M(a){o.binding=a;q(Web.Gadget.ReadyState.gadgetcomplete,o)}function I(){if(l)$Binding.remove(l);p();d.innerHTML="";l=document.createElement("div");d.appendChild(l);e(r,Web.Gadget.ReadyState.gadgetloading,o);var a=$Network;$Binding.load(M,$Binding.define(x).setDefaults(t).bindTo(l),(new a).add(a.Type.Script,D).add(a.Type.CSS,F).add(a.Type.XML,G))}function J(){return;if(!f.host||!f.host.endsWith("live.com")){i=document.createElement("A");var a=document.createElement("img");a.align="left";i.className="Web_Gadgets_Live";i.style.display=a.style.display="block";i.href=Web.Gadget.Strings.getString("AddLiveUrl");i.title=Web.Gadget.Strings.getString("AddLiveTooltip");a.src=Web.Gadget.Strings.getString("AddLiveImage");a.width="80";a.height="25";a.border="0";i.appendChild(a);i.onclick=function(){alert("This will add the module to live.com");return false}}}function q(b){if(b==Web.Gadget.ReadyState.gadgetcomplete){J();if(i&&d){var a=document.createElement("div");a.appendChild(i);a.style.clear="both";d.appendChild(a)}elButton=null}if(r)r(b,o)}var z=new function(){var m=C?a.Standard:c[y]||a.Insecure,K=this,B=h.manifestType===Web.Gadget.ManifestType.RSSGadget,g,i,r,e,I=false,x=false,w=[],b=null;function D(f){q(Web.Gadget.ReadyState.isolating,o);p();d.innerHTML="";var c={returnValue:s};k.onisolategadget.fire(c);if(c.returnValue&&c.returnValue!=s)s=c.returnValue;b=document.createElement("iframe");b.id="g"+Math.random();b.scrolling=$Browser.isMozilla()||$Browser.isSafari()?"yes":"no";b.frameBorder="0";b.allowTransparency="true";b.style.background="transparent";b.style.width="100%";if(n.params.height&&n.params.height!="")b.style.height=n.params.height.toString()+"px";else b.style.height="250px";b.style.maxHeight="1000px";b.style.maxWidth=d.scrollWidth.toString()+"px";var e=s.indexOf("?")>=0?"&":"?";b.src=s+e+"m="+h.url+"&view="+(f||a.Insecure)+"&host="+escape(document.location.host)+"&mkt="+$Config.culture;b.onresize=M;d.style.width=d.scrollWidth.toString()-2+"px";d.appendChild(b);w.push(b)}function M(){if(b.style.width!="100%")b.style.width="100%"}function L(){c[y]=a.Standard;K.initialize()}function G(){if(e)e=e.onclick=null;if(g)g=g.onclick=null;if(r)r=r.onclick=null;if(i)i=i.onclick=null;if(b)b.onresize=null}function t(){E();c[y]=a.Standard;if(!e){e=document.createElement("DIV");e.className="Web_Gadgets_RSSMode";d.insertAdjacentElement("beforeEnd",e)}if(m==a.Standard)e.innerHTML=Web.Gadget.Strings.getString("CustomExperience");else e.innerHTML=Web.Gadget.Strings.getString("StandardExperience");e.onclick=N}function E(){if(e){e.onclick=null;e.removeNode(true);e=null}}function J(){p();d.innerHTML="";k.ondefaultrss.fire({srcElement:d})}function N(){if(m==a.Custom){m=a.Standard;J();t()}else if(!I){m=a.Security;F()}else H()}function H(){I=true;G();m=a.Custom;p();d.innerHTML="";if(!x)D(a.Standard);else L(a.Standard);if(B)t()}function F(){p();var f=document.createElement("div");g=document.createElement("input");if(e){e.onclick=null;e.removeNode(true);e=null}var b=y.replace("<","&lt;"),c=d.offsetWidth/7;if(b.length>c){var n=b.slice(0,c);for(var l=c;l<b.length;l+=c){n+="<br/>";n+=b.slice(l,l+c)}b=n}if(B){f.innerHTML="<P><span class='Gadget_Manager_Warning'>"+Web.Gadget.Strings.getString("TrustedGadget01")+"</span><P>"+Web.Gadget.Strings.getString("TrustedGadgetRss01")+" <EM><div style='width:100%;overflow:hidden'>"+b+"</div></EM> "+Web.Gadget.Strings.getString("TrustedGadgetRss02")+" <P class='Gadget_Manager_Desc'>"+"<P>"+Web.Gadget.Strings.getString("TrustedGadgetRss03");var k=$Dom.Css.getElementsByCssSelector(".Gadget_Manager_Desc",f);if(k.length==1)k[0].innerText=h.description||Web.Gadget.Strings.getString("TrustedGadgetNoDesc");g.value=Web.Gadget.Strings.getString("TrustedGadgetStd")}else{f.innerHTML="<P><span class='Gadget_Manager_Warning'>"+Web.Gadget.Strings.getString("TrustedGadget01")+"</span><P>"+Web.Gadget.Strings.getString("TrustedGadget02")+" <EM><div style='width:100%;overflow:hidden'>"+b+"</div></EM>"+Web.Gadget.Strings.getString("TrustedGadget03")+" <P class='Gadget_Manager_Desc'>"+"<P>"+Web.Gadget.Strings.getString("TrustedGadget04");var k=$Dom.Css.getElementsByCssSelector(".Gadget_Manager_Desc",f);if(k.length==1)k[0].innerText=h.description||Web.Gadget.Strings.getString("TrustedGadgetNoDesc");g.value=Web.Gadget.Strings.getString("TrustedGadgetRemove");g.style.marginTop="5px";g.style.marginBottom="5px"}g.onclick=function(){if(B){m=a.Standard;J();t()}else{p();d.innerHTML="";K.dispose();q(Web.Gadget.ReadyState.gadgetcancel)}};i=document.createElement("input");i.style.marginTop="5px";i.style.marginBottom="5px";i.value=Web.Gadget.Strings.getString("TrustedGadgetInstall");i.type=g.type="button";var j;i.onclick=function(){H()};d.innerHTML="";d.appendChild(f);d.appendChild(i);d.appendChild(g);if(Web.Settings.GadgetHost.rememberPreference){j=document.createElement("div");r=document.createElement("input");r.type="checkbox";var o=document.createElement("span");o.innerText=" "+Web.Gadget.Strings.getString("TrustedGadgetRemember");j.appendChild(r);j.appendChild(o);d.appendChild(j)}}function z(b){x=b;switch(m){case a.Standard:D();break;case a.Insecure:F()}if(x&&self!=top)A()}this.initialize=function(){q(Web.Gadget.ReadyState.securing);if(l)$Binding.remove(l);if((C||c[h.url])&&(v||j))u(d,h,q);else if(C&&(!v||!j)){c[h.url]=a.Standard;z(false)}else if(j){c[h.url]=f.view;if(f.view==a.Standard)u(d,h,q);else z(true)}else z(false)};this.dispose=function(){G();E();for(var a=0;a<w.length;a++)w[a].onresize=null;b=null}};this.initialize=function(){g.callBaseMethod(this,"initialize",arguments);if(h.manifestType==Web.Gadget.ManifestType.Module){u=m.attachElementManifest;z.initialize()}else{u=I;if(!h)b(r,Web.Gadget.ErrorState.badparameters,o);w=Web.Gadget.Manifest.getType(h,"live");if(!w)b(r,Web.Gadget.ErrorState.noplatform,o);x=w.className;if(!x)b(r,Web.Gadget.ErrorState.noclassname,o);E(h,w);K(h.inheritsFrom);z.initialize();if(self.location!=top.location&&!$Browser.isSafari()&&!$Browser.isMozilla())window.attachEvent("onresize",A)}};function A(){if(self.location!=top.location&&!$Browser.isSafari()&&!$Browser.isMozilla())try{if(document.documentElement&&document.documentElement.scrollWidth&&document.documentElement.scrollHeight&&document.documentElement.scrollHeight>=25)window.resizeTo(document.documentElement.scrollWidth,Math.max(l.scrollHeight,document.documentElement.scrollHeight));else if(document.body.scrollWidth&&document.body.scrollHeight&&document.body.scrollHeight>=25)window.resizeTo(document.body.scrollWidth,Math.max(l.scrollHeight,document.body.scrollHeight))}catch(a){}}function p(){z.dispose();if(i)i=i.onclick=null}this.dispose=function(){g.callBaseMethod(this,"dispose",arguments);if(l)$Binding.remove(l);p();if(self.location!=top.location&&!$Browser.isSafari()&&!$Browser.isMozilla())window.detachEvent("onresize",A);u=null}};g.registerSealedClass(null,"$Binding");this.getViewState=function(a){return c[a]};function b(c,b,a){a.error=b;e(c,Web.Gadget.ReadyState.error,a)}function e(a,b,c){if(a)a(b,c)}this.loadManifest=function(l,i,c){var a={returnValue:false,manifest:null,params:i,url:l,error:Web.Gadget.ErrorState.none},d=null,h={},j=0,f={};function n(s,r){var o=s[0].resource;delete h[r.url];var p=Web.Utility.getDocumentRoot(o),k=null,i=null,n=null;if(o.status!=200||!p){b(c,Web.Gadget.ErrorState.filemissing,a);g();return}switch(p.tagName){case "rss":k=Web.Rss.parse(p,true);if(k.channels.length==0||k.channels[0].items.length==0){b(c,Web.Gadget.ErrorState.parseerror,a);g();return}if(!Web.Rss.isManifest(k)){f.feed=k;f.xml=o;if(Web.Rss.isRSSWithManifest(k)){j--;m(k.channels[0].binding.manifest)}else{d=k;d.manifestType=Web.Gadget.ManifestType.RSSFeed;a.manifest=d;b(c,Web.Gadget.ErrorState.rssfeed,a);g()}return}else{i=Web.Rss.convertToManifest(k,l);if(f.feed)i.manifestType=Web.Gadget.ManifestType.RSSGadget}break;case "Module":case "gadget":i=Web.Gadget.Manifest.parse(p,l,true);break;default:b(c,Web.Gadget.ErrorState.parseerror,a);g();return}if(!i){b(c,Web.Gadget.ErrorState.noplatform,a);return}if(!f.xml)f.xml=o;if(i.manifestType!=Web.Gadget.ManifestType.Module){n=Web.Gadget.Manifest.getType(i,"live");if(!n){b(c,Web.Gadget.ErrorState.noplatform,a);return}if(!d){d=i;d.rssFeed=f}else d.inheritsFrom.push(i);if(n&&n.references)for(var q in n.references)if(n.references[q].type=="text/gadget")m(q);j--;if(j==0){a.manifest=d;e(c,Web.Gadget.ReadyState.manifestcomplete,a);g()}}else{a.manifest=i;e(c,Web.Gadget.ReadyState.manifestcomplete,a)}}function m(d){d=$Request.resolveUrl(d);if(!h[d]){j++;if(!i)i={};i.url=d;if(!Web.Settings.GadgetHost.supportThirdParty&&$Request.extractHost(d)!=document.location.host)b(c,Web.Gadget.ErrorState.thirdpartydisabled,a);else{var f=$Network,k=$Request,e=i,g=new f(null,e,[new k(d,f.Type.XML,null,e)]);g.load(n);h[d]=g}}}function g(){for(var a in h){try{h[a].abort()}catch(b){}h[a]=null}}function o(){k.onrequestmanifest.fire(a);if(!a.returnValue){e(c,Web.Gadget.ReadyState.manifestloading,a);m(l)}else{objManifest=a.manifest;setTimeout(e,1)}$Runtime.onunload.attach(g)}o()};var i=new RegExp("<script","i"),l=new RegExp("</sc"+"ript>","i");this.loadNext=function(e,d,c){if(e.readyState=="complete"){var b=false,a=h[c].dequeue();while(a!=null){i.lastIndex=0;if(!b){a=a.replace(i,"<script onreadystatechange='parent.Web.Gadget.loadNext(this,window,"+c+")' ");if(i.lastIndex>0)b=true}d.document.writeln(a);if(b)if(a.match(l))return;a=h[c].dequeue()}d.document.close()}};var m=new function(){function c(a,b,c){var d="__UP_"+a+"__",e=new RegExp(d,"g");return b.replace(e,c)}function f(c){var f=null,b=new $StringBuilder,i=false;b.append("<table>");for(var a in c.UserPref){i=true;b.append('<tr><td class="Module_Setting_Label">');b.append('<label for="{0}{1}">'.format(a,d)+c.UserPref[a]+":</label></td><td>");switch(c.UserPref[a].datatype){case "bool":b.append('<input id="{0}{2}" name="{0}" type="checkbox" {1}>'.format(a,c.UserPref[a].defaultValue=="true"?"checked":"",d));break;case "enum":b.append('<select id="{0}{1}" name="{0}">'.format(a,d));for(var h in c.UserPref[a].enumList)b.append('<option value="{0}" {1}>{2}</option>'.format(c.UserPref[a].enumList[h],c.UserPref[a].enumList[h]==c.UserPref[a].defaultValue?"selected":"",h));b.append("</select>");break;default:b.append('<input id="{0}{3}" name="{0}" value="{1}" class="{2}">'.format(a,c.UserPref[a].defaultValue,"Module_Setting"+(c.UserPref[a].required?"_Required":""),d))}b.append("</td></tr>")}b.append("</table>");b.append('<input type="submit" value="Save">');if(i){var e=document.createElement("a");e.innerText="Edit";e.className="Module_Setting_Edit";e.href="#";e.onclick=function(){e.form.style.display=e.form.style.display==""?"none":"";return false};var g=document.createElement("form");g.className="Module_Setting_Form";g.innerHTML=b;f=document.createElement("div");f.className="Module_Setting_Container";f.appendChild(e);f.style.textAlign="right";f.appendChild(g);g.style.textAlign="left";e.form=f.form=g}return f}function g(a){return a.replace(/</g,"&lt;").replace(/>/g,"&gt;")}function a(i,a){if(a.Content.url){var j=a.Content.url;for(var e in a.UserPref)j=c(e,j,escape(a.UserPref[e].defaultValue));var l=j.indexOf("?")>-1,k=j+(l?"&":"?")+"w="+i.offsetWidth+"&h="+i.offsetHeight;for(var e in a.UserPref)k+="&"+a.UserPref[e].urlparam+"="+escape(a.UserPref[e].defaultValue);i.src=k}else{var b=i.contentWindow.document,f=a.Content.html;b.open("text/html");b.writeln("<html><head><style>body {margin:0px;padding:0px}</style>");b.writeln('<base href="{0}" target="_blank">'.format($Request.extractHost(a.url,true)));b.writeln("<script>");b.writeln("var __MODULE_ID__=0;");b.writeln("var __prefs = new function() {");for(var e in a.UserPref)if(a.UserPref[e].datatype=="bool")b.writeln("this['"+e+"'] = "+(a.UserPref[e].defaultValue=="true"?'"true"':null)+";");else{b.writeln("this['"+e+"'] = \""+escape(a.UserPref[e].defaultValue)+'";');f=c(e,f,g(a.UserPref[e].defaultValue))}b.writeln("}");b.writeln("</"+"script>");if($Browser.isIE()){h[d]=f.split("\n");b.writeln('<script onreadystatechange="parent.Web.Gadget.loadNext(this,window,'+d+")\" type='text/javascript' src='http://scottidemo/smoketest/igLibrary.js'></"+"script>");d++}else{b.writeln("<script type='text/javascript' src='http://scottidemo/smoketest/igLibrary.js'></"+"script>");b.writeln(f);b.close()}}}function b(a){var b=true;for(var c in a.UserPref)b=b&&(!a.UserPref[c].required||a.UserPref[c].defaultValue);return b}this.attachElementManifest=function(j,c,k){var l={returnValue:false,manifest:c,params:null,url:c.url,error:Web.Gadget.ErrorState.none};if(c.ModulePref.render_inline=="required"){j.innerText=Web.Gadget.Strings.getString("ModuleUnsupported");return}var h=document.createElement("div");j.appendChild(h);var d=f(c);if(d)h.appendChild(d);var g=document.createElement("iframe");frame.id="g"+Math.random();g.height=c.ModulePref.height||"400px";g.frameBorder=0;g.style.clear="both";g.scrolling="no";var i=b(c);if(!i){g.style.display="none";d.form.style.display=""}else if(d&&d.form)d.form.style.display="none";h.appendChild(g);if(i)a(g,c);if(d&&d.form)d.form.onsubmit=function(){var e=d.form;for(var f=0;f<e.length;f++){var h=e[f].name;if(c.UserPref[h])if(e[f].type=="select")c.UserPref[h].defaultValue=e[f][e[f].selectedIndex].value;else if(e[f].type=="checkbox")c.UserPref[h].defaultValue=e[f].checked?"true":"false";else c.UserPref[h].defaultValue=e[f].value}if(b(c)){g.style.display="";e.style.display="none";a(g,c)}return false};e(k,Web.Gadget.ReadyState.gadgetcomplete,l)}};this.attachElementManifest=function(j,i,c,e,h,f,d,a){var k=this;function b(i,b){if(a)a(i,b);if(i=Web.Gadget.ReadyState.manifestcomplete&&b.manifest)Start.Util.AttachElementBindingSync(j,g,null,{manifest:b.manifest,gadgethosturl:c,params:e,view:h,secure:f,noisolation:d,callback:a})}this.loadManifest(i,null,b)}};Web.Gadget.Actions=new $Enum("Add","Settings");Web.Strings=function(){this.markets={};this.getString=function(b,c){var a=this.markets[$Config.culture]&&this.markets[$Config.culture][b]||this.markets["en-US"]&&this.markets["en-US"][b]||b+": Missing String";if(c)a=a.format.apply(a,arguments);return a}};Web.Strings.registerClass("Web.Strings");Web.Gadget.Strings=new function(){function a(){a.initializeBase(this,arguments);this.markets["en-US"]={CustomExperience:"Switch to Custom Experience",StandardExperience:"Switch to Standard Experience",TrustedGadget01:"<b>Only install Gadgets from trusted sites.</b>",TrustedGadget02:"This a custom Gadget from",TrustedGadget03:"Below is a description of the Gadget:",TrustedGadgetNoDesc:"No Description",TrustedGadget04:"This 3rd party gadget has not been reviewed.  It could potentially access data in another 3rd party gadget, include code that is possibly unsafe and may change behavior at any time. <b>Do you trust this site and want to install this Gadget?</b>",TrustedGadgetRss01:"This RSS feed loaded from",TrustedGadgetRss02:"wants to load a custom gadget. The Gadget presents a customized experience for this feed. Below is a description of the feed:",TrustedGadgetRss03:"This 3rd party gadget has not been reviewed.  It could potentially access data in another 3rd party gadget, include code that is possibly unsafe and may change behavior at any time. <b>Do you trust this site and want to install this Gadget?</b>",TrustedGadgetRemove:"Remove",TrustedGadgetStd:"Standard View",TrustedGadgetInstall:"Install Gadget",TrustedGadgetRemember:"Remember my preference",Loading:"Loading...",Error:"Unable to retrieve data, please try again.",UnableToLoadFeed:"Oops, we seem to be having a problem with this feed.  Please try again later.",AddLiveImage:"http://scottidemo/smoketest/wl.gif",AddLiveUrl:"#TBD",AddLiveTooltip:"Add this gadget to Live.com",ModuleUnsupported:"Modules that require inlining are not supported"};this.markets[$Config.culture]={TrustedGadget01:GetString("live.sndefaultstrings.strings.gadget.framework.TrustedGadget01"),TrustedGadget02:GetString("live.sndefaultstrings.strings.gadget.framework.TrustedGadget02"),TrustedGadget03:GetString("live.sndefaultstrings.strings.gadget.framework.TrustedGadget03"),TrustedGadgetNoDesc:GetString("live.sndefaultstrings.strings.gadget.framework.TrustedGadgetNoDesc"),TrustedGadget04:GetString("live.sndefaultstrings.strings.gadget.framework.TrustedGadget04"),TrustedGadgetRss01:GetString("live.sndefaultstrings.strings.gadget.framework.TrustedGadgetRss01"),TrustedGadgetRss02:GetString("live.sndefaultstrings.strings.gadget.framework.TrustedGadgetRss02"),TrustedGadgetRss03:GetString("live.sndefaultstrings.strings.gadget.framework.TrustedGadgetRss03"),TrustedGadgetRemove:GetString("live.sndefaultstrings.strings.gadget.framework.TrustedGadgetRemove"),TrustedGadgetStd:GetString("live.sndefaultstrings.strings.gadget.framework.TrustedGadgetStd"),TrustedGadgetInstall:GetString("live.sndefaultstrings.strings.gadget.framework.TrustedGadgetInstall"),TrustedGadgetRemember:GetString("live.sndefaultstrings.strings.gadget.framework.TrustedGadgetRemember"),Loading:GetString("live.sndefaultstrings.strings.gadget.framework.loading"),Error:GetString("live.sndefaultstrings.strings.gadget.framework.error"),UnableToLoadFeed:GetString("live.sndefaultstrings.strings.gadget.framework.UnableToLoadFeed"),ModuleUnsupported:GetString("live.sndefaultstrings.strings.gadget.framework.ModuleUnsupported")}}a.registerSealedClass(null,"Web.Strings");return new a};registerNamespace("Web.Parser");Web.Parser.getTextProperty=function(a){if(a.text=="")return "";else return a.text||a.textContent};registerNamespace("Web.Gadget.Manifest");Web.Gadget.Manifest.parse=function(c,d,g){var b=g?c:Web.Utility.getDocumentRoot(c),a={};a.url=d;function e(){a.manifestType=Web.Gadget.ManifestType.Gadget;var r=b.childNodes.length;for(var m=0;m<r;m++){var c=b.childNodes[m];switch(c.tagName){case "name":case "link":case "description":a[c.tagName]=new String(Web.Parser.getTextProperty(c)||"");a[c.tagName].resourceID=c.getAttribute("resourceID");break;case "docs":case "version":case "email":case "pubDate":case "lastBuildDate":a[c.tagName]=Web.Parser.getTextProperty(c);break;case "icons":a.icons={};for(var e=0;e<nj.childNodes.length;e++){var h=nj.childNodes[e];a.icons[h.nodeName]=new String(Web.Utility.getTextProperty(h));a.icons[h.nodeName].width=h.getAttribute("width");a.icons[h.nodeName].height=h.getAttribute("height")}break;case "type":a.types={};var q=c.getAttribute("platform");if(q){var g=a.types[q.toLowerCase()]={};g=g[c.getAttribute("version")||".1"]={};g.defaults={};for(var n=0;n<c.childNodes.length;n++){var f=c.childNodes[n],o=f.childNodes.length,p=g[f.tagName]={};switch(f.tagName){case "references":g.className=f.getAttribute("class");g.isolation=(f.getAttribute("isolation")||"").toLowerCase();case "services":for(var e=0;e<o;e++){var i=f.childNodes[e];if(i.tagName=="add"){var j=i.getAttribute("src");if(j){j=$Request.resolveUrl(j,d);var l=p[j]={};if(f.tagName=="references")l.type=i.getAttribute("type")||"text/script";else l.acl=i.getAttribute("acl");l.name=i.getAttribute("name")}}}break;case "defaults":for(var e=0;e<o;e++){var k=f.childNodes[e];if(k.tagName=="param")p[k.getAttribute("name")]=k.getAttribute("value")}}}}}}}function f(){a.manifestType=Web.Gadget.ManifestType.Module;a.UserPref={};a.ModulePref={};a.Content={};for(var g=0;g<b.childNodes.length;g++){var c=b.childNodes[g];switch(c.tagName){case "ModulePrefs":for(var e=0;e<c.attributes.length;e++)a.ModulePref[c.attributes[e].nodeName]=c.attributes[e].nodeValue;a.description=a.ModulePref.description;a.name=a.ModulePref.directory_title||a.ModulePref.title;a.link=a.ModulePref.title_url;break;case "UserPref":var d=c.getAttribute("name");if(d){a.UserPref[d]=new String(c.getAttribute("display_name")||d);a.UserPref[d].defaultValue=c.getAttribute("default_value")||"";a.UserPref[d].required=c.getAttribute("required")=="true"||false;a.UserPref[d].datatype=c.getAttribute("datatype")||"";a.UserPref[d].urlparam=c.getAttribute("urlparam")||"up_"+d;if(a.UserPref[d].datatype=="enum"){var h=a.UserPref[d].enumList={};for(var e=0;e<c.childNodes.length;e++)h[c.childNodes[e].getAttribute("display_value")||c.childNodes[e].getAttribute("value")]=c.childNodes[e].getAttribute("value")||c.childNodes[e].getAttribute("display_value")}}break;case "Content":var f=c.getAttribute("type");if(f=="url")a.Content[f]=c.getAttribute("href");else a.Content[f]=Web.Utility.getTextProperty(c)}}}switch(b.tagName){case "gadget":e();break;case "Module":f()}return a};Web.Gadget.Manifest.getType=function(a,c){var e=null,d=-1;if(a&&a.types[c])for(var b in a.types[c])if(parseFloat(b)>d&&parseFloat(b)<=Web.Gadget.version){e=a.types[c][b];d=b}return e};registerNamespace("Web.Rss");Web.Rss.isManifest=function(a){return a&&a.channels[0].binding.type!=null};Web.Rss.isRSSWithManifest=function(a){return a&&a.channels[0].binding.manifest!=null};Web.Rss.convertToManifest=function(j,g){var a=null,b=j.channels[0];if(b){a={};a.url=g;var f=["link","description","pubDate","lastBuildDate","docs"],h=["name","description","pubDate","lastBuildDate","docs"];for(var c=0;c<f.length;c++)if(b[f[c]]){a[h[c]]=new String(b[f[c]]||"");a[h[c]].resourceID=b[f[c]].resourceID}a.image=b.image;if(a.image)for(var i in b.image)a.image[i]=b.image[i];a.types={};a.types.live={};a.types.live[".1"]={};a.types.live[".1"].defaults={};a.types.live[".1"].className=b.binding.type;a.types.live[".1"].isolation=b.binding.renderInline?"optional":"";var e=a.types.live[".1"].references={};for(var c=0;c<b.items.length;c++){m_strSources=b.items[c].link;if(m_strSources){var d=$Request.resolveUrl(m_strSources,g);e[d]={};e[d].name=m_strSources.name;if(d)switch(m_strSources.type){case "css":e[d].type="text/css";break;case "xml":e[d].type="text/xml";break;case "inherit":e[d].type="text/gadget";break;default:e[d].type="text/script"}}}}return a};Web.Rss.parse=function(n,p){var i=p?n:Web.Utility.getDocumentRoot(n),g=null;if(i){g={};g.channels=[];for(var k=0;k<i.childNodes.length;k++){var h=i.childNodes[k];if(h.nodeName=="channel"){var d={};d.items=[];d.binding={};g.channels.push(d);var m={},r={},q=false,s=[],j=h.attributes;for(var e=0;e<j.length;e++)m[j[e].nodeName]=j[e].nodeValue;d.attribs=m;for(var e=0;e<h.childNodes.length;e++){var c=h.childNodes[e];switch(c.nodeName){case "title":case "link":d[c.nodeName]=new String(Web.Utility.getTextProperty(c)||"");d[c.nodeName].resourceID=c.getAttribute("resourceID");break;case "class":case "binding:type":d.binding.type=Web.Utility.getTextProperty(c);break;case "binding:options":if(c.getAttribute("renderInline").toLowerCase()=="true")d.binding.renderInline=true;break;case "binding:manifest":d.binding.manifest=Web.Utility.getTextProperty(c);break;case "image":d.image={};for(var f=0;f<c.childNodes.length;f++){var b=c.childNodes[f];d.image[b.nodeName]=Web.Utility.getTextProperty(b)}break;case "item":var a={};for(var f=0;f<c.childNodes.length;f++){var b=c.childNodes[f];switch(b.nodeName){case "title":case "description":case "pubDate":case "guid":a[b.nodeName]=Web.Utility.getTextProperty(b);break;case "feedburner:origLink":case "link":a.link=new String(Web.Utility.getTextProperty(b)||"");a.link.type=b.getAttribute("binding:type")||b.getAttribute("type");a.link.name=b.getAttribute("binding:name")||b.getAttribute("name");case "source":a.source=new String(Web.Utility.getTextProperty(b)||"");a.source.url=b.getAttribute("url");break;case "enclosure":a.enclosure=new String(b.getAttribute("url")||"");a.enclosure.encUrl=b.getAttribute("url");a.enclosure.encLength=b.getAttribute("length");a.enclosure.encType=b.getAttribute("type");break;default:a[b.nodeName]=new String(Web.Utility.getTextProperty(b)||"");for(var l=0;l<b.childNodes.length;l++){var o=b.childNodes[l];a[b.nodeName][o.nodeName]=Web.Utility.getTextProperty(o)}}}if(!a.title)a.title="Default Title";else if(a.title.substring(0,4)=="ADV:")continue;if(!a.link&&a.guid&&a.guid.substring(0,7)=="http://")a.link=a.guid;d.items.push(a);break;default:d[c.nodeName]=new String(Web.Utility.getTextProperty(c))}}}}}return g};registerNamespace("Web.Utility");Web.Utility.getTextProperty=function(a){if(a.text=="")return "";else return a.text||a.textContent};Web.Utility.getDocumentRoot=function(a){var b=null;if(a.responseText.length==4)return null;if(!a.responseText||a.responseText=="")try{var c=new ActiveXObject("Microsoft.XMLDOM");c.loadXML(a.responseText);b=c.documentElement}catch(d){b=null}else{try{b=a.responseXML.documentElement}catch(d){b=null}if(!b&&$Browser.isMozilla())try{a=$Browser._Private.cleanupFirefox(a);b=a.responseXML.documentElement}catch(d){}}return b};registerNamespace("Start.Parser");Start.Parser.ParseRssResponse=Web.Rss.parse;registerNamespace("Start.Util");Start.Util.GetBindingMethodIfExists=function(a,b){var d;if(Start.Util.IsDefined(a.webBindings))for(var e=0;e<a.webBindings.length;e++){var c=a.webBindings[0];if(Start.Util.IsDefined(c[b])){d=c[b];break}}return d};Start.Util.Rectangle=function(c,d,b,a){return {x:c,y:d,width:b,height:a}};Start.Util.GetScreenView=function(){var c=document.documentElement.scrollLeft,d=document.documentElement.scrollTop,b=window.innerWidth?window.innerWidth:document.documentElement.clientWidth,a=window.innerHeight?window.innerHeight:document.documentElement.clientHeight;return new Start.Util.Rectangle(c,d,b,a)};Start.Util.Point=function(a,b){return {x:a,y:b}};Start.Util.IsPointInElement=function(b,d,a){var c=Start.Util.GetElementView(d);return Start.Util.IsPointInRectangle(b,c,a)};Start.Util.IsPointInRectangle=function(b,a,c){if(!c)return b.x>a.x&&b.x<a.x+a.width&&b.y>a.y&&b.y<a.y+a.height;else return b.x>=a.x&&b.x<=a.x+a.width&&b.y>=a.y&&b.y<=a.y+a.height};Start.Util.GetElementView=function(a){var b=Start.Util.GetElementOffset(a);return new Start.Util.Rectangle(b.x,b.y,a?a.offsetWidth:0,a?a.offsetHeight:0)};Start.Util.GetElementOffset=function(c,b){var a=Web.UI.getLocation(c,b);return new Start.Util.Point(a.left,a.top)};Start.Util.GetDistanceBetweenPoints=function(b,c,f){var d=b.x-c.x,e=b.y-c.y,a=Math.pow(d,2)+Math.pow(e,2);if(f!=false)a=Math.sqrt(a);return a};Array.prototype.insertAt=function(b,a){if(a>=this.length)this.push(b);else{if(a<0)a=0;if(a>=this.length)this.push(b);else this.splice(a,0,b)}};Array.prototype.moveItem=function(a,b){var c=this[a];this.removeAt(a);this.insertAt(c,b)};Start.Util.InsertElementChildAt=function(b,c,a){if(a==null||a>b.childNodes.length)a=b.childNodes.length;if(a<=0)a=0;if(a==b.childNodes.length)b.appendChild(c);else b.insertBefore(c,b.childNodes[a])};Start.Util.GetChildElementIndex=function GetChildElementIndex(b,d){var c=-1;for(var a=0;a<b.childNodes.length;a++)if(b.childNodes[a]==d){c=a;break}return c};Start.Util.GetArrayFromString=function(e){var d={};if(e!=null){var c=e.split(";");for(var b=0;b<c.length;b++){var a=c[b].split("=");if(!a[1])a[1]="";d[unescape(a[0]).trim()]=unescape(a[1]).trim()}}return d};Start.Util.GetStringFromArray=function(b){var a="";for(var c in b){if(a!="")a+=";";a+=escape(c)+"="+escape(b[c])}return a};Start.Util.IsDefined=function(a){return a!=null&&typeof a!="undefined"};Start.Util.ObjectToString=function(b){var a;if(b)if(typeof b.length=="undefined"){a="{";for(var c in b)a+="'"+c+"':"+Start.Util.ConvertProperty(b[c])+",";if(a.substring(a.length-1)==",")a=a.substring(0,a.length-1);a+="}"}else if(typeof b=="string")a="'"+b+"'";else{a="[";for(var c=0;c<b.length;c++)a+=Start.Util.ConvertProperty(b[c])+",";if(a.substring(a.length-1)==",")a=a.substring(0,a.length-1);a+="]"}else a="null";return a};Start.Util.ConvertProperty=function(a){switch(typeof a){case "object":return Start.Util.ObjectToString(a);case "string":return "'"+a.replace(/\'/g,"\\'")+"'";case "function":return "null";default:return a}};Start.Util.StringToArray=function(a){return Start.Util.StringToObject(a)};Start.Util.StringToObject=function(str){var result=null;try{eval("result = "+str)}catch(a){}return result};Start.Util.ReadAllQS=function(b){var e=b?b:location.search,b={},d=e.substring(1).split("&");for(var c=0;c<d.length;c++){var a=d[c].split("=");if(!a[1])a[1]="";b[a[0].trim()]=decodeURIComponent(a[1].trim())}return b};Start.Util.ReadQS=function(b,a){return Start.Util.ReadAllQS(a)[b]};Start.Util.ReadAllCookies=function(){var d={},c=document.cookie.toString().split(";");for(var b=0;b<c.length;b++){var a=c[b].split("=");if(!a[1])a[1]="";d[a[0].trim()]=unescape(a[1]).trim()}return d};Start.Util.ReadCookie=function(a){return Start.Util.ReadAllCookies()[a]};Start.Util.ClearCookie=function(b,a,c){Start.Util.WriteCookie(b,"deleted","Thu, 01-Jan-1970 00:00:01 GMT",a,c);Start.Util.WriteCookie(b,null,"Thu, 01-Jan-1970 00:00:01 GMT",a,c)};Start.Util.ClearAllCookies=function(c,d){var a=Start.Util.ReadAllCookies();for(var b in a)Start.Util.ClearCookie(b,c,d)};Start.Util.WriteCookie=function(d,f,b,c,e,g){var a="";if(b)a+="; expires="+b;if(c)a+="; domain="+c;if(e)a+="; path="+e;else a+="; path=/";if(g)a+="; secure";if(f)document.cookie=d+"="+escape(f)+a;else document.cookie=d+a};Start.Util.ModuleToString=function(a){if(Object.compare("Start.RssModule",a))return "Start.RssModule";if(Object.compare("Start.RssReader",a))return "Start.RssReader";if(Object.compare("Start.AddContentModule",a))return "Start.AddContentModule"};Start.Util.StringToModule=function(a){switch(a){case "Start.RssModule":return Start.RssModule;case "Start.RssReader":return Start.RssReader;case "Start.AddContentModule":return Start.AddContentModule}return null};Start.Util.HelperHoursAgo=function(d){var c="",b=0,e=new Date-new Date(d),a=Math.round(e/(1e3*60*60));if(a>=24){b=Math.round(a/24);a%=24}if(b>0)c+=b+" "+(b==1?L_DaySingular_Text:L_DayPlural_Text)+(a>0?", ":"");if(a>0)c+=a+" "+(a==1?L_HourSingular_Text:L_HourPlural_Text);if(b>0||a>0)c=L_AgoTextBefore_Text+" "+c+" "+L_AgoTextAfter_Text;return c};Start.Util.FormatNumber=function(c){var a=new String(c);if(c>=1e3||c<=-1e3){var b=a.length;b-=3;while(b>=1){a=a.substring(0,b)+","+a.substring(b,a.length);b-=3}}return a};Start.Util.GetTextProperty=function(a){if(a.text=="")return "";else return a.text||a.textContent};Start.Util.EncodeXml=function(c,b){var a=c.replace(/</g,"&lt;");a=a.replace(/>/g,"&gt;");a=a.replace(/\"/g,"&quot;");a=a.replace(/\'/g,"&apos;");if(b)a=a.replace(/&/g,"%26");return a};Start.Util.createRequest=function(i,e,B,p,j,l,k,q,u,r,A,v,x){var b={},a,f=i,d=e,z=B,m=p,c=j,h=l,g=k,n=q,s=u,o=r,y=A,t=v,w=x;b.execute=function(){var b=null;try{if(__dataIsland)b=__dataIsland[f]}catch(i){}if(b){var e=Start.Util.BuildResponse(b);__dataIsland.remove(b);b=null;if(c)c(e)}else{if(!a)a=Web.Network.createRequest(d,z,m,c,h,g,n,s,o,y,t,w);a.execute()}};b.isExecuting=function(){return a?a.isExecuting():false};b.abort=function(){if(a)a.abort()};return b};Start.Util.BuildResponse=function(b){var a={};a.status=200;a.responseText=b;return a};Start.Util.GetHomePageUrl=function(){return "http://"+window.location.hostname+"/"};Start.Util.TruncateToSpace=function(a,b){var c=a;if(a.length>b){var d=a.substring(b,a.length).indexOf(" ");if(d!=-1)c=a.substring(0,b+d)+" ...";else c=a.substring(0,b)}return c};Start.Util.GetImageUrlsFromHtml=function(b,c){var a=document.createElement("div");a.innerHTML=c;Start.Util.GetImages(b,a)};Start.Util.GetImages=function(d,c){if(c){var e=c.getElementsByTagName("img");for(var b=0;b<e.length;b++){var a=e[b].src;if(!Start.Util.IsAdUrl(a)&&d.indexOf(a)==-1)d.push(a)}}};Start.Util.IsAdUrl=function(b){var a=["//ads.","/adclick","/ads/","/c.gif"],c=new RegExp(a.join("|"),"im");return c.exec(b)?true:false};Start.Util.EncodeUrlQueryString=function(a){return a.replace(/%/g,"%25").replace(/&/g,"%26").replace(/\?/g,"%3F")};Start.Util.IsTrue=function(b,c){var a=false;if(Start.Util.IsDefined(b)){if(b=="true"||b==true)a=true}else a=c;return a};Start.Util.ScaleImage=function(a,c,b,e,d){if(a){if(e)a.width=e;if(d)a.height=d;if(c&&a.width>c){a.height=a.height*c/a.width;a.width=c}if(b&&a.height>b){a.width=a.width*b/a.height;a.height=b}}};Start.Util.CreateDomElement=function(c,a){var b=document.createElement(c);if(a!=null)a.appendChild(b);return b};Start.Util.EventReturn=function(b,a){if(b)b.returnValue=a;return a};Start.Util.GetParentElementByClassName=function(a,b){while(a&&!Start.Util.Dom.HasClass(a,b))a=a.parentElement;return a};Start.Util.ExtractTextFromHtml=function(c){var a=document.createElement("div");a.style.display="none";document.body.appendChild(a);a.innerHTML=c;var b=a.innerText;a.removeNode(true);a=null;b=b.replace("\t"," ").replace("  "," ").trim();return b};Start.Util.EventKeyCode=function(a){var b=null;if(a.keyCode)b=a.keyCode;else if(a.which)b=a.which;return b};Start.Util.IsDescendantEl=function(c,b){var a=c;while(a&&a!=b)a=a.parentElement;return a!=null};Start.Util.GetArg=function(a,b,c){return Start.Util.IsDefined(a)&&Start.Util.IsDefined(a[b])?a[b]:Start.Util.IsDefined(c)?c:null};Start.Util.GetDefault=function(d,e){var b=null,c=Start.Util.GetArg(d,"xml");if(c){var a=Start.Parser._GetDocumentRoot(c).selectSingleNode("channel/defaults/param[@name='"+e+"']");if(a)b=a.getAttribute("value")}return b};Start.Util.ResolveLocName=function(a){if(window[a]!=null&&typeof window[a]=="string")return window[a];return a};Start.Util.GetLocalizedMonths=function(){return [L_JanuaryShort_Text,L_FebruaryShort_Text,L_MarchShort_Text,L_AprilShort_Text,L_MayShort_Text,L_JuneShort_Text,L_JulyShort_Text,L_AugustShort_Text,L_SeptemberShort_Text,L_OctoberShort_Text,L_NovemberShort_Text,L_DecemberShort_Text]};Start.Util.GetLocalizedDays=function(){return [L_Sunday_Text,L_Monday_Text,L_Tuesday_Text,L_Wednesday_Text,L_Thursday_Text,L_Friday_Text,L_Saturday_Text]};Start.Util.GetLocalizedDate=function(d){function g(b,a){return b.getDate()==a.getDate()&&b.getMonth()==a.getMonth()&&b.getYear()==a.getYear()}var e=new Date;if(g(d,e))return L_Today_Text;e.setDate(e.getDate()-1);if(g(d,e))return L_Yesterday_Text;var i=Start.Util.GetLocalizedMonths(),a=L_DateFormat_Text,c=a.split("'");for(var b=0;b<c.length;b+=2)c[b]=c[b].replace("MMM","^0^").replace("M","^1^").replace("dddd","^2^").replace("dd","^3^").replace("d","^4^");a="";for(b=0;b<c.length;b++)a+=c[b];var h=d.getMonth();a=a.replace("^0^",i[h]);a=a.replace("^1^",h+1);var f=d.getDate();a=a.replace("^2^","");a=a.replace("^3^",(f<10?"0":"")+f);a=a.replace("^4^",f);return a};Start.Util.GetLocalizedTime=function(c){var a=L_TimeFormat_Text,b=c.getHours();a=a.replace("HH",(b<10?"0":"")+b);a=a.replace("H",b);var d=b>11;b=b-(d?12:0);a=a.replace("hh",(b<10?"0":"")+b);b=b===0?12:b;a=a.replace("h",b);var e=c.getMinutes();a=a.replace("mm",(e<10?"0":"")+e);a=a.replace("tt",d?L_TimePM_Text:L_TimeAM_Text);return a};Start.Util.GetDayOfWeek=function(a){var b=Start.Util.GetLocalizedDays();return b[a.getDay()]};registerNamespace("Start.Util.Dom");Start.Util.Dom.makeUnselectable=function(a){a.unselectable="on"};Start.Util.Dom.AddClass=function(a,b){if(!Start.Util.Dom.HasClass(a,b)){a.className+=" "+b;a.className=a.className.trim()}};Start.Util.Dom.RemoveClass=function(a,b){a.className=a.className.removeSpaceDelimitedString(b)};Start.Util.Dom.HasClass=function(a,b){if(a.className){var c=" "+a.className.trim()+" ";return c.indexOf(" "+b+" ")!=-1}return false};Start.Util.ShallowClone=function(b){var a={};for(var c in b)a[c]=b[c];return a};Start.Util.highlightTextForSearch=function(d,a){if(!a)return "";a=a+"";var b=0;while(b<a.length){var c=a.indexOf("",b);if(c==-1){d.appendChild(document.createTextNode(a.substr(b)));b=a.length}else{d.appendChild(document.createTextNode(a.substring(b,c)));var e=document.createElement("strong");d.appendChild(e);var f=a.indexOf("",c);if(f==-1){e.innerText=a.substr(c+1);b=a.length}else{e.innerText=a.substring(c+1,f);b=f+1}}}};Start.Util.AttachElementBindingSync=function(f,c,e,d,b){var g=Object.resolve(c),a=new g(f,d,b);a.initialize(e);return a};registerNamespace("Start.FancyButton");Start.FancyButton=function(p,e){Start.FancyButton.initializeBase(this,arguments);var a=p,r=this,o=null,m="submit";if(e!=null&&e.type!=null)m=e.type;var c=false,d=false,b=null;this.initialize=function(){Start.FancyButton.callBaseMethod(this,"initialize",arguments);a.type=m;b=a.className+" fancyButton";a.className=b+" fancyButtonRest";a.attachEvent("onmouseover",g);a.attachEvent("onmouseout",h);a.attachEvent("onmousedown",f);a.attachEvent("onmouseup",j);a.attachEvent("onkeydown",i);a.attachEvent("onkeyup",l);a.attachEvent("onfocus",k);a.attachEvent("onblur",n)};this.dispose=function(){Start.FancyButton.callBaseMethod(this,"dispose",arguments);a.detachEvent("onmouseover",g);a.detachEvent("onmouseout",h);a.detachEvent("onmousedown",f);a.detachEvent("onmouseup",j);a.detachEvent("onkeydown",i);a.detachEvent("onkeyup",l);a.detachEvent("onfocus",k);a.detachEvent("onblur",n)};this.setData=function(a){o.innerText=a};function g(){a.className=b+" fancyButtonHover";c=true}function h(){if(!d)a.className=b+" fancyButtonRest";else a.className=b+" fancyButtonHover";c=false}function f(){a.className=b+" fancyButtonPressed"}function j(){a.className=b+" fancyButtonHover"}function i(c){if(c.keyCode==32)a.className=b+" fancyButtonPressed"}function l(c){if(c.keyCode==32)a.className=b+" fancyButtonHover"}function k(){if(!c)a.className=b+" fancyButtonHover";d=true}function n(){if(c)a.className=b+" fancyButtonHover";else a.className=b+" fancyButtonRest";d=false}};Start.FancyButton.registerClass("Start.FancyButton","$Binding");Start.FancyButton.Events=new $Enum("onButtonClicked");registerNamespace("Start");Start.OnFocusEditBox=function(i,c){Start.OnFocusEditBox.initializeBase(this,arguments);var a=i,k=this,e=c.activeStyle,g=c.inactiveStyle,b=c.text,h=c.setFocus;this.GetText=function(){return b};this.GetEl=function(){return a};this.initialize=function(){Start.OnFocusEditBox.callBaseMethod(this,"initialize",arguments);a.title=b;a.attachEvent("onfocus",f);a.attachEvent("onblur",d);d();function c(){a.focus()}if(h)setTimeout(c,1)};this.dispose=function(){Start.OnFocusEditBox.callBaseMethod(this,"dispose",arguments);a.detachEvent("onfocus",f);a.detachEvent("onblur",d);a=null};function d(){if(a.value==""||a.value==b){a.value=b;a.className=g}else a.className=e}function f(){a.className=e;if(a.value==b)a.value=""}};Start.OnFocusEditBox.registerClass("Start.OnFocusEditBox","$Binding");registerNamespace("Start");Start.DragReorderList=function(F,g){Start.DragReorderList.initializeBase(this,arguments);var x=this,i=[],d=F,h=0,f=0,p=false,m=null,q=false,l=null,o=false,n=y;if(g){h=Start.Util.IsDefined(g.numHeaderElements)?g.numHeaderElements:0;f=Start.Util.IsDefined(g.numFooterElements)?g.numFooterElements:0}var b=null,c=null,e=false,a=null,j=null,k=null,D=null,E=null,r=null,s=null;this.initialize=function(){Start.DragReorderList.callBaseMethod(this,"initialize",arguments);v(d,"mousedown",z);v(document.body,"mouseup",t)};this.dispose=function(){while(i.length>0){var e=i.pop();B(e[0],e[1],e[2]);e=null}i=d=n=b=c=a=null;Start.DragReorderList.callBaseMethod(this,"dispose",arguments)};this.SetFloatingElementOptions=function(b,a){if(e)throw new Error("Cannot set options during a drag");q=b;l=a};this.SetPlaceholderElementOptions=function(a,b){if(e)throw new Error("Cannot set options during a drag");p=a;m=b};this.DisableDragReordering=function(){o=true;if(e)t(null)};this.EnableDragReordering=function(){o=false};function z(a){if(!o){j=a.clientX;k=a.clientY;var f=Web.UI.getLayoutRoot().scrollTop,e=Web.UI.getLayoutRoot().scrollLeft;b=C(d,j+e,k+f);if(b){var c=Start.Util.GetElementOffset(b);D=j-c.x;E=k-c.y;if(a.button==1||a.button==0)document.body.attachEvent("onmousemove",w)}return u(a)}}function t(){document.body.detachEvent("onmousemove",w);if(e){document.body.releaseCapture();if(a){a.removeNode(true);f--;a=null}d.replaceChild(b,c);e=false;x.fire("onItemDragEnd",b)}}function w(f){var g;if(!e&&b){var j=true,h=Start.Util.GetBindingMethodIfExists(b,"DragReorderList_IsDragable");if(Start.Util.IsDefined(h))j=h();if(j){x.fire("onItemDragStart",b);A(f)}}if(e){var l=Web.UI.getLayoutRoot().scrollTop,k=Web.UI.getLayoutRoot().scrollLeft;if(a){a.style.pixelLeft=f.clientX-r;a.style.pixelTop=f.clientY-s}g=n(new Start.Util.Point(f.clientX+k,f.clientY+l),d);if(g!=-1&&d.childNodes[g]!=c){c.removeNode(true);Start.Util.InsertElementChildAt(d,c,g);var i=n(new Start.Util.Point(f.clientX+k,f.clientY+l),d);if(i!=-1){c.removeNode(true);Start.Util.InsertElementChildAt(d,c,i)}}return u(f)}}function u(a){if(a&&a.preventDefault)a.preventDefault();return false}function v(b,a,c){b.attachEvent("on"+a,c);i.push([b,a,c])}function B(b,a,c){b.detachEvent("on"+a,c)}function C(d,e,g){for(var c=h;c<d.childNodes.length-f;c++){var a=d.childNodes[c],b=Start.Util.GetElementOffset(a);if(e>=b.x&&g>=b.y){var j=b.x+a.offsetWidth,i=b.y+a.offsetHeight;if(e<j&&g<i)return a}}return null}function y(e,l){var k=-1,a,m,b,d;for(var j=h;j<l.childNodes.length-f;j++){var i=l.childNodes[j],g=Start.Util.GetElementOffset(i);g.x+=i.offsetWidth/2;g.y+=i.offsetHeight/2;var n=Start.Util.GetDistanceBetweenPoints(g,e,false);if(k==-1||k>n){k=n;a=j;m=i;b=g}}if(m==c)d=-1;else{d=a;if(a==h){if(b.x<e.x&&b.y<e.y)d=a+1}else if(a==l.length-f)if(b.x<e.x||b.y<e.y)d=a+1}return d}function A(g){e=true;if(q){var h=null,i=null;a=b.cloneNode(true);a.style.cursor="move";a.style.border="solid 1px #333333";a.style.width=b.offsetWidth+1+"px";a.style.height=b.offsetHeight+1+"px";a.style.position="absolute";a.style.filter="alpha(opacity=60)";a.style.opacity="0.6";a.style.whiteSpace="nowrap";a.style.zIndex=1;d.appendChild(a);f++;h=g.clientX-b.offsetLeft;i=g.clientY-b.offsetTop;r=g.clientX-j+h;s=g.clientY-k+i;if(l)a.className=a.className+" "+l}if(p)c=document.createElement("li");else c=b.cloneNode(true);if(m)c.className=c.className+" "+m;d.replaceChild(c,b);document.body.setCapture()}};Start.DragReorderList.New=function(c,e,b,a){var d=Start.Util.AttachElementBindingSync(c,Start.DragReorderList,e,{numHeaderElements:b,numFooterElements:a});return d};Start.DragReorderList.registerClass("Start.DragReorderList","$Binding");Start.DragReorderList.Events=new $Enum("onItemDragStart","onItemDragEnd");registerNamespace("Start");Start.DropOptionList=function(H,e){Start.DropOptionList.initializeBase(this,arguments);var d=this,g=[],n=null,j=null,i=null,k="left";if(e){n=e.choiceCallback;j=e.cancelCallback;i=e.styleOverrideClassName;if(e.menuParentAlign)k=e.menuParentAlign}var f=H,a=null,b=null,c=null,I=false,h=null,m=false;this.initialize=function(){Start.DropOptionList.callBaseMethod(this,"initialize",arguments);B()};this.dispose=function(){Start.DropOptionList.callBaseMethod(this,"dispose",arguments);for(var b=0;b<g.length;b++){var a=g[b];l(a[0],a[1],a[2])}g=null;p();s();o()};this.Activate=function(){if(k=="left"){var b=Start.Util.GetElementOffset(f);a.style.pixelLeft=b.x;a.style.pixelTop=b.y+f.offsetHeight+1;a.style.display="block"}else if(k=="right"){a.style.visibility="hidden";a.style.display="block";var b=Start.Util.GetElementOffset(f),d=b.x+f.offsetWidth,c=d-a.offsetWidth;a.style.pixelLeft=c;a.style.pixelTop=b.y+f.offsetHeight+1;a.style.visibility="visible"}m=true;C();A()};this.Deactivate=function(b){s();o();a.style.display="none";w(c);c=null;m=false;if(b==true)if(Start.Util.IsDefined(j))j()};this.InsertOption=function(f,g,e,c){var a=document.createElement("li");a.className="dropOption";a.innerHTML=f;a._Start_DropOptionList_value=g;a._Start_DropOptionList_selectable=e;z(a);if(c!=null){var d=b.childNodes[c];if(d)b.insertBefore(a,d);else b.appendChild(a)}else b.appendChild(a)};this.InsertOptionWithImage=function(g,f,h,e,b){var a=null;switch(f){case Start.DropOptionList.iconType.checked:a="checked";break;case Start.DropOptionList.iconType.unchecked:a="unchecked"}var c="<div class='"+a+"'></div>"+g;d.InsertOption(c,h,e,b)};this.InsertSeperator=function(a){d.InsertOption("----",null,false,a)};this.ClearOptions=function(){c=null;if(b)while(b.childNodes.length>0){var a=b.childNodes[0];y(a);b.removeChild(a)}};this.Select=function(a){w(c);c=a;Start.Util.Dom.AddClass(a,"selected")};function t(b){if(!m)return Start.Util.EventReturn(b,true);var c=b.srcElement;if(c!=a&&!Start.Util.IsDescendantEl(c,a))d.Deactivate(true);return Start.Util.EventReturn(b,true)}function q(b){var a=b.srcElement;if(c!=a)d.Select(a);x(a);return Start.Util.EventReturn(b,false)}function r(b){var a=b.srcElement;a=Start.Util.GetParentElementByClassName(a,"dropOption");if(a&&c!=a&&a._Start_DropOptionList_selectable)d.Select(a);return Start.Util.EventReturn(b,false)}function p(){clearTimeout(h);h=null}function v(a){if(!h){h=setTimeout(p,1);var b=Start.Util.EventKeyCode(a);switch(b){case 27:d.Deactivate(true);case 38:E();return Start.Util.EventReturn(a,false);case 40:D();return Start.Util.EventReturn(a,false);case 13:x(c);return Start.Util.EventReturn(a,false);default:d.Deactivate(true)}}}function x(a){d.Deactivate(false);n(a._Start_DropOptionList_value)}function B(){a=document.createElement("div");if(Start.Util.IsDefined(i))a.className=i;else a.className="dropOptionList";a.style.display="none";b=document.createElement("ul");b.className="menuList";a.appendChild(b);document.body.appendChild(a)}function w(a){if(a){c=a;Start.Util.Dom.RemoveClass(a,"selected")}}function z(a){u(a,"mousedown",q);u(a,"mouseover",r)}function y(a){l(a,"mousedown",q);l(a,"mouseover",r)}function C(){document.body.attachEvent("onkeydown",v)}function s(){document.body.detachEvent("onkeydown",v)}function A(){document.body.attachEvent("onmousedown",t)}function o(){document.body.detachEvent("onmousedown",t)}function D(){var a=F(c);if(a)d.Select(a)}function E(){var a=G(c);if(a)d.Select(a)}function F(c){var a=null;if(!c&&b&&b.childNodes.length>0)a=b.childNodes[0];else a=c.nextSibling;while(a&&!a._Start_DropOptionList_selectable)a=a.nextSibling;return a}function G(b){var a=null;if(b){a=b.previousSibling;while(a&&!a._Start_DropOptionList_selectable)a=a.previousSibling}return a}function u(b,a,c){b.attachEvent("on"+a,c);g.push([b,a,c])}function l(b,a,c){b.detachEvent("on"+a,c)}};Start.DropOptionList.registerClass("Start.DropOptionList","$Binding");Start.DropOptionList.iconType=new $Enum("checked","unchecked");registerNamespace("Start");Start.DropTextBoxPalette=function(z,i){Start.DropTextBoxPalette.initializeBase(this,arguments);var e=this,d=[],g=z,a=null,f=false,y=i.legendText,q=i.defaultTextBoxText,x=i.buttonText,c=null,j=null,b=null,h=null;this.initialize=function(){Start.DropTextBoxPalette.callBaseMethod(this,"initialize",arguments);s()};this.dispose=function(){k();o();g=a=f=c=j=b=h=d=null;Start.DropTextBoxPalette.callBaseMethod(this,"dispose",arguments)};this.Activate=function(){var d=c.GetEl().value;function b(){c.GetEl().value=d;c.GetEl().select()}document.body.appendChild(a);u();a.style.visibility="visible";c.GetEl().focus();setTimeout(b,1);f=true;t()};this.Deactivate=function(){a.style.visibility="hidden";f=false;k();c.GetEl().blur();document.body.removeChild(a)};this.GetOptionsMenuBinding=function(){return j};this.SetStatus=function(c,a){b.innerText=c;if(a)b.className=a};this.ShowStatus=function(){Start.Util.Dom.RemoveClass(b,"hideStatus");Start.Util.Dom.AddClass(b,"showStatus")};this.HideStatus=function(){Start.Util.Dom.RemoveClass(b,"showStatus");Start.Util.Dom.AddClass(b,"hideStatus")};function r(a){e.fire("ontextsubmit",a)}function p(a){e.fire("onoptionchoose",a)}function n(a){if(!f)return Start.Util.EventReturn(a,false);r(c.GetEl().value);return Start.Util.EventReturn(a,false)}function l(b){if(!f)return Start.Util.EventReturn(b,true);var c=b.srcElement;if(c!=a&&!Start.Util.IsDescendantEl(c,a))e.Deactivate();return Start.Util.EventReturn(b,true)}function m(){}function s(){a=document.createElement("form");a.className="dropTextBoxPalette";a.style.visibility="hidden";a.style.display="block";var f=document.createElement("fieldset");f.className="fields";a.appendChild(f);var d=document.createElement("p");d.innerHTML=y;f.appendChild(d);d=document.createElement("input");d.type="text";d.className="textBox";d.value="";f.appendChild(d);c=Start.Util.AttachElementBindingSync(d,Start.OnFocusEditBox,e,{activeStyle:"textBox",inactiveStyle:"textBox",text:q});j=Start.Util.AttachElementBindingSync(d,Start.DropOptionList,e,{choiceCallback:v});h=document.createElement("input");Start.Util.AttachElementBindingSync(h,Start.FancyButton,e);h.value=x;f.appendChild(h);b=document.createElement("p");b.className="hideStatus";b.innerHTML="";a.appendChild(b)}function v(a){p(a)}function t(){document.body.attachEvent("onmousedown",l);a.attachEvent("onsubmit",n);a.attachEvent("onkeydown",m)}function k(){document.body.detachEvent("onmousedown",l);a.detachEvent("onsubmit",n);a.detachEvent("onkeydown",m)}function u(){var b=Start.Util.GetElementOffset(g);if(i.menuParentAlign=="left"){a.style.pixelLeft=b.x;a.style.pixelTop=b.y+g.offsetHeight+1}else{var d=b.x+g.offsetWidth,c=d-a.offsetWidth;a.style.pixelLeft=c;a.style.pixelTop=b.y+g.offsetHeight+1}}function w(b,a,c){b.detachEvent("on"+a,c)}function o(){if(d!=null){while(d.length>0){var a=d.pop();w(a[0],a[1],a[2]);a=null}d=null}}};Start.DropTextBoxPalette.registerClass("Start.DropTextBoxPalette","$Binding");Start.DropTextBoxPalette.Events=new $Enum("ontextsubmit","onoptionchoose");registerNamespace("Microsoft.Spaces.Proxy");Microsoft.Spaces.Proxy.UpdateProxy=function(a){if(a.proxy)return;if(a.type==$Network.Type.XML||a.type==$Network.Type.XMLGet){var c=$Request.extractHost(a.url).split(":")[0];if(c!="localhost"&&c!=$Request.extractHost(document.location)){var d,b=$Network.getCookie(C_CANARY_COOKIE_NAME);if(b&&b!="")a.setCanary(C_CANARY_COOKIE_NAME);if(!a.headers)a.headers={};if(!a.headers["LiveProxy"])a.headers["LiveProxy"]="true";if(a.context)d=a.context.proxy;switch(d){case "none":break;case "rss":var e=a.context&&a.context.numItems||5;a.url=PathUtility.GetFetchUrlService(a.url,e);break;case "generic":default:a.url=PathUtility.GetProxyUrlService(a.url)}}}};$Network.Events.onrequest.attach(Microsoft.Spaces.Proxy.UpdateProxy);var L_Loading_Text="loading...",L_Deleting_Text="deleting...",L_Error_Text="Unable to retrieve data, please try again.",L_UnableToLoadFeed_Text="Oops, we seem to be having a problem with this feed.  Please try again later.",L_RemoveModule_Text="remove module",L_AddButton_Text="add",L_SettingsLabel_Text="settings",L_PlusTooltip_Text="display more headlines",L_MinusTooltip_Text="display fewer headlines",L_SearchLabel_Text="Search",L_AddBySearch_Text="Search for feeds",L_AddSearchButton_Text="Search",L_AddFeedByUrl2_Text="Subscribe to a specific feed by entering the URL below:",L_AddGadgetByUrl_Text="Add a Gadget by URL (find out how to build your own Gadgets at <a href='http://microsoftgadgets.com/default.aspx'>microsoftgadgets.com</a>)",L_AddSubscribeButton_Text="Subscribe",L_AddImportOpml_Text="Import OPML file: ",L_AddImportButton_Text="Import",L_ExportFeedByOPMLStr1_Text="Click ",L_ExportFeedByOPMLStr2_Text="here",L_ExportFeedByOPMLStr3_Text=" to export your feed subscriptions to OPML.",L_ExportFeedByOPMLTitle_Text="OPML Export",L_AddSearchPopup_Text="Search: ",L_AddFeedVerifyText_Text="verifying feed...",L_AddDiscoverTagText_Text="checking for autodiscover tag...",L_AddTip_Text="tip: you can also drag and drop this on to your page",L_SetHomepage_Text="make Live your homepage!",L_CustomExperience_Text="Switch to Custom Experience",L_StandardExperience_Text="Switch to Standard Experience",L_TrustedGadget01_Text="<b>Only install Gadgets from trusted sites.</b>",L_TrustedGadget02_Text="This a custom Gadget from",L_TrustedGadget03_Text="Below is a description of the Gadget:",L_TrustedGadgetNoDesc_Text="No Description",L_TrustedGadget04_Text="This 3rd party gadget has not been reviewed by Microsoft.  It could potentially access data in another 3rd party gadget, include code that is possibly unsafe and may change behavior at any time. <b>Do you trust this site and want to install this Gadget?</b>",L_TrustedGadgetRss01_Text="This RSS feed loaded from",L_TrustedGadgetRss02_Text="wants to load a custom gadget. The Gadget presents a customized experience for this feed. Below is a description of the feed:",L_TrustedGadgetRss03_Text="This 3rd party gadget has not been reviewed by Microsoft.  It could potentially access data in another 3rd party gadget, include code that is possibly unsafe and may change behavior at any time. <b>Do you trust this site and want to install this Gadget?</b>",L_TrustedGadgetRemove_Text="Remove",L_TrustedGadgetStd_Text="Standard View",L_TrustedGadgetInstall_Text="Install Gadget",L_TrustedGadgetRemember_Text="Remember my preference",L_SearchBubble_Text="Find anything using the new Windows Live Search!",L_AddContentBubble_Text="Click here to add more stuff to your page!",L_StartedBigBubble_Text="Let's get started!",L_HeadingBigBubble_Text="Make live.com yours",L_SubHeadingBigBubble_Text="We've picked some stuff to get you started; uncheck anything you don't want.",L_BubbleClose_Text="Close",L_FolderRemove_Text='Remove "',L_FolderItem_Text='" item',L_FolderDeleteConfirm_Text="This will delete the entire folder and all of its contents.  Are you sure you want to do this?",L_AddToPage_Text="add to my page",L_AddToPageTip_Text="add this module to your page",L_AddModuleHdrDup_Text="this module is already on your page",L_MoreLink_Text="more",L_ReadAll_Text="read all",L_Expand_Text="expand",L_Collapse_Text="collapse",L_ExpandAll_Text="expand all",L_CollapseAll_Text="collapse all",L_NoResults_Text="Your search did not produce any results.",L_WebResults_Text="Web",L_NewsResults_Text="News",L_RssResults_Text="Feeds",L_SubscribeFeedText_Text="Subscribe to this RSS feed",L_SubscribeFeed_Text="Subscribe",L_FeedbackLink_Text="feedback",L_MicrosoftFooter_Text="&#xA9;2006 Microsoft",L_PrivacyFooter_Text="privacy",L_SupportFooter_Text="support",L_AddPage_Text="add a page",L_DeletePage_Text="delete page",L_RenamePage_Text="rename page",L_PageDeleteConfirm_Text="Are you sure you want to delete this page?",L_CannotDeletePage_Text="This page cannot be deleted.  You must have at least one page.",L_Page_Text="Page",L_TabOptionsTooltip_Text="Options",L_ClickToAddContentText_Text="Click above to add stuff.",L_MyFeedsGroup_Text="my stuff",L_AddContentHeading_Text="add stuff",L_FunTitle_Text="Fun",L_NewsInfoTitle_Text="News & Info",L_PeopleSharingTitle_Text="People & Sharing",L_ProductivityTitle_Text="Productivity",L_PulseTitle_Text="The Pulse",L_WindowsLiveTitle_Text="Windows Live",L_Startlets_Text="Gadgets",L_CategoriesGroup_Text="Directory",L_MyStuffDeleteConfirm_Text="You're about to remove this subscription from My Stuff and all your page(s). Are you ok with that?",L_SignInNameFormat_Text="hi {0}!",L_SignInNotYou_Text="not you?",L_SignInStartOver_Text="start over",L_StartOverWarning_Text="You're about to lose all your customizations. Are you sure?",L_SignOutText_Text="sign out",L_SignInText_Text="sign in",L_AgoTextAfter_Text="ago",L_AgoTextBefore_Text="",L_DaySingular_Text="day",L_DayPlural_Text="days",L_HourSingular_Text="hour",L_HourPlural_Text="hours",L_About_Text="About",L_QuestionMark_Text="?",L_MissingAboutInfo_Text="No information is available.",L_ChangeThemeText_Text="Switch theme",L_HideShowDash_Text="Hide/Show dashboard modules",L_HideText_Text="hide",L_ShowText_Text="show",L_AddBtn_Text="add",L_WeatherTitle_Text="Weather Forecasts",L_FavoritesTitle_Text="Favorites",L_ClockTitle_Text="Ticking Clock",L_StockTitle_Text="Stock Quotes",L_HoroscopeTitle2_Text="Horoscopes",L_BusinessTitle_Text="Business",L_EntertainmentTitle_Text="Entertainment",L_HealthTitle_Text="Health",L_NewsTitle_Text="News",L_ScienceTechTitle_Text="Science & Tech",L_SportsTitle_Text="Sports",L_ShoppingTitle_Text="Shopping (beta)",L_SafetyCenterTitle_Text="Safety Center",L_SearchTitle_Text="Search",L_HoroscopeDates01_Text="March 21 - April 19",L_HoroscopeDates02_Text="April 20 - May 20",L_HoroscopeDates03_Text="May 21 - June 21",L_HoroscopeDates04_Text="June 22 - July 22",L_HoroscopeDates05_Text="July 23 - August 22",L_HoroscopeDates06_Text="August 23 - September 22",L_HoroscopeDates07_Text="September 23 - October 23",L_HoroscopeDates08_Text="October 24 - November 21",L_HoroscopeDates09_Text="November 22 - December 21",L_HoroscopeDates10_Text="December 22 - January 19",L_HoroscopeDates11_Text="January 20 - February 18",L_HoroscopeDates12_Text="February 19 - March 20",L_HoroscopeIDs01_Text="Aries",L_HoroscopeIDs02_Text="Taurus",L_HoroscopeIDs03_Text="Gemini",L_HoroscopeIDs04_Text="Cancer",L_HoroscopeIDs05_Text="Leo",L_HoroscopeIDs06_Text="Virgo",L_HoroscopeIDs07_Text="Libra",L_HoroscopeIDs08_Text="Scorpio",L_HoroscopeIDs09_Text="Sagittarius",L_HoroscopeIDs10_Text="Capricorn",L_HoroscopeIDs11_Text="Aquarius",L_HoroscopeIDs12_Text="Pisces",L_HoroscopeProvider_Text="<br>Powered by Astrocenter",L_WeatherRemove_Text="remove city",L_WeatherProviderBefore_Text="Powered by: ",L_WeatherProviderAfter_Text="",L_Settings_Text="Settings",L_WhatsNew_Text="what's new",L_Legal_Text="legal",L_IdeasLive_Text="Windows Live Ideas",L_WelcomeHeader_Text="Welcome",L_Welcome01_Text="Welcome to Live.com Beta",L_Welcome02_Text="Get started",L_Welcome03_Text="with Live.com - your page, the way you want it.",L_Welcome04_Text="Discover more about",L_WL_Text="Windows Live",L_HowToHeader_Text="How to use Live.com",L_HowTo01_Text="Welcome to Live.com. Try it out and send us",L_HowTo02_Text="and tell us what you like and if there's anything you'd like to see us do differently. What Live has to offer today:",L_HowTo03_Text="Adding and reading content",L_HowTo04_Text="Drag and drop content listed in the sidebar on the left. Or click on the item to see a preview. From the preview window you can click 'add to my page' to add it to your page.",L_HowTo05_Text='Search for feeds. Just enter a query in the search box, select the "feeds" tab and then click "subscribe" to stay up to date with the latest content.',L_HowTo06_Text='If you want to see more of the story than just the headline, click on it and a preview appears. If you want the full story, select "more"',L_HowTo07_Text="Stay in touch",L_HowTo08_Text="We included e-mail inbox preview in Live.com so you can stay up to date with friends and family. We'll have even more stuff like this soon.",L_HowTo09_Text="Change the look of your page",L_HowTo10_Text="To move a module, just drag and drop its title bar to where you want. We'll automatically rearrange the page.",L_HowTo11_Text='To remove a module, select the "x" at the top of the title bar on the right.',L_HowTo12_Text='Leave modules open and we will refresh the information for you. Collapse them by clicking on the "v" to maximize viewing space.',L_HowTo13_Text='To show more or fewer headlines, select the "+/-" symbol in the content module.',L_HowTo14_Text="Enhance the page with gadgets",L_HowTo15_Text="Enter in a stock or fund symbol and the Stock Gadget shows you the latest trading price.",L_HowTo16_Text="If you're a developer and want to build your own Gadgets, visit <a href='http://www.microsoftgadgets.com'>www.microsoftgadgets.com</a>",L_HowTo17_Text="That should get you started, but feel free to play around and explore (there's lots of stuff that we didn't mention here). Since this is a beta that means it's still a work in progress, so expect lots of updates and changes. Please let us know what you think by sending",L_HowTo18_Text="or by going to",L_HowTo19_Text="ideas.live.com",L_HowTo20_Text=". Live.com is for you, so tell us what we can do to build it just the way you want it.",L_TipsHeader_Text="Live.com Tips",L_Tips01_Text="Tip 1: Check out",L_Tips02_Text="Getting Started",L_Tips03_Text="Tip 2: Use the ESC key to close a window.",L_Tips04_Text="Tip 3: The number you see in the title of a content module tells you how many items you haven't read yet.",L_RssTipReadStory_Text="Read full story",L_RssTipSendToFriend_Text="Send to a friend",L_RssTipBlog_Text="Blog this",L_FAQHeader_Text="Live.com FAQ",L_FAQ01_Text="We're so new that any questions we've received haven't been asked frequently. Please send us",L_FAQ02_Text="so we can get an idea of what you want to know.",L_MailHeader_Text="Mail",L_MailNotSignedIn01_Text="You can see your Windows Live Mail or Hotmail inbox here if you",L_MailSignInLink_Text="sign in",L_MailNotSignedIn01End_Text=".",L_MailNotSignedIn02_Text="Don't have a Windows Live Mail account? Find out how to",L_MailBetaLink_Text="join the beta",L_MailNotSignedIn02End_Text=".",L_BackToPage_Text="back to my page",L_AddContentTip_Text="<b>Tip:</b> you can drag and drop gadgets and feeds from the sidebar",L_AddContentAdvanced_Text="Advanced Options",L_MailInboxEmpty_Text="You have no new messages in your inbox.",L_MailBlocked_Text="This Windows Live Mail or Hotmail account has been closed. Access is denied.",L_MailReAuth_Text="Your Windows Live Mail or Hotmail authentication has expired. Click here to sign in again.",L_MailError_Text="The Windows Live Mail or Hotmail service is currently unavailable. Please try again.",L_InboxLink_Text="Inbox",L_ComposeLink_Text="Compose",L_CalendarLink_Text="Calendar",L_ContactsLink_Text="Contacts",L_EmailMoreLink_Text="More...",L_DeleteLink_Text="Delete",L_TimeFormat_Text="h:mm tt",L_TimeAM_Text="AM",L_TimePM_Text="PM",L_Today_Text="Today",L_Yesterday_Text="Yesterday",L_DateFormat_Text="dddd MMM d",L_Monday_Text="Monday",L_Tuesday_Text="Tuesday",L_Wednesday_Text="Wednesday",L_Thursday_Text="Thursday",L_Friday_Text="Friday",L_Saturday_Text="Saturday",L_Sunday_Text="Sunday",L_JanuaryShort_Text="Jan",L_FebruaryShort_Text="Feb",L_MarchShort_Text="Mar",L_AprilShort_Text="Apr",L_MayShort_Text="May",L_JuneShort_Text="Jun",L_JulyShort_Text="Jul",L_AugustShort_Text="Aug",L_SeptemberShort_Text="Sep",L_OctoberShort_Text="Oct",L_NovemberShort_Text="Nov",L_DecemberShort_Text="Dec",L_1column_Text="1 column",L_2column_Text="2 columns",L_3column_Text="3 columns",L_4column_Text="4 columns",L_RememberMyShowHideState_Text="Remember my show/hide state",L_AlwasyHideDashboard_Text="Always start with pages hidden",L_StockQuotesDataErrorDisplay_Text="Unavailable",L_StockQuotesAddSymbolDefault_Text="enter company",L_StockQuotesAddQuoteAction_Text="Add stock",L_StockQuotesAddSymbolFormLegend_Text="Add stock symbol",L_StockQuotesAddSymbolFormButton_Text="add",L_StockQuotesHeaderSymbolTitle_Text="sort by symbol",L_StockQuotesHeaderSymbol_Text="Symbol",L_StockQuotesHeaderPriceTitle_Text="sort by price",L_StockQuotesHeaderPrice_Text="Price",L_StockQuotesHeaderChangeTitle_Text="sort by change",L_StockQuotesHeaderChange_Text="Change",L_StockQuotesHeaderPctChangeTitle_Text="sort by percent change",L_StockQuotesHeaderPctChange_Text="%Chg",L_StockQuotesAttribution_Text="Quotes from IDC Comstock, 20 min delay",L_StockQuotesSearching_Text="Searching",L_StockQuotesCouldNotFind_Text="Could not find symbol",L_StockQuotesViewDetails_Text="view details",L_StockQuotesRemoveQuote_Text="remove quote",L_StockQuotesNotFound_Text="not found",L_WeatherLiveAddCity_Text="Add city",L_WeatherLiveItIsCurrently_Text="It is currently",L_WeatherLiveDegrees_Text="degrees",L_WeatherLiveCelcius_Text="Celsius",L_WeatherLiveFarenheit_Text="Fahrenheit",L_WeatherLiveFahrenheit_Text="Fahrenheit",L_WeatherLiveKmH_Text="km/hr",L_WeatherLiveMph_Text="mph",L_WeatherLiveSearching_Text="Searching...",L_WeatherLiveCouldNotFind_Text="Could not find location",L_WeatherLiveAddCityLegend_Text="Add a new city",L_WeatherLiveAddCityBtn_Text="search",L_WeatherLiveAddCityInput_Text="enter city",L_WeatherLiveHigh_Text="High:",L_WeatherLiveLow_Text="Low:",L_WeatherLiveWind_Text="Wind:",L_WeatherLiveHumidity_Text="Humidity:",L_WorldClockTitle_Text="World Clock";M_PrivacyLinkHref_Text="http://g.msn.com/0PR_/enus";M_LegalLinkHref_Text="loc/en/us/tou.asp";M_SupportLinkHref_Text="http://support.live.com/?locale=en-us";M_CultureVariable_Text="en-us";M_AstrologyLinkHref="http://www.astrocenter.com/msn/feeds/MyMsnDailyFile_Feed.aspx";M_CalendarLink_Url="http://calendar.msn.com/calendar/isapi.dll";M_FallbackInboxLink_Url="http://www.hotmail.msn.com/cgi-bin/sbox?rru=hotmail";M_IdeasLive_Url="http://ideas.live.com";M_LiveBlog_Url="http://spaces.msn.com/members/livecom";M_FeedBackLink_Market="";M_WeatherTitleUrl_Text="http://weather.msn.com";M_ClockTitleUrl_Text="";M_FAQTitleUrl_Text="";M_HowToHeaderUrl_Text="";M_TipsHeaderUrl_Text="";M_StockTitleUrl_Text="http://moneycentral.msn.com/home.asp";M_HoroscopeTitle2Url_Text="http://www.astrocenter.com/msn/HPChartsAndReports.aspx?osadcampaign=LV01";M_ShoppingTitleUrl_Text="http://shopping.msn.com/default/shp/?ptnrid=172,ptnrdata=10004";M_SafetyCenterTitleUrl_Text="http://safety.live.com";M_MailHeaderUrl_Text="";M_SearchTitleUrl_Text="";M_WelcomeHeaderUrl_Text="";var L_GLOBAL_ERROR="An error has occurred. Please try again later.";registerNamespace("Microsoft.Spaces.Gadget");Microsoft.Spaces.Gadget.Host=function(o,a){Microsoft.Spaces.Gadget.Host.initializeBase(this,arguments);a=this.getParameters();var f=o,g=this;a.manifesturl=R();var G=a.title,H=a.link,E=a.binding,b;if(a.safedomain&&a.safedomain.toString().toLowerCase()=="true")b=a.preferences&&a.preferences.length>0?Start.Util.StringToObject(a.preferences):{};else if(a.preferences!=null&&a.preferences.toString!=null)b=Object.fromJSON(a.preferences.toString());b=b!=null?b:{};var u=null,m;if(a.safedomain&&a.safedomain.toString().toLowerCase()=="true")m=a.preferences&&a.preferences.length>0?Start.Util.StringToObject(a.preferences):{};else if(a.preferences!=null&&a.preferences.toString!=null)m=Object.fromJSON(a.preferences.toString());m=b!=null?b:{};var y="Standard",d=a.moduleid,U=false,k=a.authorview&&a.authorview.toString().toLowerCase()=="true"?true:false,F=k||a.isowner&&a.isowner.toString().toLowerCase()=="true"?true:false,x=a.trusted&&a.trusted.toString().toLowerCase()=="true"?true:false,Y=a.iframed&&a.iframed.toString().toLowerCase()=="true"?true:false,v=a.gadgetapproved&&a.gadgetapproved.toString().toLowerCase()=="true"?true:false,ab=x||Y||v?true:false,eb=a.gadgethosturl,s=a.ownerid,bb=a.userid,w=a.authtoken,O=a.allowinlineflag&&a.allowinlineflag.toString().toLowerCase()=="true"?true:false,c=null,j=null,A=[],p=true,C=a.visitorheight,n=null,B=10,h=null,e=null,l=null,q=null,T=a.glinkserver,t=new GadgetsFpp.FppProxySettings;t.PartnerId=0;t.Version=GadgetsFpp.FppVersion.TWO;t.CanaryToken=C_CANARY_COOKIE_NAME;var r=GadgetsFpp.initializeEx($Request.extractHost(document.location,true)+"/parts/gadgets/Gadgets.fpp",t);this.GetId=function(){return d};this.GetEl=function(){return f};this.GetBodyEl=function(){return f};this.GetTitle=function(){return G};this.GetTitleBarEl=function(){return null};this.GetLink=function(){return H};this.GetBinding=function(){return E};this.SetFooterText=function(){};this.deletePreference=function(a){this.DeletePreference(a)};this.getId=function(){return this.GetId()};this.getLink=function(){return this.GetLink()};this.resize=this.Resize=function(){if(!$Browser.isSafari()&&!$Browser.isMozilla())try{if(document.documentElement&&document.documentElement.scrollWidth&&document.documentElement.scrollHeight&&document.documentElement.scrollHeight>=25)window.resizeTo(document.documentElement.scrollWidth,Math.max(document.documentElement.scrollHeight,o.scrollHeight));else if(document.body.scrollWidth&&document.body.scrollHeight&&document.body.scrollHeight>=25)window.resizeTo(document.body.scrollWidth,Math.max(document.body.scrollHeight,o.scrollHeight))}catch(a){}};this.getService=function(b,a){return this.GetService(b,a)};this.getPreference=function(b,a){return this.GetPreference(b,a)};this.setPreference=function(b,a){this.SetPreference(b,a)};this.getTitle=function(){this.GetTitle()};this.resolveUrl=function(b){return $Request.resolveUrl(b,a.manifesturl)};this.setFooterText=function(){};this.setTitleIcon=function(){};this.setLink=function(){};this.setTitle=function(){};this.addAction=function(a){var b=Start.DashboardModule.ActionCodes.settings;switch(a){case Web.Gadget.Actions.Add:b=Start.DashboardModule.ActionCodes.add}};this.removeAction=function(){};this.getMode=function(){return k?Web.Gadget.Mode.author:Web.Gadget.Mode.view};this.getType=function(){return x?Web.Gadget.Type.Internal:Web.Gadget.Type.External};this.getMarket=function(){return $Config.culture};this.getLanguage=function(){return $Config.culture.substring(0,2)};this.getLocale=function(){return $Config.culture.substring(3)};this.initialize=function(){Microsoft.Spaces.Gadget.Host.callBaseMethod(this,"initialize",arguments);var b={};b.module=g;b.onDashboard=U;b.ownermkt=a.ownermkt;b.alias=a.alias;b.height=C;M_CultureVariable_Text=b.ownermkt!=null||b.ownermkt!=""?b.ownermkt.toLowerCase():M_CultureVariable_Text;switch(M_CultureVariable_Text){case "en-ca":p=false;break;case "fr-ca":p=false}if(S())p=false;P(b,a.gadgetargs);g.registerFor("Spaces.LayoutManager",I);if(self.location==top.location){g.registerFor("Spaces.PartFrame",K);L()}Web.Gadget.attachElementManifest(o,a.manifesturl,a.gadgethosturl,b,y,ab,x||O,Q)};function R(){var b=/download\.gallery\.live\.com/i,c="download.gallery.start.com";return a.manifesturl.replace(b,c)}function Q(b){var a=Web.Gadget.ReadyState;switch(b){case a.isolating:if(!v&&F){r.SetGadgetApproved(d,J);v=true}if(!k&&F&&!$Browser.isSafari()&&!$Browser.isMozilla())n=setTimeout(D,1e4);break;case a.gadgetcancel:db();break;case a.error:g.HandleError()}}var D=function(){var a=0;if(f.scrollHeight)a=f.scrollHeight-2;if(a!=C&&a>25&&a!=250)r.SetVisitorHeight(d,a,M);else if(B>0){B--;n=setTimeout(D,1e4)}};function M(){}function I(b,a){if(a)j=b;else j=null}function K(d,g){if(g){if(!e){e=f;while(e.className.indexOf("spDefaultFrame")==-1&&e.parentNode)e=e.parentNode}var a=d._element;while(a.className.indexOf("spDefaultFrame")==-1&&a.parentNode)a=a.parentNode;if(a!=null&&a==e){l=d;if(c)for(var b=0;b<c.length;b++)d.addMenuItem(c[b].text,c[b].cb)}}else l=null}function db(){if(j!=null){j.displayToolbar();j.dirtyPage();var a=document.getElementById(d);a.style.display="none"}}function J(){}this.dispose=function(){o=f=G=H=m_bindingType=E=b=y=d=null;c=e=l=q=null;for(i=0;i<A.length;i++)A[i].onclick=null;c=null;j=null;if(h){window.clearTimeout(h);h=null}if(n){window.clearTimeout(n);n=null}Microsoft.Spaces.Gadget.Host.callBaseMethod(this,"dispose",arguments)};this.SetTitleText=function(){};this.SetTitleIcon=function(){};this.SetTitleLink=function(){};this.SetMetaData=function(){};this.GetView=function(){return y};this.Serialize=function(){u=Start.Util.ObjectToString(b);if(!h)h=setTimeout(X,200)};var X=function(){h=null;if(d&&k)if(w!=null&&w.length>0)r.SetPreferenceWithAuthToken(d,w,s,bb,u,z);else r.SetPreference(d,u,z)};this.HandleError=function(){f.innerHTML=GetString("live.sndefaultstrings.strings.rss.feedunavailabe")};function z(){}this.GetService=function(c,b){var a=null;switch(c){case "OwnerID":if(b=="1.0"){if(s&&s!="")a=s}else a=null;break;default:a=null}return a};this.GetPreference=function(a,b){return Start.Util.IsDefined(m[a])?m[a]:b};this.SetPreference=function(c,a){if(a.clone)try{a=a.clone()}catch(d){}b[c]=a;this.Serialize()};this.DeletePreference=function(a){b[a]=null};this.AddStandardAction=function(j,i,n,h){if(!k&&!h||k&&h)return null;if(h){if(c==null)c=[];c.push({text:j,cb:i});if(l)l.addMenuItem(j,i);if(!q)q=document.getElementById("pmenu_"+d);return q}else{var e=f.parentNode.childNodes,g=null;for(var b=0;b<e.length;b++)if(e[b].className&&e[b].className.indexOf("GadgetActions")>=0){g=e[b];break}if(g.childNodes.length!=0){var m=document.createTextNode(" | ");g.appendChild(m)}var a=document.createElement("a");a.innerText=j;a.onclick=function(){i();return false};a.href="#";g.appendChild(a);return a}};function P(d,a){try{if(a!=null&&a!=""){var b=Object.fromJSON(a);for(var c in b)d[c]=b[c]}}catch(e){}}function L(){g.AddStandardAction(GetString("live.sndefaultstrings.strings.gadget.framework.addspaces.tooltip"),V,Start.DashboardModule.ActionCodes.add,true);if(p)g.AddStandardAction(GetString("live.sndefaultstrings.strings.gadget.framework.addlivecom.tooltip"),W,Start.DashboardModule.ActionCodes.add,true);g.AddStandardAction(GetString("live.sndefaultstrings.strings.gadget.framework.learnmore"),cb,Start.DashboardModule.ActionCodes.add,true)}function W(){var b=null,c=a.manifesturl.split("/");if(c.length>=5){c=c[4].split(".");switch(c[0].toLowerCase()){case "horoscope":b="http://www.live.com/gadgets/horoscope/horoscope.xml";break;case "weather":liveUrl="http://www.live.com/gadgets/weather/weather.xml";b;case "stocks":b="http://www.live.com/gadgets/stocks/stock.xml";break;case "quoteoftheday":b="http://www.live.com/gadgets/quoteoftheday/quote.xml";break;case "updatedspaces":break;default:b=a.manifesturl}}else b=a.manifesturl;if(b){var d="http://www.live.com?add="+b;window.open(d,"_blank")}}function S(){var b=a.manifesturl.split("/");if(b.length>=5){b=b[4].split(".");if(b[0].toLowerCase()=="updatedspaces")return true;else return false}else return false}function V(){manifestUrl=N();if(manifestUrl){var a=manifestUrl.startsWith("/")?"AddModule":"AddGadget";Z("600","CM=Gadgets&CE="+encodeURIComponent(manifestUrl)+"&HL=AddGadget");var b=SpacesUrlBuilder.ConstructFrontdoorUrl("/api.aspx","wx_action="+a+"&wxp_url="+manifestUrl);window.open(b,"_blank")}}function N(){var b=null,c=a.manifesturl.split("/");if(c.length>=5){c=c[4].split(".");switch(c[0].toLowerCase()){case "horoscope":b="/_gadgets/horoscope.aspx";break;case "weather":b="/_gadgets/weather.aspx";break;case "stocks":b="/_gadgets/stocks.aspx";break;case "quoteoftheday":b="/_gadgets/quoteoftheday.aspx";break;case "updatedspaces":b="/_gadgets/updatedspaces.aspx";break;default:b=a.manifesturl}}else b=a.manifesturl;return b}function Z(c,d){var b=a.ownermkt.replace("-","_"),e=new Image;e.src=T+"/_0SA"+b+"/"+c+"?"+d}function cb(){var b=$Request.extractHost(document.location),a=b.split("."),c=a.length;if(c>=2)b=a[c-2]+"."+a[c-1];LaunchHelp("http://help."+b,"WL_Spaces",$Config.culture,"","keyword","stegdag",false,"b1","","","")}};Microsoft.Spaces.Gadget.Host.Params=new $Enum("manifesturl","preferences","moduleid","authorview","isowner","ownermkt","gadgetargs","alias","ownerid","trusted","gadgethosturl","iframed","gadgetapproved","authtoken","allowinlineflag","visitorheight","glinkserver","userid","safedomain");Microsoft.Spaces.Gadget.Host.registerClass("Microsoft.Spaces.Gadget.Host","$Binding");Microsoft.Spaces.Gadget.Host.skipClass=true;registerNamespace("Start.DashboardModule");Start.DashboardModule.ActionCodes=new $Enum("add","settings")